==========config==========
{'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'testing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 50,
 'epochs': 500,
 'freeze_mlp': 500,
 'group': 'Ours',
 'if_adaptive': 1,
 'if_double_label': 1,
 'if_multicore': 1,
 'if_projector': 0,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'job_type': 'yelp2018',
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'simple_Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'name': 'mixup',
 'notes': '3InfoNCE',
 'num_layers': 3,
 'perplexity': 50,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'sampling': 'uiij',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'tag': ['mixup'],
 'temp_tau': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'visual_epoch': 3,
 'weight_decay': 0.0001}
==========config==========
[0;30;43m[DATALOADER--START][0m
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
31668 users and 38048 items
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
yelp2018 is ready to go
[0;30;43m[DATALOADER--END][0m
[0;30;43m[PRECALCULATE--START][0m
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0008237361907958984
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.09099674224853516
shape test : 2474518 == 2474518
precal cost :  0.7096166610717773
[0;30;43m[PRECALCULATE--END][0m
[0;30;43m[SAMPLER--START][0m
[0;30;43m[SAMPLER--END][0m
user:31668, item:38048
[0;30;43muse NORMAL distribution UI for Embedding[0m
GCL Model is ready to go!
[0;30;43m[TRAIN][0m
EPOCH[0]:loss 5.726
[0;30;43m[TEST][0m
{'precision': array([0.01952128, 0.01647167]), 'recall': array([0.04159923, 0.06992995]), 'recall_pop': {0: array([0.00013789, 0.00026999]), 1: array([0.00010736, 0.00059682]), 2: array([0.00025894, 0.00082075]), 3: array([0.00050524, 0.00183124]), 4: array([0.00081772, 0.00226751]), 5: array([0.00149608, 0.00459313]), 6: array([0.0031233 , 0.00818765]), 7: array([0.00756962, 0.01785231]), 8: array([0.02112345, 0.0423972 ]), 9: array([0.091287  , 0.14141553])}, 'recall_pop_Contribute': {0: array([2.79693168e-05, 6.24728765e-05]), 1: array([2.5178427e-05, 1.0342996e-04]), 2: array([4.48818972e-05, 1.31833438e-04]), 3: array([7.54365594e-05, 2.83877082e-04]), 4: array([0.00013019, 0.00035989]), 5: array([0.00027141, 0.00075053]), 6: array([0.00051789, 0.00137396]), 7: array([0.0014598, 0.0033365]), 8: array([0.00465876, 0.0092301 ]), 9: array([0.03438772, 0.05429736])}, 'ndcg': array([0.03452054, 0.0451748 ])}
[5;37;44mfind a better recall[0m [0;37;44m0.04159922699540106[0m [0;37;44m++0.04159922699540106[0m
total time cost of epoch 0:  63.37286996841431
[0;30;43m[TRAIN][0m
EPOCH[1]:loss 4.661
[0;30;43m[TEST][0m
{'precision': array([0.02298061, 0.01923866]), 'recall': array([0.05056329, 0.08384609]), 'recall_pop': {0: array([0.00038735, 0.00134375]), 1: array([0.0008447 , 0.00253046]), 2: array([0.00114473, 0.00308096]), 3: array([0.00191469, 0.00490447]), 4: array([0.00312793, 0.00770821]), 5: array([0.00552095, 0.01297601]), 6: array([0.00866676, 0.02008347]), 7: array([0.01679438, 0.03379251]), 8: array([0.03647608, 0.06576978]), 9: array([0.09266973, 0.13879492])}, 'recall_pop_Contribute': {0: array([9.95010198e-05, 2.66072663e-04]), 1: array([0.00014024, 0.00042122]), 2: array([0.00018666, 0.00046172]), 3: array([0.00029315, 0.00076297]), 4: array([0.0005027 , 0.00119287]), 5: array([0.00093982, 0.00210329]), 6: array([0.00141166, 0.00341443]), 7: array([0.00318701, 0.00643268]), 8: array([0.00806477, 0.01444296]), 9: array([0.03573776, 0.05434787])}, 'ndcg': array([0.04188104, 0.05445357])}
[5;37;44mfind a better recall[0m [0;37;44m0.05056328780083954[0m [0;37;44m++0.008964060805438476[0m
total time cost of epoch 1:  64.22547960281372
[0;30;43m[TRAIN][0m
EPOCH[2]:loss 4.312
[0;30;43m[TEST][0m
{'precision': array([0.023789  , 0.01992863]), 'recall': array([0.0526924, 0.0876043]), 'recall_pop': {0: array([0.00110259, 0.00278434]), 1: array([0.00163001, 0.0042302 ]), 2: array([0.0021292 , 0.00558561]), 3: array([0.00314415, 0.00793261]), 4: array([0.00524674, 0.01158673]), 5: array([0.00880931, 0.01889309]), 6: array([0.01286811, 0.02747324]), 7: array([0.02375993, 0.04323767]), 8: array([0.04695373, 0.07835772]), 9: array([0.08425466, 0.12744786])}, 'recall_pop_Contribute': {0: array([0.00022093, 0.00055092]), 1: array([0.0002729 , 0.00066364]), 2: array([0.00032993, 0.00081629]), 3: array([0.00048171, 0.00120021]), 4: array([0.00081586, 0.00181647]), 5: array([0.00142933, 0.00308327]), 6: array([0.00213246, 0.00466402]), 7: array([0.00450748, 0.008235  ]), 8: array([0.01031758, 0.01717587]), 9: array([0.03218422, 0.04939861])}, 'ndcg': array([0.04382613, 0.05705226])}
[5;37;44mfind a better recall[0m [0;37;44m0.05269240230330112[0m [0;37;44m++0.0021291145024615807[0m
total time cost of epoch 2:  61.799978494644165
[0;30;43m[TRAIN][0m
EPOCH[3]:loss 4.130
[0;30;43m[TEST][0m
{'precision': array([0.02361848, 0.01973522]), 'recall': array([0.05218701, 0.08666683]), 'recall_pop': {0: array([0.00161332, 0.00410269]), 1: array([0.00242283, 0.00580357]), 2: array([0.003136  , 0.00725528]), 3: array([0.00456913, 0.01034514]), 4: array([0.00652525, 0.01456023]), 5: array([0.01125139, 0.02279852]), 6: array([0.01695034, 0.03320379]), 7: array([0.02865105, 0.05077174]), 8: array([0.05338558, 0.08599776]), 9: array([0.07322228, 0.11136878])}, 'recall_pop_Contribute': {0: array([0.00032792, 0.0007956 ]), 1: array([0.0003912 , 0.00091717]), 2: array([0.00046761, 0.00105787]), 3: array([0.00068036, 0.00158433]), 4: array([0.00101399, 0.00227833]), 5: array([0.00185128, 0.00378587]), 6: array([0.00283488, 0.00564732]), 7: array([0.00544072, 0.00960168]), 8: array([0.01171124, 0.01891792]), 9: array([0.0274678 , 0.04208076])}, 'ndcg': array([0.04337388, 0.0564208 ])}
total time cost of epoch 3:  60.85063171386719
[0;30;43m[TRAIN][0m
EPOCH[4]:loss 4.022
[0;30;43m[TEST][0m
{'precision': array([0.02283851, 0.0191463 ]), 'recall': array([0.05045794, 0.08392095]), 'recall_pop': {0: array([0.00227108, 0.00571208]), 1: array([0.00322988, 0.00760858]), 2: array([0.00390172, 0.00843969]), 3: array([0.00546045, 0.01196478]), 4: array([0.00871038, 0.01757524]), 5: array([0.01338518, 0.02673084]), 6: array([0.02035065, 0.0375579 ]), 7: array([0.03288195, 0.05604244]), 8: array([0.05812235, 0.09052546]), 9: array([0.06121226, 0.09398904])}, 'recall_pop_Contribute': {0: array([0.00048013, 0.00112299]), 1: array([0.00050245, 0.00121985]), 2: array([0.00059786, 0.00124934]), 3: array([0.0008249 , 0.00180257]), 4: array([0.00131043, 0.00268744]), 5: array([0.00222494, 0.00446075]), 6: array([0.00344989, 0.00642253]), 7: array([0.00623098, 0.01057305]), 8: array([0.01280665, 0.01994968]), 9: array([0.0220297 , 0.03443275])}, 'ndcg': array([0.04158177, 0.05427716])}
total time cost of epoch 4:  60.84772443771362
[0;30;43m[TRAIN][0m
EPOCH[5]:loss 3.954
[0;30;43m[TEST][0m
{'precision': array([0.02182171, 0.01840817]), 'recall': array([0.0481474, 0.0806098]), 'recall_pop': {0: array([0.00280377, 0.00664461]), 1: array([0.00395678, 0.00893534]), 2: array([0.00473717, 0.00969621]), 3: array([0.00637439, 0.01309158]), 4: array([0.00991566, 0.01999065]), 5: array([0.01514633, 0.02964838]), 6: array([0.02283623, 0.04115028]), 7: array([0.03609036, 0.06154675]), 8: array([0.06000222, 0.09331294]), 9: array([0.04998831, 0.07772143])}, 'recall_pop_Contribute': {0: array([0.00054522, 0.00130403]), 1: array([0.00063236, 0.00143457]), 2: array([0.00069604, 0.00140086]), 3: array([0.00095569, 0.00195163]), 4: array([0.00152974, 0.00306083]), 5: array([0.00255375, 0.00493117]), 6: array([0.00385525, 0.00701385]), 7: array([0.00685276, 0.01159154]), 8: array([0.01323763, 0.02051831]), 9: array([0.01728897, 0.027403  ])}, 'ndcg': array([0.03956528, 0.05190771])}
total time cost of epoch 5:  60.41219234466553
[0;30;43m[TRAIN][0m
EPOCH[6]:loss 3.909
[0;30;43m[TEST][0m
{'precision': array([0.02097385, 0.01771978]), 'recall': array([0.04631597, 0.07728848]), 'recall_pop': {0: array([0.00334966, 0.00774768]), 1: array([0.00484173, 0.01029523]), 2: array([0.00538106, 0.01121256]), 3: array([0.00723627, 0.01400763]), 4: array([0.01183017, 0.02177377]), 5: array([0.01706716, 0.03170852]), 6: array([0.02511154, 0.04334304]), 7: array([0.03891469, 0.06323947]), 8: array([0.06144642, 0.09388768]), 9: array([0.03996621, 0.0645269 ])}, 'recall_pop_Contribute': {0: array([0.00065457, 0.00151275]), 1: array([0.00076854, 0.00158412]), 2: array([0.00078506, 0.00162962]), 3: array([0.00108216, 0.00210849]), 4: array([0.00184054, 0.00328032]), 5: array([0.00288234, 0.00527605]), 6: array([0.0042528 , 0.00731944]), 7: array([0.00731131, 0.0119222 ]), 8: array([0.01354025, 0.02073414]), 9: array([0.01319839, 0.02192134])}, 'ndcg': array([0.03769152, 0.04952141])}
total time cost of epoch 6:  61.60145044326782
[0;30;43m[TRAIN][0m
[0;30;43mtesting[0m
