==========config==========
{'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'testing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 50,
 'epochs': 500,
 'freeze_mlp': 500,
 'group': 'Ours',
 'if_adaptive': 1,
 'if_double_label': 1,
 'if_multicore': 1,
 'if_projector': 0,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'job_type': 'yelp2018',
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'simple_Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'name': 'mixup',
 'notes': '3InfoNCE',
 'num_layers': 3,
 'perplexity': 50,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'sampling': 'uiij',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'tag': ['mixup'],
 'temp_tau': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'visual_epoch': 3,
 'weight_decay': 0.0001}
==========config==========
[0;30;43m[DATALOADER--START][0m
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
31668 users and 38048 items
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
yelp2018 is ready to go
[0;30;43m[DATALOADER--END][0m
[0;30;43m[PRECALCULATE--START][0m
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0007700920104980469
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.08229565620422363
shape test : 2474518 == 2474518
precal cost :  0.6713390350341797
[0;30;43m[PRECALCULATE--END][0m
[0;30;43m[SAMPLER--START][0m
[0;30;43m[SAMPLER--END][0m
user:31668, item:38048
[0;30;43muse NORMAL distribution UI for Embedding[0m
GCL Model is ready to go!
[0;30;43m[TRAIN][0m
EPOCH[0]:loss 6.143
[0;30;43m[TEST][0m
{'precision': array([0.01970128, 0.01665561]), 'recall': array([0.04200741, 0.07079954]), 'recall_pop': {0: array([0.00013789, 0.00030157]), 1: array([7.57862827e-05, 5.75765231e-04]), 2: array([0.00028262, 0.00083053]), 3: array([0.00051314, 0.00185229]), 4: array([0.00096771, 0.00234383]), 5: array([0.00151187, 0.00473526]), 6: array([0.00316541, 0.00835893]), 7: array([0.00766462, 0.01829262]), 8: array([0.02144318, 0.04343862]), 9: array([0.09197685, 0.142984  ])}, 'recall_pop_Contribute': {0: array([2.79693168e-05, 6.69839648e-05]), 1: array([1.88629035e-05, 1.01911806e-04]), 2: array([5.21261743e-05, 1.29499515e-04]), 3: array([7.68499125e-05, 2.73411936e-04]), 4: array([0.00014931, 0.00037882]), 5: array([0.00027209, 0.00077015]), 6: array([0.00051968, 0.00139025]), 7: array([0.00147521, 0.00341261]), 8: array([0.00473846, 0.00943135]), 9: array([0.03467686, 0.05484454])}, 'ndcg': array([0.0348572 , 0.04568835])}
[5;37;44mfind a better recall[0m [0;37;44m0.042007409320487195[0m [0;37;44m++0.042007409320487195[0m
total time cost of epoch 0:  64.87013792991638
[0;30;43m[TRAIN][0m
EPOCH[1]:loss 4.648
[0;30;43m[TEST][0m
{'precision': array([0.02311324, 0.01936103]), 'recall': array([0.05076363, 0.08444316]), 'recall_pop': {0: array([0.00038735, 0.00139655]), 1: array([0.00084996, 0.00254888]), 2: array([0.00123314, 0.00304517]), 3: array([0.00185154, 0.00491785]), 4: array([0.00308056, 0.00793557]), 5: array([0.005512  , 0.01285865]), 6: array([0.00882097, 0.02025271]), 7: array([0.01684234, 0.0340501 ]), 8: array([0.03714921, 0.06652659]), 9: array([0.09282982, 0.13963418])}, 'recall_pop_Contribute': {0: array([0.00010204, 0.00027339]), 1: array([0.00013474, 0.00042403]), 2: array([0.0001906 , 0.00045087]), 3: array([0.00028694, 0.0007661 ]), 4: array([0.00049894, 0.00121255]), 5: array([0.00094068, 0.00208311]), 6: array([0.00142772, 0.00344478]), 7: array([0.00320904, 0.00650032]), 8: array([0.00820537, 0.01464766]), 9: array([0.03576756, 0.05464034])}, 'ndcg': array([0.04206544, 0.05477919])}
[5;37;44mfind a better recall[0m [0;37;44m0.050763629615808895[0m [0;37;44m++0.0087562202953217[0m
total time cost of epoch 1:  64.03909969329834
[0;30;43m[TRAIN][0m
EPOCH[2]:loss 4.304
[0;30;43m[TEST][0m
{'precision': array([0.02386794, 0.01999495]), 'recall': array([0.05285805, 0.08790646]), 'recall_pop': {0: array([0.00110823, 0.00284223]), 1: array([0.00162474, 0.00420915]), 2: array([0.00210258, 0.00549456]), 3: array([0.00311652, 0.00804757]), 4: array([0.00519276, 0.01172094]), 5: array([0.008608  , 0.01867355]), 6: array([0.01287413, 0.02747242]), 7: array([0.02423242, 0.04346664]), 8: array([0.04715262, 0.07879879]), 9: array([0.08436248, 0.1278245 ])}, 'recall_pop_Contribute': {0: array([0.0002212 , 0.00055934]), 1: array([0.00028224, 0.00065705]), 2: array([0.00031807, 0.0008144 ]), 3: array([0.0004806 , 0.00122698]), 4: array([0.00081579, 0.00182796]), 5: array([0.00140697, 0.00305428]), 6: array([0.00214701, 0.00467133]), 7: array([0.00460287, 0.00829812]), 8: array([0.01038503, 0.01727073]), 9: array([0.03219828, 0.04952626])}, 'ndcg': array([0.0439703 , 0.05724801])}
[5;37;44mfind a better recall[0m [0;37;44m0.052858052981818365[0m [0;37;44m++0.0020944233660094708[0m
total time cost of epoch 2:  64.07719588279724
[0;30;43m[TRAIN][0m
EPOCH[3]:loss 4.125
[0;30;43m[TEST][0m
{'precision': array([0.02371005, 0.01977233]), 'recall': array([0.05241365, 0.08675556]), 'recall_pop': {0: array([0.00158701, 0.0040352 ]), 1: array([0.00243806, 0.00580778]), 2: array([0.0030781 , 0.00710002]), 3: array([0.00437177, 0.01021988]), 4: array([0.00670787, 0.01471097]), 5: array([0.01128783, 0.02264102]), 6: array([0.017144  , 0.03334595]), 7: array([0.02897844, 0.05105794]), 8: array([0.05378113, 0.08612504]), 9: array([0.07340647, 0.11166013])}, 'recall_pop_Contribute': {0: array([0.00032118, 0.0007836 ]), 1: array([0.00039944, 0.00091137]), 2: array([0.00046256, 0.00104026]), 3: array([0.00064528, 0.00156136]), 4: array([0.00103809, 0.00231547]), 5: array([0.00185826, 0.00375137]), 6: array([0.0028806 , 0.00565954]), 7: array([0.00548395, 0.00965896]), 8: array([0.0118153 , 0.01896182]), 9: array([0.02750899, 0.04211181])}, 'ndcg': array([0.04346623, 0.05646874])}
total time cost of epoch 3:  64.82664608955383
[0;30;43m[TRAIN][0m
EPOCH[4]:loss 4.019
[0;30;43m[TEST][0m
{'precision': array([0.02282904, 0.01915893]), 'recall': array([0.05044915, 0.08397472]), 'recall_pop': {0: array([0.00223498, 0.00553151]), 1: array([0.00309304, 0.00741122]), 2: array([0.00384251, 0.00834916]), 3: array([0.00530624, 0.01193058]), 4: array([0.00868935, 0.01747428]), 5: array([0.01350877, 0.02671824]), 6: array([0.02048643, 0.03742405]), 7: array([0.03303154, 0.05614331]), 8: array([0.05835155, 0.09097012]), 9: array([0.06123812, 0.09444922])}, 'recall_pop_Contribute': {0: array([0.00047525, 0.00108476]), 1: array([0.00048126, 0.00120034]), 2: array([0.00058643, 0.0012245 ]), 3: array([0.00078336, 0.00179867]), 4: array([0.00130992, 0.00267578]), 5: array([0.00225292, 0.00445273]), 6: array([0.00347801, 0.00638821]), 7: array([0.00624782, 0.01061181]), 8: array([0.01285447, 0.02002013]), 9: array([0.0219797 , 0.03451778])}, 'ndcg': array([0.04161972, 0.0543514 ])}
total time cost of epoch 4:  64.21211218833923
[0;30;43m[TRAIN][0m
EPOCH[5]:loss 3.952
[0;30;43m[TEST][0m
{'precision': array([0.02183592, 0.01840344]), 'recall': array([0.0480916 , 0.08055813]), 'recall_pop': {0: array([0.00283608, 0.00656982]), 1: array([0.00386731, 0.00886692]), 2: array([0.00452929, 0.00959516]), 3: array([0.00646649, 0.01298399]), 4: array([0.00982514, 0.01970382]), 5: array([0.01536377, 0.02975173]), 6: array([0.02294728, 0.04133486]), 7: array([0.03626579, 0.06163103]), 8: array([0.06024476, 0.09335409]), 9: array([0.04985468, 0.07762974])}, 'recall_pop_Contribute': {0: array([0.00055263, 0.00127841]), 1: array([0.00062604, 0.0014292 ]), 2: array([0.00067041, 0.00139306]), 3: array([0.0009657 , 0.00194709]), 4: array([0.00150886, 0.00301775]), 5: array([0.00258038, 0.00492895]), 6: array([0.00389411, 0.00703138]), 7: array([0.00687292, 0.01161362]), 8: array([0.01324521, 0.02055107]), 9: array([0.01717534, 0.02736763])}, 'ndcg': array([0.0395186 , 0.05186156])}
total time cost of epoch 5:  69.10830044746399
[0;30;43m[TRAIN][0m
EPOCH[6]:loss 3.908
[0;30;43m[TEST][0m
{'precision': array([0.02098491, 0.01777425]), 'recall': array([0.0462834 , 0.07742809]), 'recall_pop': {0: array([0.00334567, 0.00759378]), 1: array([0.00469963, 0.01022243]), 2: array([0.00531189, 0.01105353]), 3: array([0.00725206, 0.01409079]), 4: array([0.01184596, 0.02173957]), 5: array([0.01693198, 0.03189701]), 6: array([0.02520868, 0.04359414]), 7: array([0.03902604, 0.0637005 ]), 8: array([0.06139208, 0.09434579]), 9: array([0.03990549, 0.06465535])}, 'recall_pop_Contribute': {0: array([0.00064863, 0.001471  ]), 1: array([0.0007411 , 0.00158084]), 2: array([0.00078257, 0.00161145]), 3: array([0.00109436, 0.00213294]), 4: array([0.00184211, 0.00327337]), 5: array([0.0028629 , 0.00530537]), 6: array([0.00427892, 0.00734135]), 7: array([0.00734729, 0.01201002]), 8: array([0.01350134, 0.02081166]), 9: array([0.01318417, 0.0218901 ])}, 'ndcg': array([0.03773563, 0.04964029])}
total time cost of epoch 6:  64.29992389678955
[0;30;43m[TRAIN][0m
EPOCH[7]:loss 3.874
[0;30;43m[TEST][0m
{'precision': array([0.02037704, 0.01721849]), 'recall': array([0.04499454, 0.0751297 ]), 'recall_pop': {0: array([0.00402961, 0.008691  ]), 1: array([0.00522442, 0.01111041]), 2: array([0.00601103, 0.01223007]), 3: array([0.00787519, 0.01504557]), 4: array([0.0124987 , 0.02341723]), 5: array([0.01870566, 0.03436965]), 6: array([0.02635755, 0.04580121]), 7: array([0.04044534, 0.06498512]), 8: array([0.06182538, 0.09471344]), 9: array([0.03280143, 0.05348688])}, 'recall_pop_Contribute': {0: array([0.00078523, 0.00165878]), 1: array([0.00081799, 0.00172513]), 2: array([0.00088531, 0.00179447]), 3: array([0.00117842, 0.00225247]), 4: array([0.00190443, 0.00354095]), 5: array([0.0031195 , 0.00575634]), 6: array([0.00451838, 0.00771371]), 7: array([0.00764179, 0.01215255]), 8: array([0.01365188, 0.02095547]), 9: array([0.01049163, 0.01757983])}, 'ndcg': array([0.03651685, 0.04804251])}
total time cost of epoch 7:  65.85686111450195
[0;30;43m[TRAIN][0m
EPOCH[8]:loss 3.849
[0;30;43m[TEST][0m
{'precision': array([0.01972654, 0.01670061]), 'recall': array([0.04332657, 0.07280949]), 'recall_pop': {0: array([0.00454164, 0.00970211]), 1: array([0.00587386, 0.01210371]), 2: array([0.00674675, 0.01355846]), 3: array([0.00856919, 0.01639268]), 4: array([0.01329919, 0.02581396]), 5: array([0.02031889, 0.03539142]), 6: array([0.02757624, 0.0468068 ]), 7: array([0.04095263, 0.06644331]), 8: array([0.06117396, 0.09371088]), 9: array([0.02572007, 0.04345727])}, 'recall_pop_Contribute': {0: array([0.0008807 , 0.00183733]), 1: array([0.00093817, 0.00185016]), 2: array([0.00096601, 0.00196243]), 3: array([0.00127957, 0.0024294 ]), 4: array([0.00200602, 0.00388677]), 5: array([0.00339497, 0.00586347]), 6: array([0.00463728, 0.00787789]), 7: array([0.00770317, 0.01250185]), 8: array([0.01353853, 0.02072587]), 9: array([0.00798216, 0.01387434])}, 'ndcg': array([0.03543382, 0.04668693])}
total time cost of epoch 8:  65.54643106460571
[0;30;43m[TRAIN][0m
EPOCH[9]:loss 3.830
[0;30;43m[TEST][0m
{'precision': array([0.01934129, 0.01642194]), 'recall': array([0.04252372, 0.07142766]), 'recall_pop': {0: array([0.00505025, 0.01066325]), 1: array([0.00668789, 0.01321495]), 2: array([0.00755018, 0.01463123]), 3: array([0.00960121, 0.01783866]), 4: array([0.01407337, 0.02653493]), 5: array([0.02105076, 0.03732711]), 6: array([0.02904367, 0.04831806]), 7: array([0.04177628, 0.06778757]), 8: array([0.05991581, 0.09163466]), 9: array([0.02069654, 0.03621081])}, 'recall_pop_Contribute': {0: array([0.00099031, 0.00204122]), 1: array([0.00106628, 0.00202294]), 2: array([0.00109661, 0.00210199]), 3: array([0.00143604, 0.00262741]), 4: array([0.00215969, 0.00402548]), 5: array([0.00348462, 0.0061462 ]), 6: array([0.00494511, 0.00818365]), 7: array([0.00782308, 0.01270356]), 8: array([0.01328486, 0.02033588]), 9: array([0.00623712, 0.01123932])}, 'ndcg': array([0.03466066, 0.04571754])}
total time cost of epoch 9:  64.08375978469849
[0;30;43m[TRAIN][0m
EPOCH[10]:loss 3.815
[0;30;43m[TEST][0m
{'precision': array([0.01894973, 0.0161709 ]), 'recall': array([0.04159024, 0.07021946]), 'recall_pop': {0: array([0.00553459, 0.01192192]), 1: array([0.00721343, 0.01400658]), 2: array([0.00793227, 0.01539448]), 3: array([0.01024093, 0.01887398]), 4: array([0.01519595, 0.02761888]), 5: array([0.02208812, 0.03810173]), 6: array([0.02935061, 0.0498762 ]), 7: array([0.04198451, 0.06848141]), 8: array([0.05757917, 0.09004669]), 9: array([0.01682487, 0.0297406 ])}, 'recall_pop_Contribute': {0: array([0.00104068, 0.00225014]), 1: array([0.00114357, 0.00211328]), 2: array([0.00113438, 0.00222973]), 3: array([0.00150268, 0.00274886]), 4: array([0.00233451, 0.00418325]), 5: array([0.00367224, 0.00630205]), 6: array([0.00503351, 0.00843493]), 7: array([0.00786907, 0.01282985]), 8: array([0.01282061, 0.02006696]), 9: array([0.00503898, 0.00906042])}, 'ndcg': array([0.03406264, 0.04502759])}
total time cost of epoch 10:  65.30888438224792
[0;30;43m[TRAIN][0m
EPOCH[11]:loss 3.803
[0;30;43m[TEST][0m
{'precision': array([0.01858974, 0.01590644]), 'recall': array([0.04081278, 0.06897536]), 'recall_pop': {0: array([0.00600303, 0.01279817]), 1: array([0.00781472, 0.01518112]), 2: array([0.00862285, 0.01646711]), 3: array([0.01032002, 0.01979138]), 4: array([0.01595101, 0.02901292]), 5: array([0.02322936, 0.03860534]), 6: array([0.02985533, 0.04934348]), 7: array([0.04227853, 0.06836134]), 8: array([0.05594684, 0.0872514 ]), 9: array([0.01353878, 0.02522637])}, 'recall_pop_Contribute': {0: array([0.001148  , 0.00245288]), 1: array([0.00124207, 0.00231416]), 2: array([0.00125721, 0.00240508]), 3: array([0.00151317, 0.00288226]), 4: array([0.00238707, 0.00436458]), 5: array([0.00383704, 0.00638424]), 6: array([0.00513472, 0.0083571 ]), 7: array([0.00794814, 0.01277738]), 8: array([0.01239171, 0.01943999]), 9: array([0.00395365, 0.0075977 ])}, 'ndcg': array([0.03339643, 0.04417401])}
total time cost of epoch 11:  64.3955147266388
[0;30;43m[TRAIN][0m
EPOCH[12]:loss 3.792
[0;30;43m[TEST][0m
{'precision': array([0.01846975, 0.01556382]), 'recall': array([0.04033258, 0.06736056]), 'recall_pop': {0: array([0.00675188, 0.01344645]), 1: array([0.00830082, 0.01556074]), 2: array([0.00928098, 0.01742816]), 3: array([0.01124807, 0.02065968]), 4: array([0.01672119, 0.02950907]), 5: array([0.02385892, 0.0394507 ]), 6: array([0.03024109, 0.04975878]), 7: array([0.04252164, 0.06753458]), 8: array([0.05382463, 0.08436406]), 9: array([0.0108388 , 0.02025763])}, 'recall_pop_Contribute': {0: array([0.00127096, 0.00253845]), 1: array([0.00129171, 0.00237866]), 2: array([0.00136835, 0.0025394 ]), 3: array([0.00164457, 0.00299563]), 4: array([0.00250358, 0.00446676]), 5: array([0.00393234, 0.00650145]), 6: array([0.00517751, 0.00844263]), 7: array([0.00805704, 0.01263183]), 8: array([0.01196941, 0.01883108]), 9: array([0.0031171 , 0.00603468])}, 'ndcg': array([0.03296321, 0.04326339])}
total time cost of epoch 12:  64.15596723556519
[0;30;43m[TRAIN][0m
EPOCH[13]:loss 3.783
[0;30;43m[TEST][0m
{'precision': array([0.01819187, 0.01538146]), 'recall': array([0.03966716, 0.06656786]), 'recall_pop': {0: array([0.00740807, 0.0139651 ]), 1: array([0.00806556, 0.01632537]), 2: array([0.00949785, 0.01807178]), 3: array([0.01155968, 0.0207449 ]), 4: array([0.01640509, 0.02989026]), 5: array([0.02434183, 0.03997123]), 6: array([0.03091139, 0.0509666 ]), 7: array([0.04207677, 0.06766525]), 8: array([0.05203055, 0.08250828]), 9: array([0.00904856, 0.01732104])}, 'recall_pop_Contribute': {0: array([0.00139191, 0.00262549]), 1: array([0.00124155, 0.00245501]), 2: array([0.00142083, 0.00261167]), 3: array([0.00170595, 0.00301654]), 4: array([0.0024511 , 0.00454264]), 5: array([0.00400174, 0.00659796]), 6: array([0.00524446, 0.00861956]), 7: array([0.0080034 , 0.01267984]), 8: array([0.01159685, 0.01829423]), 9: array([0.00260937, 0.00512492])}, 'ndcg': array([0.03260749, 0.04287181])}
total time cost of epoch 13:  65.97865271568298
[0;30;43m[TRAIN][0m
EPOCH[14]:loss 3.775
[0;30;43m[TEST][0m
{'precision': array([0.01801345, 0.01521331]), 'recall': array([0.03930168, 0.06595658]), 'recall_pop': {0: array([0.00739359, 0.01492887]), 1: array([0.00867606, 0.01684284]), 2: array([0.00995076, 0.01870491]), 3: array([0.0128824 , 0.02181109]), 4: array([0.01792579, 0.03071683]), 5: array([0.02458639, 0.04101002]), 6: array([0.03034948, 0.05008444]), 7: array([0.04192452, 0.06729688]), 8: array([0.05088438, 0.08060162]), 9: array([0.00736944, 0.01419503])}, 'recall_pop_Contribute': {0: array([0.00141136, 0.00279459]), 1: array([0.00134258, 0.00256025]), 2: array([0.00148044, 0.00271175]), 3: array([0.00188321, 0.00319353]), 4: array([0.00266359, 0.00463062]), 5: array([0.00402605, 0.00675287]), 6: array([0.00517687, 0.00851318]), 7: array([0.00795444, 0.0126468 ]), 8: array([0.01129443, 0.01792299]), 9: array([0.00206871, 0.00423002])}, 'ndcg': array([0.0322852 , 0.04243379])}
total time cost of epoch 14:  64.10402941703796
[0;30;43m[TRAIN][0m
[0;30;43mtesting[0m
