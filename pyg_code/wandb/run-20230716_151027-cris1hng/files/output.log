==========config==========
{'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'testing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 50,
 'epochs': 500,
 'freeze_mlp': 500,
 'group': 'Ours',
 'if_adaptive': 1,
 'if_double_label': 1,
 'if_multicore': 1,
 'if_projector': 0,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'job_type': 'yelp2018',
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'simple_Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'name': 'mixup',
 'notes': 'loss_no_1/3_mixcoef_1/epoch',
 'num_layers': 3,
 'perplexity': 50,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'sampling': 'uiij',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'tag': ['mixup'],
 'temp_tau': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'visual_epoch': 3,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
31668 users and 38048 items
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0012633800506591797
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.09644198417663574
shape test : 2474518 == 2474518
precal cost :  0.7536680698394775
[PRECALCULATE--END]
[SAMPLER--START]
[SAMPLER--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[TRAIN]


































training: 604it [01:08,  8.78it/s]
EPOCH[0]:loss 18.436
[TEST]
{'precision': array([0.01969812, 0.01665483]), 'recall': array([0.04199741, 0.07080223]), 'recall_pop': {0: array([0.00013789, 0.00030157]), 1: array([7.57862827e-05, 5.75765231e-04]), 2: array([0.00028262, 0.00083053]), 3: array([0.00051314, 0.00185229]), 4: array([0.00096771, 0.0023754 ]), 5: array([0.00151187, 0.00473526]), 6: array([0.00316541, 0.00837472]), 7: array([0.00765409, 0.01828473]), 8: array([0.02144318, 0.04341932]), 9: array([0.09195077, 0.14300471])}, 'recall_pop_Contribute': {0: array([2.79693168e-05, 6.69839648e-05]), 1: array([1.88629035e-05, 1.01911806e-04]), 2: array([5.21261743e-05, 1.29499515e-04]), 3: array([7.68499125e-05, 2.73411936e-04]), 4: array([0.00014931, 0.00038333]), 5: array([0.00027209, 0.00077015]), 6: array([0.00051968, 0.00139236]), 7: array([0.00147069, 0.0034113 ]), 8: array([0.00473846, 0.00942572]), 9: array([0.03467137, 0.05484757])}, 'ndcg': array([0.0348532 , 0.04568906])}
[5mfind a better recall[25m 0.04199740974152209 ++0.04199740974152209
total time cost of epoch 0:  78.25361752510071
[TRAIN]

































training: 596it [01:07, 10.97it/s]
EPOCH[1]:loss 11.841

training: 604it [01:08,  8.84it/s]
{'precision': array([0.02320008, 0.01946523]), 'recall': array([0.05082867, 0.08462151]), 'recall_pop': {0: array([0.0003242 , 0.00097434]), 1: array([0.00058155, 0.00197785]), 2: array([0.00094895, 0.00244836]), 3: array([0.00160418, 0.00442703]), 4: array([0.00256532, 0.00674918]), 5: array([0.00443589, 0.01131189]), 6: array([0.00728562, 0.01771665]), 7: array([0.01469937, 0.03056313]), 8: array([0.03371953, 0.06169073]), 9: array([0.09780778, 0.14777151])}, 'recall_pop_Contribute': {0: array([8.07433750e-05, 2.06762168e-04]), 1: array([0.00011462, 0.00033815]), 2: array([0.0001583, 0.0003815]), 3: array([0.00025033, 0.00068475]), 4: array([0.00042093, 0.00105891]), 5: array([0.00076551, 0.00184683]), 6: array([0.00117979, 0.00299865]), 7: array([0.0028    , 0.00581364]), 8: array([0.00741123, 0.01360492]), 9: array([0.03764721, 0.0576874 ])}, 'ndcg': array([0.04202674, 0.05476342])}
[5mfind a better recall[25m 0.050828667396841096 ++0.008831257655319003
total time cost of epoch 1:  78.22590661048889
[TRAIN]


































training: 604it [01:09,  8.73it/s]
EPOCH[2]:loss 10.376
[TEST]
{'precision': array([0.02474106, 0.02073781]), 'recall': array([0.05467646, 0.09084691]), 'recall_pop': {0: array([0.00069681, 0.00179888]), 1: array([0.00098154, 0.00302235]), 2: array([0.00135524, 0.00361966]), 3: array([0.00225284, 0.00607656]), 4: array([0.00357967, 0.00917566]), 5: array([0.00649077, 0.01484395]), 6: array([0.01009016, 0.02213739]), 7: array([0.0191355 , 0.03750552]), 8: array([0.04044786, 0.07143949]), 9: array([0.09792842, 0.14769901])}, 'recall_pop_Contribute': {0: array([0.00014794, 0.00036435]), 1: array([0.00017761, 0.00049579]), 2: array([0.00020451, 0.0005702 ]), 3: array([0.00034542, 0.00094974]), 4: array([0.00056447, 0.00144822]), 5: array([0.00107579, 0.00245118]), 6: array([0.00167787, 0.0038018 ]), 7: array([0.00364073, 0.00714302]), 8: array([0.0089477 , 0.01569725]), 9: array([0.03789441, 0.05792534])}, 'ndcg': array([0.04547737, 0.05914904])}
training: 6it [00:00,  9.27it/s]
[5mfind a better recall[25m 0.054676457163240245 ++0.0038477897663991498
total time cost of epoch 2:  78.55703401565552

































training: 598it [01:06, 10.78it/s]
EPOCH[3]:loss 9.655

training: 604it [01:07,  8.93it/s]
{'precision': array([0.02571997, 0.0215083 ]), 'recall': array([0.05688291, 0.09438727]), 'recall_pop': {0: array([0.0008947 , 0.00244383]), 1: array([0.00133415, 0.00368041]), 2: array([0.00191206, 0.00481593]), 3: array([0.00275996, 0.00714471]), 4: array([0.0044785 , 0.01037683]), 5: array([0.00765673, 0.01705482]), 6: array([0.01127867, 0.02537376]), 7: array([0.02157791, 0.04126395]), 8: array([0.04428731, 0.07597489]), 9: array([0.09788128, 0.14843473])}, 'recall_pop_Contribute': {0: array([0.00019145, 0.00048509]), 1: array([0.00024484, 0.00058739]), 2: array([0.00029694, 0.00072936]), 3: array([0.00043017, 0.00112204]), 4: array([0.00072312, 0.00165028]), 5: array([0.00126185, 0.00283234]), 6: array([0.00189319, 0.00434402]), 7: array([0.00415078, 0.00781656]), 8: array([0.00977397, 0.01671761]), 9: array([0.03791659, 0.05810258])}, 'ndcg': array([0.04735641, 0.06152228])}
[5mfind a better recall[25m 0.056882906589735535 ++0.0022064494264952897
total time cost of epoch 3:  77.20370101928711
[TRAIN]

































training: 604it [01:07,  9.01it/s]
EPOCH[4]:loss 9.235
[TEST]
{'precision': array([0.02633573, 0.02187934]), 'recall': array([0.05850158, 0.09619473]), 'recall_pop': {0: array([0.00101733, 0.00309327]), 1: array([0.00153625, 0.00435652]), 2: array([0.0023128 , 0.00492773]), 3: array([0.00310389, 0.00753491]), 4: array([0.00509359, 0.01193116]), 5: array([0.00837904, 0.01859524]), 6: array([0.0124698 , 0.02730717]), 7: array([0.02370899, 0.044546  ]), 8: array([0.04734793, 0.07934721]), 9: array([0.09808365, 0.14680542])}, 'recall_pop_Contribute': {0: array([0.00022446, 0.00061426]), 1: array([0.00027302, 0.0007052 ]), 2: array([0.00035482, 0.00074991]), 3: array([0.00047977, 0.00117158]), 4: array([0.00077966, 0.00187414]), 5: array([0.0014098, 0.0031083]), 6: array([0.00213273, 0.00469665]), 7: array([0.0045203 , 0.00844672]), 8: array([0.01044025, 0.01744023]), 9: array([0.03788678, 0.05738773])}, 'ndcg': array([0.04865243, 0.0628853 ])}
[5mfind a better recall[25m 0.058501575777449896 ++0.001618669187714361
total time cost of epoch 4:  76.30864024162292
[TRAIN]

































training: 604it [01:07,  8.93it/s]
EPOCH[5]:loss 8.972
[TEST]
training: 4it [00:00,  7.47it/s]
{'precision': array([0.0267794 , 0.02215722]), 'recall': array([0.059593  , 0.09741431]), 'recall_pop': {0: array([0.00121837, 0.00336198]), 1: array([0.00161758, 0.00489026]), 2: array([0.00232171, 0.00584897]), 3: array([0.00353865, 0.0078508 ]), 4: array([0.00542656, 0.01224805]), 5: array([0.00912795, 0.01947317]), 6: array([0.01378528, 0.02896637]), 7: array([0.02541816, 0.0471574 ]), 8: array([0.04935546, 0.08215341]), 9: array([0.09752283, 0.14427774])}, 'recall_pop_Contribute': {0: array([0.00024813, 0.00067645]), 1: array([0.00027393, 0.00080416]), 2: array([0.00035714, 0.00085136]), 3: array([0.00051997, 0.00123527]), 4: array([0.00085284, 0.00191738]), 5: array([0.00154581, 0.00328759]), 6: array([0.00235115, 0.0050026 ]), 7: array([0.00482675, 0.00895875]), 8: array([0.01085944, 0.01807194]), 9: array([0.03775785, 0.0566088 ])}, 'ndcg': array([0.04947078, 0.06375082])}
[5mfind a better recall[25m 0.05959300483247104 ++0.0010914290550211453
total time cost of epoch 5:  77.01080179214478


































training: 604it [01:07,  8.89it/s]
EPOCH[6]:loss 8.796
[TEST]
{'precision': array([0.02687887, 0.02228827]), 'recall': array([0.05974457, 0.09803628]), 'recall_pop': {0: array([0.00140416, 0.00347378]), 1: array([0.00179992, 0.00516596]), 2: array([0.0025191 , 0.00593163]), 3: array([0.0035965 , 0.00822172]), 4: array([0.00601481, 0.01287531]), 5: array([0.00978761, 0.02013334]), 6: array([0.01413538, 0.02979689]), 7: array([0.02692662, 0.0502443 ]), 8: array([0.05157605, 0.08479106]), 9: array([0.09586089, 0.14197715])}, 'recall_pop_Contribute': {0: array([0.00029144, 0.0007109 ]), 1: array([0.00031233, 0.00085352]), 2: array([0.00038197, 0.00086273]), 3: array([0.0005369 , 0.00127599]), 4: array([0.00094434, 0.00201588]), 5: array([0.00164836, 0.00339429]), 6: array([0.00242538, 0.00512019]), 7: array([0.00504566, 0.00945811]), 8: array([0.01127476, 0.01866161]), 9: array([0.03688343, 0.05568307])}, 'ndcg': array([0.04965177, 0.06409793])}
[5mfind a better recall[25m 0.05974457275407751 ++0.00015156792160646998
total time cost of epoch 6:  77.34614253044128
[TRAIN]

































training: 604it [01:07,  8.96it/s]
EPOCH[7]:loss 8.667
[TEST]
training: 5it [00:00,  7.50it/s]
{'precision': array([0.02688518, 0.02237669]), 'recall': array([0.05988275, 0.09863422]), 'recall_pop': {0: array([0.00173014, 0.00380325]), 1: array([0.00201786, 0.00530176]), 2: array([0.00274011, 0.00590314]), 3: array([0.00389149, 0.00838329]), 4: array([0.00590631, 0.01320823]), 5: array([0.00989111, 0.02069413]), 6: array([0.015494  , 0.03046978]), 7: array([0.0281546 , 0.05106952]), 8: array([0.0521706 , 0.08670012]), 9: array([0.09405877, 0.14207311])}, 'recall_pop_Contribute': {0: array([0.00033933, 0.00074663]), 1: array([0.00035002, 0.00085122]), 2: array([0.00039895, 0.00086469]), 3: array([0.00055518, 0.00130893]), 4: array([0.00092843, 0.00202864]), 5: array([0.00163572, 0.00347639]), 6: array([0.00266699, 0.00524766]), 7: array([0.00533038, 0.00961105]), 8: array([0.01147045, 0.01911207]), 9: array([0.03620729, 0.05538694])}, 'ndcg': array([0.04977691, 0.06442245])}
[5mfind a better recall[25m 0.05988274570332688 ++0.00013817294924936552
total time cost of epoch 7:  76.77892899513245

































training: 602it [01:06, 10.99it/s]
EPOCH[8]:loss 8.572

training: 604it [01:07,  9.01it/s]
training: 4it [00:00,  8.28it/s]
{'precision': array([0.02694676, 0.02227959]), 'recall': array([0.06023768, 0.09810367]), 'recall_pop': {0: array([0.00154422, 0.00390418]), 1: array([0.0019439 , 0.00567093]), 2: array([0.00274275, 0.00631128]), 3: array([0.00378123, 0.00878467]), 4: array([0.00621569, 0.01359518]), 5: array([0.01082371, 0.02109737]), 6: array([0.01565979, 0.03187225]), 7: array([0.02855138, 0.05183003]), 8: array([0.05315777, 0.08774564]), 9: array([0.09357768, 0.13852913])}, 'recall_pop_Contribute': {0: array([0.00033431, 0.00079412]), 1: array([0.00033787, 0.00092863]), 2: array([0.00039364, 0.00092733]), 3: array([0.00056238, 0.00137089]), 4: array([0.00097126, 0.00208388]), 5: array([0.00182219, 0.00354679]), 6: array([0.0027551 , 0.00541218]), 7: array([0.00541459, 0.00973129]), 8: array([0.01163279, 0.01936089]), 9: array([0.03601356, 0.05394767])}, 'ndcg': array([0.04991747, 0.06423735])}
[5mfind a better recall[25m 0.06023767760041039 ++0.0003549318970835144
total time cost of epoch 8:  76.36945652961731

































training: 599it [01:06, 11.02it/s]
EPOCH[9]:loss 8.500

training: 604it [01:07,  8.99it/s]
{'precision': array([0.02681887, 0.02230643]), 'recall': array([0.05969955, 0.09859226]), 'recall_pop': {0: array([0.00157257, 0.00435836]), 1: array([0.00235178, 0.00565426]), 2: array([0.00291853, 0.00659657]), 3: array([0.00388626, 0.00917788]), 4: array([0.00652567, 0.01396467]), 5: array([0.0108317 , 0.02194589]), 6: array([0.01668367, 0.03193239]), 7: array([0.02918655, 0.05302133]), 8: array([0.05362056, 0.08934682]), 9: array([0.0912111 , 0.13726986])}, 'recall_pop_Contribute': {0: array([0.00031951, 0.00086589]), 1: array([0.00039292, 0.00093633]), 2: array([0.00042722, 0.00094452]), 3: array([0.00058347, 0.00144111]), 4: array([0.00099963, 0.00217471]), 5: array([0.00180838, 0.0036763 ]), 6: array([0.00290773, 0.00545968]), 7: array([0.0055256 , 0.00994332]), 8: array([0.01171525, 0.01970159]), 9: array([0.03501984, 0.05344881])}, 'ndcg': array([0.04974518, 0.06441579])}
total time cost of epoch 9:  76.8538761138916
[TRAIN]

































training: 602it [01:07, 10.65it/s]
EPOCH[10]:loss 8.443

training: 604it [01:08,  8.86it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02686624, 0.02229064]), 'recall': array([0.05974695, 0.09842242]), 'recall_pop': {0: array([0.0015612 , 0.00442138]), 1: array([0.00241757, 0.00602031]), 2: array([0.00274485, 0.00660766]), 3: array([0.00419415, 0.00936293]), 4: array([0.00623832, 0.01411775]), 5: array([0.01123006, 0.02205936]), 6: array([0.01686872, 0.0327255 ]), 7: array([0.02995373, 0.05408627]), 8: array([0.05527385, 0.09015299]), 9: array([0.09010256, 0.13495159])}, 'recall_pop_Contribute': {0: array([0.00031212, 0.00086683]), 1: array([0.00041128, 0.00099207]), 2: array([0.00039769, 0.00098843]), 3: array([0.00064229, 0.00145634]), 4: array([0.00095743, 0.0022157 ]), 5: array([0.00188883, 0.00369936]), 6: array([0.0029262 , 0.00564443]), 7: array([0.00561309, 0.01010225]), 8: array([0.01213455, 0.01988658]), 9: array([0.03446347, 0.05257043])}, 'ndcg': array([0.04991158, 0.06448006])}
total time cost of epoch 10:  77.82658290863037


































training: 596it [01:07, 11.21it/s]
EPOCH[11]:loss 8.397

training: 604it [01:08,  8.84it/s]
{'precision': array([0.02691202, 0.02240353]), 'recall': array([0.06012687, 0.09875204]), 'recall_pop': {0: array([0.00176099, 0.00427349]), 1: array([0.00244509, 0.00567271]), 2: array([0.00314303, 0.00686689]), 3: array([0.00428437, 0.00939517]), 4: array([0.00659312, 0.01459445]), 5: array([0.01103415, 0.02272492]), 6: array([0.01724755, 0.03321096]), 7: array([0.03040174, 0.05481677]), 8: array([0.05515108, 0.09102496]), 9: array([0.08983685, 0.13498197])}, 'recall_pop_Contribute': {0: array([0.0003618 , 0.00083333]), 1: array([0.00041422, 0.0009211 ]), 2: array([0.00046688, 0.0010427 ]), 3: array([0.00066782, 0.00143638]), 4: array([0.0010232 , 0.00227493]), 5: array([0.00188338, 0.00379044]), 6: array([0.00300592, 0.00571451]), 7: array([0.00574919, 0.0102582 ]), 8: array([0.01210294, 0.0200182 ]), 9: array([0.03445151, 0.05246226])}, 'ndcg': array([0.04977242, 0.06440358])}
total time cost of epoch 11:  77.70301151275635
[TRAIN]

































training: 604it [01:07,  8.89it/s]
EPOCH[12]:loss 8.356
[TEST]
{'precision': array([0.02688518, 0.02224248]), 'recall': array([0.05975474, 0.09813552]), 'recall_pop': {0: array([0.00175108, 0.00429633]), 1: array([0.0023514 , 0.00576867]), 2: array([0.00343617, 0.00703132]), 3: array([0.0046462 , 0.00951187]), 4: array([0.00679408, 0.01514477]), 5: array([0.01097109, 0.02293021]), 6: array([0.01739596, 0.03312971]), 7: array([0.03132463, 0.05482392]), 8: array([0.05481771, 0.09016029]), 9: array([0.08903477, 0.13329066])}, 'recall_pop_Contribute': {0: array([0.00036118, 0.00085287]), 1: array([0.00041254, 0.00092608]), 2: array([0.00049564, 0.00106816]), 3: array([0.00070648, 0.00143763]), 4: array([0.00102124, 0.00234454]), 5: array([0.00183306, 0.00380389]), 6: array([0.0030035 , 0.00569223]), 7: array([0.00592601, 0.01035312]), 8: array([0.01199721, 0.01991313]), 9: array([0.0339979 , 0.05174387])}, 'ndcg': array([0.04965671, 0.06412336])}
training: 6it [00:00,  9.06it/s]
total time cost of epoch 12:  77.33804988861084

































training: 594it [01:06,  9.77it/s]
EPOCH[13]:loss 8.323

training: 604it [01:08,  8.88it/s]
{'precision': array([0.02696571, 0.02233011]), 'recall': array([0.06006252, 0.09854779]), 'recall_pop': {0: array([0.00190568, 0.00446614]), 1: array([0.00245839, 0.00574104]), 2: array([0.00331144, 0.00677879]), 3: array([0.00447564, 0.00960384]), 4: array([0.00656072, 0.01445967]), 5: array([0.01085728, 0.02339298]), 6: array([0.01817553, 0.03385324]), 7: array([0.03103607, 0.05609646]), 8: array([0.05635586, 0.09105998]), 9: array([0.08906942, 0.13342128])}, 'recall_pop_Contribute': {0: array([0.00038601, 0.00086079]), 1: array([0.00040819, 0.00091613]), 2: array([0.00049796, 0.00102451]), 3: array([0.00067859, 0.00145625]), 4: array([0.00098348, 0.00224807]), 5: array([0.00184395, 0.00389655]), 6: array([0.0031204, 0.0058063]), 7: array([0.00589803, 0.01054734]), 8: array([0.01226157, 0.02007655]), 9: array([0.03398435, 0.05171531])}, 'ndcg': array([0.04994621, 0.06446658])}
total time cost of epoch 13:  77.54948329925537
[TRAIN]

































training: 601it [01:07, 10.04it/s]
EPOCH[14]:loss 8.296

training: 604it [01:07,  8.92it/s]
training: 1it [00:00,  4.41it/s]
{'precision': array([0.02694044, 0.02224564]), 'recall': array([0.05994549, 0.09816192]), 'recall_pop': {0: array([0.00200445, 0.00459977]), 1: array([0.00254643, 0.00575376]), 2: array([0.00326039, 0.00706264]), 3: array([0.00456488, 0.01005476]), 4: array([0.00695641, 0.01522087]), 5: array([0.01136413, 0.0238794 ]), 6: array([0.01837706, 0.03380217]), 7: array([0.03171919, 0.0561657 ]), 8: array([0.05746336, 0.09085839]), 9: array([0.08734565, 0.13149014])}, 'recall_pop_Contribute': {0: array([0.00038534, 0.00087623]), 1: array([0.00040896, 0.00091943]), 2: array([0.0004754, 0.001069 ]), 3: array([0.00069576, 0.00156214]), 4: array([0.00104412, 0.0023311 ]), 5: array([0.00191602, 0.00396583]), 6: array([0.0031274 , 0.00580681]), 7: array([0.00604335, 0.01052132]), 8: array([0.01256071, 0.02003055]), 9: array([0.03328842, 0.05107951])}, 'ndcg': array([0.04990145, 0.06429375])}
total time cost of epoch 14:  77.25270652770996


































training: 604it [01:08,  8.86it/s]
EPOCH[15]:loss 8.269
[TEST]
training: 4it [00:00,  8.44it/s]
{'precision': array([0.0269736 , 0.02218564]), 'recall': array([0.06016488, 0.097703  ]), 'recall_pop': {0: array([0.00183431, 0.00456053]), 1: array([0.00257076, 0.00600006]), 2: array([0.00346249, 0.0070351 ]), 3: array([0.0047351, 0.0098473]), 4: array([0.00731546, 0.01543255]), 5: array([0.01175877, 0.02434112]), 6: array([0.01828401, 0.03409069]), 7: array([0.03234535, 0.05640167]), 8: array([0.05750642, 0.09162639]), 9: array([0.08720348, 0.13023435])}, 'recall_pop_Contribute': {0: array([0.00035468, 0.00086621]), 1: array([0.00041444, 0.00094947]), 2: array([0.00050701, 0.00106884]), 3: array([0.0007319 , 0.00151396]), 4: array([0.0011061 , 0.00236339]), 5: array([0.00198587, 0.00402961]), 6: array([0.00309544, 0.00585796]), 7: array([0.00610092, 0.01054666]), 8: array([0.01251877, 0.02013105]), 9: array([0.03334977, 0.05037584])}, 'ndcg': array([0.05007836, 0.06424919])}
total time cost of epoch 15:  77.75098252296448

































training: 595it [01:06,  9.72it/s]
EPOCH[16]:loss 8.246

training: 604it [01:07,  8.93it/s]
{'precision': array([0.02696255, 0.02221328]), 'recall': array([0.06025983, 0.09783736]), 'recall_pop': {0: array([0.00185137, 0.00458965]), 1: array([0.00261493, 0.00598234]), 2: array([0.00338144, 0.00743759]), 3: array([0.00494957, 0.01036142]), 4: array([0.00707903, 0.01598752]), 5: array([0.01194752, 0.02414867]), 6: array([0.01817783, 0.03436277]), 7: array([0.03277787, 0.05680662]), 8: array([0.05761818, 0.09183725]), 9: array([0.08660486, 0.12941992])}, 'recall_pop_Contribute': {0: array([0.00035033, 0.00087751]), 1: array([0.00041555, 0.00093085]), 2: array([0.00050338, 0.00112842]), 3: array([0.0007646 , 0.00156562]), 4: array([0.00107433, 0.0024402 ]), 5: array([0.00205587, 0.00400505]), 6: array([0.0031586 , 0.00589361]), 7: array([0.00615795, 0.01066859]), 8: array([0.01263033, 0.02017562]), 9: array([0.03314889, 0.05015191])}, 'ndcg': array([0.04989924, 0.0641089 ])}
[5mfind a better recall[25m 0.06025982658353568 ++2.2148983125289123e-05
total time cost of epoch 16:  77.16478610038757
[TRAIN]

































training: 604it [01:07,  9.00it/s]
EPOCH[17]:loss 8.230
[TEST]
{'precision': array([0.02685045, 0.02220301]), 'recall': array([0.05982161, 0.09778971]), 'recall_pop': {0: array([0.00188265, 0.00475108]), 1: array([0.00254087, 0.00608677]), 2: array([0.00349301, 0.00748008]), 3: array([0.00474281, 0.0102922 ]), 4: array([0.0074998 , 0.01551079]), 5: array([0.01218163, 0.02426561]), 6: array([0.01824048, 0.03489828]), 7: array([0.03267631, 0.05673054]), 8: array([0.05804109, 0.09222295]), 9: array([0.08574429, 0.12941169])}, 'recall_pop_Contribute': {0: array([0.00035944, 0.00090945]), 1: array([0.00042667, 0.00098024]), 2: array([0.00050673, 0.00109482]), 3: array([0.00071897, 0.00155143]), 4: array([0.00115596, 0.00237031]), 5: array([0.00206945, 0.00399922]), 6: array([0.00314633, 0.00600019]), 7: array([0.00612408, 0.01064508]), 8: array([0.01269369, 0.02033881]), 9: array([0.0326203 , 0.04990017])}, 'ndcg': array([0.04978548, 0.0641354 ])}
training: 9it [00:01,  9.92it/s]
total time cost of epoch 17:  76.59809684753418

































training: 602it [01:07, 11.02it/s]
EPOCH[18]:loss 8.211

training: 604it [01:07,  8.95it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02686939, 0.02214617]), 'recall': array([0.05982242, 0.09755711]), 'recall_pop': {0: array([0.00192304, 0.00485888]), 1: array([0.00274244, 0.00606713]), 2: array([0.003336  , 0.00748109]), 3: array([0.00487017, 0.00971197]), 4: array([0.00745537, 0.01609077]), 5: array([0.01267954, 0.02464287]), 6: array([0.01868795, 0.0350214 ]), 7: array([0.03270137, 0.05709963]), 8: array([0.05876438, 0.09235816]), 9: array([0.08526513, 0.12792404])}, 'recall_pop_Contribute': {0: array([0.00037894, 0.00092461]), 1: array([0.0004514 , 0.00099629]), 2: array([0.00048962, 0.00110525]), 3: array([0.00074149, 0.00147566]), 4: array([0.00113271, 0.00248731]), 5: array([0.00212417, 0.00404688]), 6: array([0.0031682, 0.0060619]), 7: array([0.00616958, 0.01068073]), 8: array([0.01286416, 0.02031975]), 9: array([0.03230214, 0.04945871])}, 'ndcg': array([0.04978557, 0.06402385])}
total time cost of epoch 18:  77.14997911453247



































training: 604it [01:09,  8.73it/s]
EPOCH[19]:loss 8.196
[TEST]
{'precision': array([0.02682203, 0.02223696]), 'recall': array([0.05985556, 0.09808425]), 'recall_pop': {0: array([0.00203031, 0.00504632]), 1: array([0.0026606 , 0.00628524]), 2: array([0.00354305, 0.00729031]), 3: array([0.00478961, 0.00993038]), 4: array([0.00800587, 0.01662676]), 5: array([0.01239963, 0.02537116]), 6: array([0.01840654, 0.03576073]), 7: array([0.03351088, 0.0577116 ]), 8: array([0.05931136, 0.09271961]), 9: array([0.08446019, 0.12740353])}, 'recall_pop_Contribute': {0: array([0.00038633, 0.00094527]), 1: array([0.00043177, 0.00100414]), 2: array([0.00048605, 0.00108522]), 3: array([0.00070091, 0.00152109]), 4: array([0.00121429, 0.00255521]), 5: array([0.00209596, 0.00419136]), 6: array([0.0031823 , 0.00617693]), 7: array([0.00633711, 0.01085319]), 8: array([0.01287082, 0.02040838]), 9: array([0.03215003, 0.04934345])}, 'ndcg': array([0.04979304, 0.06425654])}
total time cost of epoch 19:  78.71979022026062
[TRAIN]

































training: 603it [01:07, 10.54it/s]
EPOCH[20]:loss 8.181

training: 604it [01:07,  8.92it/s]
{'precision': array([0.02682992, 0.02217222]), 'recall': array([0.05985548, 0.09771425]), 'recall_pop': {0: array([0.00204939, 0.0048372 ]), 1: array([0.00265955, 0.00639231]), 2: array([0.0035267 , 0.00751715]), 3: array([0.00502043, 0.01012331]), 4: array([0.00803745, 0.01647098]), 5: array([0.0127928 , 0.02500614]), 6: array([0.01895953, 0.03555731]), 7: array([0.03341756, 0.05699739]), 8: array([0.05807183, 0.09292157]), 9: array([0.08469412, 0.12716366])}, 'recall_pop_Contribute': {0: array([0.00039486, 0.00090066]), 1: array([0.00041451, 0.00102798]), 2: array([0.00050372, 0.00113086]), 3: array([0.00072952, 0.00152547]), 4: array([0.00123443, 0.00254608]), 5: array([0.00214413, 0.00412905]), 6: array([0.00324818, 0.00615787]), 7: array([0.0063122 , 0.01079846]), 8: array([0.01268557, 0.02039534]), 9: array([0.03218837, 0.04910248])}, 'ndcg': array([0.04979173, 0.06409382])}
total time cost of epoch 20:  77.60044121742249
[TRAIN]

































training: 602it [01:08, 10.02it/s]
EPOCH[21]:loss 8.170

training: 604it [01:08,  8.84it/s]
training: 1it [00:00,  5.56it/s]
{'precision': array([0.02670835, 0.02213196]), 'recall': array([0.05956176, 0.0977771 ]), 'recall_pop': {0: array([0.00192223, 0.00510804]), 1: array([0.00304938, 0.00646599]), 2: array([0.00348182, 0.00765582]), 3: array([0.00502148, 0.01013038]), 4: array([0.00822534, 0.01641712]), 5: array([0.01229929, 0.02471449]), 6: array([0.01896943, 0.0358638 ]), 7: array([0.0330834 , 0.05769184]), 8: array([0.05833359, 0.09339641]), 9: array([0.08341559, 0.12595427])}, 'recall_pop_Contribute': {0: array([0.00037322, 0.00094356]), 1: array([0.00047463, 0.00104496]), 2: array([0.00049221, 0.0011604 ]), 3: array([0.00074881, 0.00154068]), 4: array([0.00124874, 0.00252533]), 5: array([0.00210061, 0.00408544]), 6: array([0.00325636, 0.00619831]), 7: array([0.00623442, 0.01093009]), 8: array([0.01275884, 0.02055051]), 9: array([0.03187392, 0.04879782])}, 'ndcg': array([0.04967937, 0.06407791])}
total time cost of epoch 21:  77.90217566490173


































training: 599it [01:07, 10.89it/s]
EPOCH[22]:loss 8.156

training: 604it [01:08,  8.84it/s]
{'precision': array([0.02683308, 0.02214538]), 'recall': array([0.06000024, 0.0976103 ]), 'recall_pop': {0: array([0.00217692, 0.00518138]), 1: array([0.00299436, 0.00625758]), 2: array([0.00369304, 0.00769349]), 3: array([0.00517674, 0.01047457]), 4: array([0.00837037, 0.01621277]), 5: array([0.01280554, 0.0244789 ]), 6: array([0.01890728, 0.03622303]), 7: array([0.03333322, 0.0576129 ]), 8: array([0.05893359, 0.09325829]), 9: array([0.08365162, 0.12601117])}, 'recall_pop_Contribute': {0: array([0.00040579, 0.00096724]), 1: array([0.00045758, 0.00100564]), 2: array([0.00050762, 0.00115782]), 3: array([0.00078703, 0.00160626]), 4: array([0.00125453, 0.00248588]), 5: array([0.00214838, 0.00405238]), 6: array([0.00328266, 0.00620061]), 7: array([0.00633903, 0.01085607]), 8: array([0.01294949, 0.02047529]), 9: array([0.03186812, 0.04880311])}, 'ndcg': array([0.04979624, 0.06403806])}
total time cost of epoch 22:  77.96124839782715
[TRAIN]

































training: 601it [01:07, 10.51it/s]
EPOCH[23]:loss 8.148

training: 604it [01:08,  8.85it/s]
training: 1it [00:00,  5.46it/s]
{'precision': array([0.02686308, 0.02228117]), 'recall': array([0.05994266, 0.09822238]), 'recall_pop': {0: array([0.00198759, 0.00508952]), 1: array([0.00269462, 0.00641408]), 2: array([0.00350568, 0.00758823]), 3: array([0.00533647, 0.01037738]), 4: array([0.00807136, 0.01657274]), 5: array([0.01253852, 0.02465861]), 6: array([0.01933628, 0.0355848 ]), 7: array([0.03372641, 0.05793116]), 8: array([0.05891325, 0.0954688 ]), 9: array([0.08370885, 0.12668004])}, 'recall_pop_Contribute': {0: array([0.00038889, 0.00094913]), 1: array([0.00044753, 0.00103576]), 2: array([0.00049543, 0.00114366]), 3: array([0.00078888, 0.0015977 ]), 4: array([0.00122609, 0.00257712]), 5: array([0.00212891, 0.00408098]), 6: array([0.00331359, 0.00610258]), 7: array([0.00635228, 0.01086009]), 8: array([0.0128593 , 0.02092288]), 9: array([0.03194175, 0.04895246])}, 'ndcg': array([0.04975418, 0.06422995])}
total time cost of epoch 23:  77.7608654499054


































training: 604it [01:08, 10.42it/s]
EPOCH[24]:loss 8.140

training: 604it [01:08,  8.82it/s]
training: 1it [00:00,  4.39it/s]
{'precision': array([0.02670203, 0.02226064]), 'recall': array([0.05967064, 0.09805112]), 'recall_pop': {0: array([0.00196495, 0.00493095]), 1: array([0.00274729, 0.00677037]), 2: array([0.00343042, 0.00782556]), 3: array([0.00520651, 0.01041089]), 4: array([0.00818609, 0.01675309]), 5: array([0.01235465, 0.02515748]), 6: array([0.01889542, 0.03588674]), 7: array([0.03386784, 0.05855669]), 8: array([0.05904487, 0.09459894]), 9: array([0.08346919, 0.12582244])}, 'recall_pop_Contribute': {0: array([0.00038637, 0.00091117]), 1: array([0.00044072, 0.001096  ]), 2: array([0.00048892, 0.00118379]), 3: array([0.00078499, 0.00158052]), 4: array([0.00122515, 0.00258127]), 5: array([0.00205902, 0.00412285]), 6: array([0.00333217, 0.00619611]), 7: array([0.0064412 , 0.01098206]), 8: array([0.01285897, 0.02078231]), 9: array([0.03165314, 0.04861504])}, 'ndcg': array([0.04953381, 0.06408806])}
total time cost of epoch 24:  78.08613848686218


































training: 602it [01:08, 10.90it/s]
EPOCH[25]:loss 8.130

training: 604it [01:08,  8.81it/s]
training: 1it [00:00,  4.72it/s]
{'precision': array([0.02681098, 0.02218486]), 'recall': array([0.05975095, 0.09764587]), 'recall_pop': {0: array([0.00184128, 0.00485963]), 1: array([0.00267229, 0.0067281 ]), 2: array([0.00349038, 0.00746346]), 3: array([0.00524019, 0.01006676]), 4: array([0.007884  , 0.01627761]), 5: array([0.01276145, 0.0246924 ]), 6: array([0.01882956, 0.03610755]), 7: array([0.03385835, 0.0580302 ]), 8: array([0.0590195 , 0.09400846]), 9: array([0.08376519, 0.12587381])}, 'recall_pop_Contribute': {0: array([0.00035202, 0.00090834]), 1: array([0.0004248, 0.0010929]), 2: array([0.00049823, 0.00112091]), 3: array([0.00078024, 0.00154442]), 4: array([0.0011892 , 0.00250749]), 5: array([0.00212751, 0.00405105]), 6: array([0.00328422, 0.0062111 ]), 7: array([0.00635809, 0.01086075]), 8: array([0.01291187, 0.02065606]), 9: array([0.03182477, 0.04869284])}, 'ndcg': array([0.04966962, 0.06401307])}
total time cost of epoch 25:  78.20468258857727


































training: 596it [01:08, 10.85it/s]
EPOCH[26]:loss 8.121

training: 604it [01:08,  8.76it/s]
{'precision': array([0.02673993, 0.02217854]), 'recall': array([0.05955383, 0.09763857]), 'recall_pop': {0: array([0.00202022, 0.00489929]), 1: array([0.00266102, 0.00616602]), 2: array([0.00352512, 0.00749028]), 3: array([0.00498468, 0.00999556]), 4: array([0.0080564 , 0.01671839]), 5: array([0.01238145, 0.02526514]), 6: array([0.0193439 , 0.03619491]), 7: array([0.0337452 , 0.05860658]), 8: array([0.05892179, 0.09483248]), 9: array([0.08281172, 0.12531945])}, 'recall_pop_Contribute': {0: array([0.00038605, 0.0009118 ]), 1: array([0.00042307, 0.00100296]), 2: array([0.00051355, 0.0011298 ]), 3: array([0.0007459 , 0.00152784]), 4: array([0.00122438, 0.0025155 ]), 5: array([0.00208281, 0.00413584]), 6: array([0.00340038, 0.00621138]), 7: array([0.00634901, 0.01094267]), 8: array([0.01281365, 0.02083529]), 9: array([0.03161504, 0.04842548])}, 'ndcg': array([0.04940135, 0.06381431])}
total time cost of epoch 26:  78.40556478500366
[TRAIN]


































training: 604it [01:09,  8.71it/s]
EPOCH[27]:loss 8.112
[TEST]
{'precision': array([0.02655993, 0.0221738 ]), 'recall': array([0.05948852, 0.09777656]), 'recall_pop': {0: array([0.00205781, 0.0051932 ]), 1: array([0.00280676, 0.00626338]), 2: array([0.00363985, 0.00752659]), 3: array([0.004901  , 0.01051483]), 4: array([0.00827306, 0.01648287]), 5: array([0.01229952, 0.02504047]), 6: array([0.01953895, 0.03647929]), 7: array([0.03421763, 0.05879408]), 8: array([0.05883471, 0.09524421]), 9: array([0.08168892, 0.1245699 ])}, 'recall_pop_Contribute': {0: array([0.000386  , 0.00097902]), 1: array([0.0004455 , 0.00100951]), 2: array([0.0005336 , 0.00111391]), 3: array([0.00071881, 0.0015788 ]), 4: array([0.00125306, 0.00251144]), 5: array([0.00203053, 0.00408209]), 6: array([0.00338909, 0.00631005]), 7: array([0.00646157, 0.01096972]), 8: array([0.01285991, 0.02095194]), 9: array([0.03141045, 0.04827006])}, 'ndcg': array([0.04940243, 0.06393578])}
training: 7it [00:00, 10.05it/s]
total time cost of epoch 27:  79.10630869865417


































training: 595it [01:09, 10.66it/s]
EPOCH[28]:loss 8.107

training: 604it [01:09,  8.64it/s]
{'precision': array([0.0267794 , 0.02213196]), 'recall': array([0.05979333, 0.09742719]), 'recall_pop': {0: array([0.00187045, 0.0050509 ]), 1: array([0.00289743, 0.00644256]), 2: array([0.00356459, 0.00782476]), 3: array([0.0049478 , 0.01016581]), 4: array([0.00854615, 0.01672162]), 5: array([0.01270016, 0.02568842]), 6: array([0.01969702, 0.03582566]), 7: array([0.03417449, 0.05779666]), 8: array([0.05939131, 0.09456264]), 9: array([0.08206862, 0.12445529])}, 'recall_pop_Contribute': {0: array([0.00035809, 0.00093728]), 1: array([0.00046207, 0.00103511]), 2: array([0.00051212, 0.00115901]), 3: array([0.0007152 , 0.00153501]), 4: array([0.00131766, 0.0025785 ]), 5: array([0.00210959, 0.00421675]), 6: array([0.0034592 , 0.00616325]), 7: array([0.0064719 , 0.01078138]), 8: array([0.01296824, 0.02075768]), 9: array([0.03141927, 0.04826321])}, 'ndcg': array([0.04973678, 0.06397629])}
total time cost of epoch 28:  79.7538001537323
[TRAIN]


































training: 604it [01:08,  8.76it/s]
EPOCH[29]:loss 8.100
[TEST]
{'precision': array([0.02671466, 0.02220222]), 'recall': array([0.05961068, 0.09772741]), 'recall_pop': {0: array([0.00215623, 0.00539027]), 1: array([0.00274387, 0.00652969]), 2: array([0.00348358, 0.00729324]), 3: array([0.0050949 , 0.01023318]), 4: array([0.00867646, 0.01692509]), 5: array([0.01289433, 0.02623257]), 6: array([0.01937018, 0.03585533]), 7: array([0.03392584, 0.05852826]), 8: array([0.05869238, 0.09489711]), 9: array([0.08246619, 0.12489987])}, 'recall_pop_Contribute': {0: array([0.00040096, 0.00100537]), 1: array([0.000431  , 0.00104276]), 2: array([0.00052656, 0.00107479]), 3: array([0.00075148, 0.00153081]), 4: array([0.0013171 , 0.00258583]), 5: array([0.00212   , 0.00429257]), 6: array([0.00338845, 0.00619233]), 7: array([0.00643055, 0.01092892]), 8: array([0.01287707, 0.02081698]), 9: array([0.0313675 , 0.04825705])}, 'ndcg': array([0.04974541, 0.06417563])}
total time cost of epoch 29:  78.29883861541748
[TRAIN]


































training: 604it [01:08,  8.76it/s]
EPOCH[30]:loss 8.092
[TEST]
training: 7it [00:00,  9.82it/s]
{'precision': array([0.02671624, 0.02221722]), 'recall': array([0.05955254, 0.0977587 ]), 'recall_pop': {0: array([0.00224231, 0.00505997]), 1: array([0.00276203, 0.0068302 ]), 2: array([0.00364936, 0.00773585]), 3: array([0.00512279, 0.01045396]), 4: array([0.00839222, 0.01689338]), 5: array([0.01345453, 0.02619023]), 6: array([0.0196343 , 0.03612574]), 7: array([0.03361977, 0.05848398]), 8: array([0.05873723, 0.09442927]), 9: array([0.08278414, 0.12474594])}, 'recall_pop_Contribute': {0: array([0.00041034, 0.00096016]), 1: array([0.00042961, 0.00109154]), 2: array([0.00053236, 0.00113088]), 3: array([0.0007625, 0.0015543]), 4: array([0.00127651, 0.00260365]), 5: array([0.00221572, 0.00431747]), 6: array([0.00343478, 0.00624577]), 7: array([0.00635383, 0.01095385]), 8: array([0.01280082, 0.02069016]), 9: array([0.03133607, 0.04821092])}, 'ndcg': array([0.04969225, 0.06416161])}
total time cost of epoch 30:  78.4489758014679


































training: 602it [01:08, 10.81it/s]
EPOCH[31]:loss 8.084

training: 604it [01:09,  8.75it/s]
training: 1it [00:00,  4.93it/s]
{'precision': array([0.0266373 , 0.02216196]), 'recall': array([0.05939581, 0.09754632]), 'recall_pop': {0: array([0.00233599, 0.0051497 ]), 1: array([0.00280218, 0.00683231]), 2: array([0.00369778, 0.00812215]), 3: array([0.00508776, 0.01045615]), 4: array([0.00845266, 0.01659355]), 5: array([0.01289279, 0.02589573]), 6: array([0.01941498, 0.03614684]), 7: array([0.03405523, 0.05893216]), 8: array([0.05824566, 0.09376673]), 9: array([0.08213986, 0.12401   ])}, 'recall_pop_Contribute': {0: array([0.00043794, 0.00097494]), 1: array([0.00043492, 0.00110182]), 2: array([0.00054504, 0.00120666]), 3: array([0.00074672, 0.00158124]), 4: array([0.00128768, 0.00258715]), 5: array([0.00214124, 0.00430276]), 6: array([0.00343392, 0.0062577 ]), 7: array([0.00648705, 0.01106368]), 8: array([0.01272238, 0.02057426]), 9: array([0.03115893, 0.04789611])}, 'ndcg': array([0.04965479, 0.06410978])}
total time cost of epoch 31:  78.74870157241821


































training: 597it [01:08, 10.76it/s]
EPOCH[32]:loss 8.080

training: 604it [01:08,  8.76it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02678571, 0.02218801]), 'recall': array([0.0598735 , 0.09778463]), 'recall_pop': {0: array([0.00211179, 0.00505798]), 1: array([0.0028015 , 0.00673126]), 2: array([0.00366511, 0.00769731]), 3: array([0.00522798, 0.01055006]), 4: array([0.00846375, 0.01723653]), 5: array([0.0133407 , 0.02577414]), 6: array([0.01985279, 0.03661867]), 7: array([0.0344432 , 0.05905604]), 8: array([0.05854973, 0.0948927 ]), 9: array([0.0821015 , 0.12388546])}, 'recall_pop_Contribute': {0: array([0.00041608, 0.0009608 ]), 1: array([0.00043658, 0.00111435]), 2: array([0.00054526, 0.00111994]), 3: array([0.00078935, 0.00159305]), 4: array([0.00129562, 0.00262332]), 5: array([0.00218531, 0.00427462]), 6: array([0.00350838, 0.00626938]), 7: array([0.00658977, 0.01112877]), 8: array([0.01279374, 0.02077136]), 9: array([0.0313134 , 0.04792903])}, 'ndcg': array([0.04986133, 0.06421363])}
total time cost of epoch 32:  78.26784801483154


































training: 593it [01:07, 10.47it/s]
EPOCH[33]:loss 8.074

training: 604it [01:08,  8.79it/s]
{'precision': array([0.02682834, 0.02223617]), 'recall': array([0.05973529, 0.09819148]), 'recall_pop': {0: array([0.00215788, 0.00514466]), 1: array([0.00307122, 0.00680968]), 2: array([0.00393879, 0.00803414]), 3: array([0.00496746, 0.01057979]), 4: array([0.00846357, 0.01738445]), 5: array([0.01317933, 0.02585204]), 6: array([0.0194291 , 0.03607663]), 7: array([0.0342065 , 0.05978086]), 8: array([0.05930353, 0.09486312]), 9: array([0.08187442, 0.12469045])}, 'recall_pop_Contribute': {0: array([0.00040624, 0.0009707 ]), 1: array([0.00048677, 0.00111821]), 2: array([0.00058606, 0.00119403]), 3: array([0.0007326 , 0.00158517]), 4: array([0.00128215, 0.00266884]), 5: array([0.00217758, 0.00425215]), 6: array([0.00339596, 0.00622679]), 7: array([0.00654151, 0.01123728]), 8: array([0.01294899, 0.02079014]), 9: array([0.03117744, 0.04814816])}, 'ndcg': array([0.049725  , 0.06423455])}
total time cost of epoch 33:  78.34331226348877
[TRAIN]


































training: 604it [01:09,  8.69it/s]
EPOCH[34]:loss 8.070
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.02671309, 0.02219591]), 'recall': array([0.05964581, 0.09785784]), 'recall_pop': {0: array([0.00203653, 0.00507363]), 1: array([0.00295281, 0.00645638]), 2: array([0.00407825, 0.00796809]), 3: array([0.00489431, 0.01068756]), 4: array([0.00877028, 0.01705894]), 5: array([0.01339236, 0.02587344]), 6: array([0.01955248, 0.03720756]), 7: array([0.03434506, 0.05924149]), 8: array([0.05882869, 0.09497767]), 9: array([0.0818937, 0.1241325])}, 'recall_pop_Contribute': {0: array([0.0003741 , 0.00096465]), 1: array([0.00047226, 0.00105094]), 2: array([0.000597  , 0.00118611]), 3: array([0.00072855, 0.00160087]), 4: array([0.00132241, 0.00264508]), 5: array([0.00220188, 0.00423701]), 6: array([0.0034024 , 0.00642305]), 7: array([0.00648179, 0.01109861]), 8: array([0.01279238, 0.02072822]), 9: array([0.03127305, 0.04792329])}, 'ndcg': array([0.04959662, 0.06405298])}
total time cost of epoch 34:  79.34576177597046


































training: 604it [01:08, 10.27it/s]
EPOCH[35]:loss 8.066

training: 604it [01:08,  8.84it/s]
training: 1it [00:00,  4.32it/s]
{'precision': array([0.02688676, 0.02222512]), 'recall': array([0.06017804, 0.09818675]), 'recall_pop': {0: array([0.00215938, 0.00535572]), 1: array([0.00306201, 0.00719703]), 2: array([0.00398671, 0.00802528]), 3: array([0.0051043 , 0.01073045]), 4: array([0.00871396, 0.01677911]), 5: array([0.01323608, 0.02563582]), 6: array([0.01955115, 0.03682541]), 7: array([0.03469545, 0.05902191]), 8: array([0.05959657, 0.09483061]), 9: array([0.08192279, 0.12433555])}, 'recall_pop_Contribute': {0: array([0.00041312, 0.00102767]), 1: array([0.00050089, 0.0011713 ]), 2: array([0.00059665, 0.00122156]), 3: array([0.00076699, 0.00161893]), 4: array([0.00131711, 0.00260704]), 5: array([0.00222289, 0.00422625]), 6: array([0.00347509, 0.0063748 ]), 7: array([0.00656952, 0.01104635]), 8: array([0.0130491 , 0.02076444]), 9: array([0.03126669, 0.04812842])}, 'ndcg': array([0.04987791, 0.06424848])}
total time cost of epoch 35:  77.99029874801636


































training: 592it [01:08, 10.95it/s]

training: 604it [01:09,  8.69it/s]
[TEST]
{'precision': array([0.02686466, 0.02223696]), 'recall': array([0.06009494, 0.09816781]), 'recall_pop': {0: array([0.00201465, 0.00531917]), 1: array([0.00301202, 0.00698388]), 2: array([0.00393619, 0.00797009]), 3: array([0.0054312, 0.0108692]), 4: array([0.00867479, 0.01687402]), 5: array([0.0130212 , 0.02547446]), 6: array([0.02021934, 0.03727945]), 7: array([0.03425445, 0.05920666]), 8: array([0.05973106, 0.09511457]), 9: array([0.0820741 , 0.12443568])}, 'recall_pop_Contribute': {0: array([0.00037858, 0.00100444]), 1: array([0.00050253, 0.00112877]), 2: array([0.00058477, 0.00119311]), 3: array([0.00083184, 0.00162477]), 4: array([0.00130307, 0.00260738]), 5: array([0.00217494, 0.00422434]), 6: array([0.00350993, 0.00644824]), 7: array([0.00647955, 0.01115297]), 8: array([0.01305615, 0.02073017]), 9: array([0.03127359, 0.04805362])}, 'ndcg': array([0.04984877, 0.06423393])}
total time cost of epoch 36:  78.84528017044067
[TRAIN]

































training: 598it [01:07, 10.59it/s]
EPOCH[37]:loss 8.054

training: 604it [01:08,  8.87it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02681571, 0.02220459]), 'recall': array([0.06001864, 0.09791051]), 'recall_pop': {0: array([0.00214294, 0.00526429]), 1: array([0.00292612, 0.00692414]), 2: array([0.00403039, 0.00782783]), 3: array([0.0053491 , 0.01058479]), 4: array([0.00867299, 0.0172731 ]), 5: array([0.01325728, 0.02533365]), 6: array([0.01957721, 0.03743772]), 7: array([0.03428921, 0.05873384]), 8: array([0.05970895, 0.09484442]), 9: array([0.08211382, 0.12385523])}, 'recall_pop_Contribute': {0: array([0.00039308, 0.00097141]), 1: array([0.00047829, 0.00111584]), 2: array([0.00061937, 0.00118336]), 3: array([0.00082338, 0.00160104]), 4: array([0.00131508, 0.00262646]), 5: array([0.00221877, 0.00419982]), 6: array([0.00342001, 0.00647829]), 7: array([0.00645666, 0.01105819]), 8: array([0.01301387, 0.02076036]), 9: array([0.03128013, 0.04791575])}, 'ndcg': array([0.04982042, 0.06418747])}
total time cost of epoch 37:  77.46092629432678


































training: 604it [01:09,  8.70it/s]
EPOCH[38]:loss 8.056
[TEST]
{'precision': array([0.02684098, 0.02225669]), 'recall': array([0.05991488, 0.09795977]), 'recall_pop': {0: array([0.00212745, 0.00559315]), 1: array([0.00300544, 0.00688757]), 2: array([0.00395829, 0.0080818 ]), 3: array([0.00511306, 0.0104178 ]), 4: array([0.00836248, 0.01734148]), 5: array([0.01291279, 0.02599668]), 6: array([0.01994845, 0.03719736]), 7: array([0.03385695, 0.0592057 ]), 8: array([0.05926945, 0.09463429]), 9: array([0.08224041, 0.12360925])}, 'recall_pop_Contribute': {0: array([0.00040493, 0.00105084]), 1: array([0.00048676, 0.0011106 ]), 2: array([0.00058447, 0.00119748]), 3: array([0.00075887, 0.00156703]), 4: array([0.00123379, 0.00263258]), 5: array([0.00213659, 0.00427935]), 6: array([0.00347854, 0.00640625]), 7: array([0.00645257, 0.01111033]), 8: array([0.01297161, 0.02076822]), 9: array([0.03140675, 0.0478371 ])}, 'ndcg': array([0.04982557, 0.06425753])}
total time cost of epoch 38:  78.8508870601654
[TRAIN]


































training: 603it [01:09, 10.73it/s]
EPOCH[39]:loss 8.049

training: 604it [01:09,  8.67it/s]
training: 3it [00:00,  9.00it/s]
{'precision': array([0.02691518, 0.02227643]), 'recall': array([0.0600808 , 0.09815638]), 'recall_pop': {0: array([0.00188627, 0.0053621 ]), 1: array([0.00309979, 0.00689704]), 2: array([0.00368041, 0.00827758]), 3: array([0.0052194 , 0.01086041]), 4: array([0.00828849, 0.01705374]), 5: array([0.01306809, 0.02525433]), 6: array([0.02020065, 0.03671787]), 7: array([0.03411173, 0.05975351]), 8: array([0.05960728, 0.09416464]), 9: array([0.08229614, 0.12430756])}, 'recall_pop_Contribute': {0: array([0.00036517, 0.00100609]), 1: array([0.0004994 , 0.00112363]), 2: array([0.00056051, 0.00121684]), 3: array([0.00076731, 0.00164275]), 4: array([0.00123986, 0.00261008]), 5: array([0.00216764, 0.00416215]), 6: array([0.00351241, 0.00634578]), 7: array([0.00650726, 0.01122006]), 8: array([0.01306582, 0.02066059]), 9: array([0.03139543, 0.04816842])}, 'ndcg': array([0.04996168, 0.06436751])}
total time cost of epoch 39:  79.21225810050964


































training: 600it [01:08, 10.85it/s]
EPOCH[40]:loss 8.044

training: 604it [01:08,  8.77it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.0269736 , 0.02232695]), 'recall': array([0.06016457, 0.0982516 ]), 'recall_pop': {0: array([0.00211942, 0.00553541]), 1: array([0.00306378, 0.00694914]), 2: array([0.00357936, 0.00808943]), 3: array([0.00528279, 0.01063516]), 4: array([0.00850585, 0.01716076]), 5: array([0.01341017, 0.02619671]), 6: array([0.02013255, 0.03677956]), 7: array([0.03524348, 0.06023548]), 8: array([0.05930171, 0.09448049]), 9: array([0.08233825, 0.12426276])}, 'recall_pop_Contribute': {0: array([0.0003764 , 0.00104304]), 1: array([0.00047094, 0.00112547]), 2: array([0.00055282, 0.0012177 ]), 3: array([0.00077028, 0.00161585]), 4: array([0.00125438, 0.00263146]), 5: array([0.00219795, 0.00430905]), 6: array([0.00351053, 0.00631318]), 7: array([0.00671852, 0.01132583]), 8: array([0.01299855, 0.02073557]), 9: array([0.03131421, 0.04793444])}, 'ndcg': array([0.05011062, 0.06452099])}
total time cost of epoch 40:  78.40942549705505



































training: 604it [01:09,  8.73it/s]
EPOCH[41]:loss 8.040
[TEST]
{'precision': array([0.0267715 , 0.02235064]), 'recall': array([0.05964848, 0.09833005]), 'recall_pop': {0: array([0.00185101, 0.00539168]), 1: array([0.00293559, 0.00706498]), 2: array([0.00371778, 0.00780152]), 3: array([0.00504302, 0.01096146]), 4: array([0.00852878, 0.01750053]), 5: array([0.01324662, 0.02565959]), 6: array([0.01995795, 0.03705544]), 7: array([0.03495879, 0.0596364 ]), 8: array([0.05912103, 0.09475478]), 9: array([0.08135514, 0.12442844])}, 'recall_pop_Contribute': {0: array([0.00034172, 0.0010111 ]), 1: array([0.00047616, 0.00112338]), 2: array([0.0005584 , 0.00117633]), 3: array([0.00075282, 0.00166349]), 4: array([0.00126376, 0.00267085]), 5: array([0.00218544, 0.0042841 ]), 6: array([0.00348292, 0.00639104]), 7: array([0.00663234, 0.01119045]), 8: array([0.01294416, 0.02077011]), 9: array([0.03101075, 0.04804921])}, 'ndcg': array([0.04968003, 0.06435173])}
total time cost of epoch 41:  78.97918200492859
[TRAIN]





























training: 604it [01:08,  8.80it/s]
EPOCH[42]:loss 8.039
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.02685361, 0.02236327]), 'recall': array([0.05984082, 0.09847006]), 'recall_pop': {0: array([0.00190627, 0.00523459]), 1: array([0.00303965, 0.00722181]), 2: array([0.00358459, 0.00806449]), 3: array([0.00542857, 0.01076403]), 4: array([0.00814534, 0.01711205]), 5: array([0.01301905, 0.025663  ]), 6: array([0.02036614, 0.03701067]), 7: array([0.03495816, 0.06031844]), 8: array([0.05897227, 0.09480858]), 9: array([0.08180554, 0.12458765])}, 'recall_pop_Contribute': {0: array([0.00035518, 0.00098973]), 1: array([0.00047378, 0.00114629]), 2: array([0.00054037, 0.00122613]), 3: array([0.00080661, 0.00165555]), 4: array([0.00121062, 0.00262234]), 5: array([0.00214502, 0.00427394]), 6: array([0.00350184, 0.0063914 ]), 7: array([0.00660283, 0.01130226]), 8: array([0.01290466, 0.02068588]), 9: array([0.03129993, 0.04817654])}, 'ndcg': array([0.04984351, 0.06444799])}
total time cost of epoch 42:  79.28204822540283



































training: 601it [01:09, 10.79it/s]
EPOCH[43]:loss 8.035

training: 604it [01:09,  8.63it/s]
training: 1it [00:00,  5.18it/s]
{'precision': array([0.02694834, 0.02234827]), 'recall': array([0.06016714, 0.09862262]), 'recall_pop': {0: array([0.00198364, 0.00502932]), 1: array([0.00313017, 0.00710686]), 2: array([0.00372883, 0.00810019]), 3: array([0.005573  , 0.01093872]), 4: array([0.00868874, 0.0172817 ]), 5: array([0.01336689, 0.02582622]), 6: array([0.01999967, 0.03730016]), 7: array([0.03486201, 0.06025881]), 8: array([0.05919216, 0.09472313]), 9: array([0.08226734, 0.12485776])}, 'recall_pop_Contribute': {0: array([0.00035519, 0.00094749]), 1: array([0.00048254, 0.00117928]), 2: array([0.00055245, 0.0012011 ]), 3: array([0.00082041, 0.00163281]), 4: array([0.00129985, 0.00266678]), 5: array([0.00223869, 0.00428675]), 6: array([0.00345969, 0.00644997]), 7: array([0.00658867, 0.01128349]), 8: array([0.01294089, 0.02068411]), 9: array([0.03142876, 0.04829084])}, 'ndcg': array([0.04997085, 0.06450262])}
total time cost of epoch 43:  81.49073386192322



































training: 598it [01:10,  8.54it/s]
EPOCH[44]:loss 8.033

training: 604it [01:10,  8.51it/s]
{'precision': array([0.02690413, 0.02232222]), 'recall': array([0.06005728, 0.0983079 ]), 'recall_pop': {0: array([0.0019671 , 0.00504845]), 1: array([0.00295863, 0.00712237]), 2: array([0.00376777, 0.00799549]), 3: array([0.00533955, 0.01033326]), 4: array([0.0086278 , 0.01700653]), 5: array([0.01310957, 0.02573732]), 6: array([0.02035902, 0.03700972]), 7: array([0.03493269, 0.06027804]), 8: array([0.05929157, 0.09524436]), 9: array([0.08160663, 0.12401403])}, 'recall_pop_Contribute': {0: array([0.00037843, 0.00096479]), 1: array([0.00048494, 0.00114919]), 2: array([0.00055437, 0.00119509]), 3: array([0.00078733, 0.00158445]), 4: array([0.00129259, 0.0025885 ]), 5: array([0.00217338, 0.00427693]), 6: array([0.00357149, 0.00636501]), 7: array([0.00662929, 0.01126635]), 8: array([0.01297186, 0.02081313]), 9: array([0.0312136 , 0.04810447])}, 'ndcg': array([0.0499617 , 0.06444779])}
training: 7it [00:00, 10.33it/s]
total time cost of epoch 44:  85.63815593719482



































training: 603it [01:10,  9.60it/s]
EPOCH[45]:loss 8.028

training: 604it [01:10,  8.51it/s]
training: 3it [00:00,  8.08it/s]
{'precision': array([0.02702255, 0.02234353]), 'recall': array([0.06026243, 0.09834445]), 'recall_pop': {0: array([0.00207206, 0.00520708]), 1: array([0.00298375, 0.00728492]), 2: array([0.0040872, 0.0076081]), 3: array([0.00536436, 0.010492  ]), 4: array([0.00847634, 0.01721573]), 5: array([0.01311323, 0.0264931 ]), 6: array([0.02079847, 0.03787608]), 7: array([0.03513354, 0.06038882]), 8: array([0.05924851, 0.09479631]), 9: array([0.08201952, 0.12374523])}, 'recall_pop_Contribute': {0: array([0.00038876, 0.00096344]), 1: array([0.0004906 , 0.00116871]), 2: array([0.00060637, 0.00112669]), 3: array([0.00079993, 0.00158518]), 4: array([0.00124842, 0.00263654]), 5: array([0.00217367, 0.00439029]), 6: array([0.00361179, 0.00647126]), 7: array([0.00665299, 0.01129921]), 8: array([0.0129441, 0.0207735]), 9: array([0.03134581, 0.04792962])}, 'ndcg': array([0.05010951, 0.06451164])}
[5mfind a better recall[25m 0.060262434146503896 ++2.6075629682154045e-06
total time cost of epoch 45:  86.41723322868347



































training: 596it [01:10,  9.49it/s]
EPOCH[46]:loss 8.030

training: 604it [01:11,  8.48it/s]
{'precision': array([0.02717096, 0.02240748]), 'recall': array([0.06080962, 0.09880692]), 'recall_pop': {0: array([0.002061  , 0.00538459]), 1: array([0.00295281, 0.00725304]), 2: array([0.00397826, 0.00802388]), 3: array([0.00539301, 0.01044689]), 4: array([0.00837864, 0.01707126]), 5: array([0.01373978, 0.02639676]), 6: array([0.02050059, 0.03759575]), 7: array([0.03559389, 0.06108393]), 8: array([0.05995156, 0.09613365]), 9: array([0.08258291, 0.12363968])}, 'recall_pop_Contribute': {0: array([0.00037409, 0.00100239]), 1: array([0.00047663, 0.00116584]), 2: array([0.00057699, 0.00118551]), 3: array([0.00082795, 0.00160559]), 4: array([0.00123662, 0.00263152]), 5: array([0.00227123, 0.00439657]), 6: array([0.00357719, 0.00644636]), 7: array([0.00675611, 0.01140714]), 8: array([0.01304912, 0.02103755]), 9: array([0.03166371, 0.04792845])}, 'ndcg': array([0.05046911, 0.06484257])}
[5mfind a better recall[25m 0.06080962231016821 ++0.0005471881636643153
total time cost of epoch 46:  86.56841921806335
[TRAIN]


































training: 595it [01:10,  9.11it/s]
EPOCH[47]:loss 8.024

training: 604it [01:10,  8.51it/s]
{'precision': array([0.0269136 , 0.02237116]), 'recall': array([0.06011455, 0.0986073 ]), 'recall_pop': {0: array([0.00198101, 0.00527348]), 1: array([0.00305175, 0.00722782]), 2: array([0.00392458, 0.00784388]), 3: array([0.00545406, 0.01065132]), 4: array([0.00828691, 0.01709074]), 5: array([0.01316214, 0.02622204]), 6: array([0.02006497, 0.03747305]), 7: array([0.03565725, 0.06047676]), 8: array([0.05891925, 0.09517577]), 9: array([0.08178437, 0.12344005])}, 'recall_pop_Contribute': {0: array([0.0003661 , 0.00096206]), 1: array([0.00049487, 0.00118464]), 2: array([0.00058749, 0.00114548]), 3: array([0.00082045, 0.00159589]), 4: array([0.00121036, 0.00261473]), 5: array([0.00220413, 0.00437108]), 6: array([0.0035184 , 0.00640136]), 7: array([0.00669516, 0.01138678]), 8: array([0.01287077, 0.02082948]), 9: array([0.03134682, 0.04811579])}, 'ndcg': array([0.05010751, 0.06468955])}
total time cost of epoch 47:  86.3025872707367
[TRAIN]



































training: 604it [01:11,  8.49it/s]
EPOCH[48]:loss 8.023
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.02695939, 0.02235932]), 'recall': array([0.06021505, 0.09841627]), 'recall_pop': {0: array([0.00196048, 0.00493748]), 1: array([0.00309322, 0.00693779]), 2: array([0.00384668, 0.00802997]), 3: array([0.00537699, 0.0108992 ]), 4: array([0.00847638, 0.01730433]), 5: array([0.01383114, 0.02593859]), 6: array([0.02035479, 0.03759338]), 7: array([0.03521329, 0.05965353]), 8: array([0.05882422, 0.09477986]), 9: array([0.08215064, 0.12426655])}, 'recall_pop_Contribute': {0: array([0.00034992, 0.0009001 ]), 1: array([0.00049358, 0.00111721]), 2: array([0.0005872 , 0.00118953]), 3: array([0.00081024, 0.00166239]), 4: array([0.0012444 , 0.00263101]), 5: array([0.00232974, 0.00432471]), 6: array([0.00354336, 0.00638119]), 7: array([0.00664433, 0.01121827]), 8: array([0.01287864, 0.02079183]), 9: array([0.03133364, 0.04820004])}, 'ndcg': array([0.05027636, 0.0647535 ])}
total time cost of epoch 48:  85.96817636489868




































training: 604it [01:12,  8.37it/s]
EPOCH[49]:loss 8.019
[TEST]
training: 4it [00:00,  7.55it/s]
{'precision': array([0.02705255, 0.02242248]), 'recall': array([0.06056061, 0.09879402]), 'recall_pop': {0: array([0.00207394, 0.00511253]), 1: array([0.00293465, 0.00718154]), 2: array([0.00395198, 0.00816417]), 3: array([0.00533647, 0.01094578]), 4: array([0.00855953, 0.01773826]), 5: array([0.01348982, 0.02662919]), 6: array([0.02054225, 0.03767237]), 7: array([0.03513885, 0.05990335]), 8: array([0.05935357, 0.0952261 ]), 9: array([0.08256504, 0.12437785])}, 'recall_pop_Contribute': {0: array([0.00036329, 0.00094688]), 1: array([0.00047854, 0.00114708]), 2: array([0.00058198, 0.001202  ]), 3: array([0.00081417, 0.00164956]), 4: array([0.00127364, 0.00267487]), 5: array([0.00223857, 0.00442372]), 6: array([0.00355966, 0.00645248]), 7: array([0.00662474, 0.01126757]), 8: array([0.01303856, 0.02086754]), 9: array([0.03158746, 0.04816233])}, 'ndcg': array([0.05044806, 0.0649323 ])}
total time cost of epoch 49:  87.52968835830688



































training: 597it [01:10,  9.88it/s]
EPOCH[50]:loss 8.015

training: 604it [01:11,  8.45it/s]
{'precision': array([0.02714412, 0.02240511]), 'recall': array([0.06068061, 0.09873138]), 'recall_pop': {0: array([0.00219573, 0.00512901]), 1: array([0.00285308, 0.00729334]), 2: array([0.00384514, 0.00800815]), 3: array([0.00555488, 0.01092025]), 4: array([0.00858299, 0.01751902]), 5: array([0.01343389, 0.02605938]), 6: array([0.0205616 , 0.03776016]), 7: array([0.03518503, 0.05971778]), 8: array([0.05986629, 0.09593168]), 9: array([0.0823493 , 0.12455559])}, 'recall_pop_Contribute': {0: array([0.00040068, 0.00092761]), 1: array([0.00045889, 0.00115764]), 2: array([0.00058634, 0.00120308]), 3: array([0.00085846, 0.00163903]), 4: array([0.00127745, 0.0026614 ]), 5: array([0.00223295, 0.00432415]), 6: array([0.00353308, 0.00645025]), 7: array([0.00666079, 0.01121933]), 8: array([0.01311911, 0.02093903]), 9: array([0.03155286, 0.04820987])}, 'ndcg': array([0.05043946, 0.06483012])}
total time cost of epoch 50:  86.90791583061218
[TRAIN]



































training: 604it [01:11,  8.42it/s]
EPOCH[51]:loss 8.015
[TEST]
{'precision': array([0.02717096, 0.02240906]), 'recall': array([0.06067141, 0.09873479]), 'recall_pop': {0: array([0.00208213, 0.0050794 ]), 1: array([0.00289781, 0.00703914]), 2: array([0.00390303, 0.00799519]), 3: array([0.00529091, 0.01081236]), 4: array([0.00845773, 0.0172857 ]), 5: array([0.01358531, 0.02597348]), 6: array([0.02115579, 0.03766926]), 7: array([0.03496382, 0.05955635]), 8: array([0.05949289, 0.09582982]), 9: array([0.08245926, 0.12444923])}, 'recall_pop_Contribute': {0: array([0.00037223, 0.00094625]), 1: array([0.00047104, 0.00111731]), 2: array([0.0005859 , 0.00119306]), 3: array([0.0007999 , 0.00163413]), 4: array([0.00125597, 0.00263744]), 5: array([0.0022584 , 0.00433022]), 6: array([0.00368146, 0.00648125]), 7: array([0.0066091 , 0.01124099]), 8: array([0.01301626, 0.02094409]), 9: array([0.03162116, 0.04821006])}, 'ndcg': array([0.05049155, 0.06487205])}
training: 7it [00:00,  8.18it/s]
total time cost of epoch 51:  87.03483510017395



































training: 597it [01:10,  8.92it/s]
EPOCH[52]:loss 8.010

training: 604it [01:11,  8.46it/s]
training: 1it [00:00,  5.21it/s]
{'precision': array([0.02722622, 0.02243353]), 'recall': array([0.06091338, 0.09892567]), 'recall_pop': {0: array([0.00209108, 0.00508516]), 1: array([0.00336426, 0.00700252]), 2: array([0.00370511, 0.00799625]), 3: array([0.00533301, 0.01061989]), 4: array([0.00828515, 0.01731768]), 5: array([0.01347756, 0.02577296]), 6: array([0.02110336, 0.03758306]), 7: array([0.03529172, 0.05959532]), 8: array([0.05983857, 0.09541273]), 9: array([0.08309451, 0.12520947])}, 'recall_pop_Contribute': {0: array([0.00037727, 0.00095914]), 1: array([0.00053823, 0.00109786]), 2: array([0.00057343, 0.00120345]), 3: array([0.00079481, 0.00160857]), 4: array([0.00122025, 0.00263487]), 5: array([0.00227822, 0.0042651 ]), 6: array([0.00366345, 0.00641232]), 7: array([0.0066661 , 0.01121873]), 8: array([0.01303763, 0.02094023]), 9: array([0.03176399, 0.04858541])}, 'ndcg': array([0.05054679, 0.06491831])}
[5mfind a better recall[25m 0.060913379347821206 ++0.00010375703765299477
total time cost of epoch 52:  86.37522339820862



































training: 595it [01:10,  9.88it/s]
EPOCH[53]:loss 8.008

training: 604it [01:11,  8.48it/s]
{'precision': array([0.02727359, 0.02241616]), 'recall': array([0.06104881, 0.09893943]), 'recall_pop': {0: array([0.00180838, 0.00513729]), 1: array([0.00337384, 0.00703764]), 2: array([0.00372511, 0.00789386]), 3: array([0.00535827, 0.01114092]), 4: array([0.00846225, 0.01727423]), 5: array([0.01330082, 0.02611249]), 6: array([0.02079412, 0.03787261]), 7: array([0.03515288, 0.05968087]), 8: array([0.060737  , 0.09541085]), 9: array([0.08296713, 0.1250053 ])}, 'recall_pop_Contribute': {0: array([0.00032808, 0.00093313]), 1: array([0.00052549, 0.00112907]), 2: array([0.00056097, 0.00118098]), 3: array([0.00081051, 0.00166341]), 4: array([0.00128584, 0.00263852]), 5: array([0.00222275, 0.00432886]), 6: array([0.00359824, 0.00649792]), 7: array([0.00663984, 0.01125364]), 8: array([0.01326449, 0.02093449]), 9: array([0.03181259, 0.0483794 ])}, 'ndcg': array([0.05052075, 0.06481648])}
[5mfind a better recall[25m 0.06104880796588745 ++0.00013542861806624396
total time cost of epoch 53:  86.70927119255066
[TRAIN]



































training: 604it [01:11,  8.47it/s]
EPOCH[54]:loss 8.008
[TEST]
{'precision': array([0.02717728, 0.02241853]), 'recall': array([0.06065795, 0.09876558]), 'recall_pop': {0: array([0.00186101, 0.00502993]), 1: array([0.00330046, 0.00695667]), 2: array([0.00388619, 0.00795789]), 3: array([0.00542195, 0.01130449]), 4: array([0.00866066, 0.01697972]), 5: array([0.01354195, 0.02639164]), 6: array([0.02052318, 0.03780989]), 7: array([0.03490195, 0.05942566]), 8: array([0.06048892, 0.09571231]), 9: array([0.08233238, 0.12459753])}, 'recall_pop_Contribute': {0: array([0.00034426, 0.00089914]), 1: array([0.00052106, 0.00111726]), 2: array([0.00057937, 0.00119784]), 3: array([0.00080761, 0.00168356]), 4: array([0.00127793, 0.00259634]), 5: array([0.00225915, 0.00434064]), 6: array([0.0035592 , 0.00650757]), 7: array([0.00659448, 0.01118138]), 8: array([0.01323979, 0.02095226]), 9: array([0.03147511, 0.04828958])}, 'ndcg': array([0.05059619, 0.06500925])}
total time cost of epoch 54:  86.91054058074951
[TRAIN]



































training: 600it [01:10,  8.74it/s]
EPOCH[55]:loss 8.005

training: 604it [01:11,  8.46it/s]
{'precision': array([0.02704307, 0.02250063]), 'recall': array([0.06053506, 0.09901486]), 'recall_pop': {0: array([0.00193035, 0.00517836]), 1: array([0.00313175, 0.00707177]), 2: array([0.00384514, 0.00797974]), 3: array([0.00527647, 0.01145625]), 4: array([0.00813677, 0.01701405]), 5: array([0.01359096, 0.02613819]), 6: array([0.02056779, 0.03742848]), 7: array([0.0348236 , 0.05948218]), 8: array([0.06001503, 0.09582732]), 9: array([0.08184498, 0.12536399])}, 'recall_pop_Contribute': {0: array([0.00034063, 0.00093234]), 1: array([0.00049024, 0.0011201 ]), 2: array([0.00057735, 0.00119077]), 3: array([0.00080357, 0.00170897]), 4: array([0.00122527, 0.00258502]), 5: array([0.00224815, 0.0043304 ]), 6: array([0.00358425, 0.006412  ]), 7: array([0.00661507, 0.01114891]), 8: array([0.013104  , 0.02096402]), 9: array([0.03154654, 0.04862233])}, 'ndcg': array([0.05042108, 0.06503685])}
training: 10it [00:01,  8.41it/s]
total time cost of epoch 55:  87.77402114868164



































training: 604it [01:11,  8.47it/s]
EPOCH[56]:loss 8.001
[TEST]
{'precision': array([0.02715833, 0.02249353]), 'recall': array([0.06061819, 0.09885402]), 'recall_pop': {0: array([0.00188456, 0.00525646]), 1: array([0.00303307, 0.00701062]), 2: array([0.00364936, 0.0082837 ]), 3: array([0.00522989, 0.01118205]), 4: array([0.00855891, 0.01651925]), 5: array([0.01387942, 0.02610392]), 6: array([0.02027049, 0.03783827]), 7: array([0.03480665, 0.05948298]), 8: array([0.05989018, 0.09529098]), 9: array([0.08294004, 0.12506073])}, 'recall_pop_Contribute': {0: array([0.00035702, 0.00096855]), 1: array([0.0004657 , 0.00111895]), 2: array([0.00054621, 0.00124065]), 3: array([0.00079569, 0.00167076]), 4: array([0.00127141, 0.00249471]), 5: array([0.0023191 , 0.00431123]), 6: array([0.00349005, 0.00649385]), 7: array([0.00655953, 0.01117036]), 8: array([0.01307588, 0.02092018]), 9: array([0.03173761, 0.04846478])}, 'ndcg': array([0.05052947, 0.06503241])}
total time cost of epoch 56:  87.45698499679565
[TRAIN]



































training: 604it [01:11,  8.45it/s]
EPOCH[57]:loss 8.003
[TEST]
{'precision': array([0.02715833, 0.02255905]), 'recall': array([0.06058829, 0.09918651]), 'recall_pop': {0: array([0.00190802, 0.00490148]), 1: array([0.00314622, 0.00701019]), 2: array([0.00370199, 0.0084156 ]), 3: array([0.00528436, 0.0111081 ]), 4: array([0.00824338, 0.01700133]), 5: array([0.01334804, 0.02606511]), 6: array([0.0207126 , 0.03843037]), 7: array([0.03541645, 0.05985892]), 8: array([0.05901863, 0.0959145 ]), 9: array([0.08332776, 0.12552448])}, 'recall_pop_Contribute': {0: array([0.00035805, 0.00090871]), 1: array([0.00048581, 0.00111319]), 2: array([0.00054423, 0.00122269]), 3: array([0.00080542, 0.0016829 ]), 4: array([0.00120848, 0.00257578]), 5: array([0.00223287, 0.00428545]), 6: array([0.00356295, 0.00652554]), 7: array([0.00667349, 0.0112449 ]), 8: array([0.01294239, 0.02101628]), 9: array([0.0317746 , 0.04861107])}, 'ndcg': array([0.05047192, 0.06512142])}
training: 8it [00:01,  8.26it/s]
total time cost of epoch 57:  87.02564930915833



































training: 602it [01:11, 10.04it/s]
EPOCH[58]:loss 8.000

training: 604it [01:11,  8.47it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02712675, 0.02251721]), 'recall': array([0.0605945 , 0.09909031]), 'recall_pop': {0: array([0.0019596 , 0.00513752]), 1: array([0.00295439, 0.00687309]), 2: array([0.00363673, 0.00811929]), 3: array([0.00531117, 0.01102902]), 4: array([0.00842834, 0.01665   ]), 5: array([0.01387611, 0.02634639]), 6: array([0.02034587, 0.03827314]), 7: array([0.03524173, 0.06000496]), 8: array([0.05926881, 0.09564716]), 9: array([0.08266411, 0.12544061])}, 'recall_pop_Contribute': {0: array([0.0003621 , 0.00094898]), 1: array([0.00047172, 0.00109029]), 2: array([0.00054288, 0.00120569]), 3: array([0.00080718, 0.00167246]), 4: array([0.00127089, 0.00252756]), 5: array([0.00234218, 0.00437113]), 6: array([0.00347434, 0.0064619 ]), 7: array([0.00660489, 0.01129731]), 8: array([0.01303207, 0.02094031]), 9: array([0.03168626, 0.04857467])}, 'ndcg': array([0.05056426, 0.06515993])}
total time cost of epoch 58:  87.03940916061401




































training: 604it [01:11,  8.45it/s]
EPOCH[59]:loss 8.001
[TEST]
{'precision': array([0.02726727, 0.02254247]), 'recall': array([0.06093894, 0.09937934]), 'recall_pop': {0: array([0.00180772, 0.00509033]), 1: array([0.00299728, 0.00680231]), 2: array([0.00391724, 0.00796769]), 3: array([0.00538804, 0.01094346]), 4: array([0.00881358, 0.0170195 ]), 5: array([0.01374443, 0.02637404]), 6: array([0.0201597 , 0.03750773]), 7: array([0.03529874, 0.05985384]), 8: array([0.05977811, 0.0959804 ]), 9: array([0.08281193, 0.12575657])}, 'recall_pop_Contribute': {0: array([0.00033868, 0.00095464]), 1: array([0.00048118, 0.00108558]), 2: array([0.00055977, 0.00119298]), 3: array([0.00081332, 0.00165023]), 4: array([0.00134489, 0.00262093]), 5: array([0.00231045, 0.00436339]), 6: array([0.0035116 , 0.00638255]), 7: array([0.00662812, 0.01126747]), 8: array([0.01309379, 0.02105144]), 9: array([0.03185715, 0.04881014])}, 'ndcg': array([0.05073213, 0.06526546])}
training: 9it [00:01,  8.28it/s]
total time cost of epoch 59:  87.07533526420593



































training: 602it [01:11, 10.29it/s]
EPOCH[60]:loss 7.998

training: 604it [01:11,  8.43it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02728622, 0.02258826]), 'recall': array([0.06098977, 0.09969249]), 'recall_pop': {0: array([0.00184983, 0.00509641]), 1: array([0.00314216, 0.00673021]), 2: array([0.00381777, 0.00800032]), 3: array([0.00515674, 0.01119363]), 4: array([0.0086869 , 0.01683188]), 5: array([0.01391803, 0.02689927]), 6: array([0.02044777, 0.03792185]), 7: array([0.0355042 , 0.06011005]), 8: array([0.05985162, 0.0967206 ]), 9: array([0.08259536, 0.12588051])}, 'recall_pop_Contribute': {0: array([0.00035135, 0.00094994]), 1: array([0.00050968, 0.00107462]), 2: array([0.00057548, 0.00120239]), 3: array([0.00078696, 0.00169522]), 4: array([0.00129899, 0.00259043]), 5: array([0.00234137, 0.00444342]), 6: array([0.00354425, 0.00644096]), 7: array([0.00666138, 0.0112835 ]), 8: array([0.01315312, 0.02123251]), 9: array([0.0317672, 0.0487795])}, 'ndcg': array([0.05079439, 0.06541889])}
total time cost of epoch 60:  87.18927931785583




































training: 604it [01:11,  8.47it/s]
EPOCH[61]:loss 7.994
[TEST]
{'precision': array([0.02718991, 0.02256852]), 'recall': array([0.06075276, 0.09945635]), 'recall_pop': {0: array([0.0019014 , 0.00514079]), 1: array([0.00292281, 0.00700809]), 2: array([0.00374567, 0.00829469]), 3: array([0.00544537, 0.01121156]), 4: array([0.00849123, 0.01697946]), 5: array([0.01393539, 0.02680536]), 6: array([0.02035428, 0.03813633]), 7: array([0.03499848, 0.05949074]), 8: array([0.05968507, 0.09597275]), 9: array([0.08287285, 0.12554577])}, 'recall_pop_Contribute': {0: array([0.00035869, 0.00096851]), 1: array([0.00046735, 0.0011232 ]), 2: array([0.00056108, 0.00125103]), 3: array([0.00082444, 0.00170035]), 4: array([0.00127699, 0.00259098]), 5: array([0.00232675, 0.00443304]), 6: array([0.00357367, 0.00651435]), 7: array([0.00660484, 0.0112572 ]), 8: array([0.01302981, 0.02107226]), 9: array([0.03172916, 0.04854544])}, 'ndcg': array([0.05060217, 0.0652655 ])}
training: 9it [00:01,  8.31it/s]
total time cost of epoch 61:  87.04343247413635



































training: 582it [01:08,  8.50it/s]
EPOCH[62]:loss 7.993

training: 604it [01:11,  8.46it/s]
{'precision': array([0.02721675, 0.02262694]), 'recall': array([0.06079376, 0.09976758]), 'recall_pop': {0: array([0.00181447, 0.00526372]), 1: array([0.00321716, 0.00681674]), 2: array([0.00383882, 0.00801664]), 3: array([0.00547199, 0.01104709]), 4: array([0.00863201, 0.01697885]), 5: array([0.01357932, 0.02651742]), 6: array([0.02074435, 0.03844282]), 7: array([0.03423418, 0.05967527]), 8: array([0.05995828, 0.09617285]), 9: array([0.08302419, 0.12633733])}, 'recall_pop_Contribute': {0: array([0.00033805, 0.00098906]), 1: array([0.00049749, 0.00112143]), 2: array([0.00056585, 0.00121738]), 3: array([0.00080862, 0.00167145]), 4: array([0.00128319, 0.00260633]), 5: array([0.00227227, 0.00440326]), 6: array([0.00362199, 0.00652536]), 7: array([0.00647479, 0.01129599]), 8: array([0.0131279 , 0.02109863]), 9: array([0.03180361, 0.04883869])}, 'ndcg': array([0.05062438, 0.06539222])}
training: 8it [00:01,  8.32it/s]
total time cost of epoch 62:  87.81127333641052



































training: 602it [01:11,  9.90it/s]
EPOCH[63]:loss 7.992

training: 604it [01:11,  8.46it/s]
{'precision': array([0.02724201, 0.02260721]), 'recall': array([0.06081488, 0.09962742]), 'recall_pop': {0: array([0.00195574, 0.00530923]), 1: array([0.00320742, 0.00708335]), 2: array([0.00394619, 0.00811796]), 3: array([0.00544906, 0.01126822]), 4: array([0.00858228, 0.01697412]), 5: array([0.0136837 , 0.02720472]), 6: array([0.02085523, 0.03839821]), 7: array([0.03472323, 0.06015405]), 8: array([0.05954171, 0.0954806 ]), 9: array([0.08334062, 0.1257598 ])}, 'recall_pop_Contribute': {0: array([0.00036352, 0.00098939]), 1: array([0.00050717, 0.00114684]), 2: array([0.00059857, 0.00121577]), 3: array([0.00078825, 0.00170285]), 4: array([0.00130905, 0.00260609]), 5: array([0.00227502, 0.00451822]), 6: array([0.00364359, 0.00653459]), 7: array([0.00655345, 0.01131778]), 8: array([0.01302808, 0.02092809]), 9: array([0.03174817, 0.0486678 ])}, 'ndcg': array([0.05060223, 0.06530701])}
total time cost of epoch 63:  87.42569637298584
[TRAIN]



































training: 604it [01:11,  8.41it/s]
EPOCH[64]:loss 7.989
[TEST]
{'precision': array([0.02726885, 0.02263247]), 'recall': array([0.06104233, 0.09995792]), 'recall_pop': {0: array([0.002041  , 0.00521335]), 1: array([0.00300517, 0.00718361]), 2: array([0.00411355, 0.00824004]), 3: array([0.00551041, 0.01128655]), 4: array([0.00852645, 0.0170371 ]), 5: array([0.01350816, 0.02658785]), 6: array([0.02082964, 0.03881789]), 7: array([0.03520496, 0.06053445]), 8: array([0.06015877, 0.0961602 ]), 9: array([0.08317961, 0.12618284])}, 'recall_pop_Contribute': {0: array([0.00037776, 0.00096935]), 1: array([0.00047328, 0.00115893]), 2: array([0.0006323 , 0.00124586]), 3: array([0.00080253, 0.00171072]), 4: array([0.00128614, 0.00262493]), 5: array([0.00224253, 0.00443547]), 6: array([0.00365394, 0.00661141]), 7: array([0.00667099, 0.01134337]), 8: array([0.01320931, 0.021112  ]), 9: array([0.03169354, 0.04874587])}, 'ndcg': array([0.05075422, 0.06548647])}
total time cost of epoch 64:  87.89188575744629
[TRAIN]



































training: 604it [01:11,  8.47it/s]
EPOCH[65]:loss 7.989
[TEST]
{'precision': array([0.0272057 , 0.02264826]), 'recall': array([0.06105156, 0.09976599]), 'recall_pop': {0: array([0.00194153, 0.00513575]), 1: array([0.00293676, 0.00727834]), 2: array([0.00410197, 0.0082732 ]), 3: array([0.00532199, 0.01176004]), 4: array([0.00858946, 0.01728314]), 5: array([0.01368606, 0.02709387]), 6: array([0.02073428, 0.03814432]), 7: array([0.03445983, 0.06029196]), 8: array([0.05975745, 0.09550684]), 9: array([0.08371949, 0.12599532])}, 'recall_pop_Contribute': {0: array([0.00038399, 0.00095314]), 1: array([0.00045744, 0.0011593 ]), 2: array([0.00061425, 0.0012422 ]), 3: array([0.00080153, 0.00177284]), 4: array([0.00130825, 0.00264033]), 5: array([0.00227477, 0.00448727]), 6: array([0.00363943, 0.0065128 ]), 7: array([0.00653312, 0.01130925]), 8: array([0.01310263, 0.02093313]), 9: array([0.03193615, 0.04875573])}, 'ndcg': array([0.05057612, 0.0652896 ])}
training: 6it [00:00,  7.90it/s]
[5mfind a better recall[25m 0.06105155961636952 ++2.751650482073209e-06
total time cost of epoch 65:  87.3424391746521



































training: 600it [01:10,  9.56it/s]
EPOCH[66]:loss 7.988

training: 604it [01:11,  8.46it/s]
{'precision': array([0.02718359, 0.0226001 ]), 'recall': array([0.06102205, 0.09965062]), 'recall_pop': {0: array([0.0017971 , 0.00506924]), 1: array([0.00281097, 0.00739781]), 2: array([0.00383882, 0.00802295]), 3: array([0.0054015 , 0.01134375]), 4: array([0.00842157, 0.01741077]), 5: array([0.01339453, 0.02616813]), 6: array([0.02072977, 0.03760677]), 7: array([0.03458391, 0.06045859]), 8: array([0.05964289, 0.09473645]), 9: array([0.08391424, 0.12636286])}, 'recall_pop_Contribute': {0: array([0.00033372, 0.00094402]), 1: array([0.0004573 , 0.00119291]), 2: array([0.00056568, 0.00120537]), 3: array([0.00078876, 0.00171996]), 4: array([0.00130096, 0.0026708 ]), 5: array([0.0022511 , 0.00432985]), 6: array([0.00359872, 0.00644641]), 7: array([0.00655786, 0.01138604]), 8: array([0.01302832, 0.02082123]), 9: array([0.03213963, 0.04893404])}, 'ndcg': array([0.05064343, 0.06529751])}
total time cost of epoch 66:  87.05946135520935
[TRAIN]



































training: 604it [01:11,  8.46it/s]
EPOCH[67]:loss 7.984
[TEST]
training: 7it [00:00,  8.16it/s]
{'precision': array([0.02730517, 0.02259852]), 'recall': array([0.06114301, 0.09952652]), 'recall_pop': {0: array([0.00204341, 0.0050973 ]), 1: array([0.00281834, 0.00725751]), 2: array([0.0037904 , 0.00833139]), 3: array([0.0051688 , 0.01118586]), 4: array([0.00844668, 0.01762909]), 5: array([0.01370205, 0.02614036]), 6: array([0.02054394, 0.03830025]), 7: array([0.03490776, 0.06033121]), 8: array([0.05982705, 0.09493703]), 9: array([0.0837774 , 0.12542094])}, 'recall_pop_Contribute': {0: array([0.0003631 , 0.00095268]), 1: array([0.00046307, 0.00115684]), 2: array([0.00057704, 0.00124908]), 3: array([0.00076582, 0.00169172]), 4: array([0.00129718, 0.00270922]), 5: array([0.00230273, 0.00433526]), 6: array([0.00358493, 0.0065647 ]), 7: array([0.00659532, 0.01129961]), 8: array([0.01312849, 0.02091565]), 9: array([0.03206532, 0.04865176])}, 'ndcg': array([0.05072646, 0.06528666])}
[5mfind a better recall[25m 0.061143009273542576 ++9.144965717305248e-05
total time cost of epoch 67:  87.05037522315979



































training: 604it [01:11,  8.51it/s]
EPOCH[68]:loss 7.983
[TEST]
{'precision': array([0.02740464, 0.02268536]), 'recall': array([0.06140968, 0.09986288]), 'recall_pop': {0: array([0.00184868, 0.00518497]), 1: array([0.00273613, 0.00752856]), 2: array([0.00398987, 0.00813241]), 3: array([0.00516907, 0.01074952]), 4: array([0.00831944, 0.01672003]), 5: array([0.01375917, 0.02686104]), 6: array([0.02120004, 0.03863106]), 7: array([0.03480517, 0.06080927]), 8: array([0.06045469, 0.09503354]), 9: array([0.08370622, 0.12639588])}, 'recall_pop_Contribute': {0: array([0.000357  , 0.00096079]), 1: array([0.00043732, 0.00117484]), 2: array([0.00060625, 0.00121624]), 3: array([0.00078867, 0.00161691]), 4: array([0.00127847, 0.0025991 ]), 5: array([0.00231472, 0.00445657]), 6: array([0.00370195, 0.00657759]), 7: array([0.00657784, 0.01132143]), 8: array([0.01323418, 0.02087637]), 9: array([0.03211329, 0.04906305])}, 'ndcg': array([0.05089442, 0.06546828])}
training: 9it [00:01,  8.12it/s]
[5mfind a better recall[25m 0.06140968043147049 ++0.00026667115792791685
total time cost of epoch 68:  85.90270519256592



































training: 604it [01:11,  8.49it/s]
EPOCH[69]:loss 7.981
[TEST]
{'precision': array([0.0273999 , 0.02271694]), 'recall': array([0.06120653, 0.10019668]), 'recall_pop': {0: array([0.00213551, 0.00512674]), 1: array([0.00299164, 0.00744917]), 2: array([0.00377672, 0.00845319]), 3: array([0.00523034, 0.01127243]), 4: array([0.00831576, 0.01639794]), 5: array([0.01392281, 0.02651017]), 6: array([0.02124667, 0.0386716 ]), 7: array([0.03444553, 0.06016608]), 8: array([0.05996316, 0.09535932]), 9: array([0.0837396, 0.1270693])}, 'recall_pop_Contribute': {0: array([0.00039005, 0.00096584]), 1: array([0.00047314, 0.00119077]), 2: array([0.00054378, 0.0012484 ]), 3: array([0.00080162, 0.00171203]), 4: array([0.00127832, 0.00257264]), 5: array([0.00234551, 0.00442446]), 6: array([0.00372546, 0.00659087]), 7: array([0.00649532, 0.01126255]), 8: array([0.01311096, 0.02091915]), 9: array([0.03204238, 0.04930996])}, 'ndcg': array([0.05077551, 0.06553375])}
total time cost of epoch 69:  85.77678227424622
[TRAIN]



































training: 604it [01:10,  8.53it/s]
EPOCH[70]:loss 7.982
[TEST]
training: 3it [00:00,  6.52it/s]
{'precision': array([0.02742674, 0.02269957]), 'recall': array([0.06138875, 0.0998627 ]), 'recall_pop': {0: array([0.00209078, 0.00500968]), 1: array([0.00295044, 0.00735172]), 2: array([0.00387145, 0.00828504]), 3: array([0.00513121, 0.01137607]), 4: array([0.00826712, 0.01692713]), 5: array([0.01389879, 0.02657741]), 6: array([0.02050478, 0.03879761]), 7: array([0.03474134, 0.060332  ]), 8: array([0.05990153, 0.09530941]), 9: array([0.08403752, 0.12671666])}, 'recall_pop_Contribute': {0: array([0.0003956 , 0.00093006]), 1: array([0.00049055, 0.00116917]), 2: array([0.00056875, 0.00121628]), 3: array([0.00078205, 0.00175228]), 4: array([0.00128652, 0.00261501]), 5: array([0.00234826, 0.0044049 ]), 6: array([0.00359075, 0.00664076]), 7: array([0.0065661 , 0.01127773]), 8: array([0.01314404, 0.02077016]), 9: array([0.03221613, 0.04908634])}, 'ndcg': array([0.05079945, 0.06542367])}
total time cost of epoch 70:  85.14501976966858



































training: 602it [01:10, 10.81it/s]
EPOCH[71]:loss 7.979

training: 604it [01:10,  8.52it/s]
training: 1it [00:00,  6.36it/s]
{'precision': array([0.0274899 , 0.02264905]), 'recall': array([0.06140649, 0.09996651]), 'recall_pop': {0: array([0.00207762, 0.0052429 ]), 1: array([0.00311427, 0.00752461]), 2: array([0.00386721, 0.00827544]), 3: array([0.00539255, 0.01119246]), 4: array([0.00867494, 0.01692081]), 5: array([0.01357177, 0.02632547]), 6: array([0.02046937, 0.03854825]), 7: array([0.03491094, 0.0608824 ]), 8: array([0.06048521, 0.0963096 ]), 9: array([0.08378946, 0.12598839])}, 'recall_pop_Contribute': {0: array([0.00036695, 0.00097186]), 1: array([0.00049616, 0.00119897]), 2: array([0.00057027, 0.00121505]), 3: array([0.00080522, 0.00170177]), 4: array([0.00131365, 0.00261539]), 5: array([0.00229685, 0.004435  ]), 6: array([0.00356778, 0.00657493]), 7: array([0.00659621, 0.01138654]), 8: array([0.01320915, 0.02099788]), 9: array([0.03218426, 0.04886911])}, 'ndcg': array([0.05089842, 0.0654702 ])}
total time cost of epoch 71:  84.42402482032776



































training: 602it [01:10, 10.77it/s]
EPOCH[72]:loss 7.980

training: 604it [01:10,  8.55it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02741727, 0.02273273]), 'recall': array([0.0611001 , 0.10018086]), 'recall_pop': {0: array([0.00191364, 0.00535909]), 1: array([0.00339647, 0.00734198]), 2: array([0.00387145, 0.00815233]), 3: array([0.00536624, 0.01122586]), 4: array([0.00860908, 0.0173029 ]), 5: array([0.01293106, 0.02650456]), 6: array([0.02073603, 0.0379865 ]), 7: array([0.03466257, 0.06027077]), 8: array([0.06086661, 0.09695692]), 9: array([0.08350817, 0.12608498])}, 'recall_pop_Contribute': {0: array([0.00034797, 0.00099089]), 1: array([0.00051327, 0.00117821]), 2: array([0.00056293, 0.00123718]), 3: array([0.00081456, 0.00169601]), 4: array([0.00132578, 0.00267112]), 5: array([0.00218477, 0.00445022]), 6: array([0.00360751, 0.00650583]), 7: array([0.00655665, 0.01128603]), 8: array([0.01325078, 0.02116094]), 9: array([0.03193588, 0.04900443])}, 'ndcg': array([0.05084578, 0.06564151])}
total time cost of epoch 72:  84.36548638343811




































training: 604it [01:11,  8.47it/s]
EPOCH[73]:loss 7.977
[TEST]
{'precision': array([0.02751832, 0.02277062]), 'recall': array([0.06156684, 0.1004752 ]), 'recall_pop': {0: array([0.00187812, 0.00541628]), 1: array([0.00320832, 0.00709584]), 2: array([0.00392198, 0.00818315]), 3: array([0.00541041, 0.01109034]), 4: array([0.00851593, 0.01704396]), 5: array([0.01339765, 0.02644789]), 6: array([0.02056402, 0.03848595]), 7: array([0.0353629 , 0.06045115]), 8: array([0.0599797 , 0.09730093]), 9: array([0.08409123, 0.12657944])}, 'recall_pop_Contribute': {0: array([0.00033941, 0.00100987]), 1: array([0.00050669, 0.0011413 ]), 2: array([0.000582  , 0.00122789]), 3: array([0.00082268, 0.00166684]), 4: array([0.00127874, 0.00258895]), 5: array([0.00225264, 0.00443915]), 6: array([0.00358512, 0.00661348]), 7: array([0.00668587, 0.01137275]), 8: array([0.01313974, 0.02120406]), 9: array([0.03237394, 0.04921091])}, 'ndcg': array([0.05105226, 0.06578776])}
[5mfind a better recall[25m 0.06156683984421593 ++0.000157159412745439
total time cost of epoch 73:  84.28449416160583
[TRAIN]


































training: 600it [01:09, 10.44it/s]
EPOCH[74]:loss 7.977

training: 604it [01:09,  8.64it/s]
{'precision': array([0.02746148, 0.02273431]), 'recall': array([0.06132528, 0.10007174]), 'recall_pop': {0: array([0.00207811, 0.00525067]), 1: array([0.00315096, 0.00720304]), 2: array([0.00372304, 0.00813666]), 3: array([0.00539857, 0.01118375]), 4: array([0.00846044, 0.01705261]), 5: array([0.01334214, 0.02666859]), 6: array([0.02067699, 0.03846522]), 7: array([0.03496521, 0.06009687]), 8: array([0.06015711, 0.09613511]), 9: array([0.08386272, 0.12651919])}, 'recall_pop_Contribute': {0: array([0.00037059, 0.00096777]), 1: array([0.00047102, 0.00115074]), 2: array([0.0005619 , 0.00122679]), 3: array([0.00081404, 0.00171045]), 4: array([0.00126785, 0.00261181]), 5: array([0.00222379, 0.00445988]), 6: array([0.00360091, 0.00655748]), 7: array([0.00662283, 0.01125741]), 8: array([0.01312737, 0.02097483]), 9: array([0.03226498, 0.04915459])}, 'ndcg': array([0.05091103, 0.06560588])}
training: 8it [00:01,  8.13it/s]
total time cost of epoch 74:  82.46118927001953


































training: 601it [01:09,  8.36it/s]
EPOCH[75]:loss 7.975

training: 604it [01:09,  8.69it/s]
training: 6it [00:00,  7.61it/s]
{'precision': array([0.02741727, 0.02270904]), 'recall': array([0.06131447, 0.10018378]), 'recall_pop': {0: array([0.00195574, 0.00508968]), 1: array([0.00316517, 0.00721199]), 2: array([0.00378883, 0.0082869 ]), 3: array([0.00551691, 0.01103586]), 4: array([0.00852893, 0.01667263]), 5: array([0.01341279, 0.02640065]), 6: array([0.02071946, 0.03808459]), 7: array([0.03518405, 0.06028681]), 8: array([0.06038382, 0.09632941]), 9: array([0.08361825, 0.12660166])}, 'recall_pop_Contribute': {0: array([0.00035541, 0.00093412]), 1: array([0.00049574, 0.00114981]), 2: array([0.00057472, 0.00123574]), 3: array([0.00083737, 0.00169939]), 4: array([0.0012752, 0.0025975]), 5: array([0.00223472, 0.00445486]), 6: array([0.0036194 , 0.00649466]), 7: array([0.00665983, 0.01134863]), 8: array([0.01317102, 0.02103541]), 9: array([0.03209107, 0.04923366])}, 'ndcg': array([0.05087249, 0.06559033])}
total time cost of epoch 75:  82.27295327186584



































training: 604it [01:10,  8.63it/s]
EPOCH[76]:loss 7.975
[TEST]
training: 1it [00:00,  5.91it/s]
{'precision': array([0.02760515, 0.02277141]), 'recall': array([0.06167195, 0.10037302]), 'recall_pop': {0: array([0.00197574, 0.00522725]), 1: array([0.00314464, 0.00717794]), 2: array([0.00386777, 0.00842391]), 3: array([0.00546936, 0.01100925]), 4: array([0.00875945, 0.01729128]), 5: array([0.01368116, 0.02616113]), 6: array([0.02047296, 0.03850398]), 7: array([0.0347646 , 0.05990997]), 8: array([0.05998369, 0.09630761]), 9: array([0.08472977, 0.12704941])}, 'recall_pop_Contribute': {0: array([0.00036165, 0.00096143]), 1: array([0.00050069, 0.0011281 ]), 2: array([0.00057996, 0.00124911]), 3: array([0.00082411, 0.00166571]), 4: array([0.00129703, 0.0026934 ]), 5: array([0.00226405, 0.00439496]), 6: array([0.00359618, 0.00654257]), 7: array([0.00657528, 0.01123562]), 8: array([0.01310348, 0.02109435]), 9: array([0.03256951, 0.04940779])}, 'ndcg': array([0.050916  , 0.06555264])}
[5mfind a better recall[25m 0.061671947207540705 ++0.00010510736332477316
total time cost of epoch 76:  82.82758212089539



































training: 604it [01:09,  8.70it/s]
EPOCH[77]:loss 7.973
[TEST]
{'precision': array([0.02748674, 0.02268378]), 'recall': array([0.06140601, 0.09993129]), 'recall_pop': {0: array([0.00201785, 0.00511094]), 1: array([0.00305149, 0.00713788]), 2: array([0.00367672, 0.00826578]), 3: array([0.005513  , 0.01097711]), 4: array([0.0087981 , 0.01657132]), 5: array([0.01352415, 0.02640627]), 6: array([0.02063194, 0.03822552]), 7: array([0.03476149, 0.05921769]), 8: array([0.05966832, 0.09581367]), 9: array([0.08409393, 0.12662351])}, 'recall_pop_Contribute': {0: array([0.00037105, 0.00093262]), 1: array([0.00047852, 0.00115051]), 2: array([0.00056985, 0.00123093]), 3: array([0.00082156, 0.00167416]), 4: array([0.0013253 , 0.00257373]), 5: array([0.00226271, 0.00438893]), 6: array([0.00364041, 0.00653537]), 7: array([0.00656964, 0.01113137]), 8: array([0.01306336, 0.02100564]), 9: array([0.0323036 , 0.04930803])}, 'ndcg': array([0.05103449, 0.06561689])}
total time cost of epoch 77:  82.53188610076904
[TRAIN]


































training: 604it [01:09,  8.65it/s]
EPOCH[78]:loss 7.973
[TEST]
{'precision': array([0.02751042, 0.02266484]), 'recall': array([0.06140551, 0.09993464]), 'recall_pop': {0: array([0.00209363, 0.00496113]), 1: array([0.00294728, 0.0069469 ]), 2: array([0.00360146, 0.00844759]), 3: array([0.00529778, 0.01128239]), 4: array([0.00865314, 0.01689049]), 5: array([0.01333024, 0.0261419 ]), 6: array([0.02052508, 0.03850997]), 7: array([0.03500331, 0.05897976]), 8: array([0.05960881, 0.09599441]), 9: array([0.08459117, 0.12708737])}, 'recall_pop_Contribute': {0: array([0.00038463, 0.0009116 ]), 1: array([0.00047649, 0.00110417]), 2: array([0.00053172, 0.00126104]), 3: array([0.00078912, 0.00171502]), 4: array([0.00128419, 0.00264314]), 5: array([0.00223322, 0.00435986]), 6: array([0.003576  , 0.00655284]), 7: array([0.00664351, 0.01110302]), 8: array([0.01300817, 0.02097598]), 9: array([0.03247847, 0.04930797])}, 'ndcg': array([0.05102882, 0.06559563])}
total time cost of epoch 78:  82.56912469863892
[TRAIN]


































training: 603it [01:09,  8.53it/s]
EPOCH[79]:loss 7.972

training: 604it [01:09,  8.67it/s]
training: 4it [00:00,  7.18it/s]
{'precision': array([0.0274299 , 0.02270194]), 'recall': array([0.06121975, 0.09999757]), 'recall_pop': {0: array([0.00197499, 0.00492187]), 1: array([0.00296429, 0.00693596]), 2: array([0.0036462 , 0.00834786]), 3: array([0.00521752, 0.01107214]), 4: array([0.0085542 , 0.01699487]), 5: array([0.0133081 , 0.02637167]), 6: array([0.02030823, 0.03852321]), 7: array([0.03481509, 0.05953613]), 8: array([0.06020352, 0.09573405]), 9: array([0.08384329, 0.12698739])}, 'recall_pop_Contribute': {0: array([0.00037172, 0.00091144]), 1: array([0.0004563 , 0.00109536]), 2: array([0.00055674, 0.00123158]), 3: array([0.00078457, 0.00170809]), 4: array([0.00126692, 0.00261664]), 5: array([0.00222546, 0.00438085]), 6: array([0.00355679, 0.00654689]), 7: array([0.00659796, 0.01119061]), 8: array([0.01318831, 0.02097888]), 9: array([0.03221496, 0.04933723])}, 'ndcg': array([0.05093399, 0.06559958])}
total time cost of epoch 79:  82.91483521461487



































training: 601it [01:08,  8.52it/s]
EPOCH[80]:loss 7.971

training: 604it [01:09,  8.72it/s]
training: 9it [00:01,  8.57it/s]
{'precision': array([0.02737622, 0.02271378]), 'recall': array([0.06102263, 0.10012507]), 'recall_pop': {0: array([0.0019671 , 0.00474714]), 1: array([0.00323411, 0.00703727]), 2: array([0.00348568, 0.00825522]), 3: array([0.00529305, 0.01106773]), 4: array([0.00832699, 0.01680667]), 5: array([0.01373917, 0.02683331]), 6: array([0.02005372, 0.03882336]), 7: array([0.03487806, 0.05924086]), 8: array([0.06016437, 0.0959826 ]), 9: array([0.08360315, 0.12695342])}, 'recall_pop_Contribute': {0: array([0.00035915, 0.00088425]), 1: array([0.00051142, 0.00111802]), 2: array([0.00052715, 0.00122171]), 3: array([0.00077705, 0.00170844]), 4: array([0.00124192, 0.00260896]), 5: array([0.00225827, 0.00446317]), 6: array([0.00347509, 0.00661612]), 7: array([0.0065816 , 0.01113757]), 8: array([0.0131624 , 0.02103034]), 9: array([0.03212858, 0.04933649])}, 'ndcg': array([0.05084064, 0.06560963])}
total time cost of epoch 80:  81.61230421066284


































training: 604it [01:09,  8.74it/s]
EPOCH[81]:loss 7.967
[TEST]
{'precision': array([0.02747411, 0.02266089]), 'recall': array([0.0612726 , 0.09995626]), 'recall_pop': {0: array([0.00200394, 0.00500228]), 1: array([0.00291307, 0.00691205]), 2: array([0.0035741 , 0.00806456]), 3: array([0.00520621, 0.01109112]), 4: array([0.0085163 , 0.01664746]), 5: array([0.01347919, 0.0259461 ]), 6: array([0.02072824, 0.03852925]), 7: array([0.03488695, 0.05968445]), 8: array([0.05970193, 0.0959598 ]), 9: array([0.08437388, 0.12713285])}, 'recall_pop_Contribute': {0: array([0.00036277, 0.00092524]), 1: array([0.00045498, 0.00109078]), 2: array([0.00052708, 0.00121365]), 3: array([0.00079045, 0.00170794]), 4: array([0.00127925, 0.00256362]), 5: array([0.00226826, 0.00430086]), 6: array([0.00365482, 0.00656188]), 7: array([0.00654391, 0.01120481]), 8: array([0.01305559, 0.02096149]), 9: array([0.03233548, 0.04942599])}, 'ndcg': array([0.05088867, 0.06549651])}
total time cost of epoch 81:  81.46273279190063
[TRAIN]


































training: 604it [01:09,  8.69it/s]
EPOCH[82]:loss 7.966
[TEST]
{'precision': array([0.02753726, 0.02267826]), 'recall': array([0.06148042, 0.09993792]), 'recall_pop': {0: array([0.00209078, 0.00506003]), 1: array([0.00306622, 0.00691348]), 2: array([0.00349252, 0.00808768]), 3: array([0.00518042, 0.01093587]), 4: array([0.00851232, 0.01679743]), 5: array([0.01350411, 0.02624771]), 6: array([0.0208281 , 0.03832802]), 7: array([0.03493142, 0.06022844]), 8: array([0.0593715 , 0.09572636]), 9: array([0.08472734, 0.12676028])}, 'recall_pop_Contribute': {0: array([0.00036198, 0.00092142]), 1: array([0.00048201, 0.00108472]), 2: array([0.00053028, 0.00121346]), 3: array([0.00077847, 0.00168642]), 4: array([0.00128091, 0.00259138]), 5: array([0.00228136, 0.00437821]), 6: array([0.00364491, 0.00657556]), 7: array([0.00659668, 0.01132028]), 8: array([0.01298388, 0.02095117]), 9: array([0.03253994, 0.04921531])}, 'ndcg': array([0.05104805, 0.06558265])}
total time cost of epoch 82:  81.90426778793335
[TRAIN]


































training: 604it [01:09,  8.74it/s]
EPOCH[83]:loss 7.967
[TEST]
training: 5it [00:00,  8.51it/s]
{'precision': array([0.02751989, 0.02274536]), 'recall': array([0.06139341, 0.10016313]), 'recall_pop': {0: array([0.00217867, 0.00505962]), 1: array([0.00315043, 0.00706144]), 2: array([0.0034241 , 0.00809531]), 3: array([0.00529103, 0.01103323]), 4: array([0.00852863, 0.01658596]), 5: array([0.01389477, 0.02672964]), 6: array([0.02060716, 0.038598  ]), 7: array([0.0350271 , 0.06000843]), 8: array([0.05962014, 0.09628371]), 9: array([0.0844076 , 0.12689856])}, 'recall_pop_Contribute': {0: array([0.00039013, 0.00091835]), 1: array([0.00049555, 0.00111872]), 2: array([0.00051192, 0.00122712]), 3: array([0.00078781, 0.00168903]), 4: array([0.00126566, 0.00257639]), 5: array([0.00230736, 0.00445979]), 6: array([0.0036059 , 0.00659814]), 7: array([0.00659262, 0.01123972]), 8: array([0.01300478, 0.02106212]), 9: array([0.03243167, 0.04927374])}, 'ndcg': array([0.05106509, 0.06571635])}
total time cost of epoch 83:  81.40252566337585



































training: 604it [01:10,  8.63it/s]
EPOCH[84]:loss 7.965
[TEST]
{'precision': array([0.02756252, 0.02269404]), 'recall': array([0.06147896, 0.09990165]), 'recall_pop': {0: array([0.00200236, 0.00478994]), 1: array([0.00290149, 0.00700573]), 2: array([0.0038583 , 0.00805584]), 3: array([0.00533866, 0.01093692]), 4: array([0.00869021, 0.01654571]), 5: array([0.01348115, 0.02658428]), 6: array([0.02091255, 0.03802807]), 7: array([0.03504067, 0.05985672]), 8: array([0.05977789, 0.09655145]), 9: array([0.0846316 , 0.12650351])}, 'recall_pop_Contribute': {0: array([0.00034827, 0.00089723]), 1: array([0.0004669 , 0.00111722]), 2: array([0.00057876, 0.00122167]), 3: array([0.000814 , 0.0016513]), 4: array([0.00132104, 0.00257642]), 5: array([0.00225266, 0.00443508]), 6: array([0.00362967, 0.00645932]), 7: array([0.006603  , 0.01127409]), 8: array([0.01304831, 0.02104936]), 9: array([0.03241635, 0.04921996])}, 'ndcg': array([0.05118031, 0.06570827])}
total time cost of epoch 84:  82.898202419281
[TRAIN]


































training: 604it [01:09,  8.71it/s]
EPOCH[85]:loss 7.967
[TEST]
{'precision': array([0.02746148, 0.0226522 ]), 'recall': array([0.06122747, 0.09966623]), 'recall_pop': {0: array([0.00215739, 0.00494239]), 1: array([0.00307122, 0.00682284]), 2: array([0.00374248, 0.00774705]), 3: array([0.00532656, 0.0110035 ]), 4: array([0.00850363, 0.0165044 ]), 5: array([0.01352675, 0.02679237]), 6: array([0.02093342, 0.03842044]), 7: array([0.03488625, 0.05906452]), 8: array([0.05977773, 0.09598931]), 9: array([0.08398101, 0.12685499])}, 'recall_pop_Contribute': {0: array([0.00036962, 0.00091235]), 1: array([0.00048361, 0.00110701]), 2: array([0.00055561, 0.00116236]), 3: array([0.00080213, 0.00167435]), 4: array([0.00129198, 0.00258204]), 5: array([0.00227126, 0.004451  ]), 6: array([0.00361687, 0.00655219]), 7: array([0.00659756, 0.01112099]), 8: array([0.01305525, 0.02092291]), 9: array([0.03218358, 0.04918104])}, 'ndcg': array([0.05095987, 0.06549143])}
total time cost of epoch 85:  81.81246519088745
[TRAIN]


































training: 604it [01:09,  8.74it/s]
EPOCH[86]:loss 7.963
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.02755937, 0.02270668]), 'recall': array([0.06147203, 0.09997785]), 'recall_pop': {0: array([0.00198898, 0.00513964]), 1: array([0.00299096, 0.00697938]), 2: array([0.00370041, 0.00753025]), 3: array([0.00520568, 0.01097136]), 4: array([0.00825075, 0.01651728]), 5: array([0.01354513, 0.02667478]), 6: array([0.02096089, 0.03856541]), 7: array([0.03541596, 0.05949047]), 8: array([0.06009464, 0.09558395]), 9: array([0.08427388, 0.1274938 ])}, 'recall_pop_Contribute': {0: array([0.00035486, 0.000932  ]), 1: array([0.00048108, 0.00110733]), 2: array([0.00057199, 0.00112562]), 3: array([0.00077838, 0.00166917]), 4: array([0.00124128, 0.00257215]), 5: array([0.00229212, 0.00448302]), 6: array([0.00362147, 0.00661   ]), 7: array([0.0066725 , 0.01115406]), 8: array([0.01310286, 0.02090529]), 9: array([0.0323555, 0.0494192])}, 'ndcg': array([0.05129373, 0.06584238])}
total time cost of epoch 86:  81.79761838912964



































training: 604it [01:09,  8.69it/s]
EPOCH[87]:loss 7.964
[TEST]
training: 1it [00:00,  4.98it/s]
{'precision': array([0.02749147, 0.02273588]), 'recall': array([0.06139711, 0.1002471 ]), 'recall_pop': {0: array([0.00191605, 0.00491521]), 1: array([0.00314491, 0.00687833]), 2: array([0.00359725, 0.00762047]), 3: array([0.0050581 , 0.01131486]), 4: array([0.00829706, 0.01693753]), 5: array([0.01333386, 0.02651384]), 6: array([0.02102623, 0.03803418]), 7: array([0.03495266, 0.05988202]), 8: array([0.05915875, 0.09568279]), 9: array([0.08455933, 0.12781057])}, 'recall_pop_Contribute': {0: array([0.00035123, 0.00090161]), 1: array([0.00050248, 0.00109836]), 2: array([0.00055345, 0.00113473]), 3: array([0.00076621, 0.00172631]), 4: array([0.00125267, 0.00261928]), 5: array([0.00226853, 0.00446065]), 6: array([0.00364446, 0.00650968]), 7: array([0.00658836, 0.01121982]), 8: array([0.01293777, 0.02092403]), 9: array([0.03253195, 0.04965263])}, 'ndcg': array([0.05117751, 0.06585871])}
total time cost of epoch 87:  82.04432916641235



































training: 601it [01:10,  8.50it/s]
EPOCH[88]:loss 7.961

training: 604it [01:10,  8.55it/s]
{'precision': array([0.02750568, 0.02275483]), 'recall': array([0.06152352, 0.10039891]), 'recall_pop': {0: array([0.00197762, 0.00491591]), 1: array([0.00318122, 0.00698254]), 2: array([0.00387461, 0.00773129]), 3: array([0.00500915, 0.01112928]), 4: array([0.00830864, 0.01659395]), 5: array([0.01360618, 0.0265037 ]), 6: array([0.02139825, 0.03867107]), 7: array([0.03533738, 0.06000593]), 8: array([0.05887462, 0.09592708]), 9: array([0.08442529, 0.1277416 ])}, 'recall_pop_Contribute': {0: array([0.00037484, 0.00090097]), 1: array([0.00051565, 0.0011237 ]), 2: array([0.00057933, 0.00114233]), 3: array([0.00074986, 0.00168784]), 4: array([0.00125877, 0.00255999]), 5: array([0.00227545, 0.00447426]), 6: array([0.00370504, 0.0066213 ]), 7: array([0.00665718, 0.01123763]), 8: array([0.01291028, 0.02100038]), 9: array([0.03249712, 0.04965051])}, 'ndcg': array([0.05136162, 0.06607285])}
total time cost of epoch 88:  84.85761570930481
[TRAIN]



































training: 604it [01:11,  8.48it/s]
EPOCH[89]:loss 7.961
[TEST]
{'precision': array([0.02751358, 0.02269957]), 'recall': array([0.06154774, 0.1001577 ]), 'recall_pop': {0: array([0.00216679, 0.00546642]), 1: array([0.00300044, 0.00666885]), 2: array([0.00401671, 0.00791474]), 3: array([0.00495069, 0.01090767]), 4: array([0.00821023, 0.01672541]), 5: array([0.01360385, 0.02657657]), 6: array([0.02129841, 0.03854826]), 7: array([0.03523058, 0.05924702]), 8: array([0.05876492, 0.09500756]), 9: array([0.08472192, 0.12753358])}, 'recall_pop_Contribute': {0: array([0.00040079, 0.00100942]), 1: array([0.00048775, 0.00108509]), 2: array([0.00060519, 0.00118093]), 3: array([0.00074863, 0.00166064]), 4: array([0.00125121, 0.00259961]), 5: array([0.00227676, 0.00444823]), 6: array([0.00373381, 0.00657885]), 7: array([0.00661177, 0.01113628]), 8: array([0.01289941, 0.02088894]), 9: array([0.03253243, 0.0495697 ])}, 'ndcg': array([0.05138711, 0.06597572])}
total time cost of epoch 89:  85.67056894302368
[TRAIN]



































training: 604it [01:10,  8.51it/s]
EPOCH[90]:loss 7.960
[TEST]
training: 3it [00:00,  8.83it/s]
{'precision': array([0.02754989, 0.02278088]), 'recall': array([0.06154322, 0.10031594]), 'recall_pop': {0: array([0.00229573, 0.0051945 ]), 1: array([0.0029057, 0.0067827]), 2: array([0.00395882, 0.00805746]), 3: array([0.00513753, 0.01103902]), 4: array([0.00838142, 0.0163663 ]), 5: array([0.01368246, 0.02635358]), 6: array([0.02099753, 0.03838228]), 7: array([0.03498185, 0.05989456]), 8: array([0.05850073, 0.09541143]), 9: array([0.08545123, 0.12796751])}, 'recall_pop_Contribute': {0: array([0.0004066 , 0.00095642]), 1: array([0.00046624, 0.00111072]), 2: array([0.00060088, 0.00120307]), 3: array([0.0007763 , 0.00168501]), 4: array([0.00127346, 0.002531  ]), 5: array([0.00230153, 0.00437726]), 6: array([0.00365732, 0.0065207 ]), 7: array([0.00659849, 0.0112545 ]), 8: array([0.01278014, 0.0209264 ]), 9: array([0.03268227, 0.04975086])}, 'ndcg': array([0.05129474, 0.06596702])}
total time cost of epoch 90:  85.64636182785034



































training: 600it [01:10,  8.55it/s]
EPOCH[91]:loss 7.958

training: 604it [01:11,  8.51it/s]
{'precision': array([0.02759568, 0.02280062]), 'recall': array([0.06175799, 0.10051377]), 'recall_pop': {0: array([0.00198101, 0.00522982]), 1: array([0.00284623, 0.00670586]), 2: array([0.00391514, 0.00791343]), 3: array([0.00510257, 0.01071921]), 4: array([0.00837601, 0.0166174 ]), 5: array([0.01409108, 0.0265419 ]), 6: array([0.02107006, 0.03834044]), 7: array([0.03504784, 0.05976562]), 8: array([0.05900387, 0.09592901]), 9: array([0.08542541, 0.12840634])}, 'recall_pop_Contribute': {0: array([0.00035244, 0.00096236]), 1: array([0.00044982, 0.00107333]), 2: array([0.00058951, 0.00117242]), 3: array([0.0007647 , 0.00165569]), 4: array([0.00127297, 0.00255903]), 5: array([0.00237275, 0.00439664]), 6: array([0.0036675 , 0.00654636]), 7: array([0.00661855, 0.01122475]), 8: array([0.01292148, 0.02103247]), 9: array([0.03274828, 0.04989071])}, 'ndcg': array([0.05142446, 0.06610793])}
training: 13it [00:01, 11.28it/s]
[5mfind a better recall[25m 0.06175799345916589 ++8.604625162518531e-05
total time cost of epoch 91:  85.3067638874054



































training: 604it [01:10,  8.53it/s]
EPOCH[92]:loss 7.957
[TEST]
{'precision': array([0.02754831, 0.02280851]), 'recall': array([0.06161731, 0.10058268]), 'recall_pop': {0: array([0.00217468, 0.0051443 ]), 1: array([0.00281623, 0.00666831]), 2: array([0.00414513, 0.00796606]), 3: array([0.00494468, 0.0111034 ]), 4: array([0.00817391, 0.01673687]), 5: array([0.01372832, 0.02633646]), 6: array([0.02096538, 0.03877171]), 7: array([0.0346004, 0.0595434]), 8: array([0.05935026, 0.09587728]), 9: array([0.08522278, 0.12831983])}, 'recall_pop_Contribute': {0: array([0.00038756, 0.00095355]), 1: array([0.00044169, 0.00106869]), 2: array([0.00062258, 0.00120282]), 3: array([0.00074691, 0.0017134 ]), 4: array([0.00126032, 0.00257269]), 5: array([0.00228641, 0.00440949]), 6: array([0.00367025, 0.00662175]), 7: array([0.00655214, 0.01122857]), 8: array([0.01296462, 0.02094844]), 9: array([0.03268482, 0.0498633 ])}, 'ndcg': array([0.05132076, 0.06608266])}
training: 7it [00:00,  9.34it/s]
total time cost of epoch 92:  84.43066167831421



































training: 604it [01:10,  8.51it/s]
EPOCH[93]:loss 7.956
[TEST]
{'precision': array([0.02762568, 0.02276904]), 'recall': array([0.06162339, 0.10033332]), 'recall_pop': {0: array([0.00211183, 0.0049875 ]), 1: array([0.00303412, 0.00686217]), 2: array([0.00395461, 0.00815763]), 3: array([0.00532229, 0.01113248]), 4: array([0.00815707, 0.0166144 ]), 5: array([0.01347141, 0.02644527]), 6: array([0.02097213, 0.03860903]), 7: array([0.03463269, 0.05917707]), 8: array([0.05972311, 0.09583439]), 9: array([0.08487299, 0.12759606])}, 'recall_pop_Contribute': {0: array([0.0003786 , 0.00090402]), 1: array([0.00046793, 0.00110696]), 2: array([0.00058449, 0.00121848]), 3: array([0.00080021, 0.0017223 ]), 4: array([0.00124264, 0.00257403]), 5: array([0.00223737, 0.00439634]), 6: array([0.00366781, 0.00662481]), 7: array([0.00657686, 0.01113724]), 8: array([0.01298463, 0.02095364]), 9: array([0.03268286, 0.04969548])}, 'ndcg': array([0.05128649, 0.06592139])}
training: 11it [00:01,  9.74it/s]
total time cost of epoch 93:  83.8833122253418



































training: 604it [01:10,  8.57it/s]
EPOCH[94]:loss 7.956
[TEST]
training: 10it [00:01,  8.56it/s]
{'precision': array([0.02757042, 0.02279115]), 'recall': array([0.06165451, 0.10042057]), 'recall_pop': {0: array([0.00193101, 0.00478423]), 1: array([0.00301675, 0.00702584]), 2: array([0.00402566, 0.00839981]), 3: array([0.00546308, 0.01133555]), 4: array([0.0080776 , 0.01690679]), 5: array([0.01354053, 0.02632714]), 6: array([0.02091289, 0.03912549]), 7: array([0.03497974, 0.05978318]), 8: array([0.05950376, 0.09589689]), 9: array([0.08495656, 0.12715013])}, 'recall_pop_Contribute': {0: array([0.00035711, 0.00088451]), 1: array([0.00047163, 0.00114191]), 2: array([0.00060622, 0.0012568 ]), 3: array([0.00079978, 0.00172933]), 4: array([0.00124078, 0.00262556]), 5: array([0.00226655, 0.00435237]), 6: array([0.00363635, 0.00667125]), 7: array([0.00666617, 0.01124207]), 8: array([0.01299542, 0.02092183]), 9: array([0.03261449, 0.04959494])}, 'ndcg': array([0.05118148, 0.06588647])}
total time cost of epoch 94:  80.07879662513733



































training: 604it [01:09,  8.63it/s]
EPOCH[95]:loss 7.956
[TEST]
{'precision': array([0.02779146, 0.0228393 ]), 'recall': array([0.06222997, 0.10074301]), 'recall_pop': {0: array([0.00199078, 0.00497658]), 1: array([0.00309864, 0.00670296]), 2: array([0.00402303, 0.00801746]), 3: array([0.00534305, 0.01083956]), 4: array([0.00820072, 0.01642365]), 5: array([0.01395537, 0.02665499]), 6: array([0.02134263, 0.0391776 ]), 7: array([0.0349058 , 0.05960323]), 8: array([0.06013271, 0.09608562]), 9: array([0.0855302, 0.1278863])}, 'recall_pop_Contribute': {0: array([0.00036602, 0.00090408]), 1: array([0.00048587, 0.00107899]), 2: array([0.00059244, 0.0012228 ]), 3: array([0.0008038 , 0.00166015]), 4: array([0.00128871, 0.00254377]), 5: array([0.00235471, 0.00440316]), 6: array([0.00372154, 0.00673106]), 7: array([0.00664521, 0.01121519]), 8: array([0.01313247, 0.02098736]), 9: array([0.0328392 , 0.04999644])}, 'ndcg': array([0.05146966, 0.06603937])}
[5mfind a better recall[25m 0.06222996792980662 ++0.0004719744706407278
total time cost of epoch 95:  79.60583734512329
[TRAIN]


































training: 604it [01:09,  8.74it/s]
EPOCH[96]:loss 7.954
[TEST]
training: 5it [00:00,  7.75it/s]
{'precision': array([0.02775515, 0.02281404]), 'recall': array([0.06199616, 0.10049942]), 'recall_pop': {0: array([0.00203446, 0.00463185]), 1: array([0.00297112, 0.00676657]), 2: array([0.0040746 , 0.00806088]), 3: array([0.00540962, 0.0111877 ]), 4: array([0.00807546, 0.01682758]), 5: array([0.01387376, 0.02681236]), 6: array([0.02112819, 0.03924036]), 7: array([0.03459637, 0.05973397]), 8: array([0.05977805, 0.09546877]), 9: array([0.08551484, 0.12784669])}, 'recall_pop_Contribute': {0: array([0.00037434, 0.00085816]), 1: array([0.00046332, 0.00106982]), 2: array([0.00060001, 0.00120759]), 3: array([0.00081192, 0.00170163]), 4: array([0.00125835, 0.00261418]), 5: array([0.0023147 , 0.00445077]), 6: array([0.00365803, 0.00673672]), 7: array([0.00657487, 0.01123902]), 8: array([0.01308471, 0.02085074]), 9: array([0.0328559, 0.0497708])}, 'ndcg': array([0.05129414, 0.06588398])}
total time cost of epoch 96:  78.68626642227173


































training: 599it [01:08,  8.49it/s]
EPOCH[97]:loss 7.956

training: 604it [01:09,  8.70it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.0277662 , 0.02287641]), 'recall': array([0.06214352, 0.10076676]), 'recall_pop': {0: array([0.00230287, 0.00471816]), 1: array([0.00319096, 0.00685838]), 2: array([0.00403776, 0.00801053]), 3: array([0.00538282, 0.01119945]), 4: array([0.00814275, 0.01676513]), 5: array([0.01371791, 0.02646933]), 6: array([0.02112129, 0.03896637]), 7: array([0.03461371, 0.06019235]), 8: array([0.06042388, 0.09576422]), 9: array([0.08513246, 0.12793084])}, 'recall_pop_Contribute': {0: array([0.00041392, 0.00088013]), 1: array([0.00048898, 0.00111068]), 2: array([0.0005991 , 0.00118917]), 3: array([0.00081902, 0.00168849]), 4: array([0.00123396, 0.00260495]), 5: array([0.00230734, 0.00440761]), 6: array([0.00368165, 0.00670688]), 7: array([0.00656494, 0.01129059]), 8: array([0.01318223, 0.02089772]), 9: array([0.03285238, 0.04999055])}, 'ndcg': array([0.0515418 , 0.06617897])}
total time cost of epoch 97:  78.80450963973999


































training: 604it [01:07,  8.91it/s]
EPOCH[98]:loss 7.953
[TEST]
training: 7it [00:00,  8.17it/s]
{'precision': array([0.02762726, 0.02290009]), 'recall': array([0.06171936, 0.10098133]), 'recall_pop': {0: array([0.00211078, 0.00492616]), 1: array([0.00309592, 0.0068904 ]), 2: array([0.0038683 , 0.00831397]), 3: array([0.00535752, 0.01129875]), 4: array([0.00823654, 0.01680834]), 5: array([0.01390767, 0.02653429]), 6: array([0.02103569, 0.0381851 ]), 7: array([0.03423754, 0.06086847]), 8: array([0.05960222, 0.09578857]), 9: array([0.0849608 , 0.12818414])}, 'recall_pop_Contribute': {0: array([0.00038767, 0.00092031]), 1: array([0.00049159, 0.00112049]), 2: array([0.000565 , 0.0012416]), 3: array([0.00079618, 0.00169835]), 4: array([0.00126029, 0.00261827]), 5: array([0.00233064, 0.00440183]), 6: array([0.00364041, 0.00659715]), 7: array([0.00650664, 0.01142945]), 8: array([0.0129861 , 0.02086761]), 9: array([0.03275482, 0.05008627])}, 'ndcg': array([0.05130997, 0.06616905])}
total time cost of epoch 98:  77.18065762519836


































training: 604it [01:08,  8.81it/s]
EPOCH[99]:loss 7.952
[TEST]
training: 7it [00:00,  8.08it/s]
{'precision': array([0.02763515, 0.02289456]), 'recall': array([0.06191114, 0.1007652 ]), 'recall_pop': {0: array([0.00221603, 0.00480656]), 1: array([0.00318201, 0.00658334]), 2: array([0.00390093, 0.00801286]), 3: array([0.00524726, 0.01115402]), 4: array([0.00822571, 0.01654515]), 5: array([0.01404605, 0.02691095]), 6: array([0.02100439, 0.03761674]), 7: array([0.03493722, 0.06009832]), 8: array([0.05987922, 0.09629724]), 9: array([0.08471253, 0.1283844 ])}, 'recall_pop_Contribute': {0: array([0.00041367, 0.00089021]), 1: array([0.00049683, 0.0010635 ]), 2: array([0.00057445, 0.00117908]), 3: array([0.00079305, 0.00168964]), 4: array([0.00126919, 0.00254153]), 5: array([0.00236673, 0.00447434]), 6: array([0.00365311, 0.00650962]), 7: array([0.00663314, 0.01123164]), 8: array([0.013045  , 0.02104575]), 9: array([0.03266598, 0.05013989])}, 'ndcg': array([0.05159378, 0.06633546])}
total time cost of epoch 99:  78.0740818977356
training: 24it [00:02,  8.53it/s]
training: 42it [00:05,  8.53it/s]
training: 58it [00:06,  8.52it/s]
training: 76it [00:09,  8.36it/s]
training: 93it [00:11,  8.48it/s]
training: 110it [00:13,  8.50it/s]
training: 127it [00:15,  8.54it/s]
training: 148it [00:17, 10.97it/s]
training: 170it [00:19, 11.21it/s]
training: 192it [00:21, 10.77it/s]
training: 208it [00:22, 10.70it/s]
training: 230it [00:24, 10.64it/s]
training: 252it [00:27, 11.30it/s]
training: 273it [00:29,  9.27it/s]
training: 290it [00:31,  8.54it/s]
training: 307it [00:33,  8.55it/s]
training: 324it [00:35,  8.50it/s]
training: 340it [00:36,  8.49it/s]
training: 358it [00:39,  8.47it/s]
training: 375it [00:41,  8.53it/s]
training: 392it [00:43,  8.49it/s]
training: 409it [00:45,  8.49it/s]
training: 426it [00:47,  8.51it/s]
training: 443it [00:49,  8.49it/s]
training: 460it [00:51,  8.70it/s]
training: 477it [00:53,  8.58it/s]
training: 494it [00:55,  8.51it/s]
training: 511it [00:57,  8.49it/s]
training: 528it [00:59,  8.52it/s]
training: 545it [01:01,  8.50it/s]
training: 562it [01:03,  8.47it/s]
training: 579it [01:05,  8.48it/s]
training: 595it [01:06,  8.50it/s]
training: 604it [01:08,  8.87it/s]
training: 604it [01:08,  8.87it/s]
EPOCH[100]:loss 7.952
[TEST]
{'precision': array([0.02766831, 0.02289851]), 'recall': array([0.06194744, 0.10088424]), 'recall_pop': {0: array([0.00188973, 0.00485531]), 1: array([0.00310043, 0.00688942]), 2: array([0.00376567, 0.00789264]), 3: array([0.00499904, 0.01115139]), 4: array([0.00803655, 0.01653463]), 5: array([0.01355791, 0.02687936]), 6: array([0.02047921, 0.03772799]), 7: array([0.03503272, 0.06014359]), 8: array([0.06012679, 0.09581113]), 9: array([0.0854728 , 0.12805531])}, 'recall_pop_Contribute': {0: array([0.00034818, 0.00091895]), 1: array([0.00049644, 0.00108979]), 2: array([0.00055709, 0.00119515]), 3: array([0.00074204, 0.0016706 ]), 4: array([0.00121486, 0.00256944]), 5: array([0.00229695, 0.00446415]), 6: array([0.00359717, 0.00652803]), 7: array([0.00668298, 0.01132028]), 8: array([0.013133  , 0.02095812]), 9: array([0.03287873, 0.05016972])}, 'ndcg': array([0.05157481, 0.06633303])}
total time cost of epoch 100:  77.57076406478882
training: 12it [00:01,  8.47it/s]]
training: 29it [00:03,  8.49it/s]]
training: 46it [00:05,  8.48it/s]]
training: 63it [00:07,  8.41it/s]]
training: 80it [00:09,  8.50it/s]]
training: 97it [00:11,  8.49it/s]]
training: 114it [00:13,  8.47it/s]
training: 131it [00:15,  8.55it/s]
training: 148it [00:17,  8.53it/s]
training: 165it [00:19,  8.82it/s]
training: 186it [00:21, 10.96it/s]
training: 205it [00:23, 10.22it/s]
training: 227it [00:25, 10.18it/s]
training: 247it [00:27, 11.32it/s]
training: 269it [00:29, 10.86it/s]
training: 293it [00:31, 11.58it/s]
training: 313it [00:33,  8.97it/s]
training: 330it [00:35,  8.52it/s]
training: 347it [00:37,  8.53it/s]
training: 364it [00:39,  8.54it/s]
training: 382it [00:41,  8.53it/s]
training: 399it [00:43,  8.54it/s]
training: 416it [00:45,  8.53it/s]
training: 433it [00:47,  8.53it/s]
training: 450it [00:49,  8.47it/s]
training: 467it [00:51,  8.53it/s]
training: 484it [00:53,  8.53it/s]
training: 501it [00:55,  8.79it/s]
training: 518it [00:57,  8.53it/s]
training: 535it [00:59,  8.42it/s]
training: 552it [01:01,  8.50it/s]
training: 569it [01:03,  8.41it/s]
training: 586it [01:05,  8.41it/s]
training: 603it [01:07,  8.46it/s]
training: 603it [01:07,  8.46it/s]
EPOCH[101]:loss 7.951
training: 604it [01:07,  8.91it/s]
training: 2it [00:00,  6.52it/s]s]
training: 2it [00:00,  6.52it/s]s]
{'precision': array([0.02756726, 0.02289377]), 'recall': array([0.06169381, 0.10087565]), 'recall_pop': {0: array([0.00205657, 0.00509575]), 1: array([0.00287334, 0.00694542]), 2: array([0.0037183 , 0.00815872]), 3: array([0.00516166, 0.01132348]), 4: array([0.00820045, 0.0168086 ]), 5: array([0.01387361, 0.02689697]), 6: array([0.02032884, 0.03769914]), 7: array([0.03447653, 0.06055263]), 8: array([0.05981717, 0.09561456]), 9: array([0.08506502, 0.12827501])}, 'recall_pop_Contribute': {0: array([0.00038885, 0.00092849]), 1: array([0.00046439, 0.00110773]), 2: array([0.00053597, 0.00122715]), 3: array([0.00078408, 0.00169159]), 4: array([0.00126453, 0.00259489]), 5: array([0.002302  , 0.00445148]), 6: array([0.00356209, 0.00649169]), 7: array([0.00654292, 0.01137669]), 8: array([0.0130681 , 0.02082574]), 9: array([0.03278088, 0.05018019])}, 'ndcg': array([0.05142752, 0.06630182])}
total time cost of epoch 101:  77.25334143638611
training: 20it [00:02,  8.55it/s]]
training: 37it [00:04,  8.43it/s]]
training: 54it [00:06,  8.43it/s]]
training: 71it [00:08,  8.49it/s]]
training: 88it [00:10,  8.46it/s]]
training: 105it [00:12,  8.53it/s]
training: 122it [00:14,  8.52it/s]
training: 139it [00:16,  8.54it/s]
training: 156it [00:18,  8.40it/s]
training: 173it [00:20,  8.53it/s]
training: 190it [00:22,  8.49it/s]
training: 205it [00:24,  8.46it/s]
training: 226it [00:26, 11.02it/s]
training: 248it [00:28, 10.81it/s]
training: 268it [00:30,  8.81it/s]
training: 289it [00:32, 11.25it/s]
training: 311it [00:34, 11.23it/s]
training: 335it [00:36, 11.36it/s]
training: 352it [00:38,  8.59it/s]
training: 369it [00:40,  8.49it/s]
training: 386it [00:42,  8.49it/s]
training: 403it [00:44,  8.47it/s]
training: 420it [00:46,  8.60it/s]
training: 437it [00:48,  8.45it/s]
training: 454it [00:50,  8.52it/s]
training: 471it [00:52,  8.42it/s]
training: 488it [00:54,  8.55it/s]
training: 505it [00:56,  8.51it/s]
training: 522it [00:58,  8.49it/s]
training: 539it [01:00,  8.46it/s]
training: 556it [01:02,  8.48it/s]
training: 573it [01:04,  8.49it/s]
training: 590it [01:06,  8.51it/s]
training: 604it [01:08,  8.85it/s]
training: 604it [01:08,  8.85it/s]
EPOCH[102]:loss 7.952
training: 6it [00:00,  8.18it/s]s]
training: 6it [00:00,  8.18it/s]s]
{'precision': array([0.02760673, 0.02294982]), 'recall': array([0.0616581 , 0.10110629]), 'recall_pop': {0: array([0.00218626, 0.00504961]), 1: array([0.00288676, 0.00711805]), 2: array([0.00373777, 0.00796501]), 3: array([0.00511561, 0.01133848]), 4: array([0.00817053, 0.01637685]), 5: array([0.01375843, 0.02673407]), 6: array([0.02063681, 0.03821597]), 7: array([0.03454186, 0.06048195]), 8: array([0.05956482, 0.09601827]), 9: array([0.08499705, 0.12861841])}, 'recall_pop_Contribute': {0: array([0.00040122, 0.00094289]), 1: array([0.00046339, 0.00111501]), 2: array([0.00054318, 0.00119105]), 3: array([0.00075546, 0.00170289]), 4: array([0.00125093, 0.00253888]), 5: array([0.00228515, 0.00448644]), 6: array([0.00358855, 0.00656323]), 7: array([0.00657327, 0.0113518 ]), 8: array([0.01295354, 0.0208617 ]), 9: array([0.0328434 , 0.05035241])}, 'ndcg': array([0.05146287, 0.06643204])}
total time cost of epoch 102:  77.73626399040222
training: 23it [00:02,  8.43it/s]]
training: 40it [00:04,  8.44it/s]]
training: 57it [00:06,  8.46it/s]]
training: 74it [00:08,  8.54it/s]]
training: 91it [00:10,  8.49it/s]]
training: 108it [00:12,  8.55it/s]
training: 125it [00:14,  8.49it/s]
training: 142it [00:16,  8.50it/s]
training: 159it [00:18,  8.43it/s]
training: 176it [00:20,  8.50it/s]
training: 193it [00:22,  8.54it/s]
training: 210it [00:24,  8.54it/s]
training: 227it [00:26,  8.55it/s]
training: 245it [00:28,  9.29it/s]
training: 264it [00:30, 10.70it/s]
training: 288it [00:32, 11.18it/s]
training: 305it [00:34,  7.94it/s]
training: 326it [00:36, 11.27it/s]
training: 348it [00:38, 10.65it/s]
training: 370it [00:40, 11.35it/s]
training: 389it [00:42,  8.54it/s]
training: 406it [00:44,  8.24it/s]
training: 423it [00:46,  8.54it/s]
training: 440it [00:48,  8.53it/s]
training: 457it [00:50,  8.48it/s]
training: 474it [00:52,  8.43it/s]
training: 491it [00:54,  8.53it/s]
training: 508it [00:56,  8.54it/s]
training: 524it [00:58,  7.61it/s]
training: 539it [01:00,  7.50it/s]
training: 554it [01:02,  7.50it/s]
training: 569it [01:04,  7.51it/s]
training: 585it [01:06,  8.27it/s]
training: 602it [01:08,  8.54it/s]
training: 602it [01:08,  8.54it/s]
EPOCH[103]:loss 7.950
training: 604it [01:09,  8.72it/s]
training: 4it [00:00,  8.17it/s]s]
training: 4it [00:00,  8.17it/s]s]
{'precision': array([0.02778199, 0.0229214 ]), 'recall': array([0.06193312, 0.10101935]), 'recall_pop': {0: array([0.00216521, 0.00518546]), 1: array([0.00286992, 0.00707015]), 2: array([0.0039325 , 0.00801049]), 3: array([0.00515219, 0.01102188]), 4: array([0.00840435, 0.01650756]), 5: array([0.01385756, 0.02643691]), 6: array([0.0204334 , 0.03845604]), 7: array([0.03476558, 0.06025548]), 8: array([0.05976812, 0.09629276]), 9: array([0.08529426, 0.12855883])}, 'recall_pop_Contribute': {0: array([0.0004025 , 0.00094936]), 1: array([0.0004597, 0.0011419]), 2: array([0.00056957, 0.0012166 ]), 3: array([0.00077629, 0.00166487]), 4: array([0.00126667, 0.00255567]), 5: array([0.00233186, 0.00443878]), 6: array([0.00357327, 0.00660121]), 7: array([0.0065993 , 0.01130769]), 8: array([0.01300972, 0.0209428 ]), 9: array([0.03294424, 0.05020046])}, 'ndcg': array([0.05159628, 0.0663706 ])}
total time cost of epoch 103:  80.43231701850891
training: 21it [00:02,  8.57it/s]]
training: 36it [00:04,  8.40it/s]]
training: 53it [00:06,  8.53it/s]]
training: 70it [00:08,  8.46it/s]]
training: 87it [00:10,  8.48it/s]]
training: 104it [00:12,  8.55it/s]
training: 121it [00:14,  8.52it/s]
training: 138it [00:16,  8.53it/s]
training: 155it [00:18,  8.39it/s]
training: 172it [00:20,  8.51it/s]
training: 188it [00:22,  8.16it/s]
training: 205it [00:24,  8.53it/s]
training: 222it [00:26,  8.53it/s]
training: 239it [00:28,  8.53it/s]
training: 256it [00:30,  8.47it/s]
training: 275it [00:32, 10.61it/s]
training: 297it [00:34, 10.63it/s]
training: 317it [00:36, 10.79it/s]
training: 338it [00:38, 10.89it/s]
training: 360it [00:40,  9.78it/s]
training: 380it [00:42, 11.08it/s]
training: 402it [00:44, 10.85it/s]
training: 420it [00:46,  8.50it/s]
training: 437it [00:48,  8.58it/s]
training: 454it [00:50,  8.51it/s]
training: 471it [00:52,  8.38it/s]
training: 488it [00:54,  8.45it/s]
training: 505it [00:56,  8.19it/s]
training: 522it [00:58,  8.41it/s]
training: 539it [01:00,  8.50it/s]
training: 556it [01:02,  8.46it/s]
training: 573it [01:04,  8.40it/s]
training: 590it [01:06,  8.47it/s]
training: 604it [01:08,  8.84it/s]
training: 604it [01:08,  8.84it/s]
EPOCH[104]:loss 7.950
training: 8it [00:00,  8.33it/s]s]
training: 8it [00:00,  8.33it/s]s]
{'precision': array([0.02787041, 0.02296877]), 'recall': array([0.06223675, 0.10097236]), 'recall_pop': {0: array([0.002231  , 0.00510041]), 1: array([0.00306465, 0.0071912 ]), 2: array([0.00379935, 0.00775949]), 3: array([0.00525069, 0.01095605]), 4: array([0.00846149, 0.01703408]), 5: array([0.01388171, 0.02669823]), 6: array([0.02058664, 0.03802077]), 7: array([0.03567214, 0.06091776]), 8: array([0.06022232, 0.0962018 ]), 9: array([0.08560096, 0.12820575])}, 'recall_pop_Contribute': {0: array([0.00041217, 0.00094102]), 1: array([0.00048151, 0.00112826]), 2: array([0.00056534, 0.00116028]), 3: array([0.00079364, 0.0016601 ]), 4: array([0.00125857, 0.00263505]), 5: array([0.00231499, 0.00445281]), 6: array([0.00357465, 0.00652247]), 7: array([0.00675054, 0.01139202]), 8: array([0.01307231, 0.02094706]), 9: array([0.03301302, 0.05013329])}, 'ndcg': array([0.05170443, 0.06636138])}
[5mfind a better recall[25m 0.062236747556450506 ++6.7796266438879815e-06
total time cost of epoch 104:  77.6226601600647
training: 25it [00:03,  8.33it/s]]
training: 42it [00:05,  8.51it/s]]
training: 59it [00:07,  8.48it/s]]
training: 75it [00:08,  8.33it/s]]
training: 92it [00:10,  8.47it/s]]
training: 109it [00:13,  8.52it/s]
training: 126it [00:15,  8.49it/s]
training: 143it [00:17,  8.33it/s]
training: 160it [00:19,  8.48it/s]
training: 177it [00:21,  8.60it/s]
training: 193it [00:22,  8.49it/s]
training: 210it [00:24,  8.43it/s]
training: 227it [00:27,  8.41it/s]
training: 244it [00:28,  8.55it/s]
training: 259it [00:30,  8.41it/s]
training: 277it [00:33,  8.47it/s]
training: 294it [00:35,  8.48it/s]
training: 312it [00:36, 10.27it/s]
training: 334it [00:39, 10.55it/s]
training: 354it [00:40, 10.46it/s]
training: 376it [00:43, 10.85it/s]
training: 398it [00:45, 11.23it/s]
training: 420it [00:47, 10.72it/s]
training: 441it [00:49,  9.41it/s]
training: 458it [00:51,  8.41it/s]
training: 474it [00:53,  8.54it/s]
training: 491it [00:55,  8.26it/s]
training: 508it [00:57,  8.30it/s]
training: 525it [00:59,  8.33it/s]
training: 542it [01:01,  8.36it/s]
training: 559it [01:03,  8.38it/s]
training: 576it [01:05,  8.36it/s]
training: 592it [01:07,  8.49it/s]
training: 604it [01:08,  8.80it/s]
training: 604it [01:08,  8.80it/s]
EPOCH[105]:loss 7.947
training: 9it [00:01,  8.59it/s]s]
training: 9it [00:01,  8.59it/s]s]
{'precision': array([0.02771883, 0.02293956]), 'recall': array([0.06196269, 0.10086462]), 'recall_pop': {0: array([0.00217995, 0.00505829]), 1: array([0.00296465, 0.00705489]), 2: array([0.00369146, 0.00793369]), 3: array([0.0053956 , 0.01084347]), 4: array([0.00859337, 0.01675637]), 5: array([0.01362272, 0.02633572]), 6: array([0.0207491 , 0.03873984]), 7: array([0.03469925, 0.05997551]), 8: array([0.05959746, 0.09693509]), 9: array([0.08581689, 0.12783565])}, 'recall_pop_Contribute': {0: array([0.00040033, 0.00092221]), 1: array([0.00045947, 0.00111391]), 2: array([0.00054594, 0.00117357]), 3: array([0.00081315, 0.00165357]), 4: array([0.00128526, 0.00254983]), 5: array([0.00226291, 0.00437024]), 6: array([0.00356706, 0.00660355]), 7: array([0.00660864, 0.01126366]), 8: array([0.01294877, 0.02107503]), 9: array([0.03307117, 0.05013905])}, 'ndcg': array([0.05158053, 0.06632191])}
total time cost of epoch 105:  78.01544904708862
training: 26it [00:03,  8.47it/s]]
training: 43it [00:05,  8.46it/s]]
training: 60it [00:07,  8.43it/s]]
training: 77it [00:09,  8.48it/s]]
training: 94it [00:11,  8.50it/s]]
training: 111it [00:13,  8.54it/s]
training: 128it [00:15,  8.55it/s]
training: 145it [00:17,  8.49it/s]
training: 162it [00:19,  8.54it/s]
training: 179it [00:21,  8.51it/s]
training: 196it [00:23,  8.45it/s]
training: 211it [00:25,  5.48it/s]
training: 228it [00:27,  8.50it/s]
training: 245it [00:29,  8.44it/s]
training: 262it [00:31,  8.52it/s]
training: 279it [00:33,  8.49it/s]
training: 296it [00:35,  8.47it/s]
training: 313it [00:37,  8.53it/s]
training: 330it [00:39,  8.53it/s]
training: 347it [00:41,  9.88it/s]
training: 369it [00:43, 10.76it/s]
training: 391it [00:45, 10.87it/s]
training: 405it [00:46, 10.08it/s]
training: 428it [00:48, 11.19it/s]
training: 450it [00:50, 10.86it/s]
training: 472it [00:52, 11.24it/s]
training: 491it [00:54,  8.49it/s]
training: 508it [00:56,  8.48it/s]
training: 525it [00:58,  8.45it/s]
training: 541it [01:00,  8.32it/s]
training: 558it [01:02,  8.52it/s]
training: 575it [01:04,  8.40it/s]
training: 592it [01:06,  8.34it/s]
training: 604it [01:08,  8.85it/s]
training: 604it [01:08,  8.85it/s]
EPOCH[106]:loss 7.951
[TEST]
training: 8it [00:00,  8.37it/s]s]
training: 8it [00:00,  8.37it/s]s]
total time cost of epoch 106:  77.79580450057983
training: 25it [00:02,  8.57it/s]]
training: 42it [00:04,  8.57it/s]]
training: 59it [00:06,  8.63it/s]]
training: 76it [00:08,  8.45it/s]]
training: 93it [00:10,  8.53it/s]]
training: 110it [00:12,  8.36it/s]
training: 127it [00:14,  8.51it/s]
training: 144it [00:16,  8.47it/s]
training: 161it [00:18,  8.47it/s]
training: 178it [00:20,  8.48it/s]
training: 195it [00:22,  8.50it/s]
training: 212it [00:24,  8.60it/s]
training: 229it [00:26,  8.52it/s]
training: 246it [00:28,  8.46it/s]
training: 263it [00:30,  8.44it/s]
training: 280it [00:32,  8.50it/s]
training: 297it [00:34,  8.58it/s]
training: 314it [00:36,  8.52it/s]
training: 331it [00:38,  8.50it/s]
training: 348it [00:40,  8.46it/s]
training: 366it [00:43,  8.47it/s]
training: 382it [00:44,  9.18it/s]
training: 403it [00:47, 10.15it/s]
training: 425it [00:49, 11.02it/s]
training: 445it [00:50, 10.80it/s]
training: 467it [00:53, 11.07it/s]
training: 489it [00:54, 11.23it/s]
training: 511it [00:57, 11.09it/s]
training: 529it [00:58,  8.65it/s]
training: 546it [01:00,  8.51it/s]
training: 564it [01:03,  8.46it/s]
training: 579it [01:05,  8.48it/s]
training: 596it [01:07,  8.46it/s]
training: 604it [01:08,  8.87it/s]
training: 604it [01:08,  8.87it/s]
EPOCH[107]:loss 7.949
[TEST]
{'precision': array([0.02772989, 0.02291035]), 'recall': array([0.06186375, 0.10094294]), 'recall_pop': {0: array([0.00200732, 0.00490121]), 1: array([0.00294886, 0.00728918]), 2: array([0.00403618, 0.00793836]), 3: array([0.00519831, 0.01095166]), 4: array([0.00803805, 0.01740252]), 5: array([0.01364727, 0.02630615]), 6: array([0.02034832, 0.03845942]), 7: array([0.0347158 , 0.05990286]), 8: array([0.0598402 , 0.09610821]), 9: array([0.08591157, 0.12838296])}, 'recall_pop_Contribute': {0: array([0.00037098, 0.00090642]), 1: array([0.00045703, 0.00115411]), 2: array([0.00059769, 0.00119191]), 3: array([0.00079502, 0.00167848]), 4: array([0.00120276, 0.00264208]), 5: array([0.00228085, 0.004364  ]), 6: array([0.0035436 , 0.00655189]), 7: array([0.00656028, 0.01124419]), 8: array([0.01302248, 0.02094756]), 9: array([0.03303305, 0.05026229])}, 'ndcg': array([0.05155288, 0.066342  ])}
total time cost of epoch 107:  77.7251307964325
training: 11it [00:01,  8.95it/s]]
training: 28it [00:03,  8.55it/s]]
training: 45it [00:05,  8.45it/s]]
training: 62it [00:07,  8.43it/s]]
training: 79it [00:09,  8.45it/s]]
training: 96it [00:11,  8.48it/s]]
training: 112it [00:13,  8.29it/s]
training: 129it [00:15,  8.50it/s]
training: 146it [00:17,  8.53it/s]
training: 163it [00:19,  8.55it/s]
training: 180it [00:21,  8.53it/s]
training: 197it [00:23,  8.47it/s]
training: 214it [00:25,  8.48it/s]
training: 231it [00:27,  8.50it/s]
training: 248it [00:29,  8.46it/s]
training: 265it [00:31,  8.46it/s]
training: 283it [00:33,  8.51it/s]
training: 300it [00:35,  8.53it/s]
training: 317it [00:37,  8.54it/s]
training: 334it [00:39,  8.48it/s]
training: 351it [00:41,  8.42it/s]
training: 368it [00:43,  8.45it/s]
training: 385it [00:45,  8.55it/s]
training: 402it [00:47,  8.44it/s]
training: 419it [00:49,  9.63it/s]
training: 439it [00:51, 10.32it/s]
training: 461it [00:53, 11.06it/s]
training: 483it [00:55, 10.86it/s]
training: 503it [00:57, 11.27it/s]
training: 525it [00:59, 10.24it/s]
training: 547it [01:01, 11.41it/s]
training: 566it [01:03,  8.58it/s]
training: 583it [01:05,  8.49it/s]
training: 600it [01:07,  8.61it/s]
training: 600it [01:07,  8.61it/s]
EPOCH[108]:loss 7.945
training: 604it [01:07,  8.88it/s]
training: 0it [00:00, ?it/s]8it/s]
training: 0it [00:00, ?it/s]8it/s]
{'precision': array([0.02777409, 0.02288983]), 'recall': array([0.06208584, 0.10094023]), 'recall_pop': {0: array([0.0022113 , 0.00496113]), 1: array([0.00293202, 0.00718418]), 2: array([0.00401513, 0.0077071 ]), 3: array([0.00507253, 0.01070667]), 4: array([0.00843247, 0.01715644]), 5: array([0.01389247, 0.02629969]), 6: array([0.02047678, 0.03851785]), 7: array([0.03473008, 0.06034335]), 8: array([0.05967067, 0.0951649 ]), 9: array([0.0859074 , 0.12886902])}, 'recall_pop_Contribute': {0: array([0.0004109 , 0.00092884]), 1: array([0.00046004, 0.00113309]), 2: array([0.00061352, 0.00113452]), 3: array([0.00076628, 0.00164399]), 4: array([0.00126728, 0.00260562]), 5: array([0.00235051, 0.00439562]), 6: array([0.00354455, 0.00657954]), 7: array([0.00656034, 0.01132038]), 8: array([0.01301642, 0.02075612]), 9: array([0.033096 , 0.0504425])}, 'ndcg': array([0.05159259, 0.0663052 ])}
total time cost of epoch 108:  77.35511541366577
training: 17it [00:02,  8.49it/s]]
training: 34it [00:04,  8.51it/s]]
training: 51it [00:06,  8.54it/s]]
training: 69it [00:08,  8.35it/s]]
training: 86it [00:10,  8.58it/s]]
training: 103it [00:12,  8.61it/s]
training: 120it [00:14,  8.55it/s]
training: 137it [00:16,  8.50it/s]
training: 154it [00:18,  8.56it/s]
training: 170it [00:20,  8.27it/s]
training: 187it [00:22,  8.54it/s]
training: 204it [00:24,  8.55it/s]
training: 221it [00:26,  8.52it/s]
training: 238it [00:28,  8.52it/s]
training: 255it [00:30,  8.54it/s]
training: 272it [00:32,  8.52it/s]
training: 290it [00:34,  8.54it/s]
training: 307it [00:36,  8.52it/s]
training: 322it [00:38,  7.57it/s]
training: 339it [00:40,  8.52it/s]
training: 356it [00:42,  8.54it/s]
training: 373it [00:44,  8.53it/s]
training: 390it [00:46,  8.52it/s]
training: 407it [00:48,  8.53it/s]
training: 424it [00:50,  8.51it/s]
training: 441it [00:52,  8.53it/s]
training: 460it [00:54, 10.24it/s]
training: 480it [00:56, 10.38it/s]
training: 502it [00:58, 10.88it/s]
training: 522it [01:00,  9.31it/s]
training: 542it [01:02,  9.93it/s]
training: 564it [01:04, 11.26it/s]
training: 584it [01:06, 11.10it/s]
training: 604it [01:08,  8.88it/s]
training: 604it [01:08,  8.88it/s]
EPOCH[109]:loss 7.947
training: 4it [00:00,  8.00it/s]s]
training: 4it [00:00,  8.00it/s]s]
{'precision': array([0.02788619, 0.02289851]), 'recall': array([0.06242075, 0.10116383]), 'recall_pop': {0: array([0.00231889, 0.0048117 ]), 1: array([0.00300149, 0.00737207]), 2: array([0.00387303, 0.00784604]), 3: array([0.00515854, 0.0109606 ]), 4: array([0.0085151 , 0.01681435]), 5: array([0.01398375, 0.02683342]), 6: array([0.02126744, 0.03849244]), 7: array([0.03516095, 0.05983726]), 8: array([0.06037752, 0.09580232]), 9: array([0.08567594, 0.1286084 ])}, 'recall_pop_Contribute': {0: array([0.00040446, 0.00090714]), 1: array([0.00045439, 0.00116637]), 2: array([0.00057953, 0.0011761 ]), 3: array([0.00080179, 0.00167411]), 4: array([0.00127532, 0.00258555]), 5: array([0.00234647, 0.00448974]), 6: array([0.00367146, 0.00660577]), 7: array([0.00666815, 0.01123707]), 8: array([0.01316038, 0.02091833]), 9: array([0.0330588 , 0.05040364])}, 'ndcg': array([0.05166357, 0.06629475])}
[5mfind a better recall[25m 0.06242074534153373 ++0.00018399778508322584
total time cost of epoch 109:  77.6213595867157
training: 21it [00:02,  8.55it/s]]
training: 38it [00:04,  8.58it/s]]
training: 55it [00:06,  8.56it/s]]
training: 72it [00:08,  8.48it/s]]
training: 89it [00:10,  8.43it/s]]
training: 106it [00:12,  8.42it/s]
training: 123it [00:14,  8.49it/s]
training: 140it [00:16,  8.33it/s]
training: 156it [00:18,  8.45it/s]
training: 173it [00:20,  8.48it/s]
training: 190it [00:22,  8.51it/s]
training: 208it [00:24,  8.46it/s]
training: 224it [00:26,  8.53it/s]
training: 241it [00:28,  8.38it/s]
training: 258it [00:30,  8.43it/s]
training: 275it [00:32,  8.34it/s]
training: 292it [00:34,  8.50it/s]
training: 309it [00:36,  8.52it/s]
training: 326it [00:38,  8.32it/s]
training: 343it [00:40,  8.42it/s]
training: 360it [00:42,  8.48it/s]
training: 377it [00:44,  8.51it/s]
training: 394it [00:46,  8.43it/s]
training: 410it [00:48,  8.02it/s]
training: 426it [00:50,  8.26it/s]
training: 441it [00:52,  8.60it/s]
training: 458it [00:54,  8.49it/s]
training: 475it [00:56,  8.55it/s]
training: 492it [00:58,  8.45it/s]
training: 510it [01:00,  9.21it/s]
training: 531it [01:02, 10.92it/s]
training: 553it [01:04, 10.38it/s]
training: 574it [01:06,  9.47it/s]
training: 593it [01:08, 10.01it/s]
training: 604it [01:09,  8.65it/s]
training: 604it [01:09,  8.65it/s]
EPOCH[110]:loss 7.944
[TEST]
{'precision': array([0.02777567, 0.02294509]), 'recall': array([0.06212538, 0.10115496]), 'recall_pop': {0: array([0.0020613 , 0.00494073]), 1: array([0.0030557, 0.0070433]), 2: array([0.00371248, 0.00800102]), 3: array([0.00514832, 0.01095899]), 4: array([0.00832639, 0.0170481 ]), 5: array([0.01346684, 0.02643142]), 6: array([0.02075269, 0.03832536]), 7: array([0.0351915 , 0.05956222]), 8: array([0.06005947, 0.09614584]), 9: array([0.08588251, 0.12896317])}, 'recall_pop_Contribute': {0: array([0.00038126, 0.00092892]), 1: array([0.00048191, 0.0011391 ]), 2: array([0.00055435, 0.00116346]), 3: array([0.00077586, 0.00168413]), 4: array([0.00125971, 0.00263824]), 5: array([0.00227456, 0.00437898]), 6: array([0.00359736, 0.00657692]), 7: array([0.00668462, 0.0111732 ]), 8: array([0.01306668, 0.02098659]), 9: array([0.03304907, 0.05048542])}, 'ndcg': array([0.05158841, 0.06636738])}
total time cost of epoch 110:  79.27247452735901
training: 12it [00:01,  8.43it/s]]
training: 29it [00:03,  8.49it/s]]
training: 46it [00:05,  8.53it/s]]
training: 63it [00:07,  8.53it/s]]
training: 80it [00:09,  8.55it/s]]
training: 97it [00:11,  8.54it/s]]
training: 114it [00:13,  8.52it/s]
training: 131it [00:15,  8.53it/s]
training: 148it [00:17,  8.52it/s]
training: 165it [00:19,  8.53it/s]
training: 182it [00:21,  8.55it/s]
training: 199it [00:23,  8.54it/s]
training: 217it [00:25,  8.50it/s]
training: 234it [00:27,  8.52it/s]
training: 251it [00:29,  8.54it/s]
training: 268it [00:31,  8.53it/s]
training: 285it [00:33,  8.54it/s]
training: 302it [00:35,  8.54it/s]
training: 319it [00:37,  8.86it/s]
training: 336it [00:39,  8.46it/s]
training: 353it [00:41,  8.49it/s]
training: 370it [00:43,  8.55it/s]
training: 387it [00:45,  8.52it/s]
training: 403it [00:47,  7.51it/s]
training: 419it [00:49,  8.30it/s]
training: 436it [00:51,  8.43it/s]
training: 453it [00:53,  8.55it/s]
training: 470it [00:55,  8.53it/s]
training: 487it [00:57,  8.47it/s]
training: 504it [00:59,  8.53it/s]
training: 521it [01:01,  8.53it/s]
training: 538it [01:03,  8.51it/s]
training: 555it [01:05,  8.51it/s]
training: 575it [01:07, 10.42it/s]
training: 595it [01:09, 10.58it/s]
training: 595it [01:09, 10.58it/s]
EPOCH[111]:loss 7.947
training: 604it [01:10,  8.59it/s]
training: 3it [00:00,  6.51it/s]s]
training: 3it [00:00,  6.51it/s]s]
{'precision': array([0.02784041, 0.02286614]), 'recall': array([0.06235201, 0.10073521]), 'recall_pop': {0: array([0.00202183, 0.00489117]), 1: array([0.00311991, 0.00720103]), 2: array([0.00378883, 0.00824763]), 3: array([0.00522989, 0.01097557]), 4: array([0.0084451, 0.0167015]), 5: array([0.01376218, 0.02636725]), 6: array([0.02102359, 0.03821686]), 7: array([0.03538378, 0.05943232]), 8: array([0.06006157, 0.09547897]), 9: array([0.08580582, 0.12858787])}, 'recall_pop_Contribute': {0: array([0.00039287, 0.00090496]), 1: array([0.00048504, 0.00115814]), 2: array([0.00056996, 0.00118849]), 3: array([0.00080295, 0.00169988]), 4: array([0.0012531 , 0.00259715]), 5: array([0.0023297 , 0.00438875]), 6: array([0.00364301, 0.00651004]), 7: array([0.00667297, 0.01114844]), 8: array([0.01307695, 0.02087115]), 9: array([0.03312545, 0.0502682 ])}, 'ndcg': array([0.05163563, 0.06615688])}
total time cost of epoch 111:  85.06891179084778
training: 18it [00:02,  7.81it/s]]
training: 35it [00:04,  8.49it/s]]
training: 53it [00:06,  8.51it/s]]
training: 69it [00:08,  8.49it/s]]
training: 87it [00:10,  8.49it/s]]
training: 104it [00:12,  8.47it/s]
training: 121it [00:14,  8.47it/s]
training: 138it [00:16,  8.47it/s]
training: 155it [00:18,  8.46it/s]
training: 172it [00:20,  8.57it/s]
training: 189it [00:22,  8.54it/s]
training: 206it [00:24,  8.34it/s]
training: 223it [00:26,  9.17it/s]
training: 240it [00:28,  8.47it/s]
training: 257it [00:30,  8.46it/s]
training: 274it [00:32,  8.43it/s]
training: 289it [00:34,  7.43it/s]
training: 306it [00:36,  8.54it/s]
training: 322it [00:38,  8.50it/s]
training: 340it [00:40,  8.51it/s]
training: 356it [00:42,  8.06it/s]
training: 373it [00:44,  8.57it/s]
training: 390it [00:46,  8.49it/s]
training: 407it [00:48,  8.49it/s]
training: 424it [00:50,  8.50it/s]
training: 441it [00:52,  8.49it/s]
training: 458it [00:54,  8.43it/s]
training: 475it [00:56,  8.51it/s]
training: 492it [00:58,  8.51it/s]
training: 509it [01:00,  8.48it/s]
training: 526it [01:02,  8.44it/s]
training: 544it [01:04,  8.88it/s]
training: 560it [01:06,  8.35it/s]
training: 576it [01:08,  8.86it/s]
training: 599it [01:10, 10.99it/s]
training: 599it [01:10, 10.99it/s]
EPOCH[112]:loss 7.944
training: 604it [01:11,  8.50it/s]
training: 604it [01:11,  8.50it/s]
{'precision': array([0.02772515, 0.02298061]), 'recall': array([0.06205028, 0.10120233]), 'recall_pop': {0: array([0.00198394, 0.00501379]), 1: array([0.00305307, 0.00730892]), 2: array([0.00376777, 0.00823135]), 3: array([0.0049378 , 0.01106165]), 4: array([0.00818654, 0.01658857]), 5: array([0.01388868, 0.02687951]), 6: array([0.02029858, 0.03807889]), 7: array([0.03483555, 0.05982651]), 8: array([0.05977809, 0.09581632]), 9: array([0.08624627, 0.12887047])}, 'recall_pop_Contribute': {0: array([0.00038959, 0.00095223]), 1: array([0.00048208, 0.00114995]), 2: array([0.00056592, 0.00120622]), 3: array([0.00076242, 0.0016887 ]), 4: array([0.00121317, 0.00256484]), 5: array([0.00233371, 0.00447123]), 6: array([0.00353134, 0.00654795]), 7: array([0.00656375, 0.01123995]), 8: array([0.0130333 , 0.02090253]), 9: array([0.033175  , 0.05047873])}, 'ndcg': array([0.05160039, 0.06643856])}
total time cost of epoch 112:  84.75722575187683
training: 15it [00:01,  8.33it/s]]
training: 32it [00:03,  8.52it/s]]
training: 49it [00:05,  8.38it/s]]
training: 66it [00:07,  8.34it/s]]
training: 83it [00:09,  8.49it/s]]
training: 100it [00:11,  8.50it/s]
training: 115it [00:13,  8.40it/s]
training: 134it [00:15,  8.48it/s]
training: 149it [00:17,  8.43it/s]
training: 166it [00:19,  8.63it/s]
training: 183it [00:21,  8.36it/s]
training: 200it [00:23,  8.51it/s]
training: 217it [00:25,  8.58it/s]
training: 234it [00:27,  8.41it/s]
training: 251it [00:29,  8.41it/s]
training: 268it [00:31,  8.49it/s]
training: 285it [00:33,  8.53it/s]
training: 302it [00:35,  8.83it/s]
training: 319it [00:37,  8.62it/s]
training: 336it [00:39,  8.53it/s]
training: 353it [00:41,  8.53it/s]
training: 370it [00:43,  8.52it/s]
training: 387it [00:45,  8.52it/s]
training: 404it [00:47,  8.46it/s]
training: 421it [00:49,  8.50it/s]
training: 438it [00:51,  8.52it/s]
training: 455it [00:53,  8.54it/s]
training: 472it [00:55,  8.50it/s]
training: 489it [00:57,  8.47it/s]
training: 506it [00:59,  8.50it/s]
training: 523it [01:02,  8.37it/s]
training: 540it [01:04,  8.52it/s]
training: 557it [01:06,  8.44it/s]
training: 574it [01:08,  8.58it/s]
training: 591it [01:10,  8.59it/s]
training: 604it [01:11,  8.46it/s]
training: 604it [01:11,  8.46it/s]
EPOCH[113]:loss 7.945
[TEST]
{'precision': array([0.02759884, 0.02294114]), 'recall': array([0.06173743, 0.10114069]), 'recall_pop': {0: array([0.00219709, 0.00490847]), 1: array([0.00312412, 0.0070413 ]), 2: array([0.00364146, 0.00826131]), 3: array([0.00500276, 0.01090132]), 4: array([0.00833157, 0.01669506]), 5: array([0.01342314, 0.02703589]), 6: array([0.0203787 , 0.03735656]), 7: array([0.03468591, 0.05957038]), 8: array([0.05923316, 0.09610958]), 9: array([0.08546877, 0.1292468 ])}, 'recall_pop_Contribute': {0: array([0.00042559, 0.00093436]), 1: array([0.00050142, 0.00114826]), 2: array([0.00053857, 0.00119179]), 3: array([0.00077019, 0.00168179]), 4: array([0.0012507 , 0.00258142]), 5: array([0.00226402, 0.0045262 ]), 6: array([0.00356004, 0.0063995 ]), 7: array([0.00653196, 0.01123859]), 8: array([0.01293976, 0.02096272]), 9: array([0.03295519, 0.05047606])}, 'ndcg': array([0.05147501, 0.06640634])}
total time cost of epoch 113:  86.6561028957367
training: 11it [00:01,  8.47it/s]]
training: 28it [00:03,  8.51it/s]]
training: 45it [00:05,  8.54it/s]]
training: 62it [00:07,  8.52it/s]]
training: 79it [00:09,  8.55it/s]]
training: 97it [00:11,  8.62it/s]]
training: 114it [00:13,  8.57it/s]
training: 131it [00:15,  8.51it/s]
training: 147it [00:17,  7.94it/s]
training: 164it [00:19,  8.65it/s]
training: 179it [00:21,  6.49it/s]
training: 195it [00:23,  8.52it/s]
training: 213it [00:25,  8.49it/s]
training: 230it [00:27,  8.47it/s]
training: 247it [00:29,  8.54it/s]
training: 264it [00:31,  8.42it/s]
training: 281it [00:33,  8.51it/s]
training: 298it [00:35,  8.46it/s]
training: 315it [00:37,  8.47it/s]
training: 332it [00:39,  8.37it/s]
training: 349it [00:41,  8.38it/s]
training: 366it [00:43,  8.45it/s]
training: 383it [00:45,  8.48it/s]
training: 400it [00:47,  8.41it/s]
training: 417it [00:49,  8.37it/s]
training: 434it [00:51,  8.49it/s]
training: 451it [00:53,  8.37it/s]
training: 467it [00:55,  8.50it/s]
training: 484it [00:57,  8.54it/s]
training: 501it [00:59,  8.49it/s]
training: 518it [01:01,  8.49it/s]
training: 535it [01:03,  8.52it/s]
training: 552it [01:05,  8.42it/s]
training: 569it [01:07,  8.43it/s]
training: 586it [01:09,  8.44it/s]
training: 604it [01:11,  8.47it/s]
training: 604it [01:11,  8.47it/s]
EPOCH[114]:loss 7.942
[TEST]
training: 12it [00:01,  8.48it/s]]
training: 12it [00:01,  8.48it/s]]
total time cost of epoch 114:  85.92459750175476
training: 29it [00:03,  8.46it/s]]
training: 47it [00:05,  9.06it/s]]
training: 64it [00:07,  8.37it/s]]
training: 81it [00:09,  8.52it/s]]
training: 98it [00:11,  8.54it/s]]
training: 115it [00:13,  8.46it/s]
training: 132it [00:15,  8.51it/s]
training: 149it [00:17,  8.43it/s]
training: 166it [00:19,  8.48it/s]
training: 183it [00:21,  8.47it/s]
training: 197it [00:23,  8.41it/s]
training: 215it [00:25,  8.51it/s]
training: 232it [00:27,  8.43it/s]
training: 249it [00:29,  8.42it/s]
training: 266it [00:31,  8.45it/s]
training: 283it [00:33,  8.44it/s]
training: 300it [00:35,  8.66it/s]
training: 317it [00:37,  8.42it/s]
training: 334it [00:39,  8.49it/s]
training: 351it [00:41,  8.51it/s]
training: 368it [00:43,  8.49it/s]
training: 384it [00:45,  8.49it/s]
training: 401it [00:47,  8.41it/s]
training: 418it [00:49,  8.38it/s]
training: 435it [00:51,  8.44it/s]
training: 452it [00:53,  8.53it/s]
training: 469it [00:55,  8.46it/s]
training: 486it [00:57,  8.57it/s]
training: 502it [00:59,  7.56it/s]
training: 519it [01:01,  8.46it/s]
training: 536it [01:03,  8.45it/s]
training: 552it [01:05,  8.54it/s]
training: 569it [01:07,  8.50it/s]
training: 587it [01:09,  8.97it/s]
training: 604it [01:11,  8.46it/s]
training: 604it [01:11,  8.46it/s]
EPOCH[115]:loss 7.940
training: 11it [00:01,  8.51it/s]]
training: 11it [00:01,  8.51it/s]]
{'precision': array([0.02772041, 0.0229593 ]), 'recall': array([0.06200762, 0.10119777]), 'recall_pop': {0: array([0.00217867, 0.00496426]), 1: array([0.00299649, 0.00660316]), 2: array([0.00396934, 0.00831367]), 3: array([0.00519831, 0.01068505]), 4: array([0.00858893, 0.01685935]), 5: array([0.01357994, 0.02670323]), 6: array([0.02112361, 0.03777185]), 7: array([0.03431578, 0.05947452]), 8: array([0.05887718, 0.09673252]), 9: array([0.08609554, 0.1291984 ])}, 'recall_pop_Contribute': {0: array([0.00039966, 0.00092194]), 1: array([0.00046093, 0.00106561]), 2: array([0.00057939, 0.00122604]), 3: array([0.0008035 , 0.00163833]), 4: array([0.0012786 , 0.00260026]), 5: array([0.00229917, 0.0044704 ]), 6: array([0.00369283, 0.0064335 ]), 7: array([0.00645114, 0.01117821]), 8: array([0.01287461, 0.02113593]), 9: array([0.03316779, 0.05052754])}, 'ndcg': array([0.05157503, 0.06642696])}
total time cost of epoch 115:  86.37126898765564
training: 28it [00:03,  8.51it/s]]
training: 45it [00:05,  8.47it/s]]
training: 62it [00:07,  8.50it/s]]
training: 79it [00:09,  8.51it/s]]
training: 96it [00:11,  8.47it/s]]
training: 113it [00:13,  8.42it/s]
training: 130it [00:15,  8.54it/s]
training: 147it [00:17,  8.43it/s]
training: 164it [00:19,  8.51it/s]
training: 181it [00:21,  8.33it/s]
training: 196it [00:23,  7.00it/s]
training: 213it [00:25,  8.40it/s]
training: 230it [00:27,  8.53it/s]
training: 247it [00:29,  8.47it/s]
training: 264it [00:31,  8.50it/s]
training: 281it [00:33,  8.55it/s]
training: 298it [00:35,  8.49it/s]
training: 315it [00:37,  8.37it/s]
training: 332it [00:39,  8.47it/s]
training: 349it [00:41,  8.56it/s]
training: 366it [00:43,  8.53it/s]
training: 383it [00:45,  8.54it/s]
training: 400it [00:47,  8.51it/s]
training: 417it [00:49,  8.52it/s]
training: 434it [00:51,  8.49it/s]
training: 451it [00:53,  8.47it/s]
training: 468it [00:55,  8.47it/s]
training: 485it [00:57,  8.48it/s]
training: 502it [00:59,  8.53it/s]
training: 519it [01:01,  8.54it/s]
training: 536it [01:03,  8.54it/s]
training: 553it [01:05,  8.48it/s]
training: 570it [01:07,  8.48it/s]
training: 587it [01:09,  9.33it/s]
training: 604it [01:11,  8.50it/s]
training: 604it [01:11,  8.50it/s]
EPOCH[116]:loss 7.943
training: 12it [00:01,  8.45it/s]]
training: 12it [00:01,  8.45it/s]]
{'precision': array([0.0277883 , 0.02297351]), 'recall': array([0.06211147, 0.10106673]), 'recall_pop': {0: array([0.00205236, 0.00487927]), 1: array([0.00307863, 0.00668256]), 2: array([0.00386145, 0.0083963 ]), 3: array([0.00511674, 0.01068137]), 4: array([0.00883182, 0.01718024]), 5: array([0.01359554, 0.02654698]), 6: array([0.02123035, 0.03755935]), 7: array([0.03428608, 0.05923962]), 8: array([0.05900178, 0.09621372]), 9: array([0.08607705, 0.12951069])}, 'recall_pop_Contribute': {0: array([0.00036962, 0.00091294]), 1: array([0.00048438, 0.00108174]), 2: array([0.0005621 , 0.00123419]), 3: array([0.00078241, 0.00165327]), 4: array([0.00133223, 0.00264974]), 5: array([0.00230132, 0.00442448]), 6: array([0.00367256, 0.00642094]), 7: array([0.00648817, 0.01111453]), 8: array([0.01292012, 0.02098982]), 9: array([0.03319856, 0.05058508])}, 'ndcg': array([0.05171753, 0.06646742])}
total time cost of epoch 116:  85.92675614356995
training: 29it [00:03,  8.53it/s]]
training: 47it [00:05,  8.49it/s]]
training: 64it [00:07,  8.50it/s]]
training: 81it [00:09,  8.55it/s]]
training: 98it [00:11,  8.53it/s]]
training: 115it [00:13,  8.52it/s]
training: 132it [00:15,  8.42it/s]
training: 149it [00:17,  8.51it/s]
training: 162it [00:19,  8.41it/s]
training: 179it [00:21,  8.71it/s]
training: 194it [00:22,  8.49it/s]
training: 211it [00:25,  8.49it/s]
training: 228it [00:27,  8.54it/s]
training: 245it [00:29,  8.50it/s]
training: 262it [00:31,  8.50it/s]
training: 279it [00:33,  8.47it/s]
training: 296it [00:35,  8.53it/s]
training: 313it [00:37,  8.50it/s]
training: 330it [00:39,  8.51it/s]
training: 346it [00:41,  8.51it/s]
training: 363it [00:43,  8.57it/s]
training: 380it [00:45,  8.52it/s]
training: 397it [00:47,  8.52it/s]
training: 414it [00:49,  8.48it/s]
training: 431it [00:51,  8.53it/s]
training: 448it [00:53,  8.42it/s]
training: 465it [00:55,  8.53it/s]
training: 482it [00:57,  8.47it/s]
training: 499it [00:59,  8.48it/s]
training: 516it [01:01,  8.39it/s]
training: 533it [01:03,  8.53it/s]
training: 550it [01:05,  8.43it/s]
training: 567it [01:07,  8.52it/s]
training: 584it [01:09,  8.81it/s]
training: 604it [01:11,  8.50it/s]
training: 604it [01:11,  8.50it/s]
EPOCH[117]:loss 7.940
[TEST]
{'precision': array([0.02772515, 0.02305008]), 'recall': array([0.06193122, 0.10136937]), 'recall_pop': {0: array([0.00207942, 0.00495488]), 1: array([0.00318306, 0.00671187]), 2: array([0.00377725, 0.00847188]), 3: array([0.00492569, 0.01067163]), 4: array([0.00867836, 0.01711186]), 5: array([0.01353852, 0.026878  ]), 6: array([0.02072081, 0.03759198]), 7: array([0.03437919, 0.05933473]), 8: array([0.05912277, 0.09652648]), 9: array([0.08598833, 0.12958957])}, 'recall_pop_Contribute': {0: array([0.00037742, 0.00093521]), 1: array([0.00051511, 0.00109122]), 2: array([0.00055218, 0.00124119]), 3: array([0.00075258, 0.00161177]), 4: array([0.00130756, 0.00264039]), 5: array([0.00228187, 0.00446885]), 6: array([0.00358325, 0.00647581]), 7: array([0.00646198, 0.01116712]), 8: array([0.01290797, 0.02109862]), 9: array([0.0331913 , 0.05063918])}, 'ndcg': array([0.05164596, 0.06660075])}
total time cost of epoch 117:  85.37336134910583
training: 15it [00:01,  8.47it/s]]
training: 32it [00:03,  8.61it/s]]
training: 49it [00:05,  8.48it/s]]
training: 66it [00:07,  8.34it/s]]
training: 83it [00:09,  8.46it/s]]
training: 100it [00:11,  8.50it/s]
training: 117it [00:13,  8.52it/s]
training: 135it [00:15,  8.55it/s]
training: 152it [00:17,  8.48it/s]
training: 169it [00:19,  8.54it/s]
training: 186it [00:21,  8.47it/s]
training: 201it [00:23,  7.32it/s]
training: 218it [00:25,  8.40it/s]
training: 234it [00:27,  8.25it/s]
training: 251it [00:29,  8.42it/s]
training: 268it [00:31,  8.53it/s]
training: 285it [00:33,  8.51it/s]
training: 302it [00:35,  8.49it/s]
training: 319it [00:37,  8.55it/s]
training: 336it [00:39,  8.48it/s]
training: 353it [00:41,  8.41it/s]
training: 370it [00:43,  8.50it/s]
training: 387it [00:45,  8.49it/s]
training: 405it [00:47,  8.54it/s]
training: 422it [00:49,  8.56it/s]
training: 439it [00:51,  8.57it/s]
training: 456it [00:53,  8.42it/s]
training: 473it [00:55,  8.48it/s]
training: 490it [00:57,  8.51it/s]
training: 507it [00:59,  8.52it/s]
training: 524it [01:01,  8.56it/s]
training: 541it [01:03,  8.48it/s]
training: 558it [01:05,  8.49it/s]
training: 575it [01:07,  8.46it/s]
training: 593it [01:09,  8.95it/s]
training: 604it [01:11,  8.50it/s]
training: 604it [01:11,  8.50it/s]
EPOCH[118]:loss 7.942
training: 6it [00:00,  8.27it/s]s]
training: 6it [00:00,  8.27it/s]s]
{'precision': array([0.02781199, 0.02306113]), 'recall': array([0.06206239, 0.10138434]), 'recall_pop': {0: array([0.00204416, 0.00490028]), 1: array([0.00313885, 0.00646505]), 2: array([0.00392461, 0.00837632]), 3: array([0.00496336, 0.01105563]), 4: array([0.00849649, 0.01729538]), 5: array([0.01346968, 0.02667957]), 6: array([0.02070711, 0.03808269]), 7: array([0.03483295, 0.05939116]), 8: array([0.05895498, 0.09696245]), 9: array([0.08620403, 0.12941598])}, 'recall_pop_Contribute': {0: array([0.00036015, 0.00091076]), 1: array([0.00049743, 0.001058  ]), 2: array([0.00057632, 0.00121198]), 3: array([0.00075459, 0.00166969]), 4: array([0.00129054, 0.00266903]), 5: array([0.00228932, 0.00444937]), 6: array([0.00358942, 0.00654578]), 7: array([0.00658456, 0.01115729]), 8: array([0.01290776, 0.02113972]), 9: array([0.03321231, 0.05057272])}, 'ndcg': array([0.05177439, 0.06666618])}
total time cost of epoch 118:  85.24193477630615
training: 22it [00:02,  8.46it/s]]
training: 39it [00:04,  8.55it/s]]
training: 56it [00:06,  8.48it/s]]
training: 73it [00:08,  8.49it/s]]
training: 90it [00:10,  8.54it/s]]
training: 107it [00:12,  8.49it/s]
training: 124it [00:14,  7.54it/s]
training: 141it [00:16,  8.35it/s]
training: 158it [00:18,  8.51it/s]
training: 175it [00:20,  8.40it/s]
training: 192it [00:22,  8.47it/s]
training: 207it [00:24,  8.35it/s]
training: 224it [00:26,  8.23it/s]
training: 241it [00:28,  8.43it/s]
training: 258it [00:30,  8.55it/s]
training: 275it [00:32,  8.42it/s]
training: 292it [00:34,  8.47it/s]
training: 309it [00:36,  8.54it/s]
training: 326it [00:38,  8.51it/s]
training: 343it [00:40,  8.54it/s]
training: 360it [00:42,  8.50it/s]
training: 377it [00:44,  8.55it/s]
training: 394it [00:46,  8.49it/s]
training: 411it [00:48,  8.44it/s]
training: 428it [00:50,  8.43it/s]
training: 445it [00:52,  8.48it/s]
training: 462it [00:54,  8.49it/s]
training: 479it [00:56,  8.48it/s]
training: 496it [00:58,  8.43it/s]
training: 513it [01:00,  8.47it/s]
training: 530it [01:02,  8.55it/s]
training: 547it [01:04,  8.49it/s]
training: 564it [01:06,  8.48it/s]
training: 583it [01:08, 10.19it/s]
training: 603it [01:10, 10.61it/s]
training: 603it [01:10, 10.61it/s]
EPOCH[119]:loss 7.942
training: 604it [01:10,  8.52it/s]
training: 5it [00:00,  7.98it/s]s]
training: 5it [00:00,  7.98it/s]s]
{'precision': array([0.02783093, 0.0230335 ]), 'recall': array([0.06204876, 0.10150157]), 'recall_pop': {0: array([0.00205785, 0.00479064]), 1: array([0.00311622, 0.00668452]), 2: array([0.00359564, 0.00838421]), 3: array([0.0050275 , 0.01074877]), 4: array([0.00843642, 0.01675225]), 5: array([0.01358819, 0.02642047]), 6: array([0.02076542, 0.03767527]), 7: array([0.03468712, 0.05998237]), 8: array([0.05949905, 0.09688077]), 9: array([0.08622134, 0.12962921])}, 'recall_pop_Contribute': {0: array([0.00037095, 0.00088904]), 1: array([0.0005054 , 0.00108533]), 2: array([0.00054714, 0.00121438]), 3: array([0.00075587, 0.00165125]), 4: array([0.00126886, 0.00259464]), 5: array([0.00227839, 0.00444167]), 6: array([0.00355766, 0.00649347]), 7: array([0.00653731, 0.0112826 ]), 8: array([0.01302135, 0.02117514]), 9: array([0.03320582, 0.05067405])}, 'ndcg': array([0.05175126, 0.06665221])}
total time cost of epoch 119:  84.18027377128601
training: 22it [00:02,  8.53it/s]]
training: 39it [00:04,  8.52it/s]]
training: 56it [00:06,  8.54it/s]]
training: 73it [00:08,  8.54it/s]]
training: 90it [00:10,  8.53it/s]]
training: 107it [00:12,  8.47it/s]
training: 124it [00:14,  8.53it/s]
training: 142it [00:16,  8.56it/s]
training: 158it [00:18,  8.51it/s]
training: 176it [00:20,  8.46it/s]
training: 193it [00:22,  8.52it/s]
training: 208it [00:24,  8.37it/s]
training: 225it [00:26,  8.51it/s]
training: 242it [00:28,  8.40it/s]
training: 259it [00:30,  8.52it/s]
training: 276it [00:32,  8.44it/s]
training: 293it [00:34,  8.57it/s]
training: 310it [00:36,  8.49it/s]
training: 327it [00:38,  8.47it/s]
training: 344it [00:40,  8.46it/s]
training: 361it [00:42,  8.51it/s]
training: 378it [00:44,  8.44it/s]
training: 395it [00:46,  8.47it/s]
training: 412it [00:48,  8.47it/s]
training: 429it [00:50,  8.36it/s]
training: 446it [00:52,  8.55it/s]
training: 463it [00:54,  8.55it/s]
training: 480it [00:56,  8.55it/s]
training: 497it [00:58,  8.48it/s]
training: 514it [01:00,  8.48it/s]
training: 531it [01:02,  8.50it/s]
training: 549it [01:04,  9.75it/s]
training: 569it [01:06, 10.57it/s]
training: 591it [01:08, 10.73it/s]
training: 604it [01:10,  8.61it/s]
training: 604it [01:10,  8.61it/s]
EPOCH[120]:loss 7.939
training: 1it [00:00,  6.46it/s]s]
training: 1it [00:00,  6.46it/s]s]
{'precision': array([0.0278562 , 0.02306034]), 'recall': array([0.06224789, 0.10147423]), 'recall_pop': {0: array([0.00204867, 0.00498112]), 1: array([0.00293097, 0.00682747]), 2: array([0.00373409, 0.00841311]), 3: array([0.00500539, 0.01093014]), 4: array([0.00847935, 0.01723463]), 5: array([0.01363911, 0.02658656]), 6: array([0.0206781, 0.0379016]), 7: array([0.03452904, 0.05972466]), 8: array([0.05984661, 0.09703272]), 9: array([0.08619021, 0.12937314])}, 'recall_pop_Contribute': {0: array([0.00037269, 0.0009173 ]), 1: array([0.00047164, 0.00111496]), 2: array([0.00055277, 0.00122568]), 3: array([0.00074935, 0.00168851]), 4: array([0.00128809, 0.00265015]), 5: array([0.00232548, 0.00446011]), 6: array([0.00354878, 0.00652846]), 7: array([0.00654991, 0.01118724]), 8: array([0.01310917, 0.02114391]), 9: array([0.03328   , 0.05055792])}, 'ndcg': array([0.05184706, 0.0667219 ])}
total time cost of epoch 120:  82.66033411026001
training: 17it [00:02,  8.44it/s]]
training: 34it [00:04,  8.51it/s]]
training: 51it [00:06,  8.57it/s]]
training: 68it [00:08,  8.52it/s]]
training: 85it [00:10,  8.53it/s]]
training: 103it [00:12,  8.69it/s]
training: 120it [00:14,  8.46it/s]
training: 137it [00:16,  8.49it/s]
training: 154it [00:18,  8.48it/s]
training: 171it [00:20,  8.45it/s]
training: 188it [00:22,  8.52it/s]
training: 203it [00:24,  8.34it/s]
training: 220it [00:26,  8.57it/s]
training: 237it [00:28,  8.50it/s]
training: 254it [00:30,  8.52it/s]
training: 271it [00:32,  8.47it/s]
training: 288it [00:34,  8.51it/s]
training: 305it [00:36,  8.48it/s]
training: 322it [00:38,  8.47it/s]
training: 339it [00:40,  8.48it/s]
training: 356it [00:42,  8.51it/s]
training: 373it [00:44,  8.48it/s]
training: 390it [00:46,  8.53it/s]
training: 407it [00:48,  8.53it/s]
training: 424it [00:50,  8.51it/s]
training: 441it [00:52,  8.44it/s]
training: 458it [00:54,  8.50it/s]
training: 475it [00:56,  8.54it/s]
training: 492it [00:58,  8.50it/s]
training: 509it [01:00,  9.10it/s]
training: 528it [01:02, 10.54it/s]
training: 550it [01:04, 10.90it/s]
training: 571it [01:06,  9.34it/s]
training: 589it [01:08,  8.93it/s]
training: 604it [01:09,  8.65it/s]
training: 604it [01:09,  8.65it/s]
EPOCH[121]:loss 7.940
[TEST]
{'precision': array([0.0280504 , 0.02307613]), 'recall': array([0.06275365, 0.10179775]), 'recall_pop': {0: array([0.00201973, 0.00492021]), 1: array([0.0029507 , 0.00679001]), 2: array([0.00387142, 0.00833728]), 3: array([0.00522756, 0.01082377]), 4: array([0.00852863, 0.0172788 ]), 5: array([0.01384111, 0.02671269]), 6: array([0.02055398, 0.03777579]), 7: array([0.03479384, 0.05992645]), 8: array([0.05977309, 0.09674992]), 9: array([0.08710163, 0.12968035])}, 'recall_pop_Contribute': {0: array([0.00036323, 0.00091683]), 1: array([0.00047507, 0.00112053]), 2: array([0.00059033, 0.00122465]), 3: array([0.00078546, 0.00166978]), 4: array([0.00128132, 0.00269065]), 5: array([0.00233955, 0.00448204]), 6: array([0.00355903, 0.00648247]), 7: array([0.00659903, 0.01126628]), 8: array([0.01314476, 0.02113137]), 9: array([0.03361588, 0.05081314])}, 'ndcg': array([0.05207191, 0.06683587])}
training: 13it [00:01,  8.43it/s]]
training: 13it [00:01,  8.43it/s]]
total time cost of epoch 121:  82.58704805374146
training: 30it [00:03,  8.50it/s]]
training: 47it [00:05,  8.55it/s]]
training: 64it [00:07,  8.50it/s]]
training: 81it [00:09,  8.50it/s]]
training: 98it [00:11,  8.54it/s]]
training: 115it [00:13,  8.46it/s]
training: 132it [00:15,  8.48it/s]
training: 149it [00:17,  8.49it/s]
training: 166it [00:19,  8.48it/s]
training: 183it [00:21,  8.50it/s]
training: 198it [00:23,  5.83it/s]
training: 215it [00:25,  8.54it/s]
training: 232it [00:27,  8.51it/s]
training: 249it [00:29,  8.49it/s]
training: 266it [00:31,  8.44it/s]
training: 283it [00:33,  8.46it/s]
training: 300it [00:35,  8.49it/s]
training: 317it [00:37,  8.44it/s]
training: 334it [00:39,  8.47it/s]
training: 351it [00:41,  8.45it/s]
training: 368it [00:43,  8.52it/s]
training: 385it [00:45,  8.50it/s]
training: 402it [00:47,  8.58it/s]
training: 419it [00:49,  8.50it/s]
training: 436it [00:51,  8.49it/s]
training: 453it [00:53,  8.55it/s]
training: 470it [00:55,  9.98it/s]
training: 494it [00:57, 11.16it/s]
training: 516it [00:59, 11.02it/s]
training: 536it [01:01, 10.30it/s]
training: 558it [01:03, 10.29it/s]
training: 577it [01:05,  8.60it/s]
training: 594it [01:07,  8.44it/s]
training: 604it [01:09,  8.75it/s]
training: 604it [01:09,  8.75it/s]
EPOCH[122]:loss 7.939
training: 1it [00:00,  5.51it/s]s]
training: 1it [00:00,  5.51it/s]s]
{'precision': array([0.0279683 , 0.02306429]), 'recall': array([0.0625514 , 0.10173209]), 'recall_pop': {0: array([0.00204416, 0.00474312]), 1: array([0.00300044, 0.00682412]), 2: array([0.00378514, 0.00832294]), 3: array([0.00503516, 0.01062457]), 4: array([0.00845649, 0.01712253]), 5: array([0.01379907, 0.02693042]), 6: array([0.02076629, 0.03814641]), 7: array([0.0350156 , 0.06004733]), 8: array([0.05976586, 0.09640717]), 9: array([0.0867327, 0.1299349])}, 'recall_pop_Contribute': {0: array([0.00037557, 0.00089253]), 1: array([0.00047031, 0.00111224]), 2: array([0.00056276, 0.00121883]), 3: array([0.0007445 , 0.00163497]), 4: array([0.00127916, 0.00264125]), 5: array([0.00233063, 0.00451518]), 6: array([0.00359597, 0.00657045]), 7: array([0.00663389, 0.01129485]), 8: array([0.01311592, 0.02102782]), 9: array([0.03344268, 0.05082397])}, 'ndcg': array([0.05199919, 0.06684264])}
total time cost of epoch 122:  81.65455222129822
training: 18it [00:02,  8.52it/s]]
training: 35it [00:04,  8.60it/s]]
training: 52it [00:06,  8.49it/s]]
training: 69it [00:08,  8.53it/s]]
training: 86it [00:10,  8.42it/s]]
training: 103it [00:12,  8.38it/s]
training: 120it [00:14,  8.41it/s]
training: 137it [00:16,  8.54it/s]
training: 154it [00:18,  8.44it/s]
training: 171it [00:20,  8.47it/s]
training: 188it [00:22,  8.48it/s]
training: 203it [00:24,  8.26it/s]
training: 220it [00:26,  8.49it/s]
training: 237it [00:28,  8.49it/s]
training: 254it [00:30,  8.47it/s]
training: 271it [00:32,  8.48it/s]
training: 288it [00:34,  8.51it/s]
training: 305it [00:36,  8.55it/s]
training: 322it [00:38,  8.54it/s]
training: 339it [00:40,  8.59it/s]
training: 356it [00:42,  8.47it/s]
training: 373it [00:44,  8.53it/s]
training: 390it [00:46,  8.49it/s]
training: 407it [00:48,  8.47it/s]
training: 425it [00:50,  8.54it/s]
training: 442it [00:52, 10.65it/s]
training: 464it [00:54, 10.75it/s]
training: 486it [00:56, 10.67it/s]
training: 508it [00:58, 11.10it/s]
training: 530it [01:00, 11.00it/s]
training: 548it [01:02,  8.58it/s]
training: 565it [01:04,  8.48it/s]
training: 582it [01:06,  8.53it/s]
training: 599it [01:08,  8.47it/s]
training: 604it [01:08,  8.76it/s]
training: 604it [01:08,  8.76it/s]
EPOCH[123]:loss 7.941
training: 5it [00:00,  8.24it/s]s]
training: 5it [00:00,  8.24it/s]s]
{'precision': array([0.02792093, 0.02311482]), 'recall': array([0.06250353, 0.10205699]), 'recall_pop': {0: array([0.00193552, 0.00480646]), 1: array([0.00307964, 0.00674616]), 2: array([0.00404408, 0.00823978]), 3: array([0.00505388, 0.0105791 ]), 4: array([0.0082718 , 0.01729895]), 5: array([0.01348513, 0.02700442]), 6: array([0.02087071, 0.03789005]), 7: array([0.03523027, 0.06003815]), 8: array([0.05909324, 0.09651928]), 9: array([0.08684451, 0.1302067 ])}, 'recall_pop_Contribute': {0: array([0.00035941, 0.00088915]), 1: array([0.00048349, 0.00110918]), 2: array([0.00059997, 0.00122429]), 3: array([0.00076207, 0.00160803]), 4: array([0.00127512, 0.00264623]), 5: array([0.00228225, 0.00452633]), 6: array([0.00357634, 0.00651404]), 7: array([0.0066691 , 0.01129164]), 8: array([0.01300745, 0.02107904]), 9: array([0.03348831, 0.05116905])}, 'ndcg': array([0.05184698, 0.06681667])}
total time cost of epoch 123:  81.51179575920105
training: 23it [00:02,  8.50it/s]]
training: 40it [00:04,  8.45it/s]]
training: 57it [00:06,  8.11it/s]]
training: 72it [00:08,  7.44it/s]]
training: 89it [00:10,  8.45it/s]]
training: 105it [00:12,  7.78it/s]
training: 122it [00:14,  8.38it/s]
training: 139it [00:16,  8.26it/s]
training: 156it [00:18,  8.48it/s]
training: 173it [00:20,  8.49it/s]
training: 190it [00:22,  8.43it/s]
training: 205it [00:24,  8.26it/s]
training: 222it [00:26,  8.22it/s]
training: 239it [00:28,  8.56it/s]
training: 255it [00:30,  8.44it/s]
training: 273it [00:32,  8.52it/s]
training: 290it [00:34,  8.52it/s]
training: 307it [00:36,  8.53it/s]
training: 324it [00:38,  8.54it/s]
training: 341it [00:40,  8.42it/s]
training: 358it [00:42,  8.54it/s]
training: 375it [00:44,  8.49it/s]
training: 392it [00:46,  8.60it/s]
training: 411it [00:48, 10.58it/s]
training: 433it [00:50, 10.54it/s]
training: 455it [00:52, 10.34it/s]
training: 475it [00:54, 10.89it/s]
training: 494it [00:56, 10.41it/s]
training: 512it [00:58,  8.50it/s]
training: 530it [01:00,  8.51it/s]
training: 547it [01:02,  8.53it/s]
training: 564it [01:04,  8.52it/s]
training: 581it [01:06,  8.53it/s]
training: 598it [01:08,  8.54it/s]
training: 604it [01:09,  8.67it/s]
training: 604it [01:09,  8.67it/s]
EPOCH[124]:loss 7.939
training: 5it [00:00,  8.24it/s]s]
training: 5it [00:00,  8.24it/s]s]
{'precision': array([0.0278262 , 0.02313771]), 'recall': array([0.06224369, 0.10218444]), 'recall_pop': {0: array([0.00209942, 0.0051798 ]), 1: array([0.00311227, 0.00665774]), 2: array([0.00402303, 0.00817136]), 3: array([0.00497862, 0.0104548 ]), 4: array([0.00822391, 0.01693555]), 5: array([0.01348665, 0.0269005 ]), 6: array([0.02062355, 0.03798156]), 7: array([0.03495393, 0.05980677]), 8: array([0.05949409, 0.09605786]), 9: array([0.08593657, 0.13077095])}, 'recall_pop_Contribute': {0: array([0.00038661, 0.00094886]), 1: array([0.0004779 , 0.00110003]), 2: array([0.00061321, 0.001213  ]), 3: array([0.00075786, 0.00160909]), 4: array([0.00124549, 0.00260762]), 5: array([0.00228023, 0.00448847]), 6: array([0.00354046, 0.0065396 ]), 7: array([0.00662624, 0.01126326]), 8: array([0.01305804, 0.0210054 ]), 9: array([0.03325765, 0.05140909])}, 'ndcg': array([0.05181548, 0.06695508])}
total time cost of epoch 124:  82.3289520740509
training: 22it [00:02,  8.49it/s]]
training: 39it [00:04,  8.55it/s]]
training: 56it [00:06,  8.54it/s]]
training: 73it [00:08,  8.55it/s]]
training: 90it [00:10,  8.53it/s]]
training: 107it [00:12,  8.54it/s]
training: 124it [00:14,  8.50it/s]
training: 141it [00:16,  8.59it/s]
training: 158it [00:18,  8.61it/s]
training: 175it [00:20,  8.52it/s]
training: 192it [00:22,  8.55it/s]
training: 208it [00:24,  8.48it/s]
training: 225it [00:26,  8.47it/s]
training: 242it [00:28,  8.47it/s]
training: 259it [00:30,  8.53it/s]
training: 276it [00:32,  8.53it/s]
training: 293it [00:34,  8.48it/s]
training: 310it [00:36,  8.53it/s]
training: 327it [00:38,  8.54it/s]
training: 344it [00:40,  8.54it/s]
training: 361it [00:42,  9.42it/s]
training: 383it [00:44, 10.68it/s]
training: 403it [00:46, 10.61it/s]
training: 422it [00:48,  8.64it/s]
training: 442it [00:50,  8.77it/s]
training: 462it [00:52,  8.84it/s]
training: 479it [00:54,  8.48it/s]
training: 496it [00:56,  8.48it/s]
training: 513it [00:58,  8.54it/s]
training: 530it [01:00,  8.51it/s]
training: 547it [01:02,  8.50it/s]
training: 564it [01:04,  8.49it/s]
training: 581it [01:06,  8.48it/s]
training: 598it [01:08,  8.52it/s]
training: 604it [01:09,  8.69it/s]
training: 604it [01:09,  8.69it/s]
EPOCH[125]:loss 7.936
training: 1it [00:00,  5.82it/s]s]
training: 1it [00:00,  5.82it/s]s]
{'precision': array([0.02789093, 0.0230335 ]), 'recall': array([0.062385  , 0.10178737]), 'recall_pop': {0: array([0.0020889 , 0.00483307]), 1: array([0.0032528 , 0.00658774]), 2: array([0.00389777, 0.00822982]), 3: array([0.00466913, 0.01066532]), 4: array([0.00855235, 0.01690517]), 5: array([0.01334649, 0.02666098]), 6: array([0.02105853, 0.03781543]), 7: array([0.03506826, 0.06005884]), 8: array([0.05922235, 0.09582069]), 9: array([0.08619442, 0.13027365])}, 'recall_pop_Contribute': {0: array([0.00037853, 0.00089513]), 1: array([0.0005083 , 0.00109745]), 2: array([0.00058975, 0.00121212]), 3: array([0.00071931, 0.00162131]), 4: array([0.00128057, 0.00259225]), 5: array([0.00227019, 0.00447843]), 6: array([0.00362469, 0.00649363]), 7: array([0.00665575, 0.01130452]), 8: array([0.01296981, 0.02099185]), 9: array([0.0333881 , 0.05110069])}, 'ndcg': array([0.05196338, 0.06686429])}
total time cost of epoch 125:  82.50442004203796
training: 18it [00:02,  8.35it/s]]
training: 35it [00:04,  8.49it/s]]
training: 52it [00:06,  8.52it/s]]
training: 69it [00:08,  8.56it/s]]
training: 86it [00:10,  8.51it/s]]
training: 103it [00:12,  8.51it/s]
training: 120it [00:14,  8.49it/s]
training: 137it [00:16,  8.88it/s]
training: 154it [00:18,  8.51it/s]
training: 171it [00:20,  8.49it/s]
training: 188it [00:22,  8.47it/s]
training: 203it [00:24,  7.95it/s]
training: 220it [00:26,  8.51it/s]
training: 237it [00:28,  8.47it/s]
training: 254it [00:30,  8.38it/s]
training: 259it [00:30,  8.49it/s]
training: 288it [00:34,  8.49it/s]
training: 305it [00:36,  8.50it/s]
training: 321it [00:38,  8.68it/s]
training: 343it [00:40, 10.90it/s]
training: 365it [00:42, 10.57it/s]
training: 385it [00:44, 10.48it/s]
training: 406it [00:46,  9.05it/s]
training: 424it [00:48,  8.70it/s]
training: 441it [00:50,  8.48it/s]
training: 458it [00:52,  8.48it/s]
training: 475it [00:54,  8.55it/s]
training: 492it [00:56,  8.44it/s]
training: 509it [00:58,  8.32it/s]
training: 526it [01:00,  8.47it/s]
training: 543it [01:02,  8.49it/s]
training: 560it [01:04,  8.52it/s]
training: 577it [01:06,  8.52it/s]
training: 594it [01:08,  8.52it/s]
training: 604it [01:09,  8.69it/s]
training: 604it [01:09,  8.69it/s]
EPOCH[126]:loss 7.936
training: 2it [00:00,  7.95it/s]s]
training: 2it [00:00,  7.95it/s]s]
{'precision': array([0.0279304 , 0.02307613]), 'recall': array([0.06235793, 0.10182459]), 'recall_pop': {0: array([0.00213732, 0.00482372]), 1: array([0.00308859, 0.00661082]), 2: array([0.00376619, 0.00830613]), 3: array([0.00508283, 0.01070663]), 4: array([0.00831233, 0.01691487]), 5: array([0.01337544, 0.0269729 ]), 6: array([0.02136353, 0.03794527]), 7: array([0.03545016, 0.05999028]), 8: array([0.05882122, 0.09622326]), 9: array([0.08647281, 0.13020417])}, 'recall_pop_Contribute': {0: array([0.00039366, 0.0008903 ]), 1: array([0.00048858, 0.00106153]), 2: array([0.00056315, 0.00121863]), 3: array([0.0007653 , 0.00162737]), 4: array([0.00124182, 0.0025861 ]), 5: array([0.00228011, 0.00453377]), 6: array([0.00367543, 0.00655304]), 7: array([0.00668775, 0.01130423]), 8: array([0.01282682, 0.02098396]), 9: array([0.03343531, 0.05106568])}, 'ndcg': array([0.05207578, 0.06698024])}
total time cost of epoch 126:  82.07408690452576
training: 19it [00:02,  8.48it/s]]
training: 36it [00:04,  8.51it/s]]
training: 53it [00:06,  8.54it/s]]
training: 70it [00:08,  8.49it/s]]
training: 87it [00:10,  8.49it/s]]
training: 104it [00:12,  8.57it/s]
training: 121it [00:14,  8.49it/s]
training: 139it [00:16,  8.44it/s]
training: 156it [00:18,  8.58it/s]
training: 172it [00:20,  8.47it/s]
training: 189it [00:22,  8.52it/s]
training: 205it [00:24,  8.42it/s]
training: 222it [00:26,  8.54it/s]
training: 239it [00:28,  8.49it/s]
training: 255it [00:30,  7.75it/s]
training: 272it [00:32,  8.42it/s]
training: 289it [00:34,  9.89it/s]
training: 308it [00:36,  9.12it/s]
training: 327it [00:38,  9.44it/s]
training: 348it [00:40, 10.91it/s]
training: 368it [00:42, 10.84it/s]
training: 387it [00:44,  8.63it/s]
training: 400it [00:45,  8.52it/s]
training: 417it [00:47,  8.46it/s]
training: 433it [00:49,  8.49it/s]
training: 450it [00:51,  8.40it/s]
training: 467it [00:53,  8.46it/s]
training: 484it [00:55,  8.43it/s]
training: 501it [00:57,  8.54it/s]
training: 518it [00:59,  8.54it/s]
training: 535it [01:01,  8.54it/s]
training: 552it [01:03,  8.58it/s]
training: 569it [01:05,  8.59it/s]
training: 586it [01:07,  8.52it/s]
training: 603it [01:09,  8.44it/s]
training: 603it [01:09,  8.44it/s]
EPOCH[127]:loss 7.937
training: 604it [01:10,  8.62it/s]
training: 604it [01:10,  8.62it/s]
training: 11it [00:01,  8.66it/s]]
training: 11it [00:01,  8.66it/s]]
total time cost of epoch 127:  82.48443174362183
training: 29it [00:03,  8.49it/s]]
training: 46it [00:05,  8.48it/s]]
training: 63it [00:07,  8.48it/s]]
training: 80it [00:09,  8.49it/s]]
training: 97it [00:11,  8.46it/s]]
training: 114it [00:13,  8.38it/s]
training: 131it [00:15,  8.48it/s]
training: 148it [00:17,  8.39it/s]
training: 165it [00:19,  8.45it/s]
training: 182it [00:21,  8.48it/s]
training: 197it [00:23,  5.47it/s]
training: 214it [00:25,  8.39it/s]
training: 231it [00:27,  8.36it/s]
training: 250it [00:29, 10.52it/s]
training: 268it [00:31, 10.75it/s]
training: 292it [00:33, 11.04it/s]
training: 313it [00:35,  9.76it/s]
training: 331it [00:37,  9.86it/s]
training: 351it [00:39,  8.64it/s]
training: 368it [00:41,  8.31it/s]
training: 385it [00:43,  8.50it/s]
training: 402it [00:45,  8.47it/s]
training: 419it [00:47,  8.45it/s]
training: 436it [00:49,  8.43it/s]
training: 454it [00:51,  8.48it/s]
training: 471it [00:53,  8.52it/s]
training: 488it [00:55,  8.49it/s]
training: 505it [00:57,  8.43it/s]
training: 522it [00:59,  8.49it/s]
training: 537it [01:01,  8.53it/s]
training: 556it [01:03,  8.51it/s]
training: 573it [01:05,  8.53it/s]
training: 590it [01:07,  8.52it/s]
training: 604it [01:09,  8.72it/s]
training: 604it [01:09,  8.72it/s]
EPOCH[128]:loss 7.935
[TEST]
{'precision': array([0.02789409, 0.02305956]), 'recall': array([0.06239938, 0.10162465]), 'recall_pop': {0: array([0.00195657, 0.0047317 ]), 1: array([0.00316727, 0.00674436]), 2: array([0.00375988, 0.00818245]), 3: array([0.00515595, 0.01077715]), 4: array([0.00824496, 0.01723503]), 5: array([0.01331457, 0.02689354]), 6: array([0.02082256, 0.03786571]), 7: array([0.03467603, 0.0604149 ]), 8: array([0.05875353, 0.09583243]), 9: array([0.08703732, 0.130522  ])}, 'recall_pop_Contribute': {0: array([0.00035395, 0.00088313]), 1: array([0.0005043 , 0.00109774]), 2: array([0.00056947, 0.00121178]), 3: array([0.00078491, 0.00163256]), 4: array([0.00123419, 0.00266339]), 5: array([0.00227834, 0.00451909]), 6: array([0.00362338, 0.00648484]), 7: array([0.00653985, 0.01129968]), 8: array([0.01288025, 0.02086591]), 9: array([0.03363074, 0.05096653])}, 'ndcg': array([0.05211829, 0.0669738 ])}
total time cost of epoch 128:  81.65868711471558
training: 16it [00:01,  8.52it/s]]
training: 33it [00:03,  8.49it/s]]
training: 49it [00:05,  8.06it/s]]
training: 66it [00:07,  8.48it/s]]
training: 83it [00:09,  8.49it/s]]
training: 100it [00:11,  8.49it/s]
training: 117it [00:13,  8.53it/s]
training: 134it [00:15,  8.43it/s]
training: 151it [00:17,  8.46it/s]
training: 168it [00:19,  8.55it/s]
training: 185it [00:21,  8.56it/s]
training: 199it [00:23,  7.39it/s]
training: 220it [00:25, 10.41it/s]
training: 240it [00:27, 10.50it/s]
training: 262it [00:29, 10.10it/s]
training: 280it [00:31, 10.75it/s]
training: 302it [00:33, 11.02it/s]
training: 320it [00:35,  8.50it/s]
training: 337it [00:37,  8.51it/s]
training: 354it [00:39,  8.45it/s]
training: 371it [00:41,  8.51it/s]
training: 388it [00:43,  8.40it/s]
training: 405it [00:45,  8.51it/s]
training: 422it [00:47,  8.56it/s]
training: 439it [00:49,  8.51it/s]
training: 456it [00:52,  8.49it/s]
training: 473it [00:54,  8.52it/s]
training: 490it [00:56,  8.54it/s]
training: 507it [00:58,  8.53it/s]
training: 524it [01:00,  8.47it/s]
training: 541it [01:02,  8.40it/s]
training: 558it [01:04,  8.58it/s]
training: 575it [01:06,  8.55it/s]
training: 592it [01:08,  8.54it/s]
training: 604it [01:09,  8.69it/s]
training: 604it [01:09,  8.69it/s]
EPOCH[129]:loss 7.935
[TEST]
training: 11it [00:01,  8.44it/s]]
training: 11it [00:01,  8.44it/s]]
total time cost of epoch 129:  82.61692428588867
training: 28it [00:03,  8.56it/s]]
training: 45it [00:05,  8.49it/s]]
training: 62it [00:07,  8.26it/s]]
training: 79it [00:09,  8.55it/s]]
training: 96it [00:11,  8.48it/s]]
training: 113it [00:13,  8.56it/s]
training: 130it [00:15,  8.47it/s]
training: 147it [00:17,  8.49it/s]
training: 164it [00:19,  8.62it/s]
training: 184it [00:21, 10.45it/s]
training: 204it [00:23,  9.30it/s]
training: 226it [00:25,  9.84it/s]
training: 245it [00:27, 10.55it/s]
training: 265it [00:29,  8.69it/s]
training: 282it [00:31,  8.52it/s]
training: 297it [00:33,  5.64it/s]
training: 314it [00:35,  8.46it/s]
training: 331it [00:37,  8.54it/s]
training: 348it [00:39,  8.50it/s]
training: 365it [00:41,  8.45it/s]
training: 382it [00:43,  8.55it/s]
training: 399it [00:45,  8.52it/s]
training: 417it [00:47,  8.52it/s]
training: 433it [00:49,  8.16it/s]
training: 450it [00:51,  8.47it/s]
training: 468it [00:53,  8.46it/s]
training: 484it [00:55,  8.42it/s]
training: 502it [00:57,  8.53it/s]
training: 519it [00:59,  8.41it/s]
training: 535it [01:01,  8.49it/s]
training: 552it [01:03,  8.40it/s]
training: 569it [01:05,  8.56it/s]
training: 586it [01:07,  8.46it/s]
training: 603it [01:09,  8.40it/s]
training: 603it [01:09,  8.40it/s]
EPOCH[130]:loss 7.936
training: 604it [01:09,  8.67it/s]
training: 8it [00:01,  8.36it/s]s]
training: 8it [00:01,  8.36it/s]s]
{'precision': array([0.02783251, 0.02316771]), 'recall': array([0.06232851, 0.10213493]), 'recall_pop': {0: array([0.0021531 , 0.00488026]), 1: array([0.00296465, 0.00677836]), 2: array([0.00357199, 0.0085098 ]), 3: array([0.00533577, 0.01087057]), 4: array([0.00786205, 0.01709592]), 5: array([0.01315902, 0.02653838]), 6: array([0.02039077, 0.03831286]), 7: array([0.03502617, 0.0603069 ]), 8: array([0.05879399, 0.0959945 ]), 9: array([0.08711514, 0.13120209])}, 'recall_pop_Contribute': {0: array([0.0003903 , 0.00089546]), 1: array([0.00047368, 0.00110122]), 2: array([0.000544  , 0.00126932]), 3: array([0.00083744, 0.00163953]), 4: array([0.00119939, 0.00261637]), 5: array([0.00223981, 0.00451163]), 6: array([0.00355061, 0.00654482]), 7: array([0.00663116, 0.01127179]), 8: array([0.0128527 , 0.02094798]), 9: array([0.03360942, 0.05133682])}, 'ndcg': array([0.05207251, 0.06718924])}
total time cost of epoch 130:  82.54709839820862
training: 25it [00:03,  8.50it/s]]
training: 42it [00:05,  8.50it/s]]
training: 59it [00:07,  8.53it/s]]
training: 76it [00:09,  8.51it/s]]
training: 93it [00:11,  8.49it/s]]
training: 110it [00:13,  8.46it/s]
training: 128it [00:15, 10.07it/s]
training: 146it [00:16,  8.87it/s]
training: 164it [00:18,  9.78it/s]
training: 185it [00:21,  9.77it/s]
training: 206it [00:23, 10.34it/s]
training: 225it [00:25,  8.64it/s]
training: 241it [00:26,  8.54it/s]
training: 258it [00:28,  8.54it/s]
training: 275it [00:30,  8.53it/s]
training: 293it [00:33,  8.46it/s]
training: 310it [00:35,  8.51it/s]
training: 327it [00:37,  8.52it/s]
training: 344it [00:39,  8.51it/s]
training: 361it [00:41,  8.51it/s]
training: 378it [00:43,  8.50it/s]
training: 393it [00:45,  8.37it/s]
training: 410it [00:47,  8.78it/s]
training: 427it [00:49,  8.53it/s]
training: 444it [00:51,  8.53it/s]
training: 461it [00:53,  8.31it/s]
training: 478it [00:55,  8.42it/s]
training: 495it [00:57,  8.54it/s]
training: 512it [00:59,  8.54it/s]
training: 529it [01:01,  8.47it/s]
training: 546it [01:03,  8.55it/s]
training: 563it [01:05,  8.49it/s]
training: 581it [01:07,  8.58it/s]
training: 598it [01:09,  8.41it/s]
training: 604it [01:09,  8.64it/s]
training: 604it [01:09,  8.64it/s]
EPOCH[131]:loss 7.935
training: 6it [00:00,  9.80it/s]s]
training: 6it [00:00,  9.80it/s]s]
{'precision': array([0.02795251, 0.02311797]), 'recall': array([0.06260175, 0.10200717]), 'recall_pop': {0: array([0.00210017, 0.00463593]), 1: array([0.00299228, 0.00655995]), 2: array([0.00355884, 0.00811508]), 3: array([0.0052602, 0.0108182]), 4: array([0.00798103, 0.01685946]), 5: array([0.01344117, 0.02626241]), 6: array([0.02049075, 0.03806935]), 7: array([0.03499005, 0.06029618]), 8: array([0.05918244, 0.09632969]), 9: array([0.08773501, 0.13102013])}, 'recall_pop_Contribute': {0: array([0.00038025, 0.00087097]), 1: array([0.00047675, 0.00106076]), 2: array([0.00053807, 0.00120985]), 3: array([0.00081602, 0.00164176]), 4: array([0.00120578, 0.0025693 ]), 5: array([0.0022778 , 0.00443564]), 6: array([0.00359004, 0.00653875]), 7: array([0.0065908 , 0.01126222]), 8: array([0.01293756, 0.0210155 ]), 9: array([0.03378867, 0.05140242])}, 'ndcg': array([0.05218146, 0.06708847])}
total time cost of epoch 131:  82.48360896110535
training: 23it [00:02,  8.52it/s]]
training: 40it [00:04,  8.54it/s]]
training: 57it [00:06,  8.49it/s]]
training: 74it [00:08,  8.53it/s]]
training: 94it [00:10, 10.96it/s]]
training: 116it [00:12, 10.50it/s]
training: 138it [00:14, 10.75it/s]
training: 159it [00:16, 11.16it/s]
training: 177it [00:18, 10.98it/s]
training: 195it [00:20,  8.55it/s]
training: 212it [00:22,  8.51it/s]
training: 229it [00:24,  8.37it/s]
training: 246it [00:26,  8.57it/s]
training: 263it [00:28,  8.48it/s]
training: 280it [00:30,  8.56it/s]
training: 298it [00:32,  8.48it/s]
training: 314it [00:34,  8.44it/s]
training: 331it [00:36,  8.38it/s]
training: 348it [00:38,  8.44it/s]
training: 365it [00:40,  8.49it/s]
training: 381it [00:42,  7.37it/s]
training: 398it [00:44,  8.53it/s]
training: 415it [00:46,  8.45it/s]
training: 432it [00:48,  8.52it/s]
training: 449it [00:50,  8.48it/s]
training: 467it [00:52,  8.49it/s]
training: 483it [00:54,  8.42it/s]
training: 500it [00:56,  8.49it/s]
training: 517it [00:58,  8.49it/s]
training: 535it [01:00,  8.53it/s]
training: 552it [01:02,  8.43it/s]
training: 567it [01:04,  8.49it/s]
training: 584it [01:06,  8.52it/s]
training: 601it [01:08,  9.03it/s]
training: 604it [01:09,  8.73it/s]
training: 604it [01:09,  8.73it/s]
EPOCH[132]:loss 7.937
training: 8it [00:00,  8.36it/s]s]
training: 8it [00:00,  8.36it/s]s]
{'precision': array([0.02788777, 0.02318902]), 'recall': array([0.06246519, 0.10233479]), 'recall_pop': {0: array([0.00202732, 0.00472781]), 1: array([0.00299491, 0.00670438]), 2: array([0.00365357, 0.00834985]), 3: array([0.00518696, 0.01083005]), 4: array([0.00815158, 0.01741553]), 5: array([0.01345938, 0.0266149 ]), 6: array([0.0202003 , 0.03787292]), 7: array([0.03452869, 0.06074252]), 8: array([0.0594837 , 0.09641503]), 9: array([0.08754629, 0.13125924])}, 'recall_pop_Contribute': {0: array([0.00036705, 0.00087944]), 1: array([0.00047723, 0.00108542]), 2: array([0.00055795, 0.00121832]), 3: array([0.00080988, 0.00165841]), 4: array([0.00122375, 0.00266797]), 5: array([0.00228993, 0.00449818]), 6: array([0.00353664, 0.00647393]), 7: array([0.00653785, 0.0113294 ]), 8: array([0.01300435, 0.0210667 ]), 9: array([0.03366054, 0.05145701])}, 'ndcg': array([0.05203338, 0.06712611])}
total time cost of epoch 132:  81.79097723960876
training: 25it [00:02,  8.46it/s]]
training: 43it [00:05,  9.81it/s]]
training: 65it [00:07, 10.95it/s]]
training: 87it [00:09, 10.78it/s]]
training: 107it [00:10, 11.08it/s]
training: 129it [00:12, 10.46it/s]
training: 149it [00:14,  8.74it/s]
training: 166it [00:17,  8.39it/s]
training: 183it [00:19,  8.49it/s]
training: 200it [00:21,  8.43it/s]
training: 217it [00:23,  8.51it/s]
training: 234it [00:25,  8.55it/s]
training: 251it [00:27,  8.48it/s]
training: 268it [00:29,  8.53it/s]
training: 285it [00:31,  8.50it/s]
training: 302it [00:33,  8.59it/s]
training: 319it [00:35,  8.49it/s]
training: 336it [00:37,  8.45it/s]
training: 353it [00:38,  8.52it/s]
training: 371it [00:41,  8.54it/s]
training: 388it [00:43,  8.48it/s]
training: 405it [00:45,  8.53it/s]
training: 422it [00:47,  8.47it/s]
training: 439it [00:49,  8.52it/s]
training: 456it [00:51,  8.50it/s]
training: 473it [00:53,  8.48it/s]
training: 490it [00:55,  8.48it/s]
training: 507it [00:57,  8.49it/s]
training: 524it [00:59,  8.46it/s]
training: 541it [01:01,  8.55it/s]
training: 558it [01:03,  8.53it/s]
training: 575it [01:05,  8.54it/s]
training: 592it [01:07,  8.43it/s]
training: 604it [01:08,  8.81it/s]
training: 604it [01:08,  8.81it/s]
EPOCH[133]:loss 7.932
[TEST]
{'precision': array([0.02791619, 0.02313534]), 'recall': array([0.06234637, 0.10198548]), 'recall_pop': {0: array([0.00213942, 0.00459235]), 1: array([0.00297649, 0.0070058 ]), 2: array([0.0037062 , 0.00837774]), 3: array([0.00516065, 0.01113477]), 4: array([0.00806918, 0.01738711]), 5: array([0.0134543 , 0.02641188]), 6: array([0.02035183, 0.03740962]), 7: array([0.03442856, 0.05983665]), 8: array([0.05895324, 0.09595692]), 9: array([0.08745972, 0.13077417])}, 'recall_pop_Contribute': {0: array([0.00039791, 0.00084455]), 1: array([0.00046855, 0.00114352]), 2: array([0.00055076, 0.00124868]), 3: array([0.00080197, 0.00169535]), 4: array([0.00122207, 0.00264782]), 5: array([0.00229365, 0.00446439]), 6: array([0.00353662, 0.00641766]), 7: array([0.00650299, 0.01121895]), 8: array([0.01287275, 0.02094856]), 9: array([0.03369907, 0.051356  ])}, 'ndcg': array([0.05204351, 0.06705386])}
total time cost of epoch 133:  81.28385615348816
training: 17it [00:01, 10.63it/s]]
training: 39it [00:03, 10.79it/s]]
training: 61it [00:05, 10.53it/s]]
training: 81it [00:07, 10.65it/s]]
training: 99it [00:09, 10.70it/s]]
training: 118it [00:11,  8.42it/s]
training: 135it [00:13,  8.42it/s]
training: 152it [00:15,  8.55it/s]
training: 169it [00:17,  8.48it/s]
training: 186it [00:19,  8.56it/s]
training: 203it [00:21,  8.50it/s]
training: 220it [00:23,  8.45it/s]
training: 237it [00:25,  8.56it/s]
training: 254it [00:27,  8.53it/s]
training: 271it [00:29,  8.50it/s]
training: 288it [00:31,  8.51it/s]
training: 303it [00:33,  7.52it/s]
training: 318it [00:35,  7.34it/s]
training: 335it [00:37,  8.47it/s]
training: 352it [00:39,  8.53it/s]
training: 369it [00:41,  8.50it/s]
training: 386it [00:43,  8.49it/s]
training: 403it [00:45,  8.48it/s]
training: 420it [00:47,  8.53it/s]
training: 437it [00:49,  8.44it/s]
training: 454it [00:51,  8.45it/s]
training: 471it [00:53,  8.42it/s]
training: 488it [00:55,  8.47it/s]
training: 505it [00:57,  8.46it/s]
training: 522it [00:59,  8.46it/s]
training: 539it [01:01,  8.59it/s]
training: 556it [01:03,  8.48it/s]
training: 573it [01:05,  8.50it/s]
training: 590it [01:07,  8.45it/s]
training: 604it [01:09,  8.67it/s]
training: 604it [01:09,  8.67it/s]
EPOCH[134]:loss 7.934
[TEST]
training: 14it [00:01,  9.34it/s]]
training: 14it [00:01,  9.34it/s]]
[5mfind a better recall[25m 0.06277692601273974 ++2.327975881548372e-05
total time cost of epoch 134:  82.41615152359009
training: 31it [00:03,  9.23it/s]]
training: 51it [00:05,  9.27it/s]]
training: 68it [00:07,  8.42it/s]]
training: 85it [00:09,  8.55it/s]]
training: 102it [00:11,  8.44it/s]
training: 119it [00:13,  8.50it/s]
training: 137it [00:15,  8.53it/s]
training: 154it [00:17,  8.54it/s]
training: 171it [00:19,  8.43it/s]
training: 188it [00:21,  8.50it/s]
training: 205it [00:23,  8.38it/s]
training: 222it [00:25,  8.48it/s]
training: 239it [00:27,  8.45it/s]
training: 256it [00:29,  8.86it/s]
training: 273it [00:31,  8.53it/s]
training: 290it [00:33,  8.50it/s]
training: 307it [00:35,  8.46it/s]
training: 324it [00:37,  8.37it/s]
training: 341it [00:39,  8.53it/s]
training: 357it [00:41,  8.46it/s]
training: 374it [00:43,  8.51it/s]
training: 389it [00:45,  8.30it/s]
training: 406it [00:47,  8.44it/s]
training: 422it [00:49,  7.44it/s]
training: 438it [00:51,  8.30it/s]
training: 455it [00:53,  8.46it/s]
training: 471it [00:55,  8.42it/s]
training: 488it [00:57,  8.55it/s]
training: 505it [00:59,  8.50it/s]
training: 522it [01:01,  8.53it/s]
training: 539it [01:03,  8.47it/s]
training: 556it [01:05,  8.43it/s]
training: 573it [01:07,  8.46it/s]
training: 590it [01:09,  8.48it/s]
training: 604it [01:11,  8.46it/s]
training: 604it [01:11,  8.46it/s]
EPOCH[135]:loss 7.933
training: 10it [00:01,  9.10it/s]]
training: 10it [00:01,  9.10it/s]]
{'precision': array([0.02797303, 0.02313613]), 'recall': array([0.06263697, 0.10227403]), 'recall_pop': {0: array([0.00199943, 0.00477096]), 1: array([0.00289492, 0.0067457 ]), 2: array([0.00373093, 0.00832293]), 3: array([0.00523433, 0.01075479]), 4: array([0.00809046, 0.01697261]), 5: array([0.01368963, 0.02670646]), 6: array([0.02072053, 0.03817383]), 7: array([0.03509758, 0.06056369]), 8: array([0.05859647, 0.09603878]), 9: array([0.08776601, 0.13093101])}, 'recall_pop_Contribute': {0: array([0.00037865, 0.00088183]), 1: array([0.00047576, 0.00111399]), 2: array([0.00052644, 0.00123232]), 3: array([0.00081599, 0.00166571]), 4: array([0.00126515, 0.00258585]), 5: array([0.00233279, 0.00447516]), 6: array([0.00362424, 0.00654994]), 7: array([0.0066086 , 0.01135216]), 8: array([0.01278598, 0.02096555]), 9: array([0.03382337, 0.05145151])}, 'ndcg': array([0.05211181, 0.0670788 ])}
total time cost of epoch 135:  86.47122526168823
training: 28it [00:03,  8.37it/s]]
training: 44it [00:05,  8.30it/s]]
training: 61it [00:07,  8.30it/s]]
training: 78it [00:09,  8.31it/s]]
training: 95it [00:11,  8.45it/s]]
training: 111it [00:13,  8.47it/s]
training: 127it [00:15,  8.30it/s]
training: 145it [00:17,  8.33it/s]
training: 161it [00:19,  8.24it/s]
training: 178it [00:21,  8.24it/s]
training: 195it [00:23,  8.30it/s]
training: 212it [00:25,  8.39it/s]
training: 228it [00:27,  8.29it/s]
training: 245it [00:29,  8.53it/s]
training: 262it [00:31,  8.38it/s]
training: 279it [00:33,  8.27it/s]
training: 295it [00:35,  8.24it/s]
training: 312it [00:37,  8.28it/s]
training: 329it [00:39,  8.48it/s]
training: 345it [00:41,  8.30it/s]
training: 362it [00:43,  8.41it/s]
training: 379it [00:45,  8.23it/s]
training: 395it [00:47,  8.34it/s]
training: 412it [00:49,  8.26it/s]
training: 429it [00:51,  8.41it/s]
training: 446it [00:53,  8.44it/s]
training: 463it [00:55,  8.52it/s]
training: 479it [00:57,  8.28it/s]
training: 496it [00:59,  8.35it/s]
training: 513it [01:01,  8.41it/s]
training: 529it [01:03,  8.26it/s]
training: 546it [01:05,  8.27it/s]
training: 561it [01:07,  8.23it/s]
training: 578it [01:09,  8.63it/s]
training: 594it [01:11,  8.23it/s]
training: 604it [01:12,  8.33it/s]
training: 604it [01:12,  8.33it/s]
EPOCH[136]:loss 7.934
[TEST]
training: 14it [00:01,  9.00it/s]]
training: 14it [00:01,  9.00it/s]]
total time cost of epoch 136:  87.8365592956543
training: 31it [00:03,  8.51it/s]]
training: 48it [00:05,  8.53it/s]]
training: 65it [00:07,  8.49it/s]]
training: 82it [00:09,  8.52it/s]]
training: 99it [00:11,  8.48it/s]]
training: 116it [00:13,  8.49it/s]
training: 133it [00:15,  8.42it/s]
training: 150it [00:17,  8.55it/s]
training: 167it [00:19,  8.49it/s]
training: 184it [00:21,  8.60it/s]
training: 201it [00:23,  8.44it/s]
training: 219it [00:25,  8.53it/s]
training: 236it [00:27,  8.51it/s]
training: 252it [00:29,  7.63it/s]
training: 270it [00:31,  8.47it/s]
training: 286it [00:33,  8.46it/s]
training: 303it [00:35,  8.47it/s]
training: 320it [00:37,  8.48it/s]
training: 337it [00:39,  8.36it/s]
training: 354it [00:41,  8.55it/s]
training: 371it [00:43,  8.40it/s]
training: 388it [00:45,  8.49it/s]
training: 405it [00:47,  8.46it/s]
training: 422it [00:49,  8.35it/s]
training: 439it [00:51,  8.46it/s]
training: 456it [00:53,  8.32it/s]
training: 473it [00:55,  8.36it/s]
training: 490it [00:57,  8.34it/s]
training: 506it [00:59,  8.35it/s]
training: 523it [01:01,  8.39it/s]
training: 540it [01:03,  8.42it/s]
training: 557it [01:05,  8.40it/s]
training: 574it [01:07,  8.50it/s]
training: 591it [01:09,  8.39it/s]
training: 604it [01:11,  8.48it/s]
training: 604it [01:11,  8.48it/s]
EPOCH[137]:loss 7.932
training: 9it [00:00, 10.86it/s]s]
training: 9it [00:00, 10.86it/s]s]
{'precision': array([0.02787041, 0.02309113]), 'recall': array([0.06228078, 0.10192101]), 'recall_pop': {0: array([0.00188259, 0.00464746]), 1: array([0.0029836 , 0.00657343]), 2: array([0.00367725, 0.00833376]), 3: array([0.00496855, 0.01063321]), 4: array([0.0078834 , 0.01650807]), 5: array([0.01338581, 0.0262358 ]), 6: array([0.02058621, 0.03851953]), 7: array([0.03440103, 0.06039541]), 8: array([0.05933409, 0.09532699]), 9: array([0.08762012, 0.13130732])}, 'recall_pop_Contribute': {0: array([0.00034716, 0.00086857]), 1: array([0.0004771 , 0.00108622]), 2: array([0.00053848, 0.00121579]), 3: array([0.00078215, 0.00164518]), 4: array([0.00118227, 0.00252652]), 5: array([0.002272  , 0.00438728]), 6: array([0.00358429, 0.00658139]), 7: array([0.00650447, 0.01134138]), 8: array([0.01289254, 0.02087355]), 9: array([0.03370033, 0.05139514])}, 'ndcg': array([0.05182823, 0.06680188])}
total time cost of epoch 137:  86.66894960403442
training: 27it [00:02,  8.55it/s]]
training: 44it [00:04,  8.46it/s]]
training: 61it [00:06,  8.52it/s]]
training: 78it [00:08,  8.55it/s]]
training: 95it [00:10,  8.42it/s]]
training: 112it [00:12,  8.52it/s]
training: 129it [00:14,  8.48it/s]
training: 142it [00:16,  8.51it/s]
training: 159it [00:18,  8.51it/s]
training: 176it [00:20,  8.37it/s]
training: 193it [00:22,  8.46it/s]
training: 210it [00:24,  8.90it/s]
training: 227it [00:26,  8.45it/s]
training: 244it [00:28,  8.38it/s]
training: 261it [00:30,  8.42it/s]
training: 278it [00:32,  8.55it/s]
training: 293it [00:34,  6.38it/s]
training: 309it [00:36,  8.61it/s]
training: 326it [00:38,  8.53it/s]
training: 343it [00:40,  8.47it/s]
training: 360it [00:42,  8.47it/s]
training: 377it [00:44,  8.53it/s]
training: 394it [00:46,  8.49it/s]
training: 411it [00:48,  8.50it/s]
training: 428it [00:50,  8.49it/s]
training: 445it [00:52,  8.43it/s]
training: 462it [00:54,  8.54it/s]
training: 479it [00:56,  8.53it/s]
training: 496it [00:58,  8.46it/s]
training: 513it [01:00,  8.49it/s]
training: 530it [01:02,  8.50it/s]
training: 547it [01:04,  8.48it/s]
training: 564it [01:06,  8.51it/s]
training: 580it [01:08,  8.51it/s]
training: 596it [01:10,  7.47it/s]
training: 604it [01:11,  8.42it/s]
training: 604it [01:11,  8.42it/s]
EPOCH[138]:loss 7.934
[TEST]
training: 11it [00:01, 10.59it/s]]
training: 11it [00:01, 10.59it/s]]
total time cost of epoch 138:  87.4142701625824
training: 29it [00:03,  8.46it/s]]
training: 45it [00:05,  7.81it/s]]
training: 63it [00:07,  8.50it/s]]
training: 80it [00:09,  8.44it/s]]
training: 97it [00:11,  8.53it/s]]
training: 114it [00:13,  8.58it/s]
training: 131it [00:15,  8.47it/s]
training: 148it [00:17,  8.53it/s]
training: 165it [00:19,  8.55it/s]
training: 182it [00:21,  8.49it/s]
training: 199it [00:23,  8.50it/s]
training: 216it [00:25,  8.54it/s]
training: 233it [00:27,  8.48it/s]
training: 250it [00:29,  8.48it/s]
training: 267it [00:31,  8.49it/s]
training: 284it [00:33,  8.56it/s]
training: 301it [00:35,  8.45it/s]
training: 318it [00:37,  8.48it/s]
training: 335it [00:39,  8.43it/s]
training: 352it [00:41,  8.42it/s]
training: 367it [00:43,  6.52it/s]
training: 384it [00:45,  8.41it/s]
training: 401it [00:47,  8.43it/s]
training: 418it [00:49,  8.54it/s]
training: 435it [00:51,  8.34it/s]
training: 451it [00:53,  8.51it/s]
training: 469it [00:55,  8.48it/s]
training: 486it [00:57,  8.54it/s]
training: 503it [00:59,  8.53it/s]
training: 520it [01:01,  8.53it/s]
training: 537it [01:03,  8.25it/s]
training: 554it [01:05,  8.51it/s]
training: 571it [01:07,  8.55it/s]
training: 588it [01:09,  8.41it/s]
training: 604it [01:11,  8.48it/s]
training: 604it [01:11,  8.48it/s]
EPOCH[139]:loss 7.931
training: 7it [00:00, 10.69it/s]s]
training: 7it [00:00, 10.69it/s]s]
{'precision': array([0.02786883, 0.02312192]), 'recall': array([0.06226318, 0.10197739]), 'recall_pop': {0: array([0.00184049, 0.00447922]), 1: array([0.00292692, 0.00656722]), 2: array([0.00370357, 0.00821876]), 3: array([0.00501065, 0.01070058]), 4: array([0.00802993, 0.01637518]), 5: array([0.01350998, 0.0264708 ]), 6: array([0.02034081, 0.03833242]), 7: array([0.03461749, 0.06038273]), 8: array([0.05911225, 0.09554019]), 9: array([0.08775486, 0.1318882 ])}, 'recall_pop_Contribute': {0: array([0.00034313, 0.00084997]), 1: array([0.00047175, 0.00104872]), 2: array([0.00053603, 0.00119946]), 3: array([0.0007642 , 0.00162969]), 4: array([0.00120972, 0.00249099]), 5: array([0.00229723, 0.0044353 ]), 6: array([0.0035176, 0.0065405]), 7: array([0.00652731, 0.01134147]), 8: array([0.0128555 , 0.02080751]), 9: array([0.03374071, 0.05163377])}, 'ndcg': array([0.05189772, 0.06692246])}
total time cost of epoch 139:  86.60305738449097
training: 26it [00:02,  8.58it/s]]
training: 43it [00:04,  8.61it/s]]
training: 60it [00:06,  8.55it/s]]
training: 77it [00:08,  8.57it/s]]
training: 94it [00:10,  8.55it/s]]
training: 111it [00:12,  8.50it/s]
training: 128it [00:14,  8.51it/s]
training: 145it [00:16,  8.50it/s]
training: 162it [00:18,  8.59it/s]
training: 179it [00:20,  8.52it/s]
training: 196it [00:22,  8.48it/s]
training: 214it [00:24,  8.95it/s]
training: 231it [00:26,  8.56it/s]
training: 248it [00:28,  8.52it/s]
training: 265it [00:30,  8.58it/s]
training: 282it [00:32,  8.60it/s]
training: 299it [00:34,  8.46it/s]
training: 316it [00:36,  8.60it/s]
training: 333it [00:38,  8.52it/s]
training: 350it [00:40,  8.51it/s]
training: 367it [00:42,  8.46it/s]
training: 384it [00:44,  8.46it/s]
training: 401it [00:46,  8.39it/s]
training: 419it [00:48,  8.52it/s]
training: 436it [00:50,  8.50it/s]
training: 452it [00:52,  8.33it/s]
training: 469it [00:54,  8.50it/s]
training: 486it [00:56,  8.40it/s]
training: 503it [00:58,  8.53it/s]
training: 518it [01:00,  8.55it/s]
training: 533it [01:02,  7.97it/s]
training: 551it [01:04,  8.53it/s]
training: 568it [01:06,  8.45it/s]
training: 585it [01:08,  8.52it/s]
training: 602it [01:10,  8.45it/s]
training: 602it [01:10,  8.45it/s]
EPOCH[140]:loss 7.932
training: 604it [01:11,  8.48it/s]
training: 604it [01:11,  8.48it/s]
training: 13it [00:01, 11.24it/s]]
training: 13it [00:01, 11.24it/s]]
total time cost of epoch 140:  85.63117361068726
training: 32it [00:03,  8.70it/s]]
training: 49it [00:05,  8.56it/s]]
training: 66it [00:07,  8.47it/s]]
training: 83it [00:09,  8.46it/s]]
training: 100it [00:11,  8.39it/s]
training: 117it [00:13,  8.62it/s]
training: 134it [00:15,  8.53it/s]
training: 151it [00:17,  8.47it/s]
training: 168it [00:19,  8.50it/s]
training: 185it [00:21,  8.49it/s]
training: 202it [00:23,  8.48it/s]
training: 219it [00:25,  7.68it/s]
training: 236it [00:27,  8.55it/s]
training: 253it [00:29,  8.50it/s]
training: 270it [00:31,  8.54it/s]
training: 287it [00:33,  8.52it/s]
training: 304it [00:35,  8.43it/s]
training: 321it [00:37,  8.31it/s]
training: 338it [00:39,  8.40it/s]
training: 355it [00:41,  8.41it/s]
training: 371it [00:43,  8.31it/s]
training: 388it [00:45,  8.39it/s]
training: 405it [00:47,  8.53it/s]
training: 422it [00:49,  8.38it/s]
training: 439it [00:51,  8.48it/s]
training: 456it [00:53,  8.34it/s]
training: 472it [00:55,  8.35it/s]
training: 489it [00:57,  8.41it/s]
training: 506it [00:59,  8.26it/s]
training: 523it [01:01,  8.43it/s]
training: 540it [01:03,  8.41it/s]
training: 556it [01:05,  8.41it/s]
training: 573it [01:07,  8.26it/s]
training: 590it [01:09,  8.41it/s]
training: 604it [01:11,  8.50it/s]
training: 604it [01:11,  8.50it/s]
EPOCH[141]:loss 7.932
training: 9it [00:00, 10.85it/s]s]
training: 9it [00:00, 10.85it/s]s]
{'precision': array([0.02790672, 0.02316376]), 'recall': array([0.06230343, 0.10205266]), 'recall_pop': {0: array([0.00187342, 0.00450507]), 1: array([0.00294179, 0.006608  ]), 2: array([0.00352989, 0.00826767]), 3: array([0.00502118, 0.01024928]), 4: array([0.00792204, 0.01644121]), 5: array([0.01343374, 0.02665127]), 6: array([0.0205364 , 0.03796755]), 7: array([0.03472054, 0.06012673]), 8: array([0.05935276, 0.09557874]), 9: array([0.08751631, 0.13183349])}, 'recall_pop_Contribute': {0: array([0.00033611, 0.00084721]), 1: array([0.00045119, 0.00105467]), 2: array([0.0005102 , 0.00120777]), 3: array([0.00077111, 0.00156444]), 4: array([0.00122611, 0.00249703]), 5: array([0.00230747, 0.00445796]), 6: array([0.00354749, 0.00645758]), 7: array([0.00655483, 0.01130876]), 8: array([0.01293091, 0.02093341]), 9: array([0.03366802, 0.05172386])}, 'ndcg': array([0.05204334, 0.06708373])}
total time cost of epoch 141:  86.45676636695862
training: 27it [00:02,  8.55it/s]]
training: 44it [00:04,  8.54it/s]]
training: 61it [00:06,  8.52it/s]]
training: 78it [00:08,  8.52it/s]]
training: 96it [00:11,  8.53it/s]]
training: 113it [00:12,  8.58it/s]
training: 130it [00:14,  8.51it/s]
training: 147it [00:16,  8.49it/s]
training: 164it [00:18,  8.54it/s]
training: 181it [00:20,  8.52it/s]
training: 197it [00:22,  7.85it/s]
training: 215it [00:25,  8.73it/s]
training: 229it [00:26,  7.00it/s]
training: 244it [00:29,  7.29it/s]
training: 261it [00:31,  8.50it/s]
training: 278it [00:33,  8.50it/s]
training: 295it [00:35,  8.51it/s]
training: 312it [00:37,  8.53it/s]
training: 329it [00:39,  8.52it/s]
training: 346it [00:41,  8.53it/s]
training: 363it [00:43,  8.50it/s]
training: 380it [00:45,  8.53it/s]
training: 397it [00:47,  8.52it/s]
training: 414it [00:49,  8.52it/s]
training: 431it [00:51,  8.51it/s]
training: 448it [00:53,  8.50it/s]
training: 465it [00:55,  8.53it/s]
training: 482it [00:57,  8.47it/s]
training: 499it [00:59,  8.50it/s]
training: 516it [01:01,  8.53it/s]
training: 533it [01:03,  8.50it/s]
training: 550it [01:04,  8.51it/s]
training: 567it [01:06,  8.51it/s]
training: 584it [01:08,  8.52it/s]
training: 601it [01:11,  8.45it/s]
training: 601it [01:11,  8.45it/s]
EPOCH[142]:loss 7.931
training: 604it [01:11,  8.46it/s]
training: 604it [01:11,  8.46it/s]
training: 15it [00:01, 11.23it/s]]
training: 15it [00:01, 11.23it/s]]
total time cost of epoch 142:  85.65510845184326
training: 34it [00:03,  8.80it/s]]
training: 51it [00:05,  8.46it/s]]
training: 69it [00:07,  8.50it/s]]
training: 86it [00:09,  8.45it/s]]
training: 103it [00:11,  8.42it/s]
training: 120it [00:13,  8.48it/s]
training: 137it [00:15,  8.51it/s]
training: 154it [00:17,  8.41it/s]
training: 171it [00:19,  8.55it/s]
training: 188it [00:21,  8.49it/s]
training: 205it [00:23,  8.54it/s]
training: 222it [00:25,  8.47it/s]
training: 237it [00:27,  7.95it/s]
training: 253it [00:29,  8.51it/s]
training: 270it [00:31,  8.42it/s]
training: 287it [00:33,  8.48it/s]
training: 304it [00:35,  8.52it/s]
training: 321it [00:37,  8.48it/s]
training: 338it [00:39,  8.48it/s]
training: 355it [00:41,  8.56it/s]
training: 372it [00:43,  8.45it/s]
training: 390it [00:45,  8.51it/s]
training: 407it [00:47,  8.51it/s]
training: 424it [00:49,  8.47it/s]
training: 441it [00:51,  8.55it/s]
training: 458it [00:53,  8.43it/s]
training: 475it [00:55,  8.48it/s]
training: 492it [00:57,  8.41it/s]
training: 509it [00:59,  8.45it/s]
training: 526it [01:01,  8.54it/s]
training: 543it [01:03,  8.47it/s]
training: 560it [01:05,  8.42it/s]
training: 576it [01:07,  8.22it/s]
training: 593it [01:09,  8.51it/s]
training: 604it [01:10,  8.53it/s]
training: 604it [01:10,  8.53it/s]
EPOCH[143]:loss 7.930
[TEST]
training: 9it [00:01,  9.85it/s]s]
training: 9it [00:01,  9.85it/s]s]
total time cost of epoch 143:  84.34173631668091
training: 31it [00:03, 10.69it/s]]
training: 49it [00:05,  8.54it/s]]
training: 66it [00:07,  8.52it/s]]
training: 83it [00:09,  8.51it/s]]
training: 100it [00:11,  8.52it/s]
training: 117it [00:13,  8.56it/s]
training: 134it [00:15,  8.54it/s]
training: 151it [00:17,  8.54it/s]
training: 168it [00:19,  8.49it/s]
training: 185it [00:21,  8.49it/s]
training: 202it [00:23,  8.52it/s]
training: 220it [00:25,  8.49it/s]
training: 236it [00:27,  8.38it/s]
training: 252it [00:29,  7.55it/s]
training: 269it [00:31,  8.49it/s]
training: 286it [00:33,  8.52it/s]
training: 303it [00:35,  8.48it/s]
training: 320it [00:37,  8.48it/s]
training: 337it [00:39,  8.55it/s]
training: 354it [00:41,  8.53it/s]
training: 371it [00:43,  8.46it/s]
training: 388it [00:45,  8.46it/s]
training: 405it [00:47,  8.48it/s]
training: 422it [00:49,  8.53it/s]
training: 439it [00:51,  8.52it/s]
training: 456it [00:53,  8.50it/s]
training: 473it [00:55,  8.51it/s]
training: 490it [00:57,  8.53it/s]
training: 507it [00:59,  8.49it/s]
training: 524it [01:01,  8.55it/s]
training: 541it [01:03,  8.53it/s]
training: 558it [01:05,  8.47it/s]
training: 575it [01:07,  8.53it/s]
training: 592it [01:09,  8.51it/s]
training: 604it [01:10,  8.54it/s]
training: 604it [01:10,  8.54it/s]
EPOCH[144]:loss 7.928
training: 1it [00:00,  7.17it/s]s]
training: 1it [00:00,  7.17it/s]s]
{'precision': array([0.0279604, 0.0231685]), 'recall': array([0.06247378, 0.10210864]), 'recall_pop': {0: array([0.00189154, 0.00472237]), 1: array([0.00295833, 0.00663607]), 2: array([0.00367567, 0.00850363]), 3: array([0.00512837, 0.01046874]), 4: array([0.00817241, 0.01686341]), 5: array([0.01367795, 0.02595788]), 6: array([0.02055988, 0.03820853]), 7: array([0.03469712, 0.06040731]), 8: array([0.05878235, 0.0953287 ]), 9: array([0.08748416, 0.13151221])}, 'recall_pop_Contribute': {0: array([0.00034708, 0.00088781]), 1: array([0.00046372, 0.00104716]), 2: array([0.00054425, 0.00121676]), 3: array([0.0007642 , 0.00160454]), 4: array([0.00122505, 0.00254995]), 5: array([0.00231011, 0.00438293]), 6: array([0.00354157, 0.00652355]), 7: array([0.00658287, 0.01134774]), 8: array([0.01286285, 0.02083204]), 9: array([0.03383208, 0.05171616])}, 'ndcg': array([0.05208391, 0.06708557])}
total time cost of epoch 144:  81.08283925056458
training: 25it [00:02, 11.41it/s]]
training: 44it [00:04,  9.76it/s]]
training: 68it [00:06, 10.62it/s]]
training: 84it [00:08,  8.48it/s]]
training: 101it [00:10,  8.49it/s]
training: 118it [00:12,  8.49it/s]
training: 135it [00:14,  8.53it/s]
training: 152it [00:16,  8.49it/s]
training: 170it [00:18,  8.62it/s]
training: 187it [00:20,  8.53it/s]
training: 204it [00:22,  8.54it/s]
training: 221it [00:24,  8.55it/s]
training: 238it [00:26,  8.53it/s]
training: 255it [00:28,  8.49it/s]
training: 272it [00:30,  8.47it/s]
training: 287it [00:32,  8.32it/s]
training: 304it [00:34,  8.48it/s]
training: 321it [00:36,  8.47it/s]
training: 338it [00:38,  8.48it/s]
training: 355it [00:40,  8.53it/s]
training: 372it [00:42,  8.53it/s]
training: 389it [00:44,  8.52it/s]
training: 406it [00:46,  8.45it/s]
training: 423it [00:48,  8.03it/s]
training: 440it [00:50,  8.54it/s]
training: 457it [00:52,  8.56it/s]
training: 474it [00:54,  8.51it/s]
training: 491it [00:56,  8.54it/s]
training: 508it [00:58,  8.54it/s]
training: 525it [01:00,  8.46it/s]
training: 542it [01:02,  8.52it/s]
training: 559it [01:04,  8.56it/s]
training: 576it [01:06,  8.49it/s]
training: 593it [01:08,  8.50it/s]
training: 604it [01:09,  8.67it/s]
training: 604it [01:09,  8.67it/s]
EPOCH[145]:loss 7.928
training: 11it [00:01, 10.27it/s]]
training: 11it [00:01, 10.27it/s]]
{'precision': array([0.0279904 , 0.02318823]), 'recall': array([0.06254401, 0.10225598]), 'recall_pop': {0: array([0.00195417, 0.0047953 ]), 1: array([0.00320411, 0.00678189]), 2: array([0.00368251, 0.00835995]), 3: array([0.00502266, 0.01063799]), 4: array([0.00842728, 0.01694104]), 5: array([0.01371559, 0.02615013]), 6: array([0.02055229, 0.03833542]), 7: array([0.03460411, 0.06011109]), 8: array([0.0587623 , 0.09540185]), 9: array([0.08762094, 0.1319521 ])}, 'recall_pop_Contribute': {0: array([0.00035176, 0.00091196]), 1: array([0.00050343, 0.00107559]), 2: array([0.00054889, 0.00120378]), 3: array([0.00075651, 0.00161837]), 4: array([0.00127778, 0.00258418]), 5: array([0.00231577, 0.00440614]), 6: array([0.0035482 , 0.00652419]), 7: array([0.00656253, 0.01130588]), 8: array([0.0128255, 0.0207865]), 9: array([0.03385366, 0.05183938])}, 'ndcg': array([0.05218784, 0.06721695])}
total time cost of epoch 145:  79.15303230285645
training: 31it [00:03, 10.00it/s]]
training: 53it [00:05, 11.04it/s]]
training: 75it [00:07, 10.75it/s]]
training: 97it [00:09, 11.33it/s]]
training: 115it [00:11,  8.61it/s]
training: 133it [00:13,  8.53it/s]
training: 150it [00:15,  8.49it/s]
training: 167it [00:17,  8.53it/s]
training: 183it [00:19,  8.47it/s]
training: 201it [00:21,  8.54it/s]
training: 218it [00:23,  8.54it/s]
training: 235it [00:25,  8.52it/s]
training: 252it [00:27,  8.51it/s]
training: 269it [00:29,  8.52it/s]
training: 286it [00:31,  8.52it/s]
training: 303it [00:33,  8.51it/s]
training: 318it [00:35,  7.55it/s]
training: 335it [00:37,  8.51it/s]
training: 350it [00:39,  6.57it/s]
training: 367it [00:41,  8.44it/s]
training: 384it [00:43,  8.54it/s]
training: 401it [00:45,  8.43it/s]
training: 418it [00:47,  8.47it/s]
training: 434it [00:49,  8.50it/s]
training: 452it [00:51,  8.53it/s]
training: 469it [00:53,  8.44it/s]
training: 486it [00:55,  8.49it/s]
training: 503it [00:57,  8.49it/s]
training: 520it [00:59,  8.49it/s]
training: 537it [01:01,  8.44it/s]
training: 554it [01:03,  8.55it/s]
training: 571it [01:05,  8.60it/s]
training: 588it [01:07,  8.37it/s]
training: 604it [01:09,  8.72it/s]
training: 604it [01:09,  8.72it/s]
EPOCH[146]:loss 7.928
training: 3it [00:00,  8.08it/s]s]
training: 3it [00:00,  8.08it/s]s]
{'precision': array([0.02807566, 0.0231835 ]), 'recall': array([0.06261626, 0.10224958]), 'recall_pop': {0: array([0.00188161, 0.00482547]), 1: array([0.00294991, 0.00671427]), 2: array([0.00343884, 0.00850994]), 3: array([0.00511841, 0.01054038]), 4: array([0.00828391, 0.01671342]), 5: array([0.01365095, 0.02635097]), 6: array([0.02065124, 0.03823085]), 7: array([0.0345352 , 0.05994897]), 8: array([0.0589658 , 0.09567305]), 9: array([0.08767022, 0.13170027])}, 'recall_pop_Contribute': {0: array([0.00033043, 0.00091869]), 1: array([0.00046754, 0.00107282]), 2: array([0.00049   , 0.00125503]), 3: array([0.00077907, 0.0016019 ]), 4: array([0.00124709, 0.00253273]), 5: array([0.00229384, 0.00443556]), 6: array([0.00358449, 0.00653592]), 7: array([0.0065648 , 0.01130969]), 8: array([0.01291768, 0.0208793 ]), 9: array([0.03394132, 0.05170793])}, 'ndcg': array([0.05225703, 0.06722002])}
total time cost of epoch 146:  78.79050016403198
training: 23it [00:02, 10.28it/s]]
training: 45it [00:04, 10.83it/s]]
training: 67it [00:06, 10.77it/s]]
training: 86it [00:08, 10.64it/s]]
training: 110it [00:10, 11.22it/s]
training: 131it [00:12, 10.86it/s]
training: 152it [00:14,  9.54it/s]
training: 169it [00:16,  8.49it/s]
training: 186it [00:18,  8.47it/s]
training: 203it [00:20,  8.54it/s]
training: 219it [00:22,  8.30it/s]
training: 236it [00:24,  8.42it/s]
training: 253it [00:26,  8.33it/s]
training: 270it [00:28,  8.45it/s]
training: 285it [00:30,  8.37it/s]
training: 304it [00:32,  8.51it/s]
training: 321it [00:34,  8.49it/s]
training: 338it [00:36,  8.50it/s]
training: 355it [00:38,  8.47it/s]
training: 372it [00:40,  8.52it/s]
training: 385it [00:42,  8.49it/s]
training: 402it [00:44,  8.47it/s]
training: 419it [00:46,  8.53it/s]
training: 436it [00:48,  8.52it/s]
training: 453it [00:50,  8.48it/s]
training: 470it [00:52,  8.47it/s]
training: 485it [00:53,  8.50it/s]
training: 502it [00:56,  8.49it/s]
training: 519it [00:58,  8.53it/s]
training: 536it [01:00,  8.51it/s]
training: 553it [01:02,  8.50it/s]
training: 570it [01:04,  8.48it/s]
training: 587it [01:06,  8.49it/s]
training: 604it [01:08,  8.85it/s]
training: 604it [01:08,  8.85it/s]
EPOCH[147]:loss 7.929
training: 3it [00:00,  7.59it/s]s]
training: 3it [00:00,  7.59it/s]s]
{'precision': array([0.02797303, 0.02320797]), 'recall': array([0.06248717, 0.10269951]), 'recall_pop': {0: array([0.00205604, 0.00474939]), 1: array([0.00284465, 0.00673554]), 2: array([0.00347568, 0.00835337]), 3: array([0.005076  , 0.01042112]), 4: array([0.00822233, 0.01697218]), 5: array([0.0136294, 0.0268019]), 6: array([0.02063954, 0.03834693]), 7: array([0.03418045, 0.06030852]), 8: array([0.05877504, 0.09617886]), 9: array([0.08784615, 0.13171465])}, 'recall_pop_Contribute': {0: array([0.00036651, 0.0009096 ]), 1: array([0.00044852, 0.00107797]), 2: array([0.0005095 , 0.00123726]), 3: array([0.0007725 , 0.00160199]), 4: array([0.00124713, 0.00258268]), 5: array([0.00229485, 0.00450037]), 6: array([0.00358105, 0.00656119]), 7: array([0.00649453, 0.01139341]), 8: array([0.0128561 , 0.02100001]), 9: array([0.03391647, 0.05183503])}, 'ndcg': array([0.05222152, 0.06739858])}
total time cost of epoch 147:  77.7776129245758
training: 20it [00:02,  8.45it/s]]
training: 37it [00:04,  8.45it/s]]
training: 57it [00:06, 10.44it/s]]
training: 79it [00:08, 11.27it/s]]
training: 101it [00:10, 10.53it/s]
training: 120it [00:12, 10.60it/s]
training: 144it [00:14, 11.44it/s]
training: 166it [00:16, 11.40it/s]
training: 188it [00:18,  9.93it/s]
training: 205it [00:20,  8.48it/s]
training: 222it [00:22,  8.48it/s]
training: 239it [00:24,  8.42it/s]
training: 256it [00:26,  8.44it/s]
training: 273it [00:28,  8.52it/s]
training: 290it [00:30,  8.56it/s]
training: 307it [00:32,  8.59it/s]
training: 324it [00:34,  8.59it/s]
training: 341it [00:36,  8.52it/s]
training: 358it [00:38,  8.57it/s]
training: 376it [00:40,  8.52it/s]
training: 392it [00:42,  7.49it/s]
training: 408it [00:44,  8.40it/s]
training: 425it [00:46,  8.47it/s]
training: 442it [00:48,  9.04it/s]
training: 459it [00:50,  8.46it/s]
training: 476it [00:52,  8.42it/s]
training: 493it [00:54,  8.46it/s]
training: 510it [00:56,  8.45it/s]
training: 527it [00:58,  8.49it/s]
training: 543it [01:00,  8.47it/s]
training: 560it [01:02,  8.49it/s]
training: 577it [01:04,  8.46it/s]
training: 594it [01:06,  8.50it/s]
training: 604it [01:07,  8.92it/s]
training: 604it [01:07,  8.92it/s]
EPOCH[148]:loss 7.930
training: 3it [00:00,  8.24it/s]s]
training: 3it [00:00,  8.24it/s]s]
{'precision': array([0.02799672, 0.0232435 ]), 'recall': array([0.0625281 , 0.10267977]), 'recall_pop': {0: array([0.0019468 , 0.00479886]), 1: array([0.0027494 , 0.00659555]), 2: array([0.00355094, 0.00831835]), 3: array([0.00516016, 0.01050273]), 4: array([0.00827955, 0.01691218]), 5: array([0.013855  , 0.02645878]), 6: array([0.02082573, 0.0384216 ]), 7: array([0.03444549, 0.06016585]), 8: array([0.05823221, 0.09606316]), 9: array([0.08783974, 0.13223663])}, 'recall_pop_Contribute': {0: array([0.0003537 , 0.00091763]), 1: array([0.00044048, 0.00105206]), 2: array([0.00052467, 0.00121208]), 3: array([0.00077505, 0.00161493]), 4: array([0.00125024, 0.00256467]), 5: array([0.00234853, 0.00444895]), 6: array([0.00358563, 0.00656262]), 7: array([0.00656748, 0.01134277]), 8: array([0.01278096, 0.02094981]), 9: array([0.03390137, 0.05201426])}, 'ndcg': array([0.05209007, 0.06726759])}
total time cost of epoch 148:  78.18818974494934
training: 20it [00:02,  8.37it/s]]
training: 37it [00:04,  8.51it/s]]
training: 54it [00:06,  8.54it/s]]
training: 71it [00:08,  8.52it/s]]
training: 88it [00:10,  9.90it/s]]
training: 110it [00:12, 10.77it/s]
training: 132it [00:14, 10.62it/s]
training: 154it [00:16, 11.28it/s]
training: 173it [00:18, 10.72it/s]
training: 195it [00:20, 10.27it/s]
training: 216it [00:22,  9.30it/s]
training: 233it [00:24,  8.53it/s]
training: 250it [00:26,  8.54it/s]
training: 267it [00:28,  8.54it/s]
training: 284it [00:30,  8.49it/s]
training: 301it [00:32,  8.57it/s]
training: 318it [00:34,  8.50it/s]
training: 335it [00:36,  8.46it/s]
training: 352it [00:38,  8.52it/s]
training: 369it [00:40,  8.50it/s]
training: 387it [00:42,  8.85it/s]
training: 404it [00:44,  8.53it/s]
training: 421it [00:46,  8.49it/s]
training: 438it [00:48,  8.27it/s]
training: 455it [00:50,  8.51it/s]
training: 472it [00:52,  8.46it/s]
training: 489it [00:54,  8.54it/s]
training: 506it [00:56,  8.52it/s]
training: 523it [00:58,  8.52it/s]
training: 540it [01:00,  8.50it/s]
training: 557it [01:02,  8.49it/s]
training: 574it [01:04,  8.53it/s]
training: 591it [01:06,  8.50it/s]
training: 604it [01:08,  8.87it/s]
training: 604it [01:08,  8.87it/s]
EPOCH[149]:loss 7.931
training: 10it [00:01,  8.41it/s]]
training: 10it [00:01,  8.41it/s]]
{'precision': array([0.02809145, 0.02328218]), 'recall': array([0.06281498, 0.1027429 ]), 'recall_pop': {0: array([0.001795  , 0.00488885]), 1: array([0.00298991, 0.0064527 ]), 2: array([0.00365094, 0.00861627]), 3: array([0.00527945, 0.0102809 ]), 4: array([0.00798783, 0.01679342]), 5: array([0.01352046, 0.02628857]), 6: array([0.02093658, 0.0381863 ]), 7: array([0.0345202 , 0.06032418]), 8: array([0.05857249, 0.09613726]), 9: array([0.08849789, 0.13210852])}, 'recall_pop_Contribute': {0: array([0.0003237 , 0.00093202]), 1: array([0.00048534, 0.00104244]), 2: array([0.00054477, 0.0012651 ]), 3: array([0.00081281, 0.00158064]), 4: array([0.00122525, 0.00256682]), 5: array([0.00230516, 0.00444737]), 6: array([0.00361201, 0.00654631]), 7: array([0.00654779, 0.0113241 ]), 8: array([0.01285784, 0.02097331]), 9: array([0.03410032, 0.0520648 ])}, 'ndcg': array([0.05230472, 0.06741132])}
[5mfind a better recall[25m 0.06281498477738963 ++3.805876464989255e-05
total time cost of epoch 149:  79.2530448436737
training: 27it [00:03,  8.54it/s]]
training: 44it [00:05,  8.50it/s]]
training: 61it [00:07,  8.49it/s]]
training: 78it [00:09,  8.45it/s]]
training: 92it [00:10,  8.41it/s]]
training: 113it [00:13, 10.62it/s]
training: 135it [00:15, 10.71it/s]
training: 155it [00:17, 10.61it/s]
training: 174it [00:19, 11.04it/s]
training: 196it [00:21, 10.44it/s]
training: 218it [00:23, 11.38it/s]
training: 238it [00:25,  8.71it/s]
training: 255it [00:27,  8.49it/s]
training: 272it [00:29,  8.50it/s]
training: 289it [00:31,  8.44it/s]
training: 306it [00:33,  8.45it/s]
training: 323it [00:35,  8.52it/s]
training: 340it [00:37,  8.40it/s]
training: 358it [00:39,  8.48it/s]
training: 375it [00:41,  8.51it/s]
training: 392it [00:43,  8.45it/s]
training: 408it [00:45,  8.44it/s]
training: 425it [00:47,  8.53it/s]
training: 442it [00:49,  8.33it/s]
training: 458it [00:51,  8.46it/s]
training: 475it [00:53,  8.57it/s]
training: 492it [00:55,  8.56it/s]
training: 509it [00:57,  8.48it/s]
training: 527it [00:59,  9.10it/s]
training: 543it [01:01,  8.37it/s]
training: 560it [01:03,  8.32it/s]
training: 576it [01:05,  8.52it/s]
training: 593it [01:07,  7.69it/s]
training: 604it [01:08,  8.79it/s]
training: 604it [01:08,  8.79it/s]
EPOCH[150]:loss 7.928
training: 9it [00:01,  8.42it/s]s]
training: 9it [00:01,  8.42it/s]s]
{'precision': array([0.02809619, 0.0232956 ]), 'recall': array([0.06290367, 0.10271331]), 'recall_pop': {0: array([0.00208446, 0.00465907]), 1: array([0.00298228, 0.00661936]), 2: array([0.00358515, 0.00825232]), 3: array([0.00522301, 0.01070193]), 4: array([0.00808143, 0.01682488]), 5: array([0.01356903, 0.02606927]), 6: array([0.02040917, 0.03809538]), 7: array([0.03423441, 0.06025124]), 8: array([0.05909439, 0.09615913]), 9: array([0.08840891, 0.13236831])}, 'recall_pop_Contribute': {0: array([0.00038679, 0.00088524]), 1: array([0.00048313, 0.00105435]), 2: array([0.0005488 , 0.00122232]), 3: array([0.00080614, 0.00163056]), 4: array([0.00124652, 0.00255441]), 5: array([0.00231556, 0.0043965 ]), 6: array([0.00351903, 0.00657497]), 7: array([0.0065086 , 0.01129168]), 8: array([0.0129269 , 0.02098622]), 9: array([0.0341622 , 0.05211706])}, 'ndcg': array([0.0522881 , 0.06736186])}
[5mfind a better recall[25m 0.06290366596357652 ++8.868118618689247e-05
total time cost of epoch 150:  78.26710033416748
training: 25it [00:03,  8.51it/s]]
training: 42it [00:05,  8.49it/s]]
training: 59it [00:07,  8.47it/s]]
training: 76it [00:09,  8.53it/s]]
training: 93it [00:11,  8.49it/s]]
training: 110it [00:13,  8.45it/s]
training: 127it [00:15,  8.51it/s]
training: 146it [00:17, 10.91it/s]
training: 170it [00:19, 11.23it/s]
training: 190it [00:21, 10.82it/s]
training: 210it [00:23, 10.80it/s]
training: 234it [00:25, 11.12it/s]
training: 256it [00:27, 11.38it/s]
training: 277it [00:29,  9.63it/s]
training: 294it [00:31,  8.45it/s]
training: 311it [00:33,  8.52it/s]
training: 328it [00:35,  8.45it/s]
training: 345it [00:37,  8.53it/s]
training: 362it [00:39,  8.54it/s]
training: 380it [00:41,  8.46it/s]
training: 397it [00:43,  8.53it/s]
training: 414it [00:45,  8.45it/s]
training: 429it [00:46,  8.52it/s]
training: 448it [00:49,  8.49it/s]
training: 465it [00:51,  8.43it/s]
training: 479it [00:53,  7.56it/s]
training: 496it [00:55,  8.39it/s]
training: 513it [00:57,  8.55it/s]
training: 530it [00:59,  8.53it/s]
training: 548it [01:01,  8.53it/s]
training: 565it [01:03,  8.53it/s]
training: 582it [01:05,  8.49it/s]
training: 599it [01:07,  8.54it/s]
training: 604it [01:07,  8.90it/s]
training: 604it [01:07,  8.90it/s]
EPOCH[151]:loss 7.926
[TEST]
{'precision': array([0.02810408, 0.02326797]), 'recall': array([0.06274417, 0.10258029]), 'recall_pop': {0: array([0.00200364, 0.00469832]), 1: array([0.00300465, 0.00663248]), 2: array([0.00347884, 0.00800716]), 3: array([0.00504881, 0.01033958]), 4: array([0.00800366, 0.01707013]), 5: array([0.01369632, 0.02605477]), 6: array([0.02011111, 0.03790671]), 7: array([0.03539049, 0.06024095]), 8: array([0.05916285, 0.09621803]), 9: array([0.08815659, 0.13265113])}, 'recall_pop_Contribute': {0: array([0.00036688, 0.00089273]), 1: array([0.0004754 , 0.00105945]), 2: array([0.0005207 , 0.00118842]), 3: array([0.0007816 , 0.00159749]), 4: array([0.00122781, 0.00261827]), 5: array([0.00232517, 0.00439953]), 6: array([0.00347156, 0.00648479]), 7: array([0.00666755, 0.0112762 ]), 8: array([0.01289346, 0.02097097]), 9: array([0.03401403, 0.05209243])}, 'ndcg': array([0.05226967, 0.06732281])}
total time cost of epoch 151:  77.19799280166626
training: 16it [00:01,  8.50it/s]]
training: 33it [00:03,  8.50it/s]]
training: 50it [00:05,  8.50it/s]]
training: 67it [00:07,  8.47it/s]]
training: 84it [00:09,  8.42it/s]]
training: 101it [00:11,  8.43it/s]
training: 118it [00:14,  8.45it/s]
training: 135it [00:16,  8.41it/s]
training: 152it [00:18,  8.53it/s]
training: 169it [00:20,  8.50it/s]
training: 187it [00:21, 10.50it/s]
training: 209it [00:23, 11.14it/s]
training: 233it [00:26, 11.25it/s]
training: 252it [00:27, 10.74it/s]
training: 276it [00:30, 11.19it/s]
training: 296it [00:31, 11.41it/s]
training: 317it [00:34,  9.20it/s]
training: 334it [00:36,  8.54it/s]
training: 351it [00:38,  8.53it/s]
training: 368it [00:40,  8.55it/s]
training: 385it [00:42,  8.54it/s]
training: 402it [00:44,  8.48it/s]
training: 419it [00:46,  8.47it/s]
training: 436it [00:48,  8.58it/s]
training: 453it [00:50,  8.52it/s]
training: 470it [00:52,  8.46it/s]
training: 487it [00:54,  8.46it/s]
training: 504it [00:56,  8.41it/s]
training: 521it [00:58,  8.56it/s]
training: 538it [01:00,  8.53it/s]
training: 555it [01:02,  8.56it/s]
training: 572it [01:04,  8.52it/s]
training: 589it [01:06,  8.43it/s]
training: 604it [01:07,  8.90it/s]
training: 604it [01:07,  8.90it/s]
EPOCH[152]:loss 7.928
training: 4it [00:00,  6.67it/s]s]
training: 4it [00:00,  6.67it/s]s]
{'precision': array([0.02807566, 0.02328297]), 'recall': array([0.06275555, 0.10272324]), 'recall_pop': {0: array([0.0019668 , 0.00473692]), 1: array([0.00291991, 0.00669979]), 2: array([0.00359199, 0.00804575]), 3: array([0.00513358, 0.01076219]), 4: array([0.00813181, 0.01687893]), 5: array([0.01348328, 0.02626373]), 6: array([0.01991169, 0.03809663]), 7: array([0.03523429, 0.06037662]), 8: array([0.05899771, 0.09615719]), 9: array([0.08816538, 0.13255639])}, 'recall_pop_Contribute': {0: array([0.00035947, 0.0008802 ]), 1: array([0.00047944, 0.00106742]), 2: array([0.00053307, 0.00118974]), 3: array([0.000799  , 0.00166073]), 4: array([0.00124962, 0.00257665]), 5: array([0.00231228, 0.00443096]), 6: array([0.00346435, 0.00652289]), 7: array([0.00667779, 0.01129768]), 8: array([0.01284   , 0.02096256]), 9: array([0.03404054, 0.05213442])}, 'ndcg': array([0.05216815, 0.06728135])}
total time cost of epoch 152:  79.4245777130127
training: 22it [00:02,  8.51it/s]]
training: 36it [00:04,  6.99it/s]]
training: 53it [00:06,  8.38it/s]]
training: 70it [00:08,  8.34it/s]]
training: 86it [00:10,  8.27it/s]]
training: 103it [00:12,  8.38it/s]
training: 120it [00:14,  8.18it/s]
training: 137it [00:16,  8.23it/s]
training: 153it [00:18,  8.34it/s]
training: 170it [00:20,  8.29it/s]
training: 187it [00:22,  8.38it/s]
training: 206it [00:24, 10.49it/s]
training: 228it [00:26, 11.24it/s]
training: 250it [00:28, 10.96it/s]
training: 266it [00:30,  7.48it/s]
training: 288it [00:32, 11.16it/s]
training: 309it [00:34,  9.48it/s]
training: 331it [00:36, 11.01it/s]
training: 348it [00:38,  8.60it/s]
training: 363it [00:40,  7.07it/s]
training: 380it [00:42,  8.45it/s]
training: 397it [00:44,  8.47it/s]
training: 414it [00:46,  8.50it/s]
training: 431it [00:48,  8.59it/s]
training: 448it [00:50,  8.54it/s]
training: 465it [00:52,  8.60it/s]
training: 482it [00:54,  8.51it/s]
training: 500it [00:56,  8.56it/s]
training: 517it [00:58,  8.53it/s]
training: 534it [01:00,  8.55it/s]
training: 551it [01:02,  8.51it/s]
training: 568it [01:04,  8.50it/s]
training: 585it [01:06,  8.51it/s]
training: 601it [01:08,  8.44it/s]
training: 601it [01:08,  8.44it/s]
EPOCH[153]:loss 7.931
training: 604it [01:09,  8.73it/s]
training: 0it [00:00, ?it/s]3it/s]
training: 0it [00:00, ?it/s]3it/s]
{'precision': array([0.02808513, 0.02324981]), 'recall': array([0.06287409, 0.10258041]), 'recall_pop': {0: array([0.00192996, 0.00473723]), 1: array([0.00288439, 0.00684172]), 2: array([0.00359725, 0.00807733]), 3: array([0.00514779, 0.01071772]), 4: array([0.00829913, 0.01695577]), 5: array([0.01329423, 0.02646055]), 6: array([0.01998702, 0.03822621]), 7: array([0.03513876, 0.05981548]), 8: array([0.05954082, 0.09587568]), 9: array([0.08830611, 0.13212809])}, 'recall_pop_Contribute': {0: array([0.00035684, 0.00087808]), 1: array([0.00044896, 0.00107742]), 2: array([0.00052934, 0.00120849]), 3: array([0.00080355, 0.00162986]), 4: array([0.00126903, 0.00257903]), 5: array([0.00227943, 0.00447913]), 6: array([0.0034748 , 0.00653911]), 7: array([0.00661438, 0.0112656 ]), 8: array([0.01301602, 0.02088603]), 9: array([0.03408174, 0.05203765])}, 'ndcg': array([0.05227778, 0.06730021])}
total time cost of epoch 153:  78.75522112846375
training: 17it [00:02,  8.54it/s]]
training: 34it [00:04,  8.56it/s]]
training: 51it [00:06,  8.58it/s]]
training: 68it [00:08,  8.57it/s]]
training: 85it [00:10,  8.54it/s]]
training: 102it [00:12,  8.55it/s]
training: 119it [00:14,  8.47it/s]
training: 136it [00:16,  8.14it/s]
training: 153it [00:18,  8.40it/s]
training: 170it [00:20,  8.45it/s]
training: 187it [00:22,  8.50it/s]
training: 204it [00:24,  8.50it/s]
training: 221it [00:26,  8.56it/s]
training: 240it [00:28, 10.43it/s]
training: 259it [00:30, 10.43it/s]
training: 281it [00:32, 10.58it/s]
training: 301it [00:34, 10.85it/s]
training: 323it [00:36, 11.20it/s]
training: 343it [00:38, 10.81it/s]
training: 365it [00:40, 10.49it/s]
training: 383it [00:42,  8.54it/s]
training: 400it [00:44,  8.48it/s]
training: 417it [00:46,  8.53it/s]
training: 434it [00:48,  8.48it/s]
training: 451it [00:50,  8.48it/s]
training: 468it [00:52,  8.48it/s]
training: 485it [00:54,  8.66it/s]
training: 502it [00:56,  8.46it/s]
training: 519it [00:58,  8.43it/s]
training: 536it [01:00,  8.46it/s]
training: 554it [01:02,  8.54it/s]
training: 571it [01:04,  8.56it/s]
training: 588it [01:06,  8.53it/s]
training: 604it [01:08,  8.86it/s]
training: 604it [01:08,  8.86it/s]
EPOCH[154]:loss 7.925
training: 4it [00:00,  7.97it/s]s]
training: 4it [00:00,  7.97it/s]s]
{'precision': array([0.02805987, 0.02322455]), 'recall': array([0.06265008, 0.10242385]), 'recall_pop': {0: array([0.00195101, 0.00484007]), 1: array([0.00306912, 0.00672277]), 2: array([0.00360357, 0.00805628]), 3: array([0.00525363, 0.01091613]), 4: array([0.00804598, 0.01668578]), 5: array([0.01328843, 0.02591852]), 6: array([0.02014638, 0.03853692]), 7: array([0.03509951, 0.05939915]), 8: array([0.05970559, 0.09578157]), 9: array([0.08762416, 0.1322025 ])}, 'recall_pop_Contribute': {0: array([0.00036354, 0.00091301]), 1: array([0.00047271, 0.001062  ]), 2: array([0.00052087, 0.00121354]), 3: array([0.00081601, 0.00167577]), 4: array([0.00122633, 0.00254893]), 5: array([0.0022567 , 0.00438591]), 6: array([0.00352397, 0.00659837]), 7: array([0.00661853, 0.0111995 ]), 8: array([0.01299786, 0.02087778]), 9: array([0.03385356, 0.05194904])}, 'ndcg': array([0.05219704, 0.06725019])}
total time cost of epoch 154:  77.7199878692627
training: 21it [00:02,  8.49it/s]]
training: 38it [00:04,  8.50it/s]]
training: 55it [00:06,  8.54it/s]]
training: 72it [00:08,  8.47it/s]]
training: 89it [00:10,  8.47it/s]]
training: 106it [00:12,  8.51it/s]
training: 123it [00:14,  8.48it/s]
training: 140it [00:16,  8.53it/s]
training: 157it [00:18,  8.46it/s]
training: 174it [00:20,  8.53it/s]
training: 191it [00:22,  8.48it/s]
training: 208it [00:24,  8.47it/s]
training: 223it [00:26,  8.43it/s]
training: 240it [00:28,  8.52it/s]
training: 257it [00:30,  8.55it/s]
training: 276it [00:32, 10.17it/s]
training: 296it [00:34, 10.73it/s]
training: 318it [00:36, 11.08it/s]
training: 337it [00:38,  9.60it/s]
training: 359it [00:40, 11.26it/s]
training: 381it [00:42,  9.99it/s]
training: 403it [00:44, 10.52it/s]
training: 420it [00:46,  8.49it/s]
training: 437it [00:48,  8.45it/s]
training: 454it [00:50,  8.55it/s]
training: 471it [00:52,  8.52it/s]
training: 488it [00:54,  8.54it/s]
training: 505it [00:56,  8.48it/s]
training: 522it [00:58,  8.49it/s]
training: 539it [01:00,  8.46it/s]
training: 556it [01:02,  8.49it/s]
training: 573it [01:04,  8.48it/s]
training: 590it [01:06,  8.48it/s]
training: 604it [01:08,  8.85it/s]
training: 604it [01:08,  8.85it/s]
EPOCH[155]:loss 7.926
training: 6it [00:00,  7.90it/s]s]
training: 6it [00:00,  7.90it/s]s]
{'precision': array([0.02809934, 0.02323323]), 'recall': array([0.06273608, 0.1023455 ]), 'recall_pop': {0: array([0.00173553, 0.00484451]), 1: array([0.00292439, 0.00676409]), 2: array([0.00356831, 0.00797207]), 3: array([0.00521309, 0.01079877]), 4: array([0.00806756, 0.01682382]), 5: array([0.01329235, 0.0260429 ]), 6: array([0.01992389, 0.03797349]), 7: array([0.035294 , 0.0597959]), 8: array([0.0596632 , 0.09568038]), 9: array([0.08793732, 0.13232863])}, 'recall_pop_Contribute': {0: array([0.00031831, 0.00091092]), 1: array([0.00045777, 0.00107917]), 2: array([0.00050681, 0.00119242]), 3: array([0.00080863, 0.00166284]), 4: array([0.00120813, 0.00253853]), 5: array([0.00224625, 0.00442273]), 6: array([0.00349277, 0.00651099]), 7: array([0.00662863, 0.01123165]), 8: array([0.01305052, 0.02085353]), 9: array([0.03401826, 0.05194271])}, 'ndcg': array([0.052311  , 0.06729758])}
total time cost of epoch 155:  77.74300336837769
training: 23it [00:02,  8.46it/s]]
training: 40it [00:04,  8.53it/s]]
training: 57it [00:06,  8.55it/s]]
training: 74it [00:08,  8.52it/s]]
training: 91it [00:10,  8.49it/s]]
training: 109it [00:12,  8.54it/s]
training: 126it [00:14,  8.48it/s]
training: 143it [00:16,  8.47it/s]
training: 160it [00:18,  8.56it/s]
training: 177it [00:20,  8.52it/s]
training: 194it [00:22,  8.48it/s]
training: 209it [00:24,  8.44it/s]
training: 226it [00:26,  8.54it/s]
training: 243it [00:28,  8.53it/s]
training: 260it [00:30,  8.54it/s]
training: 277it [00:32,  8.51it/s]
training: 294it [00:34,  8.53it/s]
training: 314it [00:36, 10.18it/s]
training: 334it [00:38, 10.64it/s]
training: 356it [00:40, 10.67it/s]
training: 375it [00:42,  9.65it/s]
training: 397it [00:44, 10.72it/s]
training: 417it [00:46, 10.52it/s]
training: 439it [00:48, 10.68it/s]
training: 456it [00:50,  8.43it/s]
training: 473it [00:52,  8.50it/s]
training: 490it [00:54,  8.44it/s]
training: 507it [00:56,  8.50it/s]
training: 524it [00:58,  8.33it/s]
training: 541it [01:00,  8.47it/s]
training: 558it [01:02,  8.48it/s]
training: 575it [01:04,  8.45it/s]
training: 592it [01:06,  8.50it/s]
training: 604it [01:08,  8.83it/s]
training: 604it [01:08,  8.83it/s]
EPOCH[156]:loss 7.928
training: 8it [00:01,  8.36it/s]s]
training: 8it [00:01,  8.36it/s]s]
{'precision': array([0.02809776, 0.02323955]), 'recall': array([0.06263781, 0.10249004]), 'recall_pop': {0: array([0.00188973, 0.0047772 ]), 1: array([0.00293285, 0.00662436]), 2: array([0.00361567, 0.00785085]), 3: array([0.00528151, 0.01083614]), 4: array([0.00810497, 0.01632613]), 5: array([0.01340043, 0.0260825 ]), 6: array([0.01975636, 0.03815888]), 7: array([0.03486882, 0.05997155]), 8: array([0.05970441, 0.09545934]), 9: array([0.0880168 , 0.13286013])}, 'recall_pop_Contribute': {0: array([0.00033326, 0.00089247]), 1: array([0.00046392, 0.00106916]), 2: array([0.00052695, 0.00119084]), 3: array([0.00080756, 0.00165146]), 4: array([0.00122748, 0.00249965]), 5: array([0.00224219, 0.00441692]), 6: array([0.00345547, 0.00649925]), 7: array([0.00653042, 0.01126998]), 8: array([0.01301252, 0.02086218]), 9: array([0.03403805, 0.05213814])}, 'ndcg': array([0.05228328, 0.06732693])}
total time cost of epoch 156:  78.01621961593628
training: 24it [00:02,  8.32it/s]]
training: 41it [00:04,  8.37it/s]]
training: 58it [00:06,  8.47it/s]]
training: 75it [00:09,  8.36it/s]]
training: 92it [00:11,  8.34it/s]]
training: 109it [00:13,  8.37it/s]
training: 125it [00:14,  8.38it/s]
training: 142it [00:16,  8.39it/s]
training: 159it [00:18,  8.36it/s]
training: 175it [00:20,  7.99it/s]
training: 192it [00:22,  8.47it/s]
training: 207it [00:24,  8.41it/s]
training: 224it [00:26,  8.49it/s]
training: 241it [00:28,  8.50it/s]
training: 258it [00:30,  8.53it/s]
training: 275it [00:32,  8.47it/s]
training: 292it [00:34,  8.50it/s]
training: 309it [00:36,  8.49it/s]
training: 327it [00:39,  8.50it/s]
training: 345it [00:40, 10.61it/s]
training: 367it [00:43, 10.84it/s]
training: 389it [00:45, 10.64it/s]
training: 407it [00:47,  9.85it/s]
training: 429it [00:48, 11.44it/s]
training: 451it [00:50, 11.21it/s]
training: 473it [00:52, 10.61it/s]
training: 491it [00:55,  8.55it/s]
training: 508it [00:57,  8.49it/s]
training: 525it [00:59,  8.53it/s]
training: 542it [01:01,  8.54it/s]
training: 559it [01:03,  8.46it/s]
training: 577it [01:05,  8.45it/s]
training: 594it [01:07,  8.50it/s]
training: 604it [01:08,  8.84it/s]
training: 604it [01:08,  8.84it/s]
EPOCH[157]:loss 7.926
training: 10it [00:01,  8.52it/s]]
training: 10it [00:01,  8.52it/s]]
{'precision': array([0.02798251, 0.02327034]), 'recall': array([0.06235605, 0.10260705]), 'recall_pop': {0: array([0.00193394, 0.00462092]), 1: array([0.00303096, 0.00667251]), 2: array([0.00365357, 0.00800941]), 3: array([0.00533782, 0.01071167]), 4: array([0.00781893, 0.01659506]), 5: array([0.01339178, 0.0260774 ]), 6: array([0.01994454, 0.03804049]), 7: array([0.03513457, 0.06018024]), 8: array([0.05865921, 0.09581512]), 9: array([0.08743762, 0.13257726])}, 'recall_pop_Contribute': {0: array([0.00033327, 0.00085343]), 1: array([0.00047203, 0.00106179]), 2: array([0.00052792, 0.00121863]), 3: array([0.00081502, 0.00164591]), 4: array([0.00118133, 0.00255167]), 5: array([0.0022411 , 0.00443138]), 6: array([0.00346024, 0.00650585]), 7: array([0.00661844, 0.01129893]), 8: array([0.01285115, 0.02092308]), 9: array([0.03385553, 0.05211637])}, 'ndcg': array([0.05207615, 0.06730981])}
total time cost of epoch 157:  77.85964393615723
training: 27it [00:03,  8.49it/s]]
training: 44it [00:05,  8.50it/s]]
training: 61it [00:07,  8.55it/s]]
training: 78it [00:09,  8.49it/s]]
training: 95it [00:11,  8.53it/s]]
training: 112it [00:13,  8.49it/s]
training: 129it [00:15,  8.41it/s]
training: 146it [00:17,  8.45it/s]
training: 163it [00:19,  8.54it/s]
training: 180it [00:21,  8.50it/s]
training: 195it [00:23,  5.99it/s]
training: 212it [00:25,  8.53it/s]
training: 229it [00:27,  8.42it/s]
training: 246it [00:29,  8.50it/s]
training: 263it [00:31,  8.53it/s]
training: 280it [00:33,  8.52it/s]
training: 298it [00:35,  8.61it/s]
training: 315it [00:37,  8.55it/s]
training: 332it [00:39,  8.54it/s]
training: 349it [00:41,  8.48it/s]
training: 366it [00:43,  8.55it/s]
training: 384it [00:45, 10.62it/s]
training: 406it [00:47, 10.20it/s]
training: 428it [00:49, 10.41it/s]
training: 440it [00:51,  5.06it/s]
training: 463it [00:53, 11.29it/s]
training: 482it [00:55,  9.60it/s]
training: 506it [00:57, 11.29it/s]
training: 523it [00:59,  8.42it/s]
training: 541it [01:01,  8.63it/s]
training: 558it [01:03,  8.50it/s]
training: 574it [01:05,  8.22it/s]
training: 591it [01:07,  8.52it/s]
training: 604it [01:08,  8.76it/s]
training: 604it [01:08,  8.76it/s]
EPOCH[158]:loss 7.924
training: 7it [00:00,  8.12it/s]s]
training: 7it [00:00,  8.12it/s]s]
{'precision': array([0.02810566, 0.02324507]), 'recall': array([0.06263331, 0.10264509]), 'recall_pop': {0: array([0.00197604, 0.00460995]), 1: array([0.00306386, 0.00663436]), 2: array([0.00352989, 0.0079569 ]), 3: array([0.00533594, 0.01091824]), 4: array([0.00818229, 0.01664754]), 5: array([0.01352938, 0.02538595]), 6: array([0.02011583, 0.0380179 ]), 7: array([0.03512525, 0.0602759 ]), 8: array([0.05866563, 0.09653935]), 9: array([0.08784615, 0.1326164 ])}, 'recall_pop_Contribute': {0: array([0.00033425, 0.00085422]), 1: array([0.00047582, 0.00105064]), 2: array([0.00050816, 0.00120087]), 3: array([0.00081863, 0.00167437]), 4: array([0.00124827, 0.00258204]), 5: array([0.00225166, 0.00427489]), 6: array([0.00349591, 0.00650373]), 7: array([0.00661678, 0.01138188]), 8: array([0.01284059, 0.02098458]), 9: array([0.03404324, 0.05213786])}, 'ndcg': array([0.05221917, 0.06731997])}
total time cost of epoch 158:  78.4276294708252
training: 24it [00:02,  8.49it/s]]
training: 37it [00:04,  8.49it/s]]
training: 54it [00:06,  8.49it/s]]
training: 71it [00:08,  8.52it/s]]
training: 88it [00:10,  8.51it/s]]
training: 105it [00:12,  8.51it/s]
training: 122it [00:14,  8.50it/s]
training: 139it [00:16,  8.52it/s]
training: 156it [00:18,  8.54it/s]
training: 173it [00:20,  8.52it/s]
training: 190it [00:22,  8.51it/s]
training: 205it [00:24,  8.31it/s]
training: 222it [00:26,  8.46it/s]
training: 239it [00:28,  8.51it/s]
training: 256it [00:30,  8.50it/s]
training: 273it [00:32,  8.57it/s]
training: 290it [00:34,  8.30it/s]
training: 307it [00:36,  8.54it/s]
training: 324it [00:38,  8.42it/s]
training: 341it [00:40,  8.50it/s]
training: 358it [00:42,  8.49it/s]
training: 375it [00:44,  8.49it/s]
training: 392it [00:46,  8.56it/s]
training: 410it [00:48,  9.18it/s]
training: 430it [00:50, 10.87it/s]
training: 452it [00:52, 10.91it/s]
training: 472it [00:54, 10.43it/s]
training: 494it [00:56, 11.19it/s]
training: 518it [00:58, 11.20it/s]
training: 540it [01:00, 11.27it/s]
training: 558it [01:02,  8.57it/s]
training: 575it [01:04,  8.41it/s]
training: 592it [01:06,  8.44it/s]
training: 604it [01:08,  8.88it/s]
training: 604it [01:08,  8.88it/s]
EPOCH[159]:loss 7.926
training: 7it [00:00,  7.91it/s]s]
training: 7it [00:00,  7.91it/s]s]
{'precision': array([0.02811671, 0.0233106 ]), 'recall': array([0.06285601, 0.10295923]), 'recall_pop': {0: array([0.00203574, 0.00460125]), 1: array([0.0030086 , 0.00674567]), 2: array([0.00358252, 0.00785813]), 3: array([0.00533256, 0.01098192]), 4: array([0.00818711, 0.01648767]), 5: array([0.01317264, 0.02559229]), 6: array([0.02050128, 0.03795381]), 7: array([0.03483479, 0.06034281]), 8: array([0.05863249, 0.09641047]), 9: array([0.0885497 , 0.13355988])}, 'recall_pop_Contribute': {0: array([0.00035405, 0.00084976]), 1: array([0.00048315, 0.00107838]), 2: array([0.00051561, 0.00116512]), 3: array([0.00081263, 0.00166516]), 4: array([0.00126022, 0.0025309 ]), 5: array([0.00218871, 0.00433218]), 6: array([0.0035423 , 0.00649473]), 7: array([0.00657532, 0.01136158]), 8: array([0.01283806, 0.02100838]), 9: array([0.03428597, 0.05247304])}, 'ndcg': array([0.05219517, 0.06735877])}
total time cost of epoch 159:  77.65211057662964
training: 24it [00:02,  8.36it/s]]
training: 41it [00:04,  8.61it/s]]
training: 58it [00:06,  8.56it/s]]
training: 75it [00:08,  8.45it/s]]
training: 92it [00:10,  8.49it/s]]
training: 109it [00:12,  8.44it/s]
training: 126it [00:14,  8.41it/s]
training: 143it [00:16,  8.45it/s]
training: 160it [00:18,  8.50it/s]
training: 177it [00:20,  8.52it/s]
training: 193it [00:22,  8.53it/s]
training: 209it [00:24,  8.44it/s]
training: 226it [00:26,  8.49it/s]
training: 243it [00:28,  8.50it/s]
training: 260it [00:30,  8.50it/s]
training: 277it [00:32,  8.43it/s]
training: 294it [00:34,  8.56it/s]
training: 311it [00:36,  8.51it/s]
training: 328it [00:38,  8.50it/s]
training: 345it [00:40,  8.50it/s]
training: 362it [00:43,  7.88it/s]
training: 379it [00:45,  8.50it/s]
training: 396it [00:47,  8.51it/s]
training: 413it [00:49,  8.47it/s]
training: 430it [00:51,  8.50it/s]
training: 446it [00:52,  8.95it/s]
training: 468it [00:55, 10.23it/s]
training: 488it [00:56, 10.24it/s]
training: 509it [00:58,  9.40it/s]
training: 528it [01:00, 11.03it/s]
training: 552it [01:03, 11.31it/s]
training: 572it [01:04, 11.06it/s]
training: 592it [01:07,  8.62it/s]
training: 604it [01:08,  8.82it/s]
training: 604it [01:08,  8.82it/s]
EPOCH[160]:loss 7.926
training: 8it [00:01,  8.28it/s]s]
training: 8it [00:01,  8.28it/s]s]
{'precision': array([0.02801724, 0.02328612]), 'recall': array([0.06252409, 0.10292225]), 'recall_pop': {0: array([0.00199868, 0.00473469]), 1: array([0.00309412, 0.00671567]), 2: array([0.00343516, 0.00797233]), 3: array([0.00510332, 0.01085035]), 4: array([0.00808053, 0.01632139]), 5: array([0.01323445, 0.02565996]), 6: array([0.02046175, 0.03815241]), 7: array([0.03482312, 0.06022173]), 8: array([0.05858139, 0.09682463]), 9: array([0.08798454, 0.13273388])}, 'recall_pop_Contribute': {0: array([0.00036314, 0.00085751]), 1: array([0.00049344, 0.0010617 ]), 2: array([0.00049912, 0.00118273]), 3: array([0.00078289, 0.00163674]), 4: array([0.00123405, 0.0025171 ]), 5: array([0.0022272 , 0.00435222]), 6: array([0.00353613, 0.00654335]), 7: array([0.00657734, 0.01137185]), 8: array([0.01278373, 0.02109721]), 9: array([0.03402706, 0.05230185])}, 'ndcg': array([0.05208714, 0.06735493])}
total time cost of epoch 160:  78.03102684020996
training: 25it [00:03,  8.48it/s]]
training: 42it [00:05,  8.55it/s]]
training: 59it [00:07,  8.56it/s]]
training: 76it [00:08,  8.90it/s]]
training: 93it [00:10,  8.49it/s]]
training: 110it [00:12,  8.50it/s]
training: 128it [00:15,  8.54it/s]
training: 145it [00:17,  8.34it/s]
training: 162it [00:19,  8.45it/s]
training: 178it [00:20,  8.46it/s]
training: 195it [00:22,  8.43it/s]
training: 211it [00:25,  8.48it/s]
training: 228it [00:27,  8.52it/s]
training: 245it [00:29,  8.47it/s]
training: 262it [00:31,  8.52it/s]
training: 279it [00:33,  8.47it/s]
training: 296it [00:35,  8.43it/s]
training: 313it [00:37,  8.48it/s]
training: 329it [00:39,  8.47it/s]
training: 346it [00:41,  8.25it/s]
training: 363it [00:43,  8.45it/s]
training: 380it [00:45,  8.43it/s]
training: 397it [00:47,  8.31it/s]
training: 414it [00:49,  8.51it/s]
training: 431it [00:51,  8.34it/s]
training: 448it [00:53,  8.47it/s]
training: 465it [00:55,  8.41it/s]
training: 482it [00:57,  8.45it/s]
training: 503it [00:59, 10.99it/s]
training: 523it [01:00, 10.86it/s]
training: 545it [01:02, 10.81it/s]
training: 564it [01:05, 10.42it/s]
training: 586it [01:07, 11.40it/s]
training: 604it [01:08,  8.77it/s]
training: 604it [01:08,  8.77it/s]
EPOCH[161]:loss 7.926
training: 6it [00:00,  8.18it/s]s]
training: 6it [00:00,  8.18it/s]s]
{'precision': array([0.02813882, 0.02329481]), 'recall': array([0.06277221, 0.10267897]), 'recall_pop': {0: array([0.0019968 , 0.00450939]), 1: array([0.00311254, 0.00670953]), 2: array([0.00351199, 0.00795926]), 3: array([0.00537391, 0.01073561]), 4: array([0.00800554, 0.01639439]), 5: array([0.01337545, 0.02554605]), 6: array([0.02025468, 0.0378966 ]), 7: array([0.03460976, 0.06050537]), 8: array([0.05896223, 0.09591398]), 9: array([0.0886363, 0.1331676])}, 'recall_pop_Contribute': {0: array([0.00035757, 0.00083408]), 1: array([0.00050615, 0.00105816]), 2: array([0.00049381, 0.00117334]), 3: array([0.00083676, 0.00164167]), 4: array([0.00120821, 0.00252626]), 5: array([0.00223522, 0.0043021 ]), 6: array([0.00351937, 0.00650031]), 7: array([0.00652639, 0.01134653]), 8: array([0.01281163, 0.0208849 ]), 9: array([0.03427711, 0.05241162])}, 'ndcg': array([0.05227126, 0.06736292])}
total time cost of epoch 161:  78.37125873565674
training: 23it [00:02,  8.43it/s]]
training: 39it [00:04,  8.42it/s]]
training: 56it [00:06,  8.50it/s]]
training: 73it [00:08,  8.40it/s]]
training: 90it [00:10,  8.50it/s]]
training: 107it [00:12,  8.55it/s]
training: 125it [00:14,  8.94it/s]
training: 141it [00:16,  8.52it/s]
training: 158it [00:18,  8.42it/s]
training: 175it [00:20,  8.52it/s]
training: 192it [00:22,  8.44it/s]
training: 207it [00:24,  8.43it/s]
training: 224it [00:26,  8.51it/s]
training: 241it [00:28,  8.37it/s]
training: 258it [00:30,  8.45it/s]
training: 274it [00:32,  8.50it/s]
training: 291it [00:34,  8.39it/s]
training: 308it [00:36,  8.49it/s]
training: 325it [00:38,  8.51it/s]
training: 342it [00:40,  8.57it/s]
training: 359it [00:42,  8.45it/s]
training: 376it [00:44,  8.44it/s]
training: 393it [00:46,  8.43it/s]
training: 410it [00:48,  8.39it/s]
training: 427it [00:50,  8.45it/s]
training: 444it [00:52,  8.51it/s]
training: 461it [00:54,  8.46it/s]
training: 478it [00:56,  8.54it/s]
training: 495it [00:58,  8.44it/s]
training: 511it [01:00,  8.35it/s]
training: 528it [01:02,  8.42it/s]
training: 548it [01:04, 10.24it/s]
training: 570it [01:06, 11.04it/s]
training: 592it [01:08, 11.02it/s]
training: 604it [01:10,  8.59it/s]
training: 604it [01:10,  8.59it/s]
EPOCH[162]:loss 7.927
