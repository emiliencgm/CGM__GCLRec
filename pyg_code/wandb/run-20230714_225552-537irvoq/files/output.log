==========config==========
{'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'testing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 50,
 'epochs': 500,
 'freeze_mlp': 500,
 'group': 'Ours',
 'if_adaptive': 1,
 'if_double_label': 1,
 'if_multicore': 1,
 'if_projector': 0,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'job_type': 'yelp2018',
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'simple_Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'name': 'mixup',
 'notes': '3InfoNCE',
 'num_layers': 3,
 'perplexity': 50,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'sampling': 'uiij',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'tag': ['mixup'],
 'temp_tau': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'visual_epoch': 3,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
31668 users and 38048 items
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0007901191711425781
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/pyg_code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.08203959465026855
shape test : 2474518 == 2474518
precal cost :  0.6886422634124756
[PRECALCULATE--END]
[SAMPLER--START]
[SAMPLER--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[TRAIN]



























training: 602it [00:55, 11.15it/s]
EPOCH[0]:loss 6.143

training: 604it [00:55, 10.83it/s]
{'precision': array([0.01970128, 0.01665561]), 'recall': array([0.04200741, 0.07079954]), 'recall_pop': {0: array([0.00013789, 0.00030157]), 1: array([7.57862827e-05, 5.75765231e-04]), 2: array([0.00028262, 0.00083053]), 3: array([0.00051314, 0.00185229]), 4: array([0.00096771, 0.00234383]), 5: array([0.00151187, 0.00473526]), 6: array([0.00316541, 0.00835893]), 7: array([0.00766462, 0.01829262]), 8: array([0.02144318, 0.04343862]), 9: array([0.09197685, 0.142984  ])}, 'recall_pop_Contribute': {0: array([2.79693168e-05, 6.69839648e-05]), 1: array([1.88629035e-05, 1.01911806e-04]), 2: array([5.21261743e-05, 1.29499515e-04]), 3: array([7.68499125e-05, 2.73411936e-04]), 4: array([0.00014931, 0.00037882]), 5: array([0.00027209, 0.00077015]), 6: array([0.00051968, 0.00139025]), 7: array([0.00147521, 0.00341261]), 8: array([0.00473846, 0.00943135]), 9: array([0.03467686, 0.05484454])}, 'ndcg': array([0.0348572 , 0.04568835])}
training: 3it [00:00,  8.71it/s]
[5mfind a better recall[25m 0.042007409320487195 ++0.042007409320487195
total time cost of epoch 0:  65.0718264579773



























training: 604it [00:54, 11.15it/s]
EPOCH[1]:loss 4.648
[TEST]
{'precision': array([0.02311324, 0.01936103]), 'recall': array([0.05076363, 0.08444316]), 'recall_pop': {0: array([0.00038735, 0.00139655]), 1: array([0.00084996, 0.00254888]), 2: array([0.00123314, 0.00304517]), 3: array([0.00185154, 0.00491785]), 4: array([0.00308056, 0.00793557]), 5: array([0.005512  , 0.01285865]), 6: array([0.00882097, 0.02025271]), 7: array([0.01684234, 0.0340501 ]), 8: array([0.03714921, 0.06652659]), 9: array([0.09282982, 0.13963418])}, 'recall_pop_Contribute': {0: array([0.00010204, 0.00027339]), 1: array([0.00013474, 0.00042403]), 2: array([0.0001906 , 0.00045087]), 3: array([0.00028694, 0.0007661 ]), 4: array([0.00049894, 0.00121255]), 5: array([0.00094068, 0.00208311]), 6: array([0.00142772, 0.00344478]), 7: array([0.00320904, 0.00650032]), 8: array([0.00820537, 0.01464766]), 9: array([0.03576756, 0.05464034])}, 'ndcg': array([0.04206544, 0.05477919])}
training: 3it [00:00,  9.21it/s]
[5mfind a better recall[25m 0.050763629615808895 ++0.0087562202953217
total time cost of epoch 1:  64.2377462387085


























training: 580it [00:52, 11.10it/s]

training: 582it [00:52, 11.07it/s]