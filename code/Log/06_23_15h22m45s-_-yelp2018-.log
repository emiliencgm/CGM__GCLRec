==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[0;30;43m[DATALOADER--START][0m
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
[0;30;43mRemember to delete this pre-calculed mat while changing data split ![0m
yelp2018 is ready to go
[0;30;43m[DATALOADER--END][0m
[0;30;43m[PRECALCULATE--START][0m
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0008924007415771484
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07367300987243652
shape test : 2474518 == 2474518
precal cost :  0.7970035076141357
[0;30;43m[PRECALCULATE--END][0m
user:31668, item:38048
[0;30;43muse NORMAL distribution UI for Embedding[0m
GCL Model is ready to go!
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[0]:loss 6.931
[0;30;43m[TEST][0m
{'precision': array([0.01974391, 0.01647246]), 'recall': array([0.04184855, 0.06978312]), 'recall_pop': {0: array([0.00000000e+00, 4.99978948e-05]), 1: array([0.       , 0.0001421]), 2: array([9.47328534e-05, 2.84198560e-04]), 3: array([0.00022894, 0.00098522]), 4: array([0.00022104, 0.00094075]), 5: array([0.0006905 , 0.00227422]), 6: array([0.00154076, 0.00418295]), 7: array([0.00408777, 0.00910722]), 8: array([0.01337147, 0.02981873]), 9: array([0.09993881, 0.15665855])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 7.79547707e-06]), 1: array([0.000000e+00, 1.776241e-05]), 2: array([9.28966091e-06, 3.89312700e-05]), 3: array([3.74337364e-05, 1.72096515e-04]), 4: array([3.52263518e-05, 1.51858870e-04]), 5: array([9.86979307e-05, 3.92556301e-04]), 6: array([0.00025409, 0.00073272]), 7: array([0.00075332, 0.00172083]), 8: array([0.00287634, 0.00648553]), 9: array([0.03778415, 0.06006304])}, 'ndcg': array([0.03454052, 0.04497428])}
[5;37;44mfind a better recall[0m [0;37;44m0.041848549001545395[0m [0;37;44m++0.041848549001545395[0m
total time cost of epoch 0:  67.6832525730133
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[1]:loss 5.283
[0;30;43m[TEST][0m
{'precision': array([0.02383794, 0.01988206]), 'recall': array([0.05199504, 0.08606826]), 'recall_pop': {0: array([3.15776178e-05, 2.90514084e-04]), 1: array([0.00023788, 0.00087219]), 2: array([0.00036607, 0.00113815]), 3: array([0.00066287, 0.00276658]), 4: array([0.00145889, 0.00388852]), 5: array([0.00215517, 0.00607972]), 6: array([0.00383341, 0.01032722]), 7: array([0.0095055 , 0.02148303]), 8: array([0.02521818, 0.05005884]), 9: array([0.11221398, 0.17029955])}, 'recall_pop_Contribute': {0: array([4.51108825e-06, 5.79315408e-05]), 1: array([4.39690476e-05, 1.38646735e-04]), 2: array([4.67770768e-05, 1.83564260e-04]), 3: array([0.00011959, 0.00046843]), 4: array([0.0002395 , 0.00061155]), 5: array([0.00035164, 0.00101959]), 6: array([0.00063859, 0.00175079]), 7: array([0.00179937, 0.00404845]), 8: array([0.00545701, 0.01094688]), 9: array([0.0432941 , 0.06684243])}, 'ndcg': array([0.04277971, 0.05559875])}
[5;37;44mfind a better recall[0m [0;37;44m0.051995039874133626[0m [0;37;44m++0.010146490872588232[0m
total time cost of epoch 1:  65.71044039726257
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[2]:loss 5.004
[0;30;43m[TEST][0m
{'precision': array([0.02617311, 0.02180513]), 'recall': array([0.05768183, 0.09520623]), 'recall_pop': {0: array([0.00032157, 0.00086575]), 1: array([0.00053787, 0.00222061]), 2: array([0.00094105, 0.0026394 ]), 3: array([0.00180812, 0.0049567 ]), 4: array([0.00269519, 0.00623478]), 5: array([0.00438702, 0.0100161 ]), 6: array([0.00675096, 0.01699648]), 7: array([0.01412989, 0.03027279]), 8: array([0.03113694, 0.05984643]), 9: array([0.115608  , 0.17273797])}, 'recall_pop_Contribute': {0: array([7.01782951e-05, 1.66415395e-04]), 1: array([0.00010137, 0.00036269]), 2: array([0.00013594, 0.00041348]), 3: array([0.00028584, 0.0008006 ]), 4: array([0.00043999, 0.00097729]), 5: array([0.00077186, 0.0016924 ]), 6: array([0.00109675, 0.00292621]), 7: array([0.00268308, 0.00570548]), 8: array([0.0067997 , 0.01319675]), 9: array([0.04529712, 0.0689649 ])}, 'ndcg': array([0.04760033, 0.06174959])}
[5;37;44mfind a better recall[0m [0;37;44m0.05768183379764157[0m [0;37;44m++0.005686793923507946[0m
total time cost of epoch 2:  66.18519067764282
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[3]:loss 4.848
[0;30;43m[TEST][0m
{'precision': array([0.02732411, 0.02290483]), 'recall': array([0.06031396, 0.1002094 ]), 'recall_pop': {0: array([0.00064629, 0.00202638]), 1: array([0.00106732, 0.00347231]), 2: array([0.00159734, 0.00407731]), 3: array([0.00252971, 0.00615766]), 4: array([0.00369672, 0.00913974]), 5: array([0.00575255, 0.0134737 ]), 6: array([0.00938741, 0.02091792]), 7: array([0.01703183, 0.03522077]), 8: array([0.03445508, 0.06607766]), 9: array([0.11518529, 0.1721985 ])}, 'recall_pop_Contribute': {0: array([0.0001167 , 0.00039333]), 1: array([0.00017994, 0.00054799]), 2: array([0.00023685, 0.000629  ]), 3: array([0.00038314, 0.00097746]), 4: array([0.00058005, 0.00140299]), 5: array([0.00096747, 0.00221528]), 6: array([0.00159948, 0.00360923]), 7: array([0.00320082, 0.00665791]), 8: array([0.00756607, 0.01454431]), 9: array([0.04548345, 0.0692319 ])}, 'ndcg': array([0.05031765, 0.06537796])}
[5;37;44mfind a better recall[0m [0;37;44m0.06031396476633562[0m [0;37;44m++0.002632130968694045[0m
total time cost of epoch 3:  65.75072264671326
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[4]:loss 4.756
[0;30;43m[TEST][0m
{'precision': array([0.02828091, 0.02347796]), 'recall': array([0.06269043, 0.10358391]), 'recall_pop': {0: array([0.00096432, 0.00301414]), 1: array([0.00171466, 0.00416351]), 2: array([0.00201574, 0.00484467]), 3: array([0.00293991, 0.00703622]), 4: array([0.0046651 , 0.01060508]), 5: array([0.00710386, 0.01610262]), 6: array([0.01156183, 0.02420566]), 7: array([0.01973302, 0.03947953]), 8: array([0.03765781, 0.07045312]), 9: array([0.11523353, 0.17092851])}, 'recall_pop_Contribute': {0: array([0.00018822, 0.0005986 ]), 1: array([0.00028385, 0.00066601]), 2: array([0.00029335, 0.00073808]), 3: array([0.00043568, 0.00108023]), 4: array([0.00073648, 0.00166259]), 5: array([0.00119229, 0.00267657]), 6: array([0.001985  , 0.00417047]), 7: array([0.00375499, 0.00746957]), 8: array([0.008215  , 0.01552372]), 9: array([0.04560556, 0.06899807])}, 'ndcg': array([0.05208681, 0.06743524])}
[5;37;44mfind a better recall[0m [0;37;44m0.06269042825523563[0m [0;37;44m++0.002376463488900013[0m
total time cost of epoch 4:  65.7864408493042
[0;30;43m[AUGMENT][0m
