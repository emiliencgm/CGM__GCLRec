==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 1,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'SimGCL',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'SimGCL+infoNCE+AdaLoss',
 'notes': 'SimGCL+InfoNCE_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'forkmerge',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[0;30;43m[DATALOADER--START][0m
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1093508 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0011765708510383113
loading adjacency matrix
successfully loaded...
[0;30;43mRemember to delete this pre-calculed mat while changing data split ![0m
yelp2018 is ready to go
[0;30;43m[DATALOADER--END][0m
[0;30;43m[PRECALCULATE--START][0m
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0008912086486816406
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.08024764060974121
shape test : 2474518 == 2187016
precal cost :  0.8929393291473389
[0;30;43m[PRECALCULATE--END][0m
user:31668, item:38048
[0;30;43muse NORMAL distribution UI for Embedding[0m
GCL Model is ready to go!
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[0]:loss 22.987
[0;30;43m[valid][0m
VALID {'precision': array([0.01252053, 0.01002195]), 'recall': array([0.05674532, 0.09032862]), 'ndcg': array([0.03521353, 0.04532122])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.056745323888678076[0m [0;37;44m++0.056745323888678076[0m
[0;30;43m[TEST][0m
{'precision': array([0.01800398, 0.01500332]), 'recall': array([0.03793085, 0.06261296]), 'recall_pop': {0: array([0.00015368, 0.00029315]), 1: array([0.00022999, 0.00051945]), 2: array([0.0002842 , 0.00058343]), 3: array([0.00034209, 0.00120346]), 4: array([0.00057366, 0.00156203]), 5: array([0.00097364, 0.00291621]), 6: array([0.00195815, 0.00554428]), 7: array([0.00569477, 0.01267788]), 8: array([0.0162855 , 0.03102181]), 9: array([0.08981796, 0.140761  ])}, 'recall_pop_Contribute': {0: array([3.15777289e-05, 6.10583940e-05]), 1: array([4.33618719e-05, 8.92916713e-05]), 2: array([4.50493677e-05, 8.46974242e-05]), 3: array([5.02546448e-05, 1.74421889e-04]), 4: array([7.45252912e-05, 2.27188763e-04]), 5: array([0.00016661, 0.00049475]), 6: array([0.00032481, 0.00097219]), 7: array([0.00108869, 0.00236343]), 8: array([0.00347127, 0.00664059]), 9: array([0.03263471, 0.05150534])}, 'ndcg': array([0.03135626, 0.04069625])}
[5;37;44mfind a better recall[0m [0;37;44m0.037930854888945716[0m [0;37;44m++0.037930854888945716[0m
total time cost of epoch 0:  528.5976386070251
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[1]:loss 22.390
[0;30;43m[valid][0m
VALID {'precision': array([0.01468991, 0.01177766]), 'recall': array([0.06908221, 0.10961592]), 'ndcg': array([0.04280011, 0.05496285])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06908221385234314[0m [0;37;44m++0.012336889963665068[0m
[0;30;43m[TEST][0m
{'precision': array([0.02111437, 0.01761794]), 'recall': array([0.04565578, 0.07564874]), 'recall_pop': {0: array([0.00022394, 0.0006626 ]), 1: array([0.00056343, 0.00132498]), 2: array([0.00038555, 0.00134206]), 3: array([0.00093505, 0.00243423]), 4: array([0.00119906, 0.00290486]), 5: array([0.00184861, 0.00537186]), 6: array([0.00402096, 0.0101587 ]), 7: array([0.00953206, 0.0204208 ]), 8: array([0.02289156, 0.04302448]), 9: array([0.10151431, 0.15755785])}, 'recall_pop_Contribute': {0: array([4.76667967e-05, 1.42918453e-04]), 1: array([7.43797318e-05, 1.76150935e-04]), 2: array([4.52830884e-05, 1.90290969e-04]), 3: array([0.00013226, 0.00036219]), 4: array([0.00014824, 0.00039115]), 5: array([0.00032644, 0.00085984]), 6: array([0.00066987, 0.00174745]), 7: array([0.00180729, 0.00375889]), 8: array([0.00491859, 0.00933076]), 9: array([0.03748577, 0.0586891 ])}, 'ndcg': array([0.03764918, 0.04900764])}
[5;37;44mfind a better recall[0m [0;37;44m0.0456557811614823[0m [0;37;44m++0.007724926272536584[0m
total time cost of epoch 1:  532.9079010486603
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[2]:loss 21.705
[0;30;43m[valid][0m
VALID {'precision': array([0.01543988, 0.01226554]), 'recall': array([0.07437006, 0.11589193]), 'ndcg': array([0.04597532, 0.0584588 ])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07437005642527267[0m [0;37;44m++0.005287842572929524[0m
[0;30;43m[TEST][0m
{'precision': array([0.02219433, 0.01843501]), 'recall': array([0.04841199, 0.08000187]), 'recall_pop': {0: array([0.0006929, 0.0013337]), 1: array([0.00138182, 0.00275375]), 2: array([0.00098313, 0.00220368]), 3: array([0.00171923, 0.00398297]), 4: array([0.00210718, 0.00438817]), 5: array([0.00322153, 0.00800703]), 6: array([0.00647022, 0.01399624]), 7: array([0.01214721, 0.02445597]), 8: array([0.02591108, 0.0473264 ]), 9: array([0.10235223, 0.1589558 ])}, 'recall_pop_Contribute': {0: array([0.00013376, 0.00027844]), 1: array([0.00018588, 0.00035966]), 2: array([0.0001364 , 0.00030801]), 3: array([0.00022723, 0.00057584]), 4: array([0.00028048, 0.00063669]), 5: array([0.00053183, 0.00125242]), 6: array([0.0011071 , 0.00234294]), 7: array([0.00225569, 0.00450386]), 8: array([0.00556938, 0.01031255]), 9: array([0.03798423, 0.05943146])}, 'ndcg': array([0.03998083, 0.05192267])}
[5;37;44mfind a better recall[0m [0;37;44m0.048411994901342154[0m [0;37;44m++0.0027562137398598544[0m
total time cost of epoch 2:  539.9408936500549
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[3]:loss 21.282
[0;30;43m[valid][0m
VALID {'precision': array([0.01543672, 0.01232159]), 'recall': array([0.0749397 , 0.11829938]), 'ndcg': array([0.0464822 , 0.05943401])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0749397023307695[0m [0;37;44m++0.0005696459054968378[0m
[0;30;43m[TEST][0m
{'precision': array([0.02269799, 0.01863474]), 'recall': array([0.0497418 , 0.08128114]), 'recall_pop': {0: array([0.00114827, 0.00237643]), 1: array([0.0021937 , 0.00442342]), 2: array([0.00167784, 0.00325123]), 3: array([0.00240146, 0.00506849]), 4: array([0.00326148, 0.00597258]), 5: array([0.00462542, 0.01010768]), 6: array([0.0077786 , 0.01619672]), 7: array([0.01370532, 0.02641212]), 8: array([0.02728372, 0.04828171]), 9: array([0.10192282, 0.15713514])}, 'recall_pop_Contribute': {0: array([0.00022754, 0.00045652]), 1: array([0.00029948, 0.00061313]), 2: array([0.00022167, 0.00043182]), 3: array([0.00031729, 0.00071327]), 4: array([0.00043236, 0.00084826]), 5: array([0.00071995, 0.00158725]), 6: array([0.00130976, 0.00272893]), 7: array([0.00252561, 0.00484636]), 8: array([0.0058198 , 0.01049859]), 9: array([0.03786833, 0.05855701])}, 'ndcg': array([0.04100167, 0.05288712])}
[5;37;44mfind a better recall[0m [0;37;44m0.04974179766627862[0m [0;37;44m++0.0013298027649364663[0m
total time cost of epoch 3:  547.3802673816681
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[4]:loss 21.032
[0;30;43m[valid][0m
