==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[0;30;43m[DATALOADER--START][0m
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
[0;30;43mRemember to delete this pre-calculed mat while changing data split ![0m
yelp2018 is ready to go
[0;30;43m[DATALOADER--END][0m
[0;30;43m[PRECALCULATE--START][0m
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0008826255798339844
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07413530349731445
shape test : 2474518 == 2474518
precal cost :  0.8425216674804688
[0;30;43m[PRECALCULATE--END][0m
user:31668, item:38048
[0;30;43muse NORMAL distribution UI for Embedding[0m
GCL Model is ready to go!
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[0]:loss 2.999
[0;30;43m[TEST][0m
{'precision': array([0.01502621, 0.01282367]), 'recall': array([0.03233171, 0.05481979]), 'recall_pop': {0: array([0.00030455, 0.00077421]), 1: array([0.00051712, 0.00167685]), 2: array([0.00068888, 0.00203418]), 3: array([0.00103082, 0.00303977]), 4: array([0.00183101, 0.00411115]), 5: array([0.00302636, 0.00752148]), 6: array([0.00395868, 0.00986513]), 7: array([0.00896716, 0.01799927]), 8: array([0.01862568, 0.03531387]), 9: array([0.06279948, 0.09811922])}, 'recall_pop_Contribute': {0: array([6.15296366e-05, 1.64897311e-04]), 1: array([7.73647692e-05, 2.46448662e-04]), 2: array([9.67392038e-05, 3.05983116e-04]), 3: array([0.00016754, 0.00044407]), 4: array([0.00027236, 0.00062418]), 5: array([0.00049869, 0.00127935]), 6: array([0.00060855, 0.00160235]), 7: array([0.0017121 , 0.00341386]), 8: array([0.00407648, 0.00766651]), 9: array([0.02476035, 0.03907213])}, 'ndcg': array([0.02674387, 0.03526895])}
[5;37;44mfind a better recall[0m [0;37;44m0.03233171340556489[0m [0;37;44m++0.03233171340556489[0m
total time cost of epoch 0:  30.417656183242798
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[1]:loss 1.881
[0;30;43m[TEST][0m
{'precision': array([0.01921972, 0.01595775]), 'recall': array([0.04280776, 0.07072528]), 'recall_pop': {0: array([0.00088221, 0.00232233]), 1: array([0.0016179 , 0.00388734]), 2: array([0.00160738, 0.00377542]), 3: array([0.00257171, 0.00648545]), 4: array([0.00411032, 0.00877827]), 5: array([0.00687473, 0.01341263]), 6: array([0.00846646, 0.01686106]), 7: array([0.01501419, 0.02718087]), 8: array([0.02807574, 0.04912825]), 9: array([0.07330167, 0.11201626])}, 'recall_pop_Contribute': {0: array([0.0001789 , 0.00045716]), 1: array([0.00026285, 0.00058716]), 2: array([0.00021766, 0.00054438]), 3: array([0.00039398, 0.00097488]), 4: array([0.00064506, 0.00132124]), 5: array([0.00110809, 0.00222905]), 6: array([0.00139679, 0.00284251]), 7: array([0.00277944, 0.00515782]), 8: array([0.00619224, 0.01075998]), 9: array([0.02963275, 0.04585109])}, 'ndcg': array([0.03504142, 0.04561763])}
[5;37;44mfind a better recall[0m [0;37;44m0.04280775513393174[0m [0;37;44m++0.010476041728366844[0m
total time cost of epoch 1:  29.971333026885986
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[2]:loss 1.678
[0;30;43m[TEST][0m
{'precision': array([0.02098333, 0.01740164]), 'recall': array([0.04753742, 0.07772691]), 'recall_pop': {0: array([0.00178638, 0.00442957]), 1: array([0.00263885, 0.00603129]), 2: array([0.00284269, 0.00582513]), 3: array([0.00387477, 0.00825825]), 4: array([0.00570212, 0.01136849]), 5: array([0.00892317, 0.01731882]), 6: array([0.01178319, 0.02153032]), 7: array([0.01870762, 0.03283236]), 8: array([0.03207559, 0.05486537]), 9: array([0.07449598, 0.11393245])}, 'recall_pop_Contribute': {0: array([0.00035679, 0.00081523]), 1: array([0.00040155, 0.000901  ]), 2: array([0.00040977, 0.00083084]), 3: array([0.00058539, 0.00125339]), 4: array([0.0008762 , 0.00170328]), 5: array([0.00151364, 0.00289041]), 6: array([0.00200007, 0.00367592]), 7: array([0.00352489, 0.00619599]), 8: array([0.00704576, 0.01212243]), 9: array([0.03082335, 0.04733842])}, 'ndcg': array([0.03897445, 0.05048655])}
[5;37;44mfind a better recall[0m [0;37;44m0.04753742131316847[0m [0;37;44m++0.00472966617923673[0m
total time cost of epoch 2:  29.84919023513794
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[3]:loss 1.562
[0;30;43m[TEST][0m
{'precision': array([0.02182329, 0.01822344]), 'recall': array([0.04944407, 0.08166625]), 'recall_pop': {0: array([0.00254515, 0.0057792 ]), 1: array([0.00375711, 0.0080571 ]), 2: array([0.00379047, 0.00747697]), 3: array([0.00473214, 0.01010211]), 4: array([0.00683413, 0.0140464 ]), 5: array([0.01027608, 0.01968016]), 6: array([0.01342992, 0.0251954 ]), 7: array([0.02070431, 0.03749603]), 8: array([0.03355988, 0.05817648]), 9: array([0.07405691, 0.11248623])}, 'recall_pop_Contribute': {0: array([0.00047403, 0.00107376]), 1: array([0.00057795, 0.00119399]), 2: array([0.00054283, 0.00107888]), 3: array([0.00071561, 0.00154558]), 4: array([0.00104695, 0.00207542]), 5: array([0.00171566, 0.00333067]), 6: array([0.00230101, 0.00427366]), 7: array([0.00389244, 0.00708116]), 8: array([0.00742352, 0.01278337]), 9: array([0.03075407, 0.04722976])}, 'ndcg': array([0.04084645, 0.05313015])}
[5;37;44mfind a better recall[0m [0;37;44m0.049444073107133876[0m [0;37;44m++0.0019066517939654096[0m
total time cost of epoch 3:  29.604921340942383
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[4]:loss 1.487
[0;30;43m[TEST][0m
{'precision': array([0.02241537, 0.01874763]), 'recall': array([0.05112396, 0.08448811]), 'recall_pop': {0: array([0.00314945, 0.00702971]), 1: array([0.00466047, 0.0092183 ]), 2: array([0.0045249 , 0.00861008]), 3: array([0.00537464, 0.01135573]), 4: array([0.00798536, 0.01538608]), 5: array([0.01123106, 0.02168611]), 6: array([0.01451029, 0.02707654]), 7: array([0.02148621, 0.03962278]), 8: array([0.0361347 , 0.06021853]), 9: array([0.07331473, 0.11212303])}, 'recall_pop_Contribute': {0: array([0.00058814, 0.00135225]), 1: array([0.00069972, 0.00140712]), 2: array([0.00065963, 0.00122658]), 3: array([0.00079228, 0.00172214]), 4: array([0.00123444, 0.00233604]), 5: array([0.00187165, 0.00360073]), 6: array([0.00248784, 0.004686  ]), 7: array([0.00408314, 0.00755683]), 8: array([0.00793604, 0.01334532]), 9: array([0.03077107, 0.04725509])}, 'ndcg': array([0.04213673, 0.05485932])}
[5;37;44mfind a better recall[0m [0;37;44m0.05112395661213562[0m [0;37;44m++0.0016798835050017419[0m
total time cost of epoch 4:  29.45935583114624
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[5]:loss 1.438
[0;30;43m[TEST][0m
{'precision': array([0.0227122 , 0.01892999]), 'recall': array([0.0519176 , 0.08543359]), 'recall_pop': {0: array([0.00395634, 0.00795918]), 1: array([0.00507231, 0.01014359]), 2: array([0.00433747, 0.01038338]), 3: array([0.00581303, 0.01155359]), 4: array([0.00826806, 0.0165607 ]), 5: array([0.01121412, 0.02196827]), 6: array([0.01537065, 0.02892542]), 7: array([0.0229581 , 0.04063347]), 8: array([0.03592556, 0.0612325 ]), 9: array([0.07280232, 0.11089665])}, 'recall_pop_Contribute': {0: array([0.00073994, 0.00148963]), 1: array([0.00076398, 0.00154808]), 2: array([0.00063821, 0.00146968]), 3: array([0.00087277, 0.0017709 ]), 4: array([0.00126937, 0.00250448]), 5: array([0.00184863, 0.00358713]), 6: array([0.0026462 , 0.00499543]), 7: array([0.004377  , 0.00771774]), 8: array([0.0080043 , 0.01358319]), 9: array([0.03075719, 0.04676733])}, 'ndcg': array([0.04259592, 0.05539378])}
[5;37;44mfind a better recall[0m [0;37;44m0.05191760442658337[0m [0;37;44m++0.0007936478144477538[0m
total time cost of epoch 5:  29.584147214889526
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[6]:loss 1.403
[0;30;43m[TEST][0m
{'precision': array([0.02312271, 0.01921103]), 'recall': array([0.05320271, 0.08719963]), 'recall_pop': {0: array([0.00443054, 0.0088903 ]), 1: array([0.00530864, 0.01018936]), 2: array([0.00543223, 0.01051337]), 3: array([0.00619301, 0.01231188]), 4: array([0.00911311, 0.01724752]), 5: array([0.01215109, 0.0223969 ]), 6: array([0.01609135, 0.03035135]), 7: array([0.02425964, 0.04254863]), 8: array([0.03639152, 0.06170377]), 9: array([0.0727986 , 0.11149063])}, 'recall_pop_Contribute': {0: array([0.00081922, 0.00166517]), 1: array([0.0008027 , 0.00152759]), 2: array([0.00078251, 0.00152972]), 3: array([0.00095366, 0.00190244]), 4: array([0.00143605, 0.00263999]), 5: array([0.00203784, 0.00369417]), 6: array([0.0028147 , 0.00523451]), 7: array([0.00460697, 0.00809761]), 8: array([0.00799739, 0.01378524]), 9: array([0.03095167, 0.04712318])}, 'ndcg': array([0.04332578, 0.05628304])}
[5;37;44mfind a better recall[0m [0;37;44m0.05320270729345[0m [0;37;44m++0.0012851028668666303[0m
total time cost of epoch 6:  29.146215200424194
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[7]:loss 1.377
[0;30;43m[TEST][0m
{'precision': array([0.02326797, 0.01940445]), 'recall': array([0.05355468, 0.0880765 ]), 'recall_pop': {0: array([0.00482357, 0.0103532 ]), 1: array([0.00585089, 0.01140427]), 2: array([0.0053428 , 0.01115362]), 3: array([0.00649067, 0.01309848]), 4: array([0.00940116, 0.01755906]), 5: array([0.012291  , 0.02405058]), 6: array([0.01617563, 0.03068049]), 7: array([0.02481794, 0.04279866]), 8: array([0.03660347, 0.06237466]), 9: array([0.07296428, 0.11098586])}, 'recall_pop_Contribute': {0: array([0.00087301, 0.00195013]), 1: array([0.00091811, 0.00175383]), 2: array([0.00078483, 0.00159881]), 3: array([0.00099977, 0.00200837]), 4: array([0.00145383, 0.00273085]), 5: array([0.00203184, 0.00395625]), 6: array([0.00281723, 0.0052696 ]), 7: array([0.00471812, 0.00817773]), 8: array([0.00812996, 0.01384687]), 9: array([0.03082798, 0.04678406])}, 'ndcg': array([0.0437152 , 0.05690467])}
[5;37;44mfind a better recall[0m [0;37;44m0.053554680325581014[0m [0;37;44m++0.0003519730321310116[0m
total time cost of epoch 7:  29.68436360359192
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[8]:loss 1.360
[0;30;43m[TEST][0m
{'precision': array([0.02354269, 0.01958286]), 'recall': array([0.05397525, 0.08880392]), 'recall_pop': {0: array([0.00482282, 0.01027246]), 1: array([0.00579799, 0.01136925]), 2: array([0.00569642, 0.01133677]), 3: array([0.00683167, 0.01318238]), 4: array([0.00961774, 0.01826847]), 5: array([0.01230259, 0.02446223]), 6: array([0.01691779, 0.03052929]), 7: array([0.02465147, 0.0435272 ]), 8: array([0.03639138, 0.062809  ]), 9: array([0.07334167, 0.11140724])}, 'recall_pop_Contribute': {0: array([0.00087428, 0.00194242]), 1: array([0.00088129, 0.00176842]), 2: array([0.00085582, 0.00167057]), 3: array([0.00104979, 0.00202626]), 4: array([0.0014749 , 0.00279929]), 5: array([0.00206296, 0.00406506]), 6: array([0.00292394, 0.00529674]), 7: array([0.00465841, 0.00824145]), 8: array([0.00803454, 0.01387577]), 9: array([0.03115932, 0.04711793])}, 'ndcg': array([0.04420083, 0.05746897])}
[5;37;44mfind a better recall[0m [0;37;44m0.05397525268292132[0m [0;37;44m++0.0004205723573403042[0m
total time cost of epoch 8:  29.912208795547485
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[9]:loss 1.345
[0;30;43m[TEST][0m
{'precision': array([0.0238711 , 0.01972891]), 'recall': array([0.05454344, 0.08909962]), 'recall_pop': {0: array([0.00510777, 0.0104671 ]), 1: array([0.00595994, 0.01102423]), 2: array([0.00584032, 0.01179389]), 3: array([0.00698407, 0.01363287]), 4: array([0.01007758, 0.01900657]), 5: array([0.01329602, 0.02527707]), 6: array([0.01718176, 0.03096795]), 7: array([0.02494266, 0.04350945]), 8: array([0.03687032, 0.06160535]), 9: array([0.07421146, 0.11276868])}, 'recall_pop_Contribute': {0: array([0.00095436, 0.00197306]), 1: array([0.00091847, 0.00169359]), 2: array([0.00081313, 0.00169511]), 3: array([0.00107728, 0.00210108]), 4: array([0.00151987, 0.00289089]), 5: array([0.00221679, 0.00419475]), 6: array([0.00295698, 0.0053173 ]), 7: array([0.00472496, 0.00820956]), 8: array([0.00810942, 0.01358815]), 9: array([0.03125218, 0.04743614])}, 'ndcg': array([0.04477338, 0.05794919])}
[5;37;44mfind a better recall[0m [0;37;44m0.054543439786086195[0m [0;37;44m++0.0005681871031648772[0m
total time cost of epoch 9:  66.89433479309082
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[10]:loss 1.335
[0;30;43m[TEST][0m
{'precision': array([0.02413951, 0.0199089 ]), 'recall': array([0.05532437, 0.09030488]), 'recall_pop': {0: array([0.0055601 , 0.01116054]), 1: array([0.00636895, 0.01175294]), 2: array([0.00611794, 0.01217975]), 3: array([0.00690587, 0.01383306]), 4: array([0.01038734, 0.01865321]), 5: array([0.01354069, 0.02534574]), 6: array([0.01667588, 0.03055211]), 7: array([0.02537941, 0.04372854]), 8: array([0.03629095, 0.06162897]), 9: array([0.07587891, 0.11437991])}, 'recall_pop_Contribute': {0: array([0.00106231, 0.00210007]), 1: array([0.00096155, 0.00180019]), 2: array([0.00083911, 0.00172554]), 3: array([0.00103171, 0.00209338]), 4: array([0.00160501, 0.00287036]), 5: array([0.00225118, 0.00424564]), 6: array([0.00292904, 0.00528406]), 7: array([0.00484943, 0.00840056]), 8: array([0.00798007, 0.01360357]), 9: array([0.03181497, 0.0481815 ])}, 'ndcg': array([0.04544215, 0.05874117])}
[5;37;44mfind a better recall[0m [0;37;44m0.05532436550057529[0m [0;37;44m++0.0007809257144890946[0m
total time cost of epoch 10:  68.71480512619019
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[11]:loss 1.327
[0;30;43m[TEST][0m
{'precision': array([0.02440003, 0.02009205]), 'recall': array([0.05624175, 0.0911722 ]), 'recall_pop': {0: array([0.0056819 , 0.01163031]), 1: array([0.00620781, 0.01163054]), 2: array([0.00607508, 0.01199192]), 3: array([0.00715679, 0.0146195 ]), 4: array([0.01103442, 0.01892758]), 5: array([0.01329364, 0.02471935]), 6: array([0.01573518, 0.03017928]), 7: array([0.02474882, 0.04355052]), 8: array([0.0356476 , 0.06076403]), 9: array([0.07844192, 0.11687142])}, 'recall_pop_Contribute': {0: array([0.00106312, 0.0021963 ]), 1: array([0.00093036, 0.00179285]), 2: array([0.00088067, 0.00179175]), 3: array([0.00106185, 0.00219109]), 4: array([0.00168392, 0.00292195]), 5: array([0.00224645, 0.00415504]), 6: array([0.00280604, 0.00520225]), 7: array([0.00469037, 0.00839409]), 8: array([0.00785866, 0.0133544 ]), 9: array([0.03302032, 0.04917248])}, 'ndcg': array([0.04610098, 0.05941289])}
[5;37;44mfind a better recall[0m [0;37;44m0.05624174928854907[0m [0;37;44m++0.0009173837879737773[0m
total time cost of epoch 11:  68.19761347770691
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[12]:loss 1.320
[0;30;43m[TEST][0m
