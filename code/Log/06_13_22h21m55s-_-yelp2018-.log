==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'Adaptive',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 1,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'BPR_Contrast',
 'lr': 0.001,
 'model': 'GCLRec',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'Adaptive_Aug+BPR_Contrast',
 'notes': 'L=3_k=0',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_Aug'],
 'tau_plus': 0.1,
 'temp_tau': 0.1,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 4096,
 'topks': [20, 40],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 1,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[0;30;43m[DATALOADER--START][0m
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1093508 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0011765708510383113
loading adjacency matrix
successfully loaded...
[0;30;43mRemember to delete this pre-calculed mat while changing data split ![0m
yelp2018 is ready to go
[0;30;43m[DATALOADER--END][0m
[0;30;43m[PRECALCULATE--START][0m
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0008993148803710938
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07955431938171387
shape test : 2474518 == 2187016
precal cost :  0.9049108028411865
[0;30;43m[PRECALCULATE--END][0m
user:31668, item:38048
[0;30;43muse NORMAL distribution UI for Embedding[0m
GCL Model is ready to go!
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[0]:loss 1.395
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0100101 , 0.00820702]), 'recall': array([0.04677956, 0.07624152]), 'ndcg': array([0.02859613, 0.03741957])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.04677955568219927[0m [0;37;44m++0.04677955568219927[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01597196, 0.01361943]), 'recall': array([0.0339643 , 0.05721198]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 5.78922993e-05]), 4: array([0.        , 0.00010526]), 5: array([8.42069808e-05, 5.89448865e-04]), 6: array([0.00060524, 0.00124837]), 7: array([0.00155388, 0.00312303]), 8: array([0.00509531, 0.01003507]), 9: array([0.08584918, 0.14108879])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 9.97053029e-06]), 4: array([0.00000000e+00, 1.87398125e-05]), 5: array([1.09644506e-05, 8.97271490e-05]), 6: array([0.00010542, 0.00022427]), 7: array([0.00028515, 0.00054587]), 8: array([0.00100124, 0.00202486]), 9: array([0.03256153, 0.05429854])}, 'ndcg': array([0.02797096, 0.0368016 ])}
[5;37;44mfind a better recall[0m [0;37;44m0.03396429517056955[0m [0;37;44m++0.03396429517056955[0m
total time cost of epoch 0:  685.7868738174438
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[1]:loss 0.939
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01067797, 0.00872805]), 'recall': array([0.05058357, 0.0822486 ]), 'ndcg': array([0.03089926, 0.04034815])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.05058357160761298[0m [0;37;44m++0.003804015925413712[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01682929, 0.01432598]), 'recall': array([0.03615646, 0.06060902]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.36811082e-05]), 4: array([0.        , 0.00012631]), 5: array([5.2629363e-05, 6.6839291e-04]), 6: array([0.00066839, 0.00123153]), 7: array([0.00152625, 0.0034288 ]), 8: array([0.00522113, 0.010341  ]), 9: array([0.09029827, 0.14848181])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 9.35538189e-06]), 4: array([0.00000000e+00, 1.80882108e-05]), 5: array([7.45582642e-06, 1.09863007e-04]), 6: array([0.00011805, 0.00021614]), 7: array([0.00027906, 0.00059499]), 8: array([0.00102917, 0.00208185]), 9: array([0.03472273, 0.05757873])}, 'ndcg': array([0.02954147, 0.03884923])}
[5;37;44mfind a better recall[0m [0;37;44m0.03615646102898606[0m [0;37;44m++0.0021921658584165074[0m
total time cost of epoch 1:  686.3576889038086
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[2]:loss 0.784
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01135689, 0.00922619]), 'recall': array([0.0540983 , 0.08754688]), 'ndcg': array([0.03281397, 0.04274389])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.054098300326557665[0m [0;37;44m++0.0035147287189446833[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01760768, 0.01496148]), 'recall': array([0.03804192, 0.06360994]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.36811082e-05]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([8.42069808e-05, 6.36815292e-04]), 6: array([0.00063682, 0.00133415]), 7: array([0.00160914, 0.0038051 ]), 8: array([0.00531846, 0.01038607]), 9: array([0.09515947, 0.15618273])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 9.35538189e-06]), 4: array([0.00000000e+00, 9.31665033e-06]), 5: array([1.06135882e-05, 1.03547483e-04]), 6: array([0.00011278, 0.00023186]), 7: array([0.00029547, 0.0006549 ]), 8: array([0.00104328, 0.00209231]), 9: array([0.03657977, 0.06050866])}, 'ndcg': array([0.03083089, 0.04056877])}
[5;37;44mfind a better recall[0m [0;37;44m0.038041917261964174[0m [0;37;44m++0.0018854562329781166[0m
total time cost of epoch 2:  666.3847460746765
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[3]:loss 0.706
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01188424, 0.00970301]), 'recall': array([0.05674309, 0.0921212 ]), 'ndcg': array([0.03420219, 0.04470865])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.056743092820314436[0m [0;37;44m++0.0026447924937567716[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01831186, 0.01544461]), 'recall': array([0.03954352, 0.06569896]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.21034904e-05]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([8.42069808e-05, 6.05237674e-04]), 6: array([0.00064734, 0.00128679]), 7: array([0.00155651, 0.00376063]), 8: array([0.00553823, 0.01070498]), 9: array([0.09924663, 0.16196518])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.09983776e-06]), 4: array([0.00000000e+00, 1.08516734e-05]), 5: array([1.06135882e-05, 9.72319594e-05]), 6: array([0.00011504, 0.00022797]), 7: array([0.00029355, 0.00064655]), 8: array([0.00110232, 0.00218899]), 9: array([0.038022  , 0.06252027])}, 'ndcg': array([0.03190392, 0.04184631])}
[5;37;44mfind a better recall[0m [0;37;44m0.03954352376780384[0m [0;37;44m++0.0015016065058396644[0m
total time cost of epoch 3:  672.3855679035187
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[4]:loss 0.656
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01225212, 0.00998168]), 'recall': array([0.05872431, 0.09488575]), 'ndcg': array([0.0352837 , 0.04604105])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0587243147232164[0m [0;37;44m++0.0019812219029019668[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01882658, 0.01581802]), 'recall': array([0.0407153 , 0.06733385]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.21034904e-05]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([4.21034904e-05, 6.36815292e-04]), 6: array([0.00067892, 0.00134994]), 7: array([0.0015723 , 0.00384352]), 8: array([0.00581351, 0.01130559]), 9: array([0.10240923, 0.16601866])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.09983776e-06]), 4: array([0.00000000e+00, 1.08516734e-05]), 5: array([5.13136289e-06, 1.03547483e-04]), 6: array([0.0001203 , 0.00023744]), 7: array([0.00029146, 0.0006685 ]), 8: array([0.0011795 , 0.00232612]), 9: array([0.03911891, 0.0639803 ])}, 'ndcg': array([0.03280197, 0.04290166])}
[5;37;44mfind a better recall[0m [0;37;44m0.04071530260268835[0m [0;37;44m++0.001171778834884514[0m
total time cost of epoch 4:  665.4979631900787
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[5]:loss 0.621
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01250474, 0.01026746]), 'recall': array([0.05964057, 0.09754937]), 'ndcg': array([0.03625693, 0.04752229])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.05964057470537463[0m [0;37;44m++0.0009162599821582254[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01921656, 0.01609511]), 'recall': array([0.0415575 , 0.06859357]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.21034904e-05]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([4.21034904e-05, 6.36815292e-04]), 6: array([0.00059997, 0.00137626]), 7: array([0.00156178, 0.00396168]), 8: array([0.00625025, 0.0118815 ]), 9: array([0.10433784, 0.16930572])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.09983776e-06]), 4: array([0.0000000e+00, 1.0500811e-05]), 5: array([5.13136289e-06, 1.03547483e-04]), 6: array([0.00010346, 0.00024632]), 7: array([0.00028953, 0.00069755]), 8: array([0.00128664, 0.00249057]), 9: array([0.03987274, 0.06503798])}, 'ndcg': array([0.0334814 , 0.04372304])}
[5;37;44mfind a better recall[0m [0;37;44m0.04155750382223872[0m [0;37;44m++0.0008422012195503648[0m
total time cost of epoch 5:  656.6145279407501
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[6]:loss 0.594
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01279367, 0.01047114]), 'recall': array([0.06109186, 0.09948847]), 'ndcg': array([0.03708643, 0.04850638])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06109185669889108[0m [0;37;44m++0.0014512819935164484[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01951497, 0.01634142]), 'recall': array([0.04227554, 0.06971778]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.21034904e-05]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([5.26293630e-05, 6.21026483e-04]), 6: array([0.00063155, 0.00137626]), 7: array([0.00156967, 0.00407114]), 8: array([0.00665796, 0.01256456]), 9: array([0.10590848, 0.171666  ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.09983776e-06]), 4: array([0.0000000e+00, 1.0500811e-05]), 5: array([7.10496400e-06, 9.82845467e-05]), 6: array([0.00010872, 0.00024632]), 7: array([0.00029328, 0.00072061]), 8: array([0.00136765, 0.00263161]), 9: array([0.04049878, 0.06600336])}, 'ndcg': array([0.03407216, 0.04447105])}
[5;37;44mfind a better recall[0m [0;37;44m0.04227554397556831[0m [0;37;44m++0.0007180401533295952[0m
total time cost of epoch 6:  660.2304563522339
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[7]:loss 0.572
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0130684 , 0.01070718]), 'recall': array([0.06233261, 0.10155296]), 'ndcg': array([0.03797101, 0.04964029])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06233261276515615[0m [0;37;44m++0.0012407560662650724[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.01976917, 0.01655615]), 'recall': array([0.04281682, 0.07078054]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.21034904e-05]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([4.21034904e-05, 5.89448865e-04]), 6: array([0.00063155, 0.00139205]), 7: array([0.00162756, 0.00414325]), 8: array([0.00685795, 0.01288556]), 9: array([0.10719011, 0.1742006 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.09983776e-06]), 4: array([0.0000000e+00, 1.0500811e-05]), 5: array([5.13136289e-06, 9.19690231e-05]), 6: array([0.00010872, 0.0002501 ]), 7: array([0.00031037, 0.0007488 ]), 8: array([0.00141889, 0.00272457]), 9: array([0.0409737, 0.0669475])}, 'ndcg': array([0.03459863, 0.04519571])}
[5;37;44mfind a better recall[0m [0;37;44m0.04281681724206489[0m [0;37;44m++0.0005412732664965766[0m
total time cost of epoch 7:  663.5542628765106
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[8]:loss 0.554
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01333996, 0.0108927 ]), 'recall': array([0.063651  , 0.10336949]), 'ndcg': array([0.03876712, 0.05058513])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06365099743078644[0m [0;37;44m++0.0013183846656302858[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02006284, 0.01678429]), 'recall': array([0.0435168, 0.0720014]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 3.15776178e-05]), 4: array([0.000000e+00, 7.104964e-05]), 5: array([4.21034904e-05, 5.57871248e-04]), 6: array([0.00059997, 0.00144731]), 7: array([0.00167625, 0.00431938]), 8: array([0.00725006, 0.01369639]), 9: array([0.10902615, 0.1769944 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.22914524e-06]), 4: array([0.00000000e+00, 9.42123432e-06]), 5: array([5.13136289e-06, 8.56534996e-05]), 6: array([0.00010346, 0.00026017]), 7: array([0.00031251, 0.00077977]), 8: array([0.00149317, 0.00291132]), 9: array([0.04160253, 0.06795084])}, 'ndcg': array([0.03518107, 0.04596014])}
[5;37;44mfind a better recall[0m [0;37;44m0.04351679734137077[0m [0;37;44m++0.0006999800993058788[0m
total time cost of epoch 8:  665.9927682876587
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[9]:loss 0.539
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01357522, 0.01110585]), 'recall': array([0.06452065, 0.1053024 ]), 'ndcg': array([0.03945274, 0.05156876])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06452065219595714[0m [0;37;44m++0.0008696547651707021[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02025546, 0.01701481]), 'recall': array([0.0440927, 0.0730344]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 3.15776178e-05]), 4: array([0.       , 0.0001342]), 5: array([4.21034904e-05, 5.57871248e-04]), 6: array([0.0005684 , 0.00151836]), 7: array([0.00173414, 0.00461156]), 8: array([0.00760191, 0.01444193]), 9: array([0.11013652, 0.1792273 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.22914524e-06]), 4: array([0.00000000e+00, 1.64384827e-05]), 5: array([5.13136289e-06, 8.56534996e-05]), 6: array([9.89498183e-05, 2.74305055e-04]), 7: array([0.00032806, 0.00084168]), 8: array([0.00157274, 0.00308558]), 9: array([0.04208783, 0.06872652])}, 'ndcg': array([0.03563713, 0.04661431])}
[5;37;44mfind a better recall[0m [0;37;44m0.04409270441848388[0m [0;37;44m++0.000575907077113115[0m
total time cost of epoch 9:  670.1304893493652
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[10]:loss 0.527
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01377416, 0.01130637]), 'recall': array([0.06555141, 0.10696439]), 'ndcg': array([0.04003913, 0.05237826])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06555141398513822[0m [0;37;44m++0.0010307617891810866[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.0204544 , 0.01720349]), 'recall': array([0.04447727, 0.07383599]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.21034904e-05]), 4: array([0.00000000e+00, 8.68384489e-05]), 5: array([4.21034904e-05, 5.89448865e-04]), 6: array([0.00053682, 0.00153415]), 7: array([0.00179071, 0.00485015]), 8: array([0.00798644, 0.01494399]), 9: array([0.11097261, 0.18096654])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.09983776e-06]), 4: array([0.00000000e+00, 9.77209674e-06]), 5: array([5.13136289e-06, 9.19690231e-05]), 6: array([9.44387300e-05, 2.78816143e-04]), 7: array([0.0003316 , 0.00088759]), 8: array([0.00164193, 0.00318483]), 9: array([0.04240417, 0.06937591])}, 'ndcg': array([0.03604049, 0.04717992])}
[5;37;44mfind a better recall[0m [0;37;44m0.04447727482144206[0m [0;37;44m++0.0003845704029581745[0m
total time cost of epoch 10:  663.9734959602356
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[11]:loss 0.514
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01405046, 0.01145715]), 'recall': array([0.06663108, 0.10821193]), 'ndcg': array([0.04063166, 0.05300803])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0666310813994677[0m [0;37;44m++0.0010796674143294799[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02062808, 0.01742216]), 'recall': array([0.04490139, 0.07488604]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.21034904e-05]), 4: array([0.        , 0.00010263]), 5: array([4.21034904e-05, 5.89448865e-04]), 6: array([0.00053682, 0.00156572]), 7: array([0.00181834, 0.00500154]), 8: array([0.00817029, 0.01550145]), 9: array([0.1121379 , 0.18328476])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.09983776e-06]), 4: array([0.00000000e+00, 1.76665012e-05]), 5: array([5.13136289e-06, 9.19690231e-05]), 6: array([9.44387300e-05, 2.86710547e-04]), 7: array([0.00034356, 0.0009175 ]), 8: array([0.00168445, 0.00328141]), 9: array([0.04277381, 0.07028369])}, 'ndcg': array([0.03640001, 0.04778725])}
[5;37;44mfind a better recall[0m [0;37;44m0.04490139187257374[0m [0;37;44m++0.00042411705113168385[0m
total time cost of epoch 11:  681.0708985328674
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[12]:loss 0.504
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01424308, 0.0115803 ]), 'recall': array([0.0675581 , 0.10933187]), 'ndcg': array([0.04126053, 0.05370551])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06755809879434803[0m [0;37;44m++0.0009270173948803251[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02078281, 0.017524  ]), 'recall': array([0.04531474, 0.07543749]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 2.63146815e-05]), 4: array([0.        , 0.00010263]), 5: array([4.21034904e-05, 6.36815292e-04]), 6: array([0.00053682, 0.00159256]), 7: array([0.00184334, 0.00494343]), 8: array([0.0085037 , 0.01589034]), 9: array([0.11305157, 0.18425575])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 4.84429364e-06]), 4: array([0.00000000e+00, 1.48596018e-05]), 5: array([5.13136289e-06, 1.00916015e-04]), 6: array([9.44387300e-05, 2.91848176e-04]), 7: array([0.00034139, 0.00093136]), 8: array([0.00176529, 0.00338499]), 9: array([0.04310849, 0.07070867])}, 'ndcg': array([0.03673356, 0.04816699])}
[5;37;44mfind a better recall[0m [0;37;44m0.04531474038255179[0m [0;37;44m++0.0004133485099780468[0m
total time cost of epoch 12:  679.427136182785
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[13]:loss 0.495
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0144436 , 0.01176029]), 'recall': array([0.06872177, 0.11090618]), 'ndcg': array([0.0418794 , 0.05444994])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06872176609160838[0m [0;37;44m++0.0011636672972603485[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02091544, 0.01770241]), 'recall': array([0.04568878, 0.07631556]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.57888089e-05]), 4: array([0.       , 0.0001342]), 5: array([4.21034904e-05, 6.36815292e-04]), 6: array([0.00050524, 0.0016373 ]), 7: array([0.00201439, 0.0052392 ]), 8: array([0.00876623, 0.01624384]), 9: array([0.11379537, 0.18611577])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.97360111e-06]), 4: array([0.00000000e+00, 1.77918092e-05]), 5: array([5.13136289e-06, 1.00916015e-04]), 6: array([8.81232065e-05, 3.08438956e-04]), 7: array([0.00037789, 0.00099233]), 8: array([0.00181762, 0.00348867]), 9: array([0.04340002, 0.07140545])}, 'ndcg': array([0.03700154, 0.04863992])}
[5;37;44mfind a better recall[0m [0;37;44m0.045688776036190766[0m [0;37;44m++0.000374035653638978[0m
total time cost of epoch 13:  682.9205341339111
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[14]:loss 0.486
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0146157, 0.0118574]), 'recall': array([0.06923941, 0.11188095]), 'ndcg': array([0.04229381, 0.05497143])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.06923940554397386[0m [0;37;44m++0.0005176394523654787[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02103543, 0.01784609]), 'recall': array([0.04601095, 0.07695544]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.57888089e-05]), 4: array([0.        , 0.00011842]), 5: array([5.78922993e-05, 6.68392910e-04]), 6: array([0.00050524, 0.00170782]), 7: array([0.00189071, 0.00535341]), 8: array([0.00896343, 0.01675717]), 9: array([0.11444753, 0.18686443])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.97360111e-06]), 4: array([0.00000000e+00, 1.22011443e-05]), 5: array([1.14468864e-05, 1.04863217e-04]), 6: array([8.81232065e-05, 3.20669017e-04]), 7: array([0.00036086, 0.00103011]), 8: array([0.0018542 , 0.00365223]), 9: array([0.04369632, 0.07183339])}, 'ndcg': array([0.03729369, 0.04906001])}
[5;37;44mfind a better recall[0m [0;37;44m0.04601094520633736[0m [0;37;44m++0.00032216917014659535[0m
total time cost of epoch 14:  664.8415975570679
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[15]:loss 0.480
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01479727, 0.01199397]), 'recall': array([0.07018408, 0.1133069 ]), 'ndcg': array([0.04275842, 0.05555162])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07018407936929642[0m [0;37;44m++0.0009446738253225673[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02106859, 0.01794714]), 'recall': array([0.0461602 , 0.07749854]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.57888089e-05]), 4: array([0.        , 0.00011052]), 5: array([5.78922993e-05, 7.15759336e-04]), 6: array([0.00052893, 0.00175782]), 7: array([0.00189597, 0.00568655]), 8: array([0.00919122, 0.01718721]), 9: array([0.1144021 , 0.18792599])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.97360111e-06]), 4: array([0.0000000e+00, 1.5306855e-05]), 5: array([1.14468864e-05, 1.17494264e-04]), 6: array([9.89498183e-05, 3.32573278e-04]), 7: array([0.00036628, 0.00109304]), 8: array([0.00192623, 0.00374432]), 9: array([0.0437573 , 0.07219384])}, 'ndcg': array([0.03743615, 0.04937233])}
[5;37;44mfind a better recall[0m [0;37;44m0.04616020238838966[0m [0;37;44m++0.0001492571820522967[0m
total time cost of epoch 15:  668.5235011577606
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[16]:loss 0.472
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01492674, 0.01213054]), 'recall': array([0.07077122, 0.11420511]), 'ndcg': array([0.04310605, 0.05603086])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07077122379543817[0m [0;37;44m++0.0005871444261417447[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02119805, 0.01810029]), 'recall': array([0.04641314, 0.0783886 ]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.57888089e-05]), 4: array([0.       , 0.0001421]), 5: array([5.78922993e-05, 7.31548145e-04]), 6: array([0.00054998, 0.00177361]), 7: array([0.00191808, 0.00576234]), 8: array([0.0092723 , 0.01799479]), 9: array([0.1151395 , 0.18965933])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.97360111e-06]), 4: array([0.00000000e+00, 1.68857359e-05]), 5: array([1.14468864e-05, 1.24336081e-04]), 6: array([0.00010301, 0.00033472]), 7: array([0.00037872, 0.00110807]), 8: array([0.00194228, 0.00395698]), 9: array([0.04397769, 0.07284564])}, 'ndcg': array([0.03767561, 0.04982627])}
[5;37;44mfind a better recall[0m [0;37;44m0.046413144806582506[0m [0;37;44m++0.00025294241819284746[0m
total time cost of epoch 16:  681.7089071273804
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[17]:loss 0.466
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01505779, 0.01225054]), 'recall': array([0.07141364, 0.11533529]), 'ndcg': array([0.04354021, 0.05661191])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07141364055086821[0m [0;37;44m++0.0006424167554300447[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02140647, 0.01815555]), 'recall': array([0.046897  , 0.07878171]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.57888089e-05]), 4: array([0.        , 0.00012631]), 5: array([5.78922993e-05, 6.99970528e-04]), 6: array([0.00062366, 0.00186308]), 7: array([0.00197158, 0.00605338]), 8: array([0.00950303, 0.01871599]), 9: array([0.11596826, 0.18985228])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.97360111e-06]), 4: array([0.00000000e+00, 1.84646168e-05]), 5: array([1.14468864e-05, 1.19073145e-04]), 6: array([0.0001179 , 0.00035344]), 7: array([0.00038978, 0.00117866]), 8: array([0.00199684, 0.00411742]), 9: array([0.04438103, 0.07299268])}, 'ndcg': array([0.03806707, 0.05015302])}
[5;37;44mfind a better recall[0m [0;37;44m0.04689699702665689[0m [0;37;44m++0.0004838522200743822[0m
total time cost of epoch 17:  674.6637048721313
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[18]:loss 0.461
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01517462, 0.01236816]), 'recall': array([0.07186406, 0.11643386]), 'ndcg': array([0.04383903, 0.05709993])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07186406268930166[0m [0;37;44m++0.00045042213843345114[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02153909, 0.01821318]), 'recall': array([0.04718274, 0.07913079]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.57888089e-05]), 4: array([0.        , 0.00011052]), 5: array([5.78922993e-05, 7.26285209e-04]), 6: array([0.00062366, 0.00189203]), 7: array([0.00209018, 0.00631284]), 8: array([0.00970364, 0.01918554]), 9: array([0.11667665, 0.19004894])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.97360111e-06]), 4: array([0.0000000e+00, 1.5306855e-05]), 5: array([1.14468864e-05, 1.27206774e-04]), 6: array([0.0001179 , 0.00035717]), 7: array([0.00041253, 0.0012157 ]), 8: array([0.00205438, 0.00421901]), 9: array([0.04458649, 0.07319443])}, 'ndcg': array([0.03838269, 0.05048177])}
[5;37;44mfind a better recall[0m [0;37;44m0.04718274395368141[0m [0;37;44m++0.00028574692702452303[0m
total time cost of epoch 18:  687.6006615161896
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[19]:loss 0.454
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01528199, 0.01243211]), 'recall': array([0.07248567, 0.11702051]), 'ndcg': array([0.04417753, 0.05744027])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07248567249014397[0m [0;37;44m++0.0006216098008423043[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02176014, 0.01837265]), 'recall': array([0.04779981, 0.07986163]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.57888089e-05]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([0.00010526, 0.00077365]), 6: array([0.00063945, 0.00198939]), 7: array([0.00224148, 0.00660888]), 8: array([0.01013781, 0.01972055]), 9: array([0.1178559 , 0.19148078])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.97360111e-06]), 4: array([0.00000000e+00, 1.49559926e-05]), 5: array([2.12710342e-05, 1.33409520e-04]), 6: array([0.00012241, 0.0003793 ]), 7: array([0.00044625, 0.0012826 ]), 8: array([0.00216145, 0.00432176]), 9: array([0.04504843, 0.07372764])}, 'ndcg': array([0.03874796, 0.0508899 ])}
[5;37;44mfind a better recall[0m [0;37;44m0.047799812273712654[0m [0;37;44m++0.000617068320031243[0m
total time cost of epoch 19:  664.2869324684143
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[20]:loss 0.449
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01543672, 0.01250868]), 'recall': array([0.07319192, 0.11751305]), 'ndcg': array([0.04458923, 0.05781115])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0731919176983978[0m [0;37;44m++0.0007062452082538251[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02180277, 0.01842791]), 'recall': array([0.04789315, 0.08016728]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.00000000e+00, 9.47328534e-05]), 5: array([0.00013684, 0.00077365]), 6: array([0.00063945, 0.00199992]), 7: array([0.00240683, 0.00674572]), 8: array([0.01030066, 0.02043659]), 9: array([0.11784899, 0.19175606])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.00000000e+00, 1.49559926e-05]), 5: array([2.52182364e-05, 1.37469500e-04]), 6: array([0.00012241, 0.00037629]), 7: array([0.00047833, 0.00131293]), 8: array([0.00221531, 0.00447955]), 9: array([0.04505189, 0.07384608])}, 'ndcg': array([0.03885584, 0.05107952])}
[5;37;44mfind a better recall[0m [0;37;44m0.04789315180684199[0m [0;37;44m++9.333953312933713e-05[0m
total time cost of epoch 20:  680.8388273715973
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[21]:loss 0.445
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0155425 , 0.01261763]), 'recall': array([0.07339999, 0.11864149]), 'ndcg': array([0.04479095, 0.0582462 ])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07339998928799794[0m [0;37;44m++0.0002080715896001506[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02188487, 0.01855106]), 'recall': array([0.04817295, 0.08078043]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.        , 0.00012631]), 5: array([0.00013684, 0.00080523]), 6: array([0.00060787, 0.00213991]), 7: array([0.00255261, 0.00716307]), 8: array([0.0104432 , 0.02159087]), 9: array([0.11857697, 0.19236317])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.00000000e+00, 1.94670809e-05]), 5: array([2.52182364e-05, 1.39725044e-04]), 6: array([0.00011609, 0.00041327]), 7: array([0.00050876, 0.00139817]), 8: array([0.00224487, 0.00468281]), 9: array([0.04527801, 0.07412698])}, 'ndcg': array([0.0391088 , 0.05147462])}
[5;37;44mfind a better recall[0m [0;37;44m0.04817294840375498[0m [0;37;44m++0.0002797965969129901[0m
total time cost of epoch 21:  677.1523358821869
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[22]:loss 0.441
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01563566, 0.01270683]), 'recall': array([0.0740006 , 0.11937226]), 'ndcg': array([0.04510113, 0.05861981])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07400060377961103[0m [0;37;44m++0.0006006144916130829[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02198592, 0.01858738]), 'recall': array([0.04834755, 0.08098371]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.       , 0.0001421]), 5: array([0.00013684, 0.0007526 ]), 6: array([0.0007026 , 0.00216886]), 7: array([0.00261998, 0.0073299 ]), 8: array([0.01079231, 0.02202685]), 9: array([0.11908102, 0.19232639])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.00000000e+00, 1.98179433e-05]), 5: array([2.52182364e-05, 1.34024669e-04]), 6: array([0.00013504, 0.00041872]), 7: array([0.0005204 , 0.00143315]), 8: array([0.00231229, 0.00483014]), 9: array([0.04535461, 0.07414785])}, 'ndcg': array([0.03926211, 0.05162891])}
[5;37;44mfind a better recall[0m [0;37;44m0.04834755440458399[0m [0;37;44m++0.00017460600082901123[0m
total time cost of epoch 22:  659.511312007904
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[23]:loss 0.436
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01578407, 0.0127542 ]), 'recall': array([0.07470564, 0.1198993 ]), 'ndcg': array([0.04548087, 0.05892712])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07470564347022[0m [0;37;44m++0.0007050396906089773[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02204591, 0.01870421]), 'recall': array([0.04845965, 0.08145428]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.       , 0.0001421]), 5: array([0.00013684, 0.00084733]), 6: array([0.00068155, 0.00223201]), 7: array([0.00267103, 0.00753888]), 8: array([0.0109298 , 0.02284979]), 9: array([0.11894682, 0.19321953])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.00000000e+00, 1.98179433e-05]), 5: array([2.52182364e-05, 1.48911260e-04]), 6: array([0.00013622, 0.00042812]), 7: array([0.00053665, 0.00146855]), 8: array([0.0023395 , 0.00500403]), 9: array([0.04542206, 0.07438485])}, 'ndcg': array([0.03942429, 0.05193497])}
[5;37;44mfind a better recall[0m [0;37;44m0.04845964785056118[0m [0;37;44m++0.00011209344597718635[0m
total time cost of epoch 23:  661.0044269561768
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[24]:loss 0.432
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01587407, 0.01285446]), 'recall': array([0.07527682, 0.12050922]), 'ndcg': array([0.04579398, 0.05929435])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07527682373570221[0m [0;37;44m++0.0005711802654822101[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02211223, 0.01875632]), 'recall': array([0.04865418, 0.08171483]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.        , 0.00020525]), 5: array([0.00013684, 0.0008447 ]), 6: array([0.0007026 , 0.00233727]), 7: array([0.00286553, 0.00752862]), 8: array([0.0111633 , 0.02338035]), 9: array([0.11924026, 0.19338254])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0., 0.]), 4: array([0.00000000e+00, 3.38023169e-05]), 5: array([2.52182364e-05, 1.46956455e-04]), 6: array([0.00013504, 0.00045223]), 7: array([0.00058127, 0.00147593]), 8: array([0.00239735, 0.00512553]), 9: array([0.0455153 , 0.07448038])}, 'ndcg': array([0.0395496, 0.0520936])}
[5;37;44mfind a better recall[0m [0;37;44m0.04865417721010345[0m [0;37;44m++0.0001945293595422698[0m
total time cost of epoch 24:  672.1941962242126
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[25]:loss 0.428
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01600354, 0.01290183]), 'recall': array([0.07573584, 0.12102883]), 'ndcg': array([0.04609628, 0.05959174])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07573583796959783[0m [0;37;44m++0.0004590142338956188[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02213591, 0.0188621 ]), 'recall': array([0.0488059 , 0.08224972]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 3.15776178e-05]), 4: array([0.        , 0.00023683]), 5: array([0.00013684, 0.00082891]), 6: array([0.00071839, 0.00236885]), 7: array([0.00299053, 0.00789834]), 8: array([0.0113989 , 0.02435434]), 9: array([0.11926669, 0.19412206])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 6.31552356e-06]), 4: array([0.00000000e+00, 4.04687028e-05]), 5: array([2.52182364e-05, 1.43341829e-04]), 6: array([0.00013855, 0.00045732]), 7: array([0.0006136 , 0.00153839]), 8: array([0.0024658 , 0.00534107]), 9: array([0.04556273, 0.07472281])}, 'ndcg': array([0.03963368, 0.05234585])}
[5;37;44mfind a better recall[0m [0;37;44m0.048805899544877615[0m [0;37;44m++0.0001517223347741667[0m
total time cost of epoch 25:  668.9797446727753
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[26]:loss 0.425
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01612353, 0.01299656]), 'recall': array([0.07642963, 0.1218899 ]), 'ndcg': array([0.04639906, 0.05995769])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07642963141415632[0m [0;37;44m++0.0006937934445584854[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02227959, 0.01894973]), 'recall': array([0.04910798, 0.08262654]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 6.31552356e-05]), 4: array([0.        , 0.00023683]), 5: array([0.00013684, 0.00086049]), 6: array([0.00072892, 0.00254162]), 7: array([0.00308131, 0.00812658]), 8: array([0.01164372, 0.02519495]), 9: array([0.1199795 , 0.19384301])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.08266118e-05]), 4: array([0.00000000e+00, 4.04687028e-05]), 5: array([2.52182364e-05, 1.52001751e-04]), 6: array([0.0001417 , 0.00048842]), 7: array([0.00061567, 0.00157144]), 8: array([0.00251997, 0.00552155]), 9: array([0.04580543, 0.07484183])}, 'ndcg': array([0.03991305, 0.05265113])}
[5;37;44mfind a better recall[0m [0;37;44m0.04910798410217739[0m [0;37;44m++0.00030208455729977685[0m
total time cost of epoch 26:  675.947966337204
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[27]:loss 0.422
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01620405, 0.01308024]), 'recall': array([0.0766957 , 0.12276793]), 'ndcg': array([0.04663386, 0.06034756])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07669569961244675[0m [0;37;44m++0.00026606819829043393[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02232222, 0.01895447]), 'recall': array([0.04922465, 0.08278047]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 6.31552356e-05]), 4: array([1.57888089e-05, 2.21043324e-04]), 5: array([0.00010526, 0.0008447 ]), 6: array([0.00075786, 0.00255215]), 7: array([0.00293869, 0.00831499]), 8: array([0.01202223, 0.02582915]), 9: array([0.1198355 , 0.19366222])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.60895481e-05]), 4: array([4.51108825e-06, 3.73109411e-05]), 5: array([2.17096122e-05, 1.50949164e-04]), 6: array([0.00014837, 0.00049227]), 7: array([0.00059176, 0.00163866]), 8: array([0.00261015, 0.00566513]), 9: array([0.04584815, 0.07478005])}, 'ndcg': array([0.03999537, 0.05273296])}
[5;37;44mfind a better recall[0m [0;37;44m0.04922465304223789[0m [0;37;44m++0.00011666894006049505[0m
total time cost of epoch 27:  673.7480487823486
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[28]:loss 0.419
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01631616, 0.01312524]), 'recall': array([0.07714797, 0.12302699]), 'ndcg': array([0.04694824, 0.06061784])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07714796864882544[0m [0;37;44m++0.000452269036378683[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02239011, 0.01903657]), 'recall': array([0.0493561, 0.0830273]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 7.89440445e-05]), 4: array([1.57888089e-05, 2.99987369e-04]), 5: array([0.00010526, 0.0009247 ]), 6: array([0.00080523, 0.00268372]), 7: array([0.00318604, 0.00849498]), 8: array([0.01219538, 0.02630101]), 9: array([0.12000401, 0.1936798 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 1.80631492e-05]), 4: array([4.51108825e-06, 5.85757099e-05]), 5: array([2.17096122e-05, 1.63956135e-04]), 6: array([0.00015802, 0.00051563]), 7: array([0.00064496, 0.00165911]), 8: array([0.00265927, 0.00577241]), 9: array([0.04586763, 0.07483955])}, 'ndcg': array([0.04016046, 0.05295345])}
[5;37;44mfind a better recall[0m [0;37;44m0.04935609691580369[0m [0;37;44m++0.00013144387356580495[0m
total time cost of epoch 28:  674.6987705230713
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[29]:loss 0.416
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01636984, 0.01317181]), 'recall': array([0.07749286, 0.12326518]), 'ndcg': array([0.04713365, 0.06080431])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07749286498352079[0m [0;37;44m++0.0003448963346953521[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.0224359 , 0.01906657]), 'recall': array([0.04962163, 0.0832394 ]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 9.47328534e-05]), 4: array([1.57888089e-05, 2.84198560e-04]), 5: array([0.00010526, 0.0009668 ]), 6: array([0.00083681, 0.00266041]), 7: array([0.00330367, 0.00886207]), 8: array([0.01234062, 0.02677759]), 9: array([0.12040056, 0.19362735])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 2.43786728e-05]), 4: array([4.51108825e-06, 5.54179481e-05]), 5: array([2.17096122e-05, 1.74279587e-04]), 6: array([0.00016524, 0.0005086 ]), 7: array([0.00067315, 0.0017437 ]), 8: array([0.00269482, 0.00586696]), 9: array([0.0460622 , 0.07486606])}, 'ndcg': array([0.04026872, 0.0530592 ])}
[5;37;44mfind a better recall[0m [0;37;44m0.049621630949416205[0m [0;37;44m++0.0002655340336125134[0m
total time cost of epoch 29:  677.6091091632843
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[30]:loss 0.413
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01650404, 0.01323339]), 'recall': array([0.07810883, 0.12396735]), 'ndcg': array([0.04743189, 0.06111098])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07810883104796741[0m [0;37;44m++0.0006159660644466242[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02249747, 0.01910446]), 'recall': array([0.04975714, 0.08347569]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 9.47328534e-05]), 4: array([1.57888089e-05, 4.05246095e-04]), 5: array([7.36811082e-05, 1.02469370e-03]), 6: array([0.00087365, 0.0028665 ]), 7: array([0.00330762, 0.00905635]), 8: array([0.01263729, 0.02725277]), 9: array([0.12074232, 0.19377682])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([0.00000000e+00, 2.43786728e-05]), 4: array([4.51108825e-06, 8.23842312e-05]), 5: array([1.77624100e-05, 1.79320251e-04]), 6: array([0.00017606, 0.00054583]), 7: array([0.00066708, 0.00177236]), 8: array([0.00277604, 0.00600451]), 9: array([0.04611569, 0.07486691])}, 'ndcg': array([0.04038341, 0.05320352])}
[5;37;44mfind a better recall[0m [0;37;44m0.04975714296195138[0m [0;37;44m++0.00013551201253517164[0m
total time cost of epoch 30:  667.876186132431
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[31]:loss 0.410
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01655615, 0.01326023]), 'recall': array([0.07816064, 0.12415433]), 'ndcg': array([0.04757098, 0.06128224])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07816063816291832[0m [0;37;44m++5.180711495091084e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02256852, 0.01915893]), 'recall': array([0.04992202, 0.08377914]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([3.15776178e-05, 9.47328534e-05]), 4: array([1.57888089e-05, 4.05246095e-04]), 5: array([0.00010526, 0.00111943]), 6: array([0.00090523, 0.00297559]), 7: array([0.00356129, 0.00918897]), 8: array([0.01308956, 0.02833835]), 9: array([0.1203316 , 0.19362722])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([6.31552356e-06, 2.43786728e-05]), 4: array([4.51108825e-06, 8.05797959e-05]), 5: array([2.17096122e-05, 1.91874186e-04]), 6: array([0.00018576, 0.00055985]), 7: array([0.00071506, 0.00180686]), 8: array([0.00288033, 0.00622412]), 9: array([0.04610834, 0.07489147])}, 'ndcg': array([0.04058179, 0.0534459 ])}
[5;37;44mfind a better recall[0m [0;37;44m0.04992202174745223[0m [0;37;44m++0.0001648787855008521[0m
total time cost of epoch 31:  666.4633455276489
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[32]:loss 0.409
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01665404, 0.01338338]), 'recall': array([0.0786297 , 0.12515245]), 'ndcg': array([0.04792963, 0.06180608])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07862970213939613[0m [0;37;44m++0.00046906397647780707[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02261431, 0.01921261]), 'recall': array([0.05005183, 0.08404316]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([3.15776178e-05, 9.47328534e-05]), 4: array([1.57888089e-05, 4.49981053e-04]), 5: array([0.00016841, 0.00114469]), 6: array([0.00094733, 0.00312558]), 7: array([0.00364287, 0.0096982 ]), 8: array([0.01347919, 0.02870425]), 9: array([0.12064766, 0.19363472])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0., 0.]), 3: array([6.31552356e-06, 2.43786728e-05]), 4: array([4.51108825e-06, 7.90240488e-05]), 5: array([3.35512189e-05, 1.96610828e-04]), 6: array([0.00018914, 0.00059414]), 7: array([0.00072524, 0.00191632]), 8: array([0.0029672 , 0.00630864]), 9: array([0.04612587, 0.07492404])}, 'ndcg': array([0.04071044, 0.05363249])}
[5;37;44mfind a better recall[0m [0;37;44m0.050051830242309255[0m [0;37;44m++0.0001298084948570255[0m
total time cost of epoch 32:  667.0265142917633
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[33]:loss 0.406
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01676456, 0.01344575]), 'recall': array([0.07904456, 0.12564477]), 'ndcg': array([0.04815958, 0.06204814])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07904456460134801[0m [0;37;44m++0.0004148624619518815[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02263799, 0.01926708]), 'recall': array([0.05011991, 0.08438979]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([3.15776178e-05, 7.89440445e-05]), 4: array([4.73664267e-05, 4.28929308e-04]), 5: array([0.00019999, 0.00117627]), 6: array([0.00101575, 0.00322859]), 7: array([0.00367313, 0.00994135]), 8: array([0.01356498, 0.0294036 ]), 9: array([0.12050552, 0.19367963])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([6.31552356e-06, 2.24050717e-05]), 4: array([9.02217651e-06, 7.62171494e-05]), 5: array([3.88141552e-05, 1.99481521e-04]), 6: array([0.00020523, 0.0006156 ]), 7: array([0.00072541, 0.00195486]), 8: array([0.00295859, 0.00650053]), 9: array([0.04617652, 0.07501438])}, 'ndcg': array([0.04075259, 0.05377516])}
[5;37;44mfind a better recall[0m [0;37;44m0.05011990714023252[0m [0;37;44m++6.807689792326377e-05[0m
total time cost of epoch 33:  683.0873882770538
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[34]:loss 0.403
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01679456, 0.01345917]), 'recall': array([0.07941883, 0.12601684]), 'ndcg': array([0.04823329, 0.06212683])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07941883072857692[0m [0;37;44m++0.00037426612722890606[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02272641, 0.0192284 ]), 'recall': array([0.05039997, 0.08423807]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([4.73664267e-05, 7.89440445e-05]), 4: array([6.31552356e-05, 4.76295735e-04]), 5: array([0.00017631, 0.00125521]), 6: array([0.00101575, 0.00324437]), 7: array([0.00379286, 0.00998766]), 8: array([0.01384488, 0.02951471]), 9: array([0.12121769, 0.1928289 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([1.08266118e-05, 2.24050717e-05]), 4: array([1.69165810e-05, 8.99759686e-05]), 5: array([3.60072558e-05, 2.19542194e-04]), 6: array([0.00020912, 0.0006118 ]), 7: array([0.00075947, 0.00195133]), 8: array([0.003036  , 0.00652025]), 9: array([0.04633164, 0.07481645])}, 'ndcg': array([0.04086922, 0.05372411])}
[5;37;44mfind a better recall[0m [0;37;44m0.05039996903144156[0m [0;37;44m++0.0002800618912090422[0m
total time cost of epoch 34:  661.0415167808533
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[35]:loss 0.402
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01681982, 0.01349391]), 'recall': array([0.07963242, 0.12625965]), 'ndcg': array([0.04840401, 0.06232977])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.07963242397944337[0m [0;37;44m++0.00021359325086645065[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02271536, 0.01928761]), 'recall': array([0.05041026, 0.08454256]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([4.73664267e-05, 1.10521662e-04]), 4: array([7.89440445e-05, 6.10500611e-04]), 5: array([0.00017631, 0.00128679]), 6: array([0.00111574, 0.00335189]), 7: array([0.00395206, 0.01022221]), 8: array([0.01407225, 0.03038105]), 9: array([0.12090962, 0.19274701])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([1.08266118e-05, 2.69161599e-05]), 4: array([2.00743427e-05, 1.16854536e-04]), 5: array([3.60072558e-05, 2.21971241e-04]), 6: array([0.00022453, 0.0006377 ]), 7: array([0.00079293, 0.00201949]), 8: array([0.00310941, 0.00671591]), 9: array([0.04621648, 0.0747974 ])}, 'ndcg': array([0.04089244, 0.05386463])}
[5;37;44mfind a better recall[0m [0;37;44m0.05041025780248429[0m [0;37;44m++1.0288771042726852e-05[0m
total time cost of epoch 35:  662.6898572444916
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[36]:loss 0.400
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01688139, 0.01351285]), 'recall': array([0.07991137, 0.12641448]), 'ndcg': array([0.04867974, 0.06257795])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0799113663480191[0m [0;37;44m++0.00027894236857572974[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02284483, 0.0193405 ]), 'recall': array([0.05063217, 0.08474423]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([4.73664267e-05, 1.42099280e-04]), 4: array([7.89440445e-05, 6.57867037e-04]), 5: array([0.00017631, 0.00138152]), 6: array([0.00106838, 0.00340001]), 7: array([0.00400996, 0.01057273]), 8: array([0.01421885, 0.03091427]), 9: array([0.12156863, 0.19282448])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([1.08266118e-05, 3.62202794e-05]), 4: array([2.00743427e-05, 1.26830193e-04]), 5: array([3.60072558e-05, 2.43026053e-04]), 6: array([0.00021897, 0.00064317]), 7: array([0.00079692, 0.00206441]), 8: array([0.00313238, 0.00684603]), 9: array([0.04641699, 0.07477823])}, 'ndcg': array([0.04105528, 0.0540011 ])}
[5;37;44mfind a better recall[0m [0;37;44m0.05063216617983421[0m [0;37;44m++0.00022190837734992197[0m
total time cost of epoch 36:  660.4900405406952
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[37]:loss 0.399
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01693192, 0.01357048]), 'recall': array([0.08002767, 0.12692646]), 'ndcg': array([0.04875419, 0.06275939])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08002767492950572[0m [0;37;44m++0.00011630858148661827[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02284956, 0.01934129]), 'recall': array([0.05061509, 0.0847937 ]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([6.31552356e-05, 2.05254516e-04]), 4: array([0.00011052, 0.00059471]), 5: array([0.00020789, 0.00150783]), 6: array([0.00114732, 0.0036624 ]), 7: array([0.00414021, 0.01076991]), 8: array([0.01464307, 0.03149201]), 9: array([0.12106365, 0.19192073])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([1.60895481e-05, 4.88513266e-05]), 4: array([2.40215450e-05, 1.17734759e-04]), 5: array([4.12701921e-05, 2.62057273e-04]), 6: array([0.00022854, 0.00070332]), 7: array([0.00083393, 0.00212014]), 8: array([0.00319531, 0.00697816]), 9: array([0.04627593, 0.07455711])}, 'ndcg': array([0.04113792, 0.05410649])}
total time cost of epoch 37:  662.0243089199066
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[38]:loss 0.396
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01699507, 0.01357364]), 'recall': array([0.0803076 , 0.12716946]), 'ndcg': array([0.04896433, 0.06294223])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08030760444488892[0m [0;37;44m++0.00027992951538320654[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02295693, 0.01936182]), 'recall': array([0.05085436, 0.08477496]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([6.31552356e-05, 2.36832133e-04]), 4: array([0.00011052, 0.00065787]), 5: array([0.00032893, 0.00152888]), 6: array([0.00107364, 0.00375789]), 7: array([0.00422968, 0.01093482]), 8: array([0.01489302, 0.03167819]), 9: array([0.12120096, 0.19164936])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([1.60895481e-05, 4.20231793e-05]), 4: array([2.40215450e-05, 1.29313219e-04]), 5: array([6.58172421e-05, 2.69226030e-04]), 6: array([0.0002198 , 0.00072147]), 7: array([0.00083925, 0.00216042]), 8: array([0.00327649, 0.00702191]), 9: array([0.0464129 , 0.07442428])}, 'ndcg': array([0.04127285, 0.05414131])}
[5;37;44mfind a better recall[0m [0;37;44m0.05085436239805859[0m [0;37;44m++0.0002221962182243839[0m
total time cost of epoch 38:  671.2613308429718
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[39]:loss 0.395
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01701718, 0.01366285]), 'recall': array([0.08026069, 0.12787978]), 'ndcg': array([0.04894669, 0.06315053])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02299008, 0.01935945]), 'recall': array([0.05093796, 0.08483577]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([4.73664267e-05, 2.05254516e-04]), 4: array([0.00011052, 0.00079997]), 5: array([0.00036577, 0.00157888]), 6: array([0.00115258, 0.00383871]), 7: array([0.00434866, 0.0113455 ]), 8: array([0.01490149, 0.03186819]), 9: array([0.12116965, 0.1913087 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([1.08266118e-05, 3.91524868e-05]), 4: array([2.40215450e-05, 1.52852898e-04]), 5: array([7.55775967e-05, 2.80990173e-04]), 6: array([0.00023433, 0.00074419]), 7: array([0.00087253, 0.00221717]), 8: array([0.00328997, 0.00705907]), 9: array([0.04643071, 0.07433603])}, 'ndcg': array([0.04135819, 0.05421574])}
[5;37;44mfind a better recall[0m [0;37;44m0.050937962137852004[0m [0;37;44m++8.359973979341073e-05[0m
total time cost of epoch 39:  676.3025224208832
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[40]:loss 0.393
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01708823, 0.01369442]), 'recall': array([0.08053133, 0.12810515]), 'ndcg': array([0.04915681, 0.06333714])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08053133470538372[0m [0;37;44m++0.00022373026049479772[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02296798, 0.0194376 ]), 'recall': array([0.05091043, 0.0851728 ]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([6.31552356e-05, 2.52620942e-04]), 4: array([0.00011052, 0.00073681]), 5: array([0.0003342 , 0.00164467]), 6: array([0.00118942, 0.00393081]), 7: array([0.00431656, 0.01146918]), 8: array([0.01514213, 0.03247023]), 9: array([0.12104723, 0.19187124])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([1.60895481e-05, 4.99175838e-05]), 4: array([2.40215450e-05, 1.45102028e-04]), 5: array([7.21942805e-05, 2.80328319e-04]), 6: array([0.00024361, 0.00075713]), 7: array([0.00086894, 0.00225586]), 8: array([0.00332591, 0.00719228]), 9: array([0.04635967, 0.07448586])}, 'ndcg': array([0.04132958, 0.05433559])}
total time cost of epoch 40:  662.3081061840057
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[41]:loss 0.390
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01714191, 0.01368495]), 'recall': array([0.08090165, 0.1281616 ]), 'ndcg': array([0.04935391, 0.06344233])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08090164681342464[0m [0;37;44m++0.0003703121080409211[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02295851, 0.01943997]), 'recall': array([0.05086602, 0.08524875]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.57888089e-05]), 3: array([9.47328534e-05, 2.36832133e-04]), 4: array([0.00011052, 0.00077891]), 5: array([0.00034999, 0.00171835]), 6: array([0.00118416, 0.00384134]), 7: array([0.00438287, 0.01175689]), 8: array([0.01544686, 0.03264617]), 9: array([0.12081025, 0.19178455])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 6.31552356e-06]), 3: array([2.00367503e-05, 4.79439827e-05]), 4: array([2.4021545e-05, 1.5703135e-04]), 5: array([7.16303944e-05, 2.89386949e-04]), 6: array([0.00024203, 0.00074974]), 7: array([0.00088803, 0.00232231]), 8: array([0.00338433, 0.00724762]), 9: array([0.04623594, 0.0744284 ])}, 'ndcg': array([0.04140222, 0.05444696])}
total time cost of epoch 41:  666.2896749973297
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[42]:loss 0.389
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01717665, 0.01371258]), 'recall': array([0.08116815, 0.12823866]), 'ndcg': array([0.04947931, 0.0635426 ])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08116814595328452[0m [0;37;44m++0.00026649913985987705[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02302008, 0.01943208]), 'recall': array([0.05095078, 0.08527409]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 4.73664267e-05]), 3: array([9.47328534e-05, 2.36832133e-04]), 4: array([0.00011052, 0.00083681]), 5: array([0.00031841, 0.00172361]), 6: array([0.0012631 , 0.00397555]), 7: array([0.00453813, 0.01203357]), 8: array([0.01566874, 0.03302986]), 9: array([0.1209153 , 0.19153916])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.15784599e-05]), 3: array([2.00367503e-05, 4.79439827e-05]), 4: array([2.40215450e-05, 1.68208824e-04]), 5: array([6.84726327e-05, 2.96467991e-04]), 6: array([0.00025572, 0.00077527]), 7: array([0.00092107, 0.00238235]), 8: array([0.0034382 , 0.00731254]), 9: array([0.04622326, 0.07427973])}, 'ndcg': array([0.04141605, 0.05442364])}
[5;37;44mfind a better recall[0m [0;37;44m0.05095078345411174[0m [0;37;44m++1.2821316259736815e-05[0m
total time cost of epoch 42:  660.22909116745
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[43]:loss 0.387
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01724769, 0.01375363]), 'recall': array([0.08159009, 0.12867645]), 'ndcg': array([0.04969256, 0.06375992])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08159008824407704[0m [0;37;44m++0.00042194229079252354[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02302798, 0.0194376 ]), 'recall': array([0.05103223, 0.08521065]), 'recall_pop': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 4.73664267e-05]), 3: array([9.47328534e-05, 2.84198560e-04]), 4: array([0.00012631, 0.00081576]), 5: array([0.00034999, 0.00184729]), 6: array([0.00135257, 0.00412659]), 7: array([0.00456576, 0.01214619]), 8: array([0.0158233 , 0.03350174]), 9: array([0.12089853, 0.19072978])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0., 0.]), 2: array([0.00000000e+00, 1.15784599e-05]), 3: array([2.00367503e-05, 6.05750298e-05]), 4: array([2.79687472e-05, 1.68960672e-04]), 5: array([7.29837209e-05, 3.20175126e-04]), 6: array([0.00026753, 0.00078982]), 7: array([0.0009204 , 0.00242405]), 8: array([0.00348295, 0.00740644]), 9: array([0.04624037, 0.07402905])}, 'ndcg': array([0.04149298, 0.05447109])}
[5;37;44mfind a better recall[0m [0;37;44m0.05103223037349626[0m [0;37;44m++8.144691938451881e-05[0m
total time cost of epoch 43:  665.8126962184906
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[44]:loss 0.386
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01722875, 0.01379231]), 'recall': array([0.08174877, 0.1291801 ]), 'ndcg': array([0.04976009, 0.0639429 ])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08174876660148868[0m [0;37;44m++0.00015867835741163738[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02311166, 0.01948576]), 'recall': array([0.05111578, 0.08548843]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.57888089e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([9.47328534e-05, 2.84198560e-04]), 4: array([0.00011052, 0.00084733]), 5: array([0.00034999, 0.00192097]), 6: array([0.00146836, 0.0041708 ]), 7: array([0.00480391, 0.01250565]), 8: array([0.0159758 , 0.03349167]), 9: array([0.12075932, 0.19110174])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-06]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([2.00367503e-05, 6.05750298e-05]), 4: array([2.40215450e-05, 1.70746881e-04]), 5: array([7.29837209e-05, 3.46038699e-04]), 6: array([0.00028362, 0.00080939]), 7: array([0.00096496, 0.00248754]), 8: array([0.00353169, 0.00743518]), 9: array([0.04621847, 0.07415474])}, 'ndcg': array([0.04159681, 0.05461962])}
[5;37;44mfind a better recall[0m [0;37;44m0.05111578383411785[0m [0;37;44m++8.355346062158958e-05[0m
total time cost of epoch 44:  674.3384833335876
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[45]:loss 0.385
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01728717, 0.01383494]), 'recall': array([0.08154314, 0.12930843]), 'ndcg': array([0.04984446, 0.06411101])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02321271, 0.01948023]), 'recall': array([0.05131467, 0.08539178]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.57888089e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([7.89440445e-05, 2.84198560e-04]), 4: array([0.00012105, 0.00094996]), 5: array([0.00034999, 0.00192623]), 6: array([0.00153151, 0.00415396]), 7: array([0.00502627, 0.01258635]), 8: array([0.01617454, 0.03384182]), 9: array([0.1207736 , 0.19071767])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-06]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([1.55256621e-05, 6.05750298e-05]), 4: array([2.75301692e-05, 1.89784935e-04]), 5: array([7.29837209e-05, 3.38595403e-04]), 6: array([0.00029231, 0.00080925]), 7: array([0.00101525, 0.0024887 ]), 8: array([0.00358573, 0.00749667]), 9: array([0.04630534, 0.07398399])}, 'ndcg': array([0.04174432, 0.05464631])}
[5;37;44mfind a better recall[0m [0;37;44m0.051314674321694294[0m [0;37;44m++0.00019889048757644467[0m
total time cost of epoch 45:  665.692214012146
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[46]:loss 0.384
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01729348, 0.01385626]), 'recall': array([0.08159107, 0.12958199]), 'ndcg': array([0.04985694, 0.0641833 ])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02320008, 0.01950786]), 'recall': array([0.05123595, 0.08543093]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.57888089e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([7.89440445e-05, 2.52620942e-04]), 4: array([0.00016841, 0.00101312]), 5: array([0.00034999, 0.00188939]), 6: array([0.00151573, 0.00436816]), 7: array([0.00511228, 0.01282195]), 8: array([0.01643435, 0.03405346]), 9: array([0.12017775, 0.19010352])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-06]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([1.55256621e-05, 5.42595062e-05]), 4: array([3.77928949e-05, 2.06106873e-04]), 5: array([7.29837209e-05, 3.34422647e-04]), 6: array([0.00028887, 0.00083645]), 7: array([0.00102698, 0.00251883]), 8: array([0.00365827, 0.00756852]), 9: array([0.04613553, 0.07388814])}, 'ndcg': array([0.04179196, 0.05475939])}
total time cost of epoch 46:  675.3166728019714
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[47]:loss 0.382
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01739927, 0.01384915]), 'recall': array([0.08214741, 0.1293017 ]), 'ndcg': array([0.05009207, 0.06417453])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0821474125573511[0m [0;37;44m++0.00039864595586242[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02323639, 0.01951339]), 'recall': array([0.05142453, 0.08552557]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.57888089e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([6.31552356e-05, 3.15776178e-04]), 4: array([0.00019999, 0.00091838]), 5: array([0.0003763 , 0.00192992]), 6: array([0.00152099, 0.00446711]), 7: array([0.0052163 , 0.01297247]), 8: array([0.01651672, 0.03469591]), 9: array([0.12063861, 0.19024577])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-06]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([1.60895481e-05, 6.16412870e-05]), 4: array([4.23039832e-05, 1.91476594e-04]), 5: array([8.11173497e-05, 3.47029771e-04]), 6: array([0.0002951 , 0.00085374]), 7: array([0.00105377, 0.00254143]), 8: array([0.00365951, 0.00770834]), 9: array([0.04627664, 0.07379771])}, 'ndcg': array([0.04185517, 0.05478394])}
[5;37;44mfind a better recall[0m [0;37;44m0.05142453010494063[0m [0;37;44m++0.00010985578324633483[0m
total time cost of epoch 47:  676.3806364536285
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[48]:loss 0.382
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01736927, 0.01388784]), 'recall': array([0.08209351, 0.12985451]), 'ndcg': array([0.05007902, 0.06434167])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02323797, 0.01953944]), 'recall': array([0.05140023, 0.08561794]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.57888089e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([7.89440445e-05, 3.31564987e-04]), 4: array([0.00019999, 0.00080523]), 5: array([0.00036051, 0.0019615 ]), 6: array([0.00155783, 0.00446778]), 7: array([0.00538576, 0.01327381]), 8: array([0.01672202, 0.03486737]), 9: array([0.12019914, 0.19017985])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-06]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([2.39839526e-05, 6.36148881e-05]), 4: array([4.23039832e-05, 1.64449584e-04]), 5: array([7.58544134e-05, 3.52555855e-04]), 6: array([0.00031251, 0.00085746]), 7: array([0.00108724, 0.00260614]), 8: array([0.00371289, 0.0077604 ]), 9: array([0.04614545, 0.07378911])}, 'ndcg': array([0.04192743, 0.05489298])}
total time cost of epoch 48:  675.2921123504639
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[49]:loss 0.380
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01738032, 0.01393678]), 'recall': array([0.08197751, 0.13012846]), 'ndcg': array([0.05006916, 0.06445225])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02329955, 0.01957497]), 'recall': array([0.05146937, 0.08581402]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.63146815e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([0.00011052, 0.00031578]), 4: array([0.00023157, 0.00089996]), 5: array([0.00036577, 0.00200623]), 6: array([0.00157888, 0.00441448]), 7: array([0.00540888, 0.01332081]), 8: array([0.01702365, 0.03540094]), 9: array([0.12028386, 0.19022275])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.02627258e-05]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([2.79311548e-05, 6.16412870e-05]), 4: array([4.75669195e-05, 1.83233254e-04]), 5: array([7.82466572e-05, 3.76419116e-04]), 6: array([0.00030448, 0.00085624]), 7: array([0.00109133, 0.00261877]), 8: array([0.00376111, 0.00789671]), 9: array([0.04615871, 0.07379284])}, 'ndcg': array([0.04196537, 0.05496534])}
[5;37;44mfind a better recall[0m [0;37;44m0.05146937266813506[0m [0;37;44m++4.484256319443186e-05[0m
total time cost of epoch 49:  658.5305144786835
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[50]:loss 0.379
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01740085, 0.01396836]), 'recall': array([0.08226975, 0.13043111]), 'ndcg': array([0.0502738 , 0.06467502])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08226975188804309[0m [0;37;44m++0.00012233933069198677[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02329955, 0.0196176 ]), 'recall': array([0.05149932, 0.0859718 ]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.63146815e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([0.00011052, 0.00036314]), 4: array([0.00021578, 0.00091575]), 5: array([0.00042893, 0.00197992]), 6: array([0.00154204, 0.00456041]), 7: array([0.00549027, 0.01368776]), 8: array([0.01719241, 0.03576903]), 9: array([0.12014892, 0.19006223])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.02627258e-05]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([2.89837420e-05, 6.70238355e-05]), 4: array([4.54617450e-05, 1.93608757e-04]), 5: array([8.61410617e-05, 3.62961036e-04]), 6: array([0.00029971, 0.00088299]), 7: array([0.00110775, 0.00266873]), 8: array([0.00379832, 0.00791038]), 9: array([0.04613295, 0.07385795])}, 'ndcg': array([0.04197105, 0.05502515])}
[5;37;44mfind a better recall[0m [0;37;44m0.051499322232550854[0m [0;37;44m++2.9949564415793217e-05[0m
total time cost of epoch 50:  683.6285080909729
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[51]:loss 0.378
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01747821, 0.01397783]), 'recall': array([0.08242328, 0.13053321]), 'ndcg': array([0.05037957, 0.06474619])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08242327908751591[0m [0;37;44m++0.00015352719947282767[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02327586, 0.01955444]), 'recall': array([0.05144672, 0.08570383]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.63146815e-05]), 2: array([0.00000000e+00, 6.31552356e-05]), 3: array([0.00011052, 0.00033156]), 4: array([0.00026315, 0.00086838]), 5: array([0.00043419, 0.0021036 ]), 6: array([0.00161625, 0.00473709]), 7: array([0.00563105, 0.01369956]), 8: array([0.01735695, 0.03600706]), 9: array([0.12013531, 0.18925337])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.02627258e-05]), 2: array([0.00000000e+00, 1.78939834e-05]), 3: array([2.8983742e-05, 6.4904991e-05]), 4: array([5.35953738e-05, 1.83458809e-04]), 5: array([8.54831946e-05, 3.73989280e-04]), 6: array([0.00030943, 0.00090258]), 7: array([0.00112034, 0.00268382]), 8: array([0.00382539, 0.00797519]), 9: array([0.0460235 , 0.07349174])}, 'ndcg': array([0.04193796, 0.0549053 ])}
total time cost of epoch 51:  670.5386431217194
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[52]:loss 0.377
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01742927, 0.01396757]), 'recall': array([0.08233856, 0.13054045]), 'ndcg': array([0.05035507, 0.06476709])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02328534, 0.01959549]), 'recall': array([0.05132313, 0.08583201]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.63146815e-05]), 2: array([0.00000000e+00, 9.47328534e-05]), 3: array([0.00011052, 0.00036314]), 4: array([0.00024736, 0.00092733]), 5: array([0.00039209, 0.00215886]), 6: array([0.00171098, 0.00496866]), 7: array([0.00565049, 0.01371799]), 8: array([0.01743681, 0.0365002 ]), 9: array([0.11980194, 0.18895899])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.02627258e-05]), 2: array([0.00000000e+00, 2.31569197e-05]), 3: array([2.89837420e-05, 6.99047805e-05]), 4: array([5.38824430e-05, 1.96678804e-04]), 5: array([7.89045242e-05, 3.93605463e-04]), 6: array([0.00032665, 0.00094827]), 7: array([0.00112254, 0.00270086]), 8: array([0.00383495, 0.00812501]), 9: array([0.04587722, 0.07336427])}, 'ndcg': array([0.04193313, 0.05499924])}
total time cost of epoch 52:  671.5117838382721
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[53]:loss 0.376
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0174719 , 0.01401336]), 'recall': array([0.08253392, 0.13077233]), 'ndcg': array([0.0505438 , 0.06498273])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0825339213714417[0m [0;37;44m++0.00011064228392579367[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02330744, 0.01959391]), 'recall': array([0.05143992, 0.08580316]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.63146815e-05]), 2: array([1.57888089e-05, 9.47328534e-05]), 3: array([0.00012631, 0.00036314]), 4: array([0.00021578, 0.00091838]), 5: array([0.00051314, 0.00215886]), 6: array([0.00166625, 0.00491867]), 7: array([0.00586548, 0.01396939]), 8: array([0.01766657, 0.03697421]), 9: array([0.11988444, 0.18879873])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.02627258e-05]), 2: array([6.31552356e-06, 2.31569197e-05]), 3: array([3.42466783e-05, 7.04686665e-05]), 4: array([4.36197173e-05, 1.92119520e-04]), 5: array([9.60090672e-05, 3.95239024e-04]), 6: array([0.00031733, 0.00093937]), 7: array([0.0011646 , 0.00274372]), 8: array([0.00389209, 0.00817431]), 9: array([0.04588571, 0.07325451])}, 'ndcg': array([0.0420163, 0.0550312])}
total time cost of epoch 53:  662.4949867725372
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[54]:loss 0.375
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01750663, 0.01402283]), 'recall': array([0.0826295 , 0.13096045]), 'ndcg': array([0.05060721, 0.06505671])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08262950394530849[0m [0;37;44m++9.558257386678426e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02325849, 0.01958996]), 'recall': array([0.05137508, 0.08573984]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 5.78922993e-05]), 2: array([0.        , 0.00012631]), 3: array([0.00012631, 0.00036314]), 4: array([0.00019999, 0.00095522]), 5: array([0.00047366, 0.00210096]), 6: array([0.00173993, 0.00489837]), 7: array([0.0058889 , 0.01421586]), 8: array([0.01769906, 0.0371196 ]), 9: array([0.11956353, 0.18808049])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.81571302e-05]), 2: array([0.00000000e+00, 2.94724433e-05]), 3: array([3.42466783e-05, 6.93921568e-05]), 4: array([4.46723045e-05, 1.95803575e-04]), 5: array([0.00010106, 0.00037795]), 6: array([0.00033432, 0.00093715]), 7: array([0.00117011, 0.0027802 ]), 8: array([0.003908  , 0.00819827]), 9: array([0.04578269, 0.07313345])}, 'ndcg': array([0.04199076, 0.05502551])}
total time cost of epoch 54:  659.4183120727539
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[55]:loss 0.374
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0175761 , 0.01403783]), 'recall': array([0.08288075, 0.1309956 ]), 'ndcg': array([0.0507794 , 0.06515068])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08288074779963336[0m [0;37;44m++0.00025124385432487295[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.0232727 , 0.01962865]), 'recall': array([0.05139236, 0.08582988]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 5.78922993e-05]), 2: array([1.57888089e-05, 1.36836344e-04]), 3: array([0.00012631, 0.00037367]), 4: array([0.00023157, 0.00097101]), 5: array([0.00049735, 0.00224833]), 6: array([0.00166046, 0.00503415]), 7: array([0.00588894, 0.01422217]), 8: array([0.01775617, 0.03718457]), 9: array([0.1194868, 0.1880754])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.81571302e-05]), 2: array([6.31552356e-06, 3.57879668e-05]), 3: array([3.42466783e-05, 7.31753195e-05]), 4: array([4.99352408e-05, 1.98998930e-04]), 5: array([0.00010364, 0.00039888]), 6: array([0.00033217, 0.0009593 ]), 7: array([0.00117231, 0.00277842]), 8: array([0.00392016, 0.00822812]), 9: array([0.04577359, 0.07313905])}, 'ndcg': array([0.04201958, 0.05509392])}
total time cost of epoch 55:  667.0520617961884
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[56]:loss 0.374
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01759505, 0.01409625]), 'recall': array([0.08299602, 0.13139987]), 'ndcg': array([0.05095021, 0.06542993])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08299602443400084[0m [0;37;44m++0.00011527663436747271[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02337849, 0.01959549]), 'recall': array([0.05158309, 0.08565901]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 5.78922993e-05]), 2: array([1.57888089e-05, 1.26310471e-04]), 3: array([0.00012631, 0.00037367]), 4: array([0.00018947, 0.00099575]), 5: array([0.00054735, 0.00219043]), 6: array([0.00174729, 0.00511704]), 7: array([0.00595157, 0.01447099]), 8: array([0.01816162, 0.03779351]), 9: array([0.11976609, 0.18726619])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.81571302e-05]), 2: array([6.31552356e-06, 2.94724433e-05]), 3: array([3.42466783e-05, 7.15349238e-05]), 4: array([4.11636803e-05, 2.04761170e-04]), 5: array([0.00011329, 0.00038279]), 6: array([0.00034943, 0.00098887]), 7: array([0.00118626, 0.00285143]), 8: array([0.00398873, 0.00836097]), 9: array([0.04586365, 0.07275102])}, 'ndcg': array([0.04208854, 0.05500075])}
[5;37;44mfind a better recall[0m [0;37;44m0.05158309097289374[0m [0;37;44m++8.376874034288911e-05[0m
total time cost of epoch 56:  679.4190454483032
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[57]:loss 0.373
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01765978, 0.01410177]), 'recall': array([0.08325103, 0.13169881]), 'ndcg': array([0.05104512, 0.06551407])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08325102789160395[0m [0;37;44m++0.00025500345760311183[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02337059, 0.01960891]), 'recall': array([0.05160396, 0.08577057]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 5.78922993e-05]), 2: array([3.15776178e-05, 1.26310471e-04]), 3: array([0.00012631, 0.00044735]), 4: array([0.00027894, 0.00104311]), 5: array([0.00059997, 0.00226096]), 6: array([0.00182098, 0.00517441]), 7: array([0.00597841, 0.01430258]), 8: array([0.01816727, 0.03836733]), 9: array([0.11976681, 0.1869273 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 1.81571302e-05]), 2: array([1.26310471e-05, 2.94724433e-05]), 3: array([3.42466783e-05, 8.52322281e-05]), 4: array([6.40335308e-05, 2.15023896e-04]), 5: array([0.00011822, 0.00039613]), 6: array([0.00036346, 0.00098495]), 7: array([0.00119395, 0.00282431]), 8: array([0.0039904 , 0.00852647]), 9: array([0.04582071, 0.07269082])}, 'ndcg': array([0.04208423, 0.05502878])}
[5;37;44mfind a better recall[0m [0;37;44m0.05160396139307931[0m [0;37;44m++2.087042018556612e-05[0m
total time cost of epoch 57:  678.7426037788391
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[58]:loss 0.371
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01761242, 0.01409072]), 'recall': array([0.08308541, 0.13154927]), 'ndcg': array([0.05094558, 0.06544621])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02336428, 0.01961049]), 'recall': array([0.05155124, 0.08585635]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 5.78922993e-05]), 2: array([3.15776178e-05, 1.26310471e-04]), 3: array([0.00012631, 0.00040525]), 4: array([0.00027894, 0.00111153]), 5: array([0.00059997, 0.00223885]), 6: array([0.0018715 , 0.00517809]), 7: array([0.00605449, 0.01449111]), 8: array([0.01824062, 0.03804432]), 9: array([0.11959553, 0.18703178])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.81571302e-05]), 2: array([1.26310471e-05, 2.94724433e-05]), 3: array([3.42466783e-05, 7.94908430e-05]), 4: array([6.16652094e-05, 2.34145898e-04]), 5: array([0.00011822, 0.0003994 ]), 6: array([0.00036806, 0.00098484]), 7: array([0.0012076 , 0.00286075]), 8: array([0.00401534, 0.00846823]), 9: array([0.04573348, 0.07278186])}, 'ndcg': array([0.04211163, 0.05509983])}
total time cost of epoch 58:  667.5452492237091
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[59]:loss 0.371
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01764084, 0.01416335]), 'recall': array([0.08335574, 0.13207158]), 'ndcg': array([0.05109663, 0.06568897])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08335574030371706[0m [0;37;44m++0.00010471241211311433[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02342428, 0.0195876 ]), 'recall': array([0.05164571, 0.08572441]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 4.73664267e-05]), 2: array([3.15776178e-05, 1.05258726e-04]), 3: array([0.00012631, 0.00045261]), 4: array([0.00029472, 0.00119837]), 5: array([0.00063682, 0.00225464]), 6: array([0.0019715 , 0.00530102]), 7: array([0.00620659, 0.01471031]), 8: array([0.01851847, 0.03864721]), 9: array([0.11955967, 0.18618772])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.0000000e+00, 1.4209928e-05]), 2: array([1.26310471e-05, 2.94724433e-05]), 3: array([3.42466783e-05, 8.86770591e-05]), 4: array([6.79807330e-05, 2.45033236e-04]), 5: array([0.00012348, 0.00040041]), 6: array([0.00039951, 0.00100702]), 7: array([0.0012336, 0.0029149]), 8: array([0.00407658, 0.00855729]), 9: array([0.04569768, 0.07246739])}, 'ndcg': array([0.04219613, 0.05508741])}
[5;37;44mfind a better recall[0m [0;37;44m0.05164571002054019[0m [0;37;44m++4.1748627460883037e-05[0m
total time cost of epoch 59:  674.9167771339417
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[60]:loss 0.370
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01766136, 0.01419177]), 'recall': array([0.08336423, 0.13235357]), 'ndcg': array([0.05122839, 0.06589161])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0833642256944144[0m [0;37;44m++8.485390697338113e-06[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02339112, 0.01963102]), 'recall': array([0.05157521, 0.08598326]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-05]), 2: array([1.57888089e-05, 1.21047535e-04]), 3: array([0.00012631, 0.00042103]), 4: array([0.00027894, 0.00114469]), 5: array([0.00068418, 0.00223885]), 6: array([0.00188413, 0.00530365]), 7: array([0.00618817, 0.01475632]), 8: array([0.01880688, 0.03889996]), 9: array([0.11906895, 0.18691716])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.68413962e-05]), 2: array([6.31552356e-06, 3.57879668e-05]), 3: array([3.42466783e-05, 8.58063666e-05]), 4: array([5.99108973e-05, 2.40059647e-04]), 5: array([0.00013138, 0.00039866]), 6: array([0.00038132, 0.00100818]), 7: array([0.00122999, 0.00291551]), 8: array([0.00414807, 0.0086101 ]), 9: array([0.04558397, 0.07267231])}, 'ndcg': array([0.04216761, 0.05519236])}
total time cost of epoch 60:  660.9936242103577
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[61]:loss 0.370
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01773241, 0.01416335]), 'recall': array([0.08375945, 0.13204484]), 'ndcg': array([0.05144646, 0.06590333])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08375944927162618[0m [0;37;44m++0.0003952235772117785[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02336902, 0.01962786]), 'recall': array([0.05151157, 0.08597325]), 'recall_pop': {0: array([0., 0.]), 1: array([3.15776178e-05, 7.89440445e-05]), 2: array([1.57888089e-05, 1.21047535e-04]), 3: array([0.00012631, 0.0005105 ]), 4: array([0.00027367, 0.00114206]), 5: array([0.00068418, 0.00233359]), 6: array([0.0018815 , 0.00536154]), 7: array([0.00611844, 0.01481654]), 8: array([0.01871466, 0.03944823]), 9: array([0.11893039, 0.1863926 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([7.89440445e-06, 2.31569197e-05]), 2: array([6.31552356e-06, 3.57879668e-05]), 3: array([3.42466783e-05, 9.65970947e-05]), 4: array([6.12266314e-05, 2.31700464e-04]), 5: array([0.00013138, 0.00041247]), 6: array([0.00037761, 0.00102589]), 7: array([0.00122467, 0.00293146]), 8: array([0.00416175, 0.0087461 ]), 9: array([0.04550648, 0.07247008])}, 'ndcg': array([0.04221708, 0.05525438])}
total time cost of epoch 61:  681.841477394104
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[62]:loss 0.369
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0176961 , 0.01419335]), 'recall': array([0.08369245, 0.13243713]), 'ndcg': array([0.05134166, 0.06594012])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02345112, 0.01962944]), 'recall': array([0.05179822, 0.08595958]), 'recall_pop': {0: array([0., 0.]), 1: array([3.15776178e-05, 4.73664267e-05]), 2: array([1.57888089e-05, 1.42099280e-04]), 3: array([0.00015789, 0.00043946]), 4: array([0.00030525, 0.00121311]), 5: array([0.00067366, 0.00224412]), 6: array([0.00192097, 0.00545033]), 7: array([0.00625734, 0.01498823]), 8: array([0.01909232, 0.03961532]), 9: array([0.11933762, 0.18595477])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([7.89440445e-06, 1.42099280e-05]), 2: array([6.31552356e-06, 3.57879668e-05]), 3: array([3.87577666e-05, 9.47470929e-05]), 4: array([6.83315954e-05, 2.51727750e-04]), 5: array([0.00012941, 0.00040094]), 6: array([0.00037227, 0.00103327]), 7: array([0.00124455, 0.00296241]), 8: array([0.00423304, 0.00879964]), 9: array([0.04569765, 0.07236685])}, 'ndcg': array([0.04235322, 0.05527751])}
[5;37;44mfind a better recall[0m [0;37;44m0.051798216039277235[0m [0;37;44m++0.00015250601873704334[0m
total time cost of epoch 62:  660.8048975467682
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[63]:loss 0.369
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01770399, 0.0141894 ]), 'recall': array([0.08358845, 0.13243986]), 'ndcg': array([0.05135267, 0.06598155])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02337849, 0.01962075]), 'recall': array([0.05154333, 0.08585489]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-05]), 2: array([1.57888089e-05, 1.10521662e-04]), 3: array([0.00012631, 0.00050261]), 4: array([0.00028946, 0.00118784]), 5: array([0.00063682, 0.00236516]), 6: array([0.00198939, 0.00554206]), 7: array([0.00639444, 0.01499056]), 8: array([0.01903428, 0.04014679]), 9: array([0.11888711, 0.18525157])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.77185522e-05]), 2: array([6.31552356e-06, 2.94724433e-05]), 3: array([3.42466783e-05, 1.05009819e-04]), 4: array([6.43843932e-05, 2.42342181e-04]), 5: array([0.00012369, 0.00040806]), 6: array([0.00038797, 0.001047  ]), 7: array([0.00127541, 0.00294309]), 8: array([0.00422638, 0.0089143 ]), 9: array([0.04542493, 0.0721479 ])}, 'ndcg': array([0.04222637, 0.05521594])}
total time cost of epoch 63:  678.5089659690857
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[64]:loss 0.368
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01775136, 0.01420519]), 'recall': array([0.08383098, 0.13240351]), 'ndcg': array([0.05137781, 0.06594187])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08383097586537064[0m [0;37;44m++7.152659374445869e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02335165, 0.01959549]), 'recall': array([0.05147312, 0.08583673]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 6.31552356e-05]), 2: array([1.57888089e-05, 1.21047535e-04]), 3: array([0.00012631, 0.00053419]), 4: array([0.00033683, 0.00132205]), 5: array([0.00068944, 0.00244253]), 6: array([0.00200571, 0.00565164]), 7: array([0.00667154, 0.01516085]), 8: array([0.01916243, 0.04040195]), 9: array([0.11844384, 0.1847978 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 1.77185522e-05]), 2: array([6.31552356e-06, 3.57879668e-05]), 3: array([3.42466783e-05, 1.02079320e-04]), 4: array([7.35945317e-05, 2.62228561e-04]), 5: array([0.00013291, 0.00043448]), 6: array([0.00038904, 0.00107633]), 7: array([0.00130912, 0.00298903]), 8: array([0.00425094, 0.0089754 ]), 9: array([0.04527695, 0.07194368])}, 'ndcg': array([0.04213907, 0.05514661])}
total time cost of epoch 64:  678.982216835022
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[65]:loss 0.367
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01776241, 0.0142194 ]), 'recall': array([0.08378897, 0.13243609]), 'ndcg': array([0.05140255, 0.06600021])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02341165, 0.0196547 ]), 'recall': array([0.05161034, 0.08618064]), 'recall_pop': {0: array([0.00000000e+00, 1.05258726e-05]), 1: array([0.00000000e+00, 6.31552356e-05]), 2: array([1.57888089e-05, 1.31573407e-04]), 3: array([0.00015789, 0.00054471]), 4: array([0.00038419, 0.00130205]), 5: array([0.00066839, 0.00256094]), 6: array([0.00203202, 0.00576698]), 7: array([0.0065247 , 0.01530213]), 8: array([0.01926363, 0.04048491]), 9: array([0.11863815, 0.18537394])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 3.15776178e-06]), 1: array([0.00000000e+00, 1.68413962e-05]), 2: array([6.31552356e-06, 4.21034904e-05]), 3: array([3.87577666e-05, 1.06590408e-04]), 4: array([8.44211435e-05, 2.66150702e-04]), 5: array([0.00012612, 0.00045377]), 6: array([0.0003953 , 0.00107404]), 7: array([0.0013021 , 0.00302926]), 8: array([0.00427668, 0.00901539]), 9: array([0.04538064, 0.07217332])}, 'ndcg': array([0.04222176, 0.0552898 ])}
total time cost of epoch 65:  667.4088666439056
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[66]:loss 0.366
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01775609, 0.01428729]), 'recall': array([0.08395601, 0.13310909]), 'ndcg': array([0.05147786, 0.06622921])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08395600640029294[0m [0;37;44m++0.0001250305349222991[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02344322, 0.0196618 ]), 'recall': array([0.05169986, 0.08619967]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 7.36811082e-05]), 2: array([1.57888089e-05, 1.21047535e-04]), 3: array([0.0001421, 0.0005605]), 4: array([0.00035788, 0.00134836]), 5: array([0.00067629, 0.00230727]), 6: array([0.00205307, 0.00584103]), 7: array([0.00678179, 0.01554948]), 8: array([0.01940817, 0.04052053]), 9: array([0.11878732, 0.18543081])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.16657544e-05]), 2: array([6.31552356e-06, 3.57879668e-05]), 3: array([3.34948303e-05, 1.14903455e-04]), 4: array([7.49478582e-05, 2.70736975e-04]), 5: array([0.00013891, 0.00040752]), 6: array([0.00040769, 0.00110419]), 7: array([0.00134586, 0.00307101]), 8: array([0.00430011, 0.00900696]), 9: array([0.04539254, 0.0721669 ])}, 'ndcg': array([0.04221166, 0.05525574])}
total time cost of epoch 66:  666.5753393173218
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[67]:loss 0.366
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0177782 , 0.01429124]), 'recall': array([0.08406134, 0.13300984]), 'ndcg': array([0.05154022, 0.0662418 ])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08406133643320685[0m [0;37;44m++0.00010533003291390841[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02338007, 0.01969733]), 'recall': array([0.05149658, 0.08629083]), 'recall_pop': {0: array([0.00000000e+00, 1.05258726e-05]), 1: array([0.00000000e+00, 6.31552356e-05]), 2: array([1.57888089e-05, 1.31573407e-04]), 3: array([0.00011052, 0.0005605 ]), 4: array([0.00042103, 0.00142415]), 5: array([0.00066576, 0.00249147]), 6: array([0.00206623, 0.00600193]), 7: array([0.00666575, 0.01554922]), 8: array([0.01927433, 0.0404461 ]), 9: array([0.1182783 , 0.18536778])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 3.15776178e-06]), 1: array([0.00000000e+00, 1.77185522e-05]), 2: array([6.31552356e-06, 4.21034904e-05]), 3: array([2.89837420e-05, 1.12391599e-04]), 4: array([8.65263181e-05, 2.90385270e-04]), 5: array([0.00013627, 0.00043465]), 6: array([0.00040514, 0.00113634]), 7: array([0.00133128, 0.00307824]), 8: array([0.00427707, 0.00898028]), 9: array([0.04522499, 0.07219557])}, 'ndcg': array([0.0421883 , 0.05535926])}
total time cost of epoch 67:  669.4288103580475
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[68]:loss 0.365
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01776557, 0.01430308]), 'recall': array([0.08373215, 0.13327932]), 'ndcg': array([0.05152992, 0.06636148])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02336744, 0.01965865]), 'recall': array([0.0514663 , 0.08611077]), 'recall_pop': {0: array([0.00000000e+00, 1.05258726e-05]), 1: array([0.00000000e+00, 8.42069808e-05]), 2: array([0.        , 0.00012105]), 3: array([0.00011052, 0.00050787]), 4: array([0.00038946, 0.00146941]), 5: array([0.0006105 , 0.00260305]), 6: array([0.00201097, 0.00613933]), 7: array([0.00682627, 0.01533658]), 8: array([0.01970094, 0.04059323]), 9: array([0.1179033 , 0.18506881])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 3.15776178e-06]), 1: array([0.00000000e+00, 2.48235162e-05]), 2: array([0.00000000e+00, 3.57879668e-05]), 3: array([2.89837420e-05, 1.06889439e-04]), 4: array([8.02107945e-05, 2.91187242e-04]), 5: array([0.00012259, 0.00045414]), 6: array([0.00038697, 0.00115929]), 7: array([0.00134254, 0.00303078]), 8: array([0.00439175, 0.00899158]), 9: array([0.04511326, 0.07201314])}, 'ndcg': array([0.04221012, 0.05532108])}
total time cost of epoch 68:  679.6888298988342
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[69]:loss 0.364
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01779083, 0.01434492]), 'recall': array([0.08394404, 0.1334631 ]), 'ndcg': array([0.05158671, 0.0664299 ])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02340375, 0.01967917]), 'recall': array([0.05158261, 0.08626075]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 7.89440445e-05]), 2: array([0.        , 0.00012105]), 3: array([0.00011052, 0.00060261]), 4: array([0.00037893, 0.00137678]), 5: array([0.00071313, 0.00252042]), 6: array([0.00201097, 0.00610117]), 7: array([0.00674807, 0.01559476]), 8: array([0.02000073, 0.04132532]), 9: array([0.11788691, 0.18515258])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 2.40340758e-05]), 2: array([0.00000000e+00, 3.57879668e-05]), 3: array([2.89837420e-05, 1.16458414e-04]), 4: array([7.67021703e-05, 2.70599136e-04]), 5: array([0.00014312, 0.00044621]), 6: array([0.00038835, 0.00116649]), 7: array([0.00133717, 0.00309866]), 8: array([0.0044475 , 0.00913207]), 9: array([0.04515447, 0.07197045])}, 'ndcg': array([0.04225329, 0.05536985])}
total time cost of epoch 69:  675.8808324337006
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[70]:loss 0.364
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01785399, 0.01430387]), 'recall': array([0.08418534, 0.13315149]), 'ndcg': array([0.05170727, 0.06637358])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.084185340983843[0m [0;37;44m++0.00012400455063615867[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02347796, 0.01967917]), 'recall': array([0.05181168, 0.08612329]), 'recall_pop': {0: array([0.00000000e+00, 1.05258726e-05]), 1: array([1.57888089e-05, 7.36811082e-05]), 2: array([0.        , 0.00015263]), 3: array([0.00011052, 0.00057103]), 4: array([0.00034209, 0.00143362]), 5: array([0.00065524, 0.00248358]), 6: array([0.00203991, 0.00616576]), 7: array([0.00700521, 0.01569519]), 8: array([0.02016141, 0.04133467]), 9: array([0.1181593 , 0.18468891])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 3.15776178e-06]), 1: array([6.31552356e-06, 2.44726538e-05]), 2: array([0.00000000e+00, 4.21034904e-05]), 3: array([2.89837420e-05, 1.16219189e-04]), 4: array([7.17023808e-05, 2.76250527e-04]), 5: array([0.00014027, 0.00044427]), 6: array([0.00039775, 0.00117623]), 7: array([0.00137881, 0.00311915]), 8: array([0.00450774, 0.0091425 ]), 9: array([0.04528012, 0.07177894])}, 'ndcg': array([0.04237202, 0.05536449])}
[5;37;44mfind a better recall[0m [0;37;44m0.05181168103153235[0m [0;37;44m++1.3464992255116104e-05[0m
total time cost of epoch 70:  668.1852834224701
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[71]:loss 0.363
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01789977, 0.01432992]), 'recall': array([0.08425643, 0.1334114 ]), 'ndcg': array([0.05179432, 0.06649455])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08425642614241448[0m [0;37;44m++7.10851585714739e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02343533, 0.01968549]), 'recall': array([0.05159669, 0.08609901]), 'recall_pop': {0: array([0.00000000e+00, 1.05258726e-05]), 1: array([1.57888089e-05, 7.36811082e-05]), 2: array([0.        , 0.00012105]), 3: array([0.00011052, 0.00059208]), 4: array([0.00033156, 0.00137047]), 5: array([0.00069471, 0.00253358]), 6: array([0.00212149, 0.00626853]), 7: array([0.00685969, 0.01576492]), 8: array([0.02015394, 0.04166831]), 9: array([0.11782095, 0.18424085])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 3.15776178e-06]), 1: array([6.31552356e-06, 2.44726538e-05]), 2: array([0.00000000e+00, 3.57879668e-05]), 3: array([2.89837420e-05, 1.16458414e-04]), 4: array([6.64394445e-05, 2.63093187e-04]), 5: array([0.00014771, 0.00045591]), 6: array([0.00041303, 0.00118706]), 7: array([0.00135266, 0.00314775]), 8: array([0.00448126, 0.00919877]), 9: array([0.04510029, 0.07166655])}, 'ndcg': array([0.04230206, 0.05536965])}
total time cost of epoch 71:  667.6465902328491
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[72]:loss 0.363
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01784609, 0.01433545]), 'recall': array([0.08401317, 0.1333873 ]), 'ndcg': array([0.05175936, 0.06654613])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02345901, 0.01970838]), 'recall': array([0.05170256, 0.08617852]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 7.36811082e-05]), 2: array([0.        , 0.00012105]), 3: array([0.00012631, 0.0005605 ]), 4: array([0.00034209, 0.001361  ]), 5: array([0.00065524, 0.00259484]), 6: array([0.00213728, 0.00624365]), 7: array([0.00700486, 0.01583395]), 8: array([0.02049565, 0.0416903 ]), 9: array([0.11759507, 0.18476326])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 2.08763140e-05]), 2: array([0.00000000e+00, 3.57879668e-05]), 3: array([3.04190883e-05, 1.13587721e-04]), 4: array([6.99480687e-05, 2.71739439e-04]), 5: array([0.00013746, 0.00046244]), 6: array([0.00041241, 0.00118118]), 7: array([0.00138221, 0.00317158]), 8: array([0.00456365, 0.00920295]), 9: array([0.04510015, 0.07171837])}, 'ndcg': array([0.04235417, 0.05542995])}
total time cost of epoch 72:  680.229499578476
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[73]:loss 0.362
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01788872, 0.01434887]), 'recall': array([0.08414458, 0.13347975]), 'ndcg': array([0.05176852, 0.06654635])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02344638, 0.01969022]), 'recall': array([0.05163601, 0.08619235]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 7.36811082e-05]), 2: array([0.        , 0.00015263]), 3: array([0.00012631, 0.00059208]), 4: array([0.00035788, 0.00139257]), 5: array([0.00071839, 0.00257642]), 6: array([0.00210044, 0.00635522]), 7: array([0.00706284, 0.01612245]), 8: array([0.02036688, 0.04203982]), 9: array([0.11763808, 0.18412262])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 2.08763140e-05]), 2: array([0.00000000e+00, 4.21034904e-05]), 3: array([3.04190883e-05, 1.20286004e-04]), 4: array([7.62635923e-05, 2.79195265e-04]), 5: array([0.00014033, 0.00046072]), 6: array([0.00041286, 0.00119637]), 7: array([0.00139898, 0.00320311]), 8: array([0.0045529 , 0.00927388]), 9: array([0.04501794, 0.07159582])}, 'ndcg': array([0.04229535, 0.05538032])}
total time cost of epoch 73:  673.7584853172302
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[74]:loss 0.362
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01793924, 0.01438597]), 'recall': array([0.08454752, 0.13368766]), 'ndcg': array([0.05201438, 0.06675486])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08454752262901445[0m [0;37;44m++0.0002910964865999732[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02348901, 0.01972733]), 'recall': array([0.05175372, 0.08648984]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 7.36811082e-05]), 2: array([0.        , 0.00015263]), 3: array([0.00011052, 0.00067629]), 4: array([0.00034735, 0.00138415]), 5: array([0.00080786, 0.00257642]), 6: array([0.00218043, 0.0063259 ]), 7: array([0.0073026 , 0.01656044]), 8: array([0.02062803, 0.04274207]), 9: array([0.11741161, 0.18430774])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 2.08763140e-05]), 2: array([0.00000000e+00, 4.21034904e-05]), 3: array([2.89837420e-05, 1.36074813e-04]), 4: array([7.27549681e-05, 2.73556405e-04]), 5: array([0.00015574, 0.00046981]), 6: array([0.00042105, 0.00119403]), 7: array([0.00145526, 0.00330112]), 8: array([0.00460143, 0.00943158]), 9: array([0.04501219, 0.0716207 ])}, 'ndcg': array([0.04242292, 0.05555526])}
total time cost of epoch 74:  673.4492406845093
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[75]:loss 0.362
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01790451, 0.01437808]), 'recall': array([0.08454149, 0.13371076]), 'ndcg': array([0.05202889, 0.06678464])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02343217, 0.01971706]), 'recall': array([0.05165587, 0.0863632 ]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 8.94699171e-05]), 2: array([1.57888089e-05, 1.52625153e-04]), 3: array([0.00011052, 0.00062366]), 4: array([0.00043682, 0.00143362]), 5: array([0.00077628, 0.00267378]), 6: array([0.00214886, 0.00636312]), 7: array([0.00721148, 0.01631148]), 8: array([0.02057228, 0.04279978]), 9: array([0.11747071, 0.18396477])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 2.71918375e-05]), 2: array([6.31552356e-06, 4.21034904e-05]), 3: array([2.89837420e-05, 1.30060028e-04]), 4: array([9.09758915e-05, 2.83518392e-04]), 5: array([0.00014802, 0.00049266]), 6: array([0.00041667, 0.00119922]), 7: array([0.00142558, 0.00322921]), 8: array([0.00458382, 0.00946178]), 9: array([0.04494919, 0.07149746])}, 'ndcg': array([0.04230104, 0.0554435 ])}
total time cost of epoch 75:  665.0464112758636
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[76]:loss 0.360
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01796609, 0.01437966]), 'recall': array([0.08463287, 0.13356854]), 'ndcg': array([0.05203485, 0.06671658])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08463286913129822[0m [0;37;44m++8.534650228377016e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02334691, 0.01967522]), 'recall': array([0.05143918, 0.08614437]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 9.99957897e-05]), 2: array([1.57888089e-05, 1.52625153e-04]), 3: array([0.00015789, 0.00062892]), 4: array([0.00043156, 0.00141784]), 5: array([0.0008086 , 0.00267378]), 6: array([0.00213728, 0.00630748]), 7: array([0.00728147, 0.01660131]), 8: array([0.02038225, 0.04281039]), 9: array([0.1168218 , 0.18318255])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.11390398e-05]), 2: array([6.31552356e-06, 4.21034904e-05]), 3: array([3.32897808e-05, 1.27210920e-04]), 4: array([8.86075701e-05, 2.86901708e-04]), 5: array([0.0001566 , 0.00048609]), 6: array([0.00041629, 0.00118796]), 7: array([0.00143145, 0.00330395]), 8: array([0.00455012, 0.00944261]), 9: array([0.04475651, 0.0712364 ])}, 'ndcg': array([0.0422722 , 0.05542614])}
total time cost of epoch 76:  672.6886434555054
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[77]:loss 0.360
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01797872, 0.01438597]), 'recall': array([0.08459767, 0.13368914]), 'ndcg': array([0.05213507, 0.06684923])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02338796, 0.0196918 ]), 'recall': array([0.05151522, 0.08612942]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 8.94699171e-05]), 2: array([1.57888089e-05, 1.52625153e-04]), 3: array([0.00011052, 0.00067102]), 4: array([0.00041577, 0.0013231 ]), 5: array([0.00077702, 0.00281693]), 6: array([0.00224096, 0.00635605]), 7: array([0.00746173, 0.01643952]), 8: array([0.02049541, 0.04260346]), 9: array([0.11663042, 0.18342323])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.71918375e-05]), 2: array([6.31552356e-06, 4.21034904e-05]), 3: array([2.89837420e-05, 1.32104767e-04]), 4: array([8.30814870e-05, 2.63444049e-04]), 5: array([0.00015581, 0.00050634]), 6: array([0.00043866, 0.00119835]), 7: array([0.00148195, 0.00326275]), 8: array([0.00456427, 0.00938671]), 9: array([0.04475615, 0.07131043])}, 'ndcg': array([0.04226468, 0.05538119])}
total time cost of epoch 77:  669.3978598117828
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[78]:loss 0.360
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01799293, 0.01438124]), 'recall': array([0.08474531, 0.13361856]), 'ndcg': array([0.0521087, 0.0667708])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08474531447664946[0m [0;37;44m++0.0001124453453512364[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02336744, 0.01969733]), 'recall': array([0.05148097, 0.08616165]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 8.94699171e-05]), 2: array([4.73664267e-05, 1.52625153e-04]), 3: array([0.00011052, 0.0007026 ]), 4: array([0.00037367, 0.00140994]), 5: array([0.00074471, 0.00295567]), 6: array([0.00223306, 0.00640341]), 7: array([0.00757323, 0.01657665]), 8: array([0.02044076, 0.04274502]), 9: array([0.11687866, 0.18329717])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 2.71918375e-05]), 2: array([1.15784599e-05, 4.21034904e-05]), 3: array([2.89837420e-05, 1.41100233e-04]), 4: array([7.38952709e-05, 2.78855006e-04]), 5: array([0.00014706, 0.00052545]), 6: array([0.00043771, 0.00121145]), 7: array([0.00149453, 0.00327707]), 8: array([0.00455385, 0.00941143]), 9: array([0.04473337, 0.07124699])}, 'ndcg': array([0.04221649, 0.05537092])}
total time cost of epoch 78:  668.3952841758728
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[79]:loss 0.360
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01801029, 0.01435834]), 'recall': array([0.08482834, 0.13355309]), 'ndcg': array([0.05218239, 0.06678441])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08482833919675017[0m [0;37;44m++8.302472010071615e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02336744, 0.01968312]), 'recall': array([0.0515263 , 0.08613009]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00012105]), 2: array([4.73664267e-05, 1.52625153e-04]), 3: array([0.0001421 , 0.00071839]), 4: array([0.00036841, 0.00142573]), 5: array([0.00074471, 0.00297145]), 6: array([0.00228832, 0.00639063]), 7: array([0.00737053, 0.01669076]), 8: array([0.02080259, 0.0431504 ]), 9: array([0.11663516, 0.18279052])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.24923662e-05]), 2: array([1.15784599e-05, 4.21034904e-05]), 3: array([3.29309443e-05, 1.42762213e-04]), 4: array([7.94213541e-05, 2.84418682e-04]), 5: array([0.00014355, 0.00052925]), 6: array([0.00044654, 0.00123176]), 7: array([0.00147878, 0.00330267]), 8: array([0.0046356 , 0.00951497]), 9: array([0.04469789, 0.07104967])}, 'ndcg': array([0.0422769 , 0.05539497])}
total time cost of epoch 79:  666.5930972099304
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[80]:loss 0.360
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0179724, 0.0143986]), 'recall': array([0.08460675, 0.13408941]), 'ndcg': array([0.05218273, 0.06698976])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02335007, 0.0196997 ]), 'recall': array([0.05147366, 0.08626525]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00013157]), 2: array([4.73664267e-05, 1.52625153e-04]), 3: array([0.00015789, 0.00071839]), 4: array([0.00037893, 0.00135994]), 5: array([0.0008447 , 0.00288619]), 6: array([0.00227254, 0.00644326]), 7: array([0.00785479, 0.01708443]), 8: array([0.02068667, 0.04351445]), 9: array([0.11642594, 0.18299305])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.0000000e+00, 3.5650128e-05]), 2: array([1.15784599e-05, 4.21034904e-05]), 3: array([3.43662905e-05, 1.42762213e-04]), 4: array([8.46842903e-05, 2.76451020e-04]), 5: array([0.00017251, 0.0005107 ]), 6: array([0.0004436 , 0.00124373]), 7: array([0.00156497, 0.00337732]), 8: array([0.00461116, 0.00957345]), 9: array([0.04455078, 0.07106307])}, 'ndcg': array([0.04221136, 0.05538691])}
total time cost of epoch 80:  686.0262644290924
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[81]:loss 0.359
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01803714, 0.01437018]), 'recall': array([0.08490274, 0.13360372]), 'ndcg': array([0.05230775, 0.06689932])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08490273703849194[0m [0;37;44m++7.439784174176345e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02324586, 0.01966101]), 'recall': array([0.05136156, 0.08612896]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00013157]), 2: array([6.31552356e-05, 1.52625153e-04]), 3: array([0.00012631, 0.00065524]), 4: array([0.00033683, 0.00139784]), 5: array([0.00078754, 0.00299745]), 6: array([0.00220833, 0.00646431]), 7: array([0.00757793, 0.0168664 ]), 8: array([0.02062919, 0.04325418]), 9: array([0.11631387, 0.18286917])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.0000000e+00, 3.5650128e-05]), 2: array([1.05258726e-05, 4.21034904e-05]), 3: array([3.04190883e-05, 1.35011344e-04]), 4: array([7.24918213e-05, 2.80899454e-04]), 5: array([0.00015443, 0.00053268]), 6: array([0.00043309, 0.001238  ]), 7: array([0.00151347, 0.00332497]), 8: array([0.00461035, 0.00950034]), 9: array([0.04453678, 0.07103931])}, 'ndcg': array([0.04207589, 0.05527887])}
total time cost of epoch 81:  690.9619152545929
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[82]:loss 0.358
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01804029, 0.0144136 ]), 'recall': array([0.08496782, 0.13386557]), 'ndcg': array([0.05229083, 0.06695377])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0849678242238556[0m [0;37;44m++6.508718536366032e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02329639, 0.01966654]), 'recall': array([0.05144616, 0.08600614]), 'recall_pop': {0: array([0., 0.]), 1: array([3.15776178e-05, 1.31573407e-04]), 2: array([3.15776178e-05, 1.52625153e-04]), 3: array([0.00011052, 0.00069208]), 4: array([0.00037893, 0.00144415]), 5: array([0.00097175, 0.0030185 ]), 6: array([0.0023478 , 0.00658341]), 7: array([0.00757766, 0.01724209]), 8: array([0.02073533, 0.04315848]), 9: array([0.11602129, 0.18230044])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([7.89440445e-06, 3.56501280e-05]), 2: array([5.26293630e-06, 4.21034904e-05]), 3: array([2.89837420e-05, 1.36164747e-04]), 4: array([8.27545470e-05, 2.81814203e-04]), 5: array([0.00019613, 0.00053531]), 6: array([0.00046248, 0.0012625 ]), 7: array([0.00152551, 0.00340982]), 8: array([0.00463492, 0.00950041]), 9: array([0.04450222, 0.07080238])}, 'ndcg': array([0.04218085, 0.05530978])}
total time cost of epoch 82:  670.1215102672577
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[83]:loss 0.358
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0180545 , 0.01443255]), 'recall': array([0.0849881 , 0.13408928]), 'ndcg': array([0.05231934, 0.06703168])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.0849880968920574[0m [0;37;44m++2.027266820180118e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02330428, 0.01965786]), 'recall': array([0.05146943, 0.08597723]), 'recall_pop': {0: array([0., 0.]), 1: array([3.15776178e-05, 8.42069808e-05]), 2: array([4.73664267e-05, 1.52625153e-04]), 3: array([0.00011052, 0.00063945]), 4: array([0.00036314, 0.00144257]), 5: array([0.00095596, 0.00295008]), 6: array([0.00232411, 0.0065492 ]), 7: array([0.00786344, 0.01737323]), 8: array([0.02081916, 0.04337528]), 9: array([0.11594683, 0.18209377])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([7.89440445e-06, 2.48235162e-05]), 2: array([1.15784599e-05, 4.21034904e-05]), 3: array([2.8983742e-05, 1.2727927e-04]), 4: array([8.27545470e-05, 2.87238112e-04]), 5: array([0.00019498, 0.00051901]), 6: array([0.00045328, 0.00126328]), 7: array([0.00157519, 0.0034451 ]), 8: array([0.00465383, 0.0095648 ]), 9: array([0.04446095, 0.07070359])}, 'ndcg': array([0.04222676, 0.05533668])}
total time cost of epoch 83:  680.8603131771088
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[84]:loss 0.357
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01803556, 0.01439781]), 'recall': array([0.08497007, 0.13371181]), 'ndcg': array([0.05238084, 0.06701118])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02325376, 0.01969259]), 'recall': array([0.05130281, 0.08617901]), 'recall_pop': {0: array([0., 0.]), 1: array([3.15776178e-05, 1.47362216e-04]), 2: array([4.73664267e-05, 1.52625153e-04]), 3: array([0.00011052, 0.00067102]), 4: array([0.00041051, 0.00150309]), 5: array([0.00087102, 0.00307639]), 6: array([0.00230148, 0.00669393]), 7: array([0.00775818, 0.017326  ]), 8: array([0.02079911, 0.04349666]), 9: array([0.11542829, 0.18221608])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([7.89440445e-06, 3.38456927e-05]), 2: array([1.15784599e-05, 4.21034904e-05]), 3: array([2.89837420e-05, 1.33594793e-04]), 4: array([9.11752451e-05, 2.90623356e-04]), 5: array([0.00017899, 0.00054609]), 6: array([0.00045277, 0.00127363]), 7: array([0.00155427, 0.00343991]), 8: array([0.004654  , 0.00960114]), 9: array([0.04432315, 0.07081807])}, 'ndcg': array([0.04220045, 0.05544917])}
total time cost of epoch 84:  682.3767464160919
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[85]:loss 0.357
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01805608, 0.01440492]), 'recall': array([0.08516766, 0.1338065 ]), 'ndcg': array([0.05250163, 0.06709565])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08516766396873458[0m [0;37;44m++0.00017956707667718397[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02337533, 0.01970522]), 'recall': array([0.05157508, 0.0861873 ]), 'recall_pop': {0: array([0., 0.]), 1: array([3.15776178e-05, 1.31573407e-04]), 2: array([7.89440445e-05, 1.52625153e-04]), 3: array([0.00011052, 0.00067102]), 4: array([0.00041051, 0.0014531 ]), 5: array([0.00083944, 0.00312639]), 6: array([0.00237411, 0.00672682]), 7: array([0.00801817, 0.01741179]), 8: array([0.02122655, 0.04387141]), 9: array([0.11599962, 0.18171769])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([7.89440445e-06, 3.56501280e-05]), 2: array([1.78939834e-05, 4.21034904e-05]), 3: array([2.89837420e-05, 1.34628585e-04]), 4: array([8.95963642e-05, 2.88194308e-04]), 5: array([0.00017439, 0.00055025]), 6: array([0.00045788, 0.00127436]), 7: array([0.00158868, 0.0034431 ]), 8: array([0.00475707, 0.0097161 ]), 9: array([0.0444527 , 0.07070291])}, 'ndcg': array([0.04234978, 0.05548826])}
total time cost of epoch 85:  665.9220230579376
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[86]:loss 0.357
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01805924, 0.01447202]), 'recall': array([0.08482204, 0.13434917]), 'ndcg': array([0.05235345, 0.06718633])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02332007, 0.01970838]), 'recall': array([0.05152712, 0.08630392]), 'recall_pop': {0: array([0., 0.]), 1: array([3.15776178e-05, 1.68413962e-04]), 2: array([0.00011052, 0.00019473]), 3: array([0.0001421 , 0.00060787]), 4: array([0.00042103, 0.00149941]), 5: array([0.00083944, 0.00306692]), 6: array([0.00241358, 0.00655089]), 7: array([0.00771029, 0.01748913]), 8: array([0.0209923 , 0.04415824]), 9: array([0.11625177, 0.18221093])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([7.89440445e-06, 4.25295376e-05]), 2: array([2.31569197e-05, 5.26293630e-05]), 3: array([3.52992656e-05, 1.23801973e-04]), 4: array([9.31049884e-05, 2.93806811e-04]), 5: array([0.00016951, 0.00054282]), 6: array([0.00046195, 0.00124576]), 7: array([0.00152816, 0.00346935]), 8: array([0.00468571, 0.0097588 ]), 9: array([0.04452234, 0.07077442])}, 'ndcg': array([0.04231412, 0.05551427])}
total time cost of epoch 86:  664.9059896469116
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[87]:loss 0.356
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01807503, 0.01450992]), 'recall': array([0.08482989, 0.13465479]), 'ndcg': array([0.05239301, 0.06731108])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02339744, 0.01971864]), 'recall': array([0.05161932, 0.08627658]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 1.15784599e-04]), 2: array([7.89440445e-05, 1.94728643e-04]), 3: array([0.00015263, 0.00060787]), 4: array([0.00041051, 0.00149257]), 5: array([0.00087102, 0.00303534]), 6: array([0.00248463, 0.00664525]), 7: array([0.008079  , 0.01752409]), 8: array([0.02108956, 0.04486533]), 9: array([0.1159963 , 0.18192012])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 3.74545633e-05]), 2: array([1.68413962e-05, 5.26293630e-05]), 3: array([3.98103538e-05, 1.23801973e-04]), 4: array([8.78420521e-05, 2.89657188e-04]), 5: array([0.00017214, 0.00053872]), 6: array([0.00047803, 0.00124475]), 7: array([0.0016    , 0.00347394]), 8: array([0.00472817, 0.00988485]), 9: array([0.04449018, 0.07063079])}, 'ndcg': array([0.04237722, 0.05552237])}
total time cost of epoch 87:  670.6105027198792
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[88]:loss 0.356
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01807977, 0.01444597]), 'recall': array([0.08504259, 0.13415315]), 'ndcg': array([0.05243528, 0.06715137])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02339744, 0.01974312]), 'recall': array([0.0515477 , 0.08640234]), 'recall_pop': {0: array([0., 0.]), 1: array([1.57888089e-05, 9.47328534e-05]), 2: array([7.89440445e-05, 1.94728643e-04]), 3: array([0.00015263, 0.00060787]), 4: array([0.00036841, 0.00146099]), 5: array([0.0008447, 0.0030185]), 6: array([0.00252147, 0.00679073]), 7: array([0.00803426, 0.01762929]), 8: array([0.0212108 , 0.04447862]), 9: array([0.11621982, 0.18232866])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([6.31552356e-06, 3.03495993e-05]), 2: array([1.78939834e-05, 5.26293630e-05]), 3: array([3.98103538e-05, 1.22749385e-04]), 4: array([7.90704916e-05, 2.87201151e-04]), 5: array([0.00017076, 0.00053382]), 6: array([0.0004877 , 0.00127946]), 7: array([0.00158651, 0.00350698]), 8: array([0.00470232, 0.00981445]), 9: array([0.04445732, 0.07077471])}, 'ndcg': array([0.04236386, 0.05557165])}
total time cost of epoch 88:  683.1073815822601
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[89]:loss 0.356
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01810029, 0.01444913]), 'recall': array([0.0851335, 0.1341518]), 'ndcg': array([0.05246504, 0.0671505 ])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02338796, 0.01976443]), 'recall': array([0.05152605, 0.0864428 ]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00013684]), 2: array([7.89440445e-05, 1.63151025e-04]), 3: array([0.00015263, 0.00056577]), 4: array([0.00038946, 0.00139784]), 5: array([0.00095522, 0.00303429]), 6: array([0.00250305, 0.00682419]), 7: array([0.00797742, 0.01793988]), 8: array([0.02147598, 0.04493955]), 9: array([0.11610613, 0.18208712])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.80184493e-05]), 2: array([1.78939834e-05, 4.47349585e-05]), 3: array([3.98103538e-05, 1.12223513e-04]), 4: array([8.32808407e-05, 2.75572568e-04]), 5: array([0.00019292, 0.00052962]), 6: array([0.0004773 , 0.00130327]), 7: array([0.00157306, 0.00357598]), 8: array([0.0047555 , 0.00988307]), 9: array([0.04438629, 0.0706803 ])}, 'ndcg': array([0.04236179, 0.05560404])}
total time cost of epoch 89:  664.9072508811951
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[90]:loss 0.355
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01814134, 0.0144436 ]), 'recall': array([0.08525866, 0.13407322]), 'ndcg': array([0.05262419, 0.06723559])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08525866042519434[0m [0;37;44m++9.099645645975485e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02333744, 0.0197368 ]), 'recall': array([0.0514055 , 0.08635238]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00013684]), 2: array([7.89440445e-05, 1.52625153e-04]), 3: array([0.0001421 , 0.00063945]), 4: array([0.00035788, 0.00151783]), 5: array([0.0009447 , 0.00305534]), 6: array([0.00247561, 0.00674366]), 7: array([0.00795795, 0.01767198]), 8: array([0.02133995, 0.04451099]), 9: array([0.11592964, 0.18191293])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.80184493e-05]), 2: array([1.78939834e-05, 4.21034904e-05]), 3: array([3.52992656e-05, 1.27260474e-04]), 4: array([7.06497936e-05, 2.94691879e-04]), 5: array([0.00019121, 0.0005301 ]), 6: array([0.00047181, 0.0012817 ]), 7: array([0.00156208, 0.00354569]), 8: array([0.00473896, 0.0098192 ]), 9: array([0.04431761, 0.07067361])}, 'ndcg': array([0.04231164, 0.05557186])}
total time cost of epoch 90:  664.9457890987396
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[91]:loss 0.355
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0181745, 0.0144215]), 'recall': array([0.08550113, 0.13392628]), 'ndcg': array([0.05274893, 0.06724704])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08550112576531217[0m [0;37;44m++0.00024246534011783394[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02342901, 0.01973127]), 'recall': array([0.05172255, 0.08626337]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 9.47328534e-05]), 2: array([7.89440445e-05, 1.42099280e-04]), 3: array([0.0001421 , 0.00064734]), 4: array([0.00037367, 0.00159677]), 5: array([0.00092365, 0.0031406 ]), 6: array([0.00257147, 0.0068505 ]), 7: array([0.00822854, 0.01774112]), 8: array([0.02129754, 0.04487707]), 9: array([0.11651657, 0.18135676])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.03495993e-05]), 2: array([1.78939834e-05, 3.57879668e-05]), 3: array([3.52992656e-05, 1.31426965e-04]), 4: array([7.69653171e-05, 3.07147495e-04]), 5: array([0.00018265, 0.00054971]), 6: array([0.00050382, 0.00129726]), 7: array([0.00163086, 0.003552  ]), 8: array([0.00473747, 0.00988348]), 9: array([0.04453759, 0.0704762 ])}, 'ndcg': array([0.0424424 , 0.05554606])}
total time cost of epoch 91:  670.4193239212036
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[92]:loss 0.355
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.0181966 , 0.01441755]), 'recall': array([0.08556625, 0.13380495]), 'ndcg': array([0.05266497, 0.06711362])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08556625103603711[0m [0;37;44m++6.512527072494168e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02338638, 0.01971628]), 'recall': array([0.05154368, 0.08620571]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 9.47328534e-05]), 2: array([7.89440445e-05, 1.52625153e-04]), 3: array([0.00017368, 0.00062892]), 4: array([0.00036841, 0.00159677]), 5: array([0.00094996, 0.00323428]), 6: array([0.00255794, 0.00703997]), 7: array([0.00804637, 0.01768824]), 8: array([0.02155868, 0.04478035]), 9: array([0.11576949, 0.1813023 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.03495993e-05]), 2: array([1.78939834e-05, 4.21034904e-05]), 3: array([3.83965917e-05, 1.23407252e-04]), 4: array([8.20528222e-05, 3.01897089e-04]), 5: array([0.00019686, 0.00056482]), 6: array([0.00050271, 0.0013419 ]), 7: array([0.00159661, 0.00353463]), 8: array([0.00478526, 0.00983953]), 9: array([0.0443239 , 0.07042708])}, 'ndcg': array([0.04236205, 0.05550895])}
total time cost of epoch 92:  669.2168934345245
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[93]:loss 0.355
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01814924, 0.01446097]), 'recall': array([0.0852246 , 0.13421934]), 'ndcg': array([0.05261354, 0.06728467])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02338323, 0.01974233]), 'recall': array([0.05158256, 0.08632309]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00012631]), 2: array([4.73664267e-05, 1.99991579e-04]), 3: array([0.0001421 , 0.00067629]), 4: array([0.00033683, 0.00160467]), 5: array([0.00085523, 0.00337112]), 6: array([0.00261057, 0.00688734]), 7: array([0.00828027, 0.01790555]), 8: array([0.02151141, 0.04533329]), 9: array([0.11577442, 0.18106295])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.48606876e-05]), 2: array([1.15784599e-05, 5.45089831e-05]), 3: array([3.52992656e-05, 1.31038510e-04]), 4: array([6.78428942e-05, 3.12457487e-04]), 5: array([0.00017865, 0.00059421]), 6: array([0.00052331, 0.00129932]), 7: array([0.00165566, 0.00355588]), 8: array([0.00480766, 0.00994089]), 9: array([0.04430255, 0.07039993])}, 'ndcg': array([0.04233635, 0.05552614])}
total time cost of epoch 93:  667.4414293766022
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[94]:loss 0.354
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01819818, 0.01449492]), 'recall': array([0.08557744, 0.13444912]), 'ndcg': array([0.05276448, 0.06739903])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08557743540070029[0m [0;37;44m++1.1184364663172075e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02335954, 0.01976601]), 'recall': array([0.05153377, 0.08640877]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00012631]), 2: array([4.73664267e-05, 1.52625153e-04]), 3: array([0.00012105, 0.00067102]), 4: array([0.00036841, 0.00168361]), 5: array([0.00086049, 0.0034448 ]), 6: array([0.00264778, 0.00733086]), 7: array([0.00819097, 0.01806188]), 8: array([0.02161636, 0.04507819]), 9: array([0.11578047, 0.18123465])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.48606876e-05]), 2: array([1.15784599e-05, 4.21034904e-05]), 3: array([3.34948303e-05, 1.31489619e-04]), 4: array([7.07135867e-05, 3.18370729e-04]), 5: array([0.00017766, 0.00061652]), 6: array([0.00052609, 0.00136529]), 7: array([0.00162986, 0.00360179]), 8: array([0.00481802, 0.00990874]), 9: array([0.04426635, 0.0703896 ])}, 'ndcg': array([0.04228075, 0.05553344])}
total time cost of epoch 94:  678.6581239700317
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[95]:loss 0.354
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01819187, 0.01445387]), 'recall': array([0.0855792 , 0.13418456]), 'ndcg': array([0.05271097, 0.06725898])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08557919508384391[0m [0;37;44m++1.759683143628954e-06[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.0234148 , 0.01978732]), 'recall': array([0.05169906, 0.08641803]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00013684]), 2: array([4.73664267e-05, 1.84202770e-04]), 3: array([0.00012105, 0.00073418]), 4: array([0.00029472, 0.00162046]), 5: array([0.00090259, 0.00346059]), 6: array([0.0026553 , 0.00722503]), 7: array([0.00839202, 0.01804195]), 8: array([0.02171648, 0.04496926]), 9: array([0.1157211 , 0.18132127])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.80184493e-05]), 2: array([1.15784599e-05, 4.99978948e-05]), 3: array([3.34948303e-05, 1.42316231e-04]), 4: array([5.98231817e-05, 3.13421851e-04]), 5: array([0.00018501, 0.00061552]), 6: array([0.00051621, 0.00137247]), 7: array([0.00168636, 0.00357955]), 8: array([0.0048481, 0.0098976]), 9: array([0.04435849, 0.07040913])}, 'ndcg': array([0.04233604, 0.05553169])}
total time cost of epoch 95:  667.8552088737488
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[96]:loss 0.354
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01815555, 0.01446492]), 'recall': array([0.0853952 , 0.13402419]), 'ndcg': array([0.05263292, 0.06721633])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02340217, 0.01977785]), 'recall': array([0.05162969, 0.08640849]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00016841]), 2: array([4.73664267e-05, 1.84202770e-04]), 3: array([0.00012105, 0.00076576]), 4: array([0.00037367, 0.00162046]), 5: array([0.00089207, 0.00342217]), 6: array([0.00263951, 0.00712587]), 7: array([0.00838379, 0.01804529]), 8: array([0.02156655, 0.04509599]), 9: array([0.11572254, 0.1812608 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 4.43339729e-05]), 2: array([1.15784599e-05, 4.99978948e-05]), 3: array([3.34948303e-05, 1.45022884e-04]), 4: array([7.12649420e-05, 3.12692217e-04]), 5: array([0.00017777, 0.00062338]), 6: array([0.00051879, 0.00133934]), 7: array([0.00168349, 0.00359019]), 8: array([0.00482237, 0.00996022]), 9: array([0.04431093, 0.07034331])}, 'ndcg': array([0.04231807, 0.05553495])}
total time cost of epoch 96:  667.565958738327
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[97]:loss 0.353
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01814134, 0.01446255]), 'recall': array([0.08534963, 0.13402184]), 'ndcg': array([0.05263552, 0.06723589])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02346217, 0.01976601]), 'recall': array([0.05179561, 0.08632261]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00014736]), 2: array([4.73664267e-05, 1.84202770e-04]), 3: array([0.00012105, 0.00076576]), 4: array([0.00037367, 0.00157835]), 5: array([0.00093417, 0.00345901]), 6: array([0.00265004, 0.00739503]), 7: array([0.00838555, 0.01790517]), 8: array([0.0218162, 0.0450904]), 9: array([0.11608274, 0.18143999])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 4.19656516e-05]), 2: array([1.15784599e-05, 4.99978948e-05]), 3: array([3.34948303e-05, 1.46827319e-04]), 4: array([7.35204861e-05, 3.09629356e-04]), 5: array([0.00018993, 0.00062775]), 6: array([0.00052   , 0.00139344]), 7: array([0.00168748, 0.00354389]), 8: array([0.00484431, 0.0098985 ]), 9: array([0.04443529, 0.07031061])}, 'ndcg': array([0.0424255 , 0.05554235])}
total time cost of epoch 97:  664.8169329166412
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[98]:loss 0.353
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01821397, 0.01445781]), 'recall': array([0.08577295, 0.13406307]), 'ndcg': array([0.05282319, 0.06729119])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08577295011106388[0m [0;37;44m++0.00019375502721996618[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02339744, 0.01977548]), 'recall': array([0.05165051, 0.08638767]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00013684]), 2: array([4.73664267e-05, 1.84202770e-04]), 3: array([0.00011052, 0.00071839]), 4: array([0.00037367, 0.00158888]), 5: array([0.00087628, 0.00340217]), 6: array([0.00250005, 0.00756976]), 7: array([0.00843818, 0.01819556]), 8: array([0.02184133, 0.04568695]), 9: array([0.11557265, 0.18107174])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.80184493e-05]), 2: array([1.15784599e-05, 4.99978948e-05]), 3: array([2.89837420e-05, 1.38256251e-04]), 4: array([7.03627243e-05, 3.03182259e-04]), 5: array([0.0001756 , 0.00061925]), 6: array([0.00049631, 0.00140756]), 7: array([0.0016936 , 0.00361236]), 8: array([0.00487166, 0.01005512]), 9: array([0.04430243, 0.07016394])}, 'ndcg': array([0.0423602 , 0.05556189])}
total time cost of epoch 98:  666.5752897262573
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[99]:loss 0.352
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01821871, 0.0144665 ]), 'recall': array([0.08579015, 0.13412172]), 'ndcg': array([0.05283488, 0.0673228 ])}
[5;37;44mfind a better valid recall[0m [0;37;44m0.08579015012264457[0m [0;37;44m++1.7200011580689734e-05[0m
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.02340691, 0.01978338]), 'recall': array([0.05165618, 0.08648062]), 'recall_pop': {0: array([0., 0.]), 1: array([0.00000000e+00, 9.47328534e-05]), 2: array([4.73664267e-05, 1.84202770e-04]), 3: array([0.00011052, 0.00068681]), 4: array([0.00035788, 0.00152836]), 5: array([0.00092891, 0.00342743]), 6: array([0.00247937, 0.00746345]), 7: array([0.00828187, 0.01811143]), 8: array([0.02172362, 0.04620042]), 9: array([0.11578551, 0.1808035 ])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.03495993e-05]), 2: array([1.15784599e-05, 4.99978948e-05]), 3: array([2.89837420e-05, 1.31940728e-04]), 4: array([6.72049625e-05, 2.95685642e-04]), 5: array([0.00018561, 0.00062491]), 6: array([0.00048203, 0.00138799]), 7: array([0.00166164, 0.00360701]), 8: array([0.00484202, 0.01020691]), 9: array([0.04437713, 0.07014584])}, 'ndcg': array([0.04239059, 0.05561753])}
total time cost of epoch 99:  664.2289555072784
[0;30;43m[AUGMENT][0m
[0;30;43m[TRAIN][0m
EPOCH[100]:loss 0.352
[0;30;43m[valid][0m
test_u_batch_size is too big for this dataset, try a small one 3166
VALID {'precision': array([0.01822818, 0.01445702]), 'recall': array([0.08571887, 0.13406159]), 'ndcg': array([0.05281152, 0.06729732])}
[0;30;43m[TEST][0m
test_u_batch_size is too big for this dataset, try a small one 3166
{'precision': array([0.0234748 , 0.01980785]), 'recall': array([0.05178656, 0.08649732]), 'recall_pop': {0: array([0., 0.]), 1: array([0.        , 0.00012631]), 2: array([4.73664267e-05, 1.99991579e-04]), 3: array([9.47328534e-05, 7.07864932e-04]), 4: array([0.00038946, 0.00157572]), 5: array([0.00087628, 0.00349237]), 6: array([0.00251057, 0.00736161]), 7: array([0.00845423, 0.01830932]), 8: array([0.02188906, 0.04578413]), 9: array([0.11575032, 0.18085452])}, 'recall_pop_Contribute': {0: array([0., 0.]), 1: array([0.00000000e+00, 3.48606876e-05]), 2: array([1.15784599e-05, 5.24269423e-05]), 3: array([2.44726538e-05, 1.33745163e-04]), 4: array([8.22282534e-05, 3.03755478e-04]), 5: array([0.00017683, 0.00063844]), 6: array([0.00049556, 0.00137548]), 7: array([0.00168229, 0.00362766]), 8: array([0.0048793 , 0.01009608]), 9: array([0.04443429, 0.07023488])}, 'ndcg': array([0.04243323, 0.05561896])}
early stop triggerd at epoch 100, best recall: 0.05181168103153235
