==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaptive_method': 'None',
 'alpha': 0.5,
 'augment': 'Learner',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': 'tune_Aument_Learner_LGN_Contrast',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 40,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': '-',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': '-',
 'k_aug': 0,
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'BPR_Contrast',
 'lr': 0.001,
 'model': 'LightGCN_PyG',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'name',
 'notes': '-',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'project',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': None,
 'tau_plus': 0.1,
 'temp_tau': 0.2,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 1,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
precal cost :  0.8085501194000244
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]


















































training: 592it [01:40,  5.70it/s]
EPOCH[0]:loss 1.828

training: 604it [01:43,  5.86it/s]
{'precision': array([0.0008447]), 'recall': array([0.00134539]), 'recall_pop': {0: array([0.0001421]), 1: array([0.0001421]), 2: array([0.00014999]), 3: array([8.68384489e-05]), 4: array([0.00018947]), 5: array([0.0002842]), 6: array([0.00018947]), 7: array([0.00011578]), 8: array([0.00055233]), 9: array([0.00218411])}, 'recall_pop_Contribute': {0: array([2.85702256e-05]), 1: array([3.49985264e-05]), 2: array([2.13314504e-05]), 3: array([9.92575766e-06]), 4: array([2.20788312e-05]), 5: array([4.43007181e-05]), 6: array([3.26351122e-05]), 7: array([1.64762642e-05]), 8: array([0.00011254]), 9: array([0.00102254])}, 'ndcg': array([0.00127837])}
[5mfind a better recall[25m [0.00134539] ++[0.00134539]
time cost of epoch 0:  110.34603714942932
[AUGMENT]
[TRAIN]


















































training: 599it [01:41,  5.43it/s]
EPOCH[1]:loss 1.830

training: 604it [01:42,  5.90it/s]
{'precision': array([0.00297303]), 'recall': array([0.00558752]), 'recall_pop': {0: array([0.00018947]), 1: array([4.73664267e-05]), 2: array([7.89440445e-05]), 3: array([1.57888089e-05]), 4: array([7.89440445e-05]), 5: array([6.31552356e-05]), 6: array([0.00017368]), 7: array([0.00013368]), 8: array([0.00047612]), 9: array([0.00979457])}, 'recall_pop_Contribute': {0: array([4.6840133e-05]), 1: array([1.15784599e-05]), 2: array([1.05395426e-05]), 3: array([3.5086242e-06]), 4: array([8.62536782e-06]), 5: array([7.1425564e-06]), 6: array([2.12215959e-05]), 7: array([3.70793016e-05]), 8: array([0.00012292]), 9: array([0.00531806])}, 'ndcg': array([0.00496204])}
[5mfind a better recall[25m [0.00558752] ++[0.00424213]
time cost of epoch 1:  109.77013325691223
[AUGMENT]
[TRAIN]


















































training: 604it [01:41,  5.58it/s]
EPOCH[2]:loss 1.830

training: 604it [01:41,  5.93it/s]
training: 2it [00:00,  4.64it/s]
{'precision': array([0.00627605]), 'recall': array([0.01312977]), 'recall_pop': {0: array([6.31552356e-05]), 1: array([4.73664267e-05]), 2: array([0.]), 3: array([3.15776178e-05]), 4: array([1.57888089e-05]), 5: array([6.31552356e-05]), 6: array([4.73664267e-05]), 7: array([0.00021525]), 8: array([0.0004744]), 9: array([0.0238226])}, 'recall_pop_Contribute': {0: array([1.24054927e-05]), 1: array([1.15784599e-05]), 2: array([0.]), 3: array([6.31552356e-06]), 4: array([3.94720222e-06]), 5: array([1.15784599e-05]), 6: array([8.01971245e-06]), 7: array([4.87893348e-05]), 8: array([0.0001299]), 9: array([0.01289724])}, 'ndcg': array([0.01075973])}
[5mfind a better recall[25m [0.01312977] ++[0.00754225]
time cost of epoch 2:  109.33887195587158
[AUGMENT]










































training: 509it [01:24,  5.61it/s]WARNING:root:NaN or Inf found in input tensor.
training: 510it [01:24,  5.53it/s]WARNING:root:NaN or Inf found in input tensor.
training: 511it [01:25,  5.61it/s]WARNING:root:NaN or Inf found in input tensor.
training: 512it [01:25,  5.68it/s]WARNING:root:NaN or Inf found in input tensor.
training: 513it [01:25,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 514it [01:25,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 515it [01:25,  5.51it/s]WARNING:root:NaN or Inf found in input tensor.
training: 516it [01:26,  5.57it/s]WARNING:root:NaN or Inf found in input tensor.
training: 517it [01:26,  5.59it/s]WARNING:root:NaN or Inf found in input tensor.
training: 518it [01:26,  5.57it/s]WARNING:root:NaN or Inf found in input tensor.
training: 519it [01:26,  5.65it/s]WARNING:root:NaN or Inf found in input tensor.
training: 520it [01:26,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 521it [01:26,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 522it [01:27,  5.54it/s]WARNING:root:NaN or Inf found in input tensor.
training: 523it [01:27,  5.60it/s]WARNING:root:NaN or Inf found in input tensor.
training: 524it [01:27,  5.52it/s]WARNING:root:NaN or Inf found in input tensor.
training: 525it [01:27,  5.42it/s]WARNING:root:NaN or Inf found in input tensor.
training: 526it [01:27,  5.49it/s]WARNING:root:NaN or Inf found in input tensor.
training: 527it [01:28,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 528it [01:28,  5.54it/s]WARNING:root:NaN or Inf found in input tensor.
training: 529it [01:28,  5.49it/s]WARNING:root:NaN or Inf found in input tensor.
training: 530it [01:28,  5.57it/s]WARNING:root:NaN or Inf found in input tensor.
training: 531it [01:28,  5.53it/s]WARNING:root:NaN or Inf found in input tensor.
training: 532it [01:28,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 533it [01:29,  5.51it/s]WARNING:root:NaN or Inf found in input tensor.
training: 534it [01:29,  5.59it/s]WARNING:root:NaN or Inf found in input tensor.
training: 535it [01:29,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 536it [01:29,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 537it [01:29,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 538it [01:30,  5.65it/s]WARNING:root:NaN or Inf found in input tensor.
training: 539it [01:30,  5.69it/s]WARNING:root:NaN or Inf found in input tensor.
training: 540it [01:30,  5.71it/s]WARNING:root:NaN or Inf found in input tensor.
training: 541it [01:30,  5.60it/s]WARNING:root:NaN or Inf found in input tensor.
training: 542it [01:30,  5.59it/s]WARNING:root:NaN or Inf found in input tensor.
training: 543it [01:30,  5.48it/s]WARNING:root:NaN or Inf found in input tensor.
training: 544it [01:31,  5.42it/s]WARNING:root:NaN or Inf found in input tensor.
training: 545it [01:31,  5.40it/s]WARNING:root:NaN or Inf found in input tensor.
training: 546it [01:31,  5.31it/s]WARNING:root:NaN or Inf found in input tensor.
training: 547it [01:31,  5.29it/s]WARNING:root:NaN or Inf found in input tensor.
training: 548it [01:31,  5.24it/s]WARNING:root:NaN or Inf found in input tensor.
training: 549it [01:32,  5.33it/s]WARNING:root:NaN or Inf found in input tensor.
training: 550it [01:32,  5.29it/s]WARNING:root:NaN or Inf found in input tensor.
training: 551it [01:32,  5.30it/s]WARNING:root:NaN or Inf found in input tensor.
training: 552it [01:32,  5.30it/s]WARNING:root:NaN or Inf found in input tensor.
training: 553it [01:32,  5.37it/s]WARNING:root:NaN or Inf found in input tensor.
training: 554it [01:32,  5.44it/s]WARNING:root:NaN or Inf found in input tensor.
training: 555it [01:33,  5.50it/s]WARNING:root:NaN or Inf found in input tensor.
training: 556it [01:33,  5.54it/s]WARNING:root:NaN or Inf found in input tensor.
training: 557it [01:33,  5.48it/s]WARNING:root:NaN or Inf found in input tensor.
training: 558it [01:33,  5.51it/s]WARNING:root:NaN or Inf found in input tensor.
training: 559it [01:33,  5.50it/s]WARNING:root:NaN or Inf found in input tensor.
training: 560it [01:34,  5.57it/s]WARNING:root:NaN or Inf found in input tensor.
training: 561it [01:34,  5.51it/s]WARNING:root:NaN or Inf found in input tensor.
training: 562it [01:34,  5.53it/s]WARNING:root:NaN or Inf found in input tensor.
training: 563it [01:34,  5.54it/s]WARNING:root:NaN or Inf found in input tensor.
training: 564it [01:34,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 565it [01:34,  5.64it/s]WARNING:root:NaN or Inf found in input tensor.
training: 566it [01:35,  5.54it/s]WARNING:root:NaN or Inf found in input tensor.
training: 567it [01:35,  5.59it/s]WARNING:root:NaN or Inf found in input tensor.
training: 568it [01:35,  5.52it/s]WARNING:root:NaN or Inf found in input tensor.
training: 569it [01:35,  5.59it/s]WARNING:root:NaN or Inf found in input tensor.
training: 570it [01:35,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 571it [01:36,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 572it [01:36,  5.56it/s]WARNING:root:NaN or Inf found in input tensor.
training: 573it [01:36,  5.64it/s]WARNING:root:NaN or Inf found in input tensor.
training: 574it [01:36,  5.57it/s]WARNING:root:NaN or Inf found in input tensor.
training: 575it [01:36,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 576it [01:36,  5.54it/s]WARNING:root:NaN or Inf found in input tensor.
training: 577it [01:37,  5.59it/s]WARNING:root:NaN or Inf found in input tensor.
training: 578it [01:37,  5.62it/s]WARNING:root:NaN or Inf found in input tensor.
training: 579it [01:37,  5.60it/s]WARNING:root:NaN or Inf found in input tensor.
training: 580it [01:37,  5.54it/s]WARNING:root:NaN or Inf found in input tensor.
training: 581it [01:37,  5.60it/s]WARNING:root:NaN or Inf found in input tensor.
training: 582it [01:38,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 583it [01:38,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 584it [01:38,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 585it [01:38,  5.59it/s]WARNING:root:NaN or Inf found in input tensor.
training: 586it [01:38,  5.65it/s]WARNING:root:NaN or Inf found in input tensor.
training: 587it [01:38,  5.57it/s]WARNING:root:NaN or Inf found in input tensor.
training: 588it [01:39,  5.61it/s]WARNING:root:NaN or Inf found in input tensor.
training: 589it [01:39,  5.58it/s]WARNING:root:NaN or Inf found in input tensor.
training: 590it [01:39,  5.61it/s]WARNING:root:NaN or Inf found in input tensor.
training: 591it [01:39,  5.61it/s]WARNING:root:NaN or Inf found in input tensor.
training: 592it [01:39,  5.52it/s]WARNING:root:NaN or Inf found in input tensor.
training: 593it [01:39,  5.49it/s]WARNING:root:NaN or Inf found in input tensor.
training: 594it [01:40,  5.53it/s]WARNING:root:NaN or Inf found in input tensor.
training: 595it [01:40,  5.46it/s]WARNING:root:NaN or Inf found in input tensor.
training: 596it [01:40,  5.53it/s]WARNING:root:NaN or Inf found in input tensor.
training: 597it [01:40,  5.53it/s]WARNING:root:NaN or Inf found in input tensor.
training: 598it [01:40,  5.48it/s]WARNING:root:NaN or Inf found in input tensor.
training: 599it [01:41,  5.56it/s]WARNING:root:NaN or Inf found in input tensor.
training: 600it [01:41,  5.51it/s]WARNING:root:NaN or Inf found in input tensor.
training: 601it [01:41,  5.51it/s]WARNING:root:NaN or Inf found in input tensor.
training: 602it [01:41,  5.48it/s]WARNING:root:NaN or Inf found in input tensor.
training: 603it [01:41,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 604it [01:42,  5.92it/s]
WARNING:root:NaN or Inf found in input tensor.
EPOCH[3]:loss nan
[TEST]
{'precision': array([0.00149204]), 'recall': array([0.00348623]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([9.47328534e-05]), 4: array([0.]), 5: array([0.]), 6: array([9.47328534e-05]), 7: array([3.15776178e-05]), 8: array([0.00040292]), 9: array([0.00618721])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([7.93826225e-06]), 4: array([0.]), 5: array([0.]), 6: array([1.93361647e-05]), 7: array([7.66885003e-06]), 8: array([7.26267612e-05]), 9: array([0.00337866])}, 'ndcg': array([0.0020213])}
time cost of epoch 3:  109.44651341438293
[AUGMENT]
[TRAIN]
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
WARNING:root:NaN or Inf found in input tensor.
training: 0it [00:00, ?it/s]WARNING:root:NaN or Inf found in input tensor.
training: 1it [00:00,  4.35it/s]WARNING:root:NaN or Inf found in input tensor.
training: 2it [00:00,  5.00it/s]WARNING:root:NaN or Inf found in input tensor.
training: 3it [00:00,  5.29it/s]WARNING:root:NaN or Inf found in input tensor.
training: 4it [00:00,  5.31it/s]WARNING:root:NaN or Inf found in input tensor.
training: 5it [00:00,  5.42it/s]WARNING:root:NaN or Inf found in input tensor.
training: 6it [00:01,  5.41it/s]WARNING:root:NaN or Inf found in input tensor.
training: 7it [00:01,  5.50it/s]WARNING:root:NaN or Inf found in input tensor.
training: 8it [00:01,  5.48it/s]WARNING:root:NaN or Inf found in input tensor.
training: 9it [00:01,  5.45it/s]WARNING:root:NaN or Inf found in input tensor.
training: 10it [00:01,  5.55it/s]WARNING:root:NaN or Inf found in input tensor.
training: 11it [00:02,  5.52it/s]WARNING:root:NaN or Inf found in input tensor.
training: 12it [00:02,  5.56it/s]WARNING:root:NaN or Inf found in input tensor.
training: 13it [00:02,  5.42it/s]WARNING:root:NaN or Inf found in input tensor.
training: 14it [00:02,  5.45it/s]WARNING:root:NaN or Inf found in input tensor.
training: 15it [00:02,  5.39it/s]WARNING:root:NaN or Inf found in input tensor.
training: 16it [00:02,  5.33it/s]WARNING:root:NaN or Inf found in input tensor.
training: 17it [00:03,  5.20it/s]
training: 7it [00:01,  5.50it/s]WARNING:root:NaN or Inf found in input tensor.
training: 35it [00:05,  7.93it/s]WARNING:root:NaN or Inf found in input tensor.
training: 63it [00:09,  8.29it/s]WARNING:root:NaN or Inf found in input tensor.
training: 63it [00:09,  8.29it/s]WARNING:root:NaN or Inf found in input tensor.
training: 91it [00:13,  6.33it/s]WARNING:root:NaN or Inf found in input tensor.
training: 91it [00:13,  6.33it/s]WARNING:root:NaN or Inf found in input tensor.
training: 91it [00:13,  6.33it/s]WARNING:root:NaN or Inf found in input tensor.
training: 91it [00:13,  6.33it/s]WARNING:root:NaN or Inf found in input tensor.
training: 91it [00:13,  6.33it/s]WARNING:root:NaN or Inf found in input tensor.