==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 1,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'AllWeight',
 'lr': 0.001,
 'model': 'SimGCL',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'SimGCL+All_Weighted_Loss',
 'notes': 'SimGCL+All_Weighted_InfoNCE_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1093508 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0011765708510383113
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0010821819305419922
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.09302067756652832
shape test : 2474518 == 2187016
precal cost :  0.8645408153533936
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]


















































































































training: 533it [03:49,  2.32it/s]
EPOCH[0]:loss 14.373
[valid]
VALID {'precision': array([0.01253158, 0.01009221]), 'recall': array([0.05804085, 0.09342498]), 'ndcg': array([0.03599725, 0.04654359])}
[5mfind a better valid recall[25m 0.058040847673118526 ++0.058040847673118526
[TEST]
{'precision': array([0.018675  , 0.01558908]), 'recall': array([0.03956608, 0.06557876]), 'recall_pop': {0: array([0.00000000e+00, 4.73664267e-05]), 1: array([6.31552356e-06, 1.03679845e-04]), 2: array([3.15776178e-05, 1.10521662e-04]), 3: array([0.00011842, 0.00048945]), 4: array([4.73664267e-05, 5.02735724e-04]), 5: array([0.00037893, 0.00135863]), 6: array([0.0008359 , 0.00286392]), 7: array([0.00436036, 0.00977615]), 8: array([0.01292448, 0.02750564]), 9: array([0.09736891, 0.15349598])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 8.01971245e-06]), 1: array([4.38578025e-07, 1.16078590e-05]), 2: array([3.15776178e-06, 1.55017396e-05]), 3: array([2.33059930e-05, 8.89468838e-05]), 4: array([8.28912467e-06, 8.93427711e-05]), 5: array([5.59381751e-05, 1.96289888e-04]), 6: array([0.00013988, 0.00049443]), 7: array([0.00080516, 0.00182221]), 8: array([0.00271388, 0.00587572]), 9: array([0.03581603, 0.05697669])}, 'ndcg': array([0.03250524, 0.04231041])}
[5mfind a better recall[25m 0.03956608169184988 ++0.03956608169184988
total time cost of epoch 0:  242.4566125869751
[AUGMENT]
[TRAIN]

















































































































training: 529it [03:47,  2.42it/s]
EPOCH[1]:loss 13.397

training: 533it [03:49,  2.32it/s]
VALID {'precision': array([0.01492516, 0.01190318]), 'recall': array([0.07041713, 0.11189225]), 'ndcg': array([0.04369848, 0.05604541])}
[5mfind a better valid recall[25m 0.07041712632903467 ++0.012376278655916145
[TEST]
{'precision': array([0.02189592, 0.01819187]), 'recall': array([0.04701555, 0.0779988 ]), 'recall_pop': {0: array([1.05258726e-05, 4.31560776e-05]), 1: array([1.68413962e-05, 7.47336954e-05]), 2: array([0.        , 0.00019234]), 3: array([0.00016841, 0.00063418]), 4: array([0.0001421 , 0.00085339]), 5: array([0.0004798 , 0.00186352]), 6: array([0.00112324, 0.00415289]), 7: array([0.00565451, 0.01275195]), 8: array([0.01704228, 0.03604838]), 9: array([0.11265617, 0.17655133])}, 'recall_pop_Contribute': {0: array([7.70185800e-07, 1.09770926e-05]), 1: array([3.59633980e-06, 1.36732957e-05]), 2: array([0.00000000e+00, 3.17163163e-05]), 3: array([2.71793067e-05, 9.93543839e-05]), 4: array([1.56741039e-05, 1.28678314e-04]), 5: array([6.41972258e-05, 3.29651727e-04]), 6: array([0.0001814 , 0.00068342]), 7: array([0.00105734, 0.00238105]), 8: array([0.00362431, 0.00777584]), 9: array([0.04204108, 0.06654443])}, 'ndcg': array([0.03872983, 0.0503522 ])}
[5mfind a better recall[25m 0.04701555190922206 ++0.0074494702173721825
total time cost of epoch 1:  242.03245878219604
[AUGMENT]
[TRAIN]


















































































































training: 533it [03:49,  2.32it/s]
EPOCH[2]:loss 12.862
[valid]
VALID {'precision': array([0.01574302, 0.01250632]), 'recall': array([0.07551395, 0.11908912]), 'ndcg': array([0.04684608, 0.05981958])}
[5mfind a better valid recall[25m 0.07551394904932095 ++0.005096822720286276
[TEST]
{'precision': array([0.02287167, 0.01901446]), 'recall': array([0.04949499, 0.08190909]), 'recall_pop': {0: array([1.05258726e-05, 1.16837186e-04]), 1: array([2.47358006e-05, 1.95029382e-04]), 2: array([3.15776178e-05, 2.18651081e-04]), 3: array([0.00017631, 0.00072892]), 4: array([0.00029823, 0.00138424]), 5: array([0.0006019 , 0.00238693]), 6: array([0.00170061, 0.00542545]), 7: array([0.00627373, 0.0155752 ]), 8: array([0.0189387 , 0.03897173]), 9: array([0.11617553, 0.18001541])}, 'recall_pop_Contribute': {0: array([7.70185800e-07, 2.57133142e-05]), 1: array([4.20360168e-06, 2.92641916e-05]), 2: array([4.51108825e-06, 3.30503882e-05]), 3: array([3.05626229e-05, 1.11239476e-04]), 4: array([3.52767471e-05, 2.11046735e-04]), 5: array([9.83507321e-05, 3.99276818e-04]), 6: array([0.00028455, 0.00087727]), 7: array([0.00119567, 0.00295126]), 8: array([0.0040333 , 0.00843962]), 9: array([0.0438078 , 0.06883135])}, 'ndcg': array([0.04079635, 0.05299569])}
[5mfind a better recall[25m 0.049494990330903696 ++0.0024794384216816345
total time cost of epoch 2:  242.67311358451843
[AUGMENT]
[TRAIN]


















































































































training: 533it [03:49,  2.32it/s]
EPOCH[3]:loss 12.522
[valid]
VALID {'precision': array([0.01594354, 0.012575  ]), 'recall': array([0.07728292, 0.12120265]), 'ndcg': array([0.0475487 , 0.06059446])}
[5mfind a better valid recall[25m 0.07728292246422737 ++0.0017689734149064218
[TEST]
{'precision': array([0.02313061, 0.01918419]), 'recall': array([0.05033114, 0.0831261 ]), 'recall_pop': {0: array([2.10517452e-05, 1.26611210e-04]), 1: array([0.00011947, 0.00028525]), 2: array([4.21034904e-05, 1.99704510e-04]), 3: array([0.00027104, 0.00105785]), 4: array([0.00039139, 0.00171396]), 5: array([0.00078891, 0.00310319]), 6: array([0.00238401, 0.00691643]), 7: array([0.0082322 , 0.01759172]), 8: array([0.02089245, 0.04192613]), 9: array([0.11526765, 0.17855897])}, 'recall_pop_Contribute': {0: array([6.03312210e-06, 2.31326466e-05]), 1: array([1.64837864e-05, 4.15890989e-05]), 2: array([5.28127405e-06, 2.74594852e-05]), 3: array([4.07125715e-05, 1.44923399e-04]), 4: array([4.87959061e-05, 2.53050663e-04]), 5: array([0.0001245 , 0.00051164]), 6: array([0.00037982, 0.00112172]), 7: array([0.00152962, 0.00332329]), 8: array([0.00450652, 0.00907731]), 9: array([0.04367337, 0.06860199])}, 'ndcg': array([0.04132473, 0.05365621])}
[5mfind a better recall[25m 0.0503311427900716 ++0.0008361524591679048
total time cost of epoch 3:  242.53630208969116
[AUGMENT]
[TRAIN]




















































































































training: 529it [03:52,  2.35it/s]
EPOCH[4]:loss 12.308

training: 533it [03:54,  2.27it/s]
VALID {'precision': array([0.01583618, 0.01261921]), 'recall': array([0.07779042, 0.12265012]), 'ndcg': array([0.04787456, 0.06123112])}
[5mfind a better valid recall[25m 0.07779042397597599 ++0.0005075015117486231
[TEST]
{'precision': array([0.02301061, 0.01916761]), 'recall': array([0.0505933 , 0.08356997]), 'recall_pop': {0: array([4.52988446e-05, 1.46347221e-04]), 1: array([0.00013526, 0.00041946]), 2: array([5.78922993e-05, 5.44666062e-04]), 3: array([0.00038156, 0.00110259]), 4: array([0.00061243, 0.00197343]), 5: array([0.00094259, 0.00371109]), 6: array([0.00303678, 0.00872323]), 7: array([0.00929953, 0.01930132]), 8: array([0.02250404, 0.0429732 ]), 9: array([0.11293335, 0.17561095])}, 'recall_pop_Contribute': {0: array([1.03232756e-05, 2.18240444e-05]), 1: array([1.72356344e-05, 5.45079030e-05]), 2: array([1.15967976e-05, 7.22624001e-05]), 3: array([4.9637481e-05, 1.5462437e-04]), 4: array([8.21702304e-05, 2.79550195e-04]), 5: array([0.00015765, 0.00061629]), 6: array([0.00047345, 0.00145833]), 7: array([0.00173958, 0.00362898]), 8: array([0.00479992, 0.00935604]), 9: array([0.04325173, 0.06792756])}, 'ndcg': array([0.04139433, 0.05383919])}
[5mfind a better recall[25m 0.05059330231139916 ++0.00026215952132756237
total time cost of epoch 4:  247.74522161483765
[AUGMENT]
[TRAIN]


















































































































training: 529it [03:49,  2.26it/s]
EPOCH[5]:loss 12.186

training: 533it [03:51,  2.30it/s]
VALID {'precision': array([0.01612827, 0.01278657]), 'recall': array([0.07938549, 0.12457187]), 'ndcg': array([0.0488683 , 0.06230523])}
[5mfind a better valid recall[25m 0.07938548914747967 ++0.001595065171503679
[TEST]
{'precision': array([0.02336428, 0.01937682]), 'recall': array([0.05142045, 0.08466132]), 'recall_pop': {0: array([0.00010079, 0.00016687]), 1: array([0.00014052, 0.00057734]), 2: array([0.00020525, 0.00056285]), 3: array([0.00030525, 0.00129468]), 4: array([0.00073769, 0.00224552]), 5: array([0.00117925, 0.00417764]), 6: array([0.00381015, 0.00944094]), 7: array([0.01021605, 0.02006623]), 8: array([0.02312685, 0.04427092]), 9: array([0.11316091, 0.17658568])}, 'recall_pop_Contribute': {0: array([1.83259242e-05, 2.50518391e-05]), 1: array([1.50965055e-05, 6.91033163e-05]), 2: array([2.50902960e-05, 7.18223572e-05]), 3: array([3.95521709e-05, 1.80911188e-04]), 4: array([0.0001029 , 0.00031593]), 5: array([0.00017732, 0.00066128]), 6: array([0.00062025, 0.00154984]), 7: array([0.00190942, 0.00379231]), 8: array([0.00495398, 0.00963215]), 9: array([0.04355852, 0.06836292])}, 'ndcg': array([0.04198318, 0.05451544])}
[5mfind a better recall[25m 0.05142045174744039 ++0.0008271494360412301
total time cost of epoch 5:  244.1597044467926
[AUGMENT]
[TRAIN]



















































































































training: 533it [03:52,  2.30it/s]
EPOCH[6]:loss 12.145
[valid]
VALID {'precision': array([0.01616774, 0.01282841]), 'recall': array([0.07971006, 0.12552226]), 'ndcg': array([0.04902768, 0.06264112])}
[5mfind a better valid recall[25m 0.07971006374107888 ++0.0003245745935992056
[TEST]
{'precision': array([0.02348743, 0.01960339]), 'recall': array([0.05170863, 0.08563881]), 'recall_pop': {0: array([6.58242961e-05, 1.84240363e-04]), 1: array([0.00015631, 0.00056419]), 2: array([0.00018947, 0.00070916]), 3: array([0.00047366, 0.00131047]), 4: array([0.00078874, 0.00237025]), 5: array([0.00120188, 0.00477162]), 6: array([0.00410595, 0.0098027 ]), 7: array([0.01064381, 0.02077165]), 8: array([0.02299737, 0.04505389]), 9: array([0.11376538, 0.17785596])}, 'recall_pop_Contribute': {0: array([1.30748998e-05, 2.98399204e-05]), 1: array([1.75086846e-05, 5.94806252e-05]), 2: array([2.12011912e-05, 8.68697906e-05]), 3: array([6.70998832e-05, 1.87211691e-04]), 4: array([0.00010558, 0.00031591]), 5: array([0.00018208, 0.00074825]), 6: array([0.00065943, 0.00162129]), 7: array([0.00198189, 0.00391286]), 8: array([0.00494519, 0.00976906]), 9: array([0.04371557, 0.06890804])}, 'ndcg': array([0.04221565, 0.05503115])}
[5mfind a better recall[25m 0.05170862970448672 ++0.0002881779570463247
total time cost of epoch 6:  244.82364869117737
[AUGMENT]
[TRAIN]



















































































































training: 531it [03:51,  2.28it/s]
EPOCH[7]:loss 12.120

training: 533it [03:52,  2.29it/s]
VALID {'precision': array([0.01621037, 0.01284814]), 'recall': array([0.07992002, 0.12571624]), 'ndcg': array([0.04909173, 0.06269182])}
[5mfind a better valid recall[25m 0.07992002173676248 ++0.00020995799568360174
[TEST]
training: 1it [00:00,  2.10it/s]
{'precision': array([0.02350164, 0.01955918]), 'recall': array([0.05181898, 0.08562298]), 'recall_pop': {0: array([8.71391881e-05, 2.23712385e-04]), 1: array([0.00016684, 0.00064313]), 2: array([0.00021578, 0.00065126]), 3: array([0.00060787, 0.00129612]), 4: array([0.00080979, 0.00245577]), 5: array([0.00122504, 0.00458145]), 6: array([0.00425249, 0.00995059]), 7: array([0.01135987, 0.02131797]), 8: array([0.02313658, 0.04560866]), 9: array([0.1136469 , 0.17729643])}, 'recall_pop_Contribute': {0: array([1.68841766e-05, 3.75872378e-05]), 1: array([1.96185880e-05, 7.55687713e-05]), 2: array([2.39808617e-05, 8.94481277e-05]), 3: array([8.52116135e-05, 1.88393864e-04]), 4: array([0.00010478, 0.00031863]), 5: array([0.00018249, 0.00073737]), 6: array([0.00068618, 0.00165054]), 7: array([0.00210064, 0.00396613]), 8: array([0.00496692, 0.00992863]), 9: array([0.04363228, 0.06863067])}, 'ndcg': array([0.04231266, 0.05505434])}
[5mfind a better recall[25m 0.051818980307713 ++0.00011035060322628354
total time cost of epoch 7:  245.20726680755615
[AUGMENT]






















































































































training: 530it [03:55,  2.43it/s]
EPOCH[8]:loss 12.100

training: 533it [03:57,  2.25it/s]
VALID {'precision': array([0.01620405, 0.01281736]), 'recall': array([0.08015196, 0.12549396]), 'ndcg': array([0.04940249, 0.06289566])}
[5mfind a better valid recall[25m 0.08015195819087975 ++0.0002319364541172736
[TEST]
{'precision': array([0.02349375, 0.01962391]), 'recall': array([0.05184153, 0.08602359]), 'recall_pop': {0: array([9.24021244e-05, 3.09235100e-04]), 1: array([0.00019052, 0.00060629]), 2: array([0.0001842 , 0.00061103]), 3: array([0.00048945, 0.00127243]), 4: array([0.00093189, 0.00271261]), 5: array([0.00137064, 0.00485094]), 6: array([0.00459913, 0.00963008]), 7: array([0.01069765, 0.02105698]), 8: array([0.02287545, 0.04502127]), 9: array([0.11342716, 0.17860438])}, 'recall_pop_Contribute': {0: array([1.33755524e-05, 5.72576732e-05]), 1: array([2.41379601e-05, 8.12427704e-05]), 2: array([1.74852392e-05, 7.24772092e-05]), 3: array([6.71578243e-05, 1.79985520e-04]), 4: array([0.00011658, 0.00036944]), 5: array([0.00020801, 0.00075453]), 6: array([0.0007356 , 0.00158781]), 7: array([0.00197855, 0.00395135]), 8: array([0.00496687, 0.00983   ]), 9: array([0.04371377, 0.06913949])}, 'ndcg': array([0.04256348, 0.05544512])}
[5mfind a better recall[25m 0.05184152739581222 ++2.2547088099220125e-05
total time cost of epoch 8:  250.7338845729828
[AUGMENT]
[TRAIN]




















































































































training: 530it [03:53,  2.27it/s]
EPOCH[9]:loss 12.089

training: 533it [03:55,  2.27it/s]
VALID {'precision': array([0.01610301, 0.01274157]), 'recall': array([0.08019257, 0.12493082]), 'ndcg': array([0.04915125, 0.06247649])}
[5mfind a better valid recall[25m 0.08019257449181676 ++4.0616300937004746e-05
[TEST]
{'precision': array([0.02333428, 0.0195126 ]), 'recall': array([0.05151583, 0.08541861]), 'recall_pop': {0: array([0.00010188, 0.00030976]), 1: array([0.00022367, 0.00051945]), 2: array([0.00025262, 0.00072313]), 3: array([0.00045261, 0.00135545]), 4: array([0.00095952, 0.00280453]), 5: array([0.00169719, 0.0049727 ]), 6: array([0.00462093, 0.00940159]), 7: array([0.01044294, 0.02006344]), 8: array([0.02205541, 0.04288127]), 9: array([0.11297434, 0.17862261])}, 'recall_pop_Contribute': {0: array([1.38141304e-05, 5.15519032e-05]), 1: array([2.66565604e-05, 6.71254214e-05]), 2: array([2.66692434e-05, 9.48998323e-05]), 3: array([6.74452217e-05, 1.77530366e-04]), 4: array([0.00012945, 0.00039094]), 5: array([0.00027699, 0.00077136]), 6: array([0.00073511, 0.00150624]), 7: array([0.00195615, 0.00378918]), 8: array([0.00472377, 0.00935936]), 9: array([0.04355979, 0.06921043])}, 'ndcg': array([0.04213739, 0.05493848])}
total time cost of epoch 9:  248.01615071296692
[AUGMENT]
[TRAIN]



































































































training: 533it [03:19,  2.67it/s]
EPOCH[10]:loss 12.074
[valid]
VALID {'precision': array([0.01587091, 0.01244   ]), 'recall': array([0.07902959, 0.12265616]), 'ndcg': array([0.04842257, 0.06135759])}
[TEST]
{'precision': array([0.02308324, 0.01929314]), 'recall': array([0.05098489, 0.08458518]), 'recall_pop': {0: array([3.71412933e-05, 3.19760972e-04]), 1: array([0.00031578, 0.00080365]), 2: array([0.00021157, 0.00073997]), 3: array([0.00058419, 0.00153807]), 4: array([0.00103873, 0.00296838]), 5: array([0.00192457, 0.00490699]), 6: array([0.00453759, 0.00922871]), 7: array([0.01042375, 0.01852637]), 8: array([0.02072953, 0.04102251]), 9: array([0.11222467, 0.17861145])}, 'recall_pop_Contribute': {0: array([4.26695654e-06, 5.30577247e-05]), 1: array([3.47348381e-05, 9.73943877e-05]), 2: array([2.39771840e-05, 8.79172583e-05]), 3: array([7.73270175e-05, 2.21625854e-04]), 4: array([0.00013736, 0.00041797]), 5: array([0.00029531, 0.00076255]), 6: array([0.00072354, 0.0015124 ]), 7: array([0.00190966, 0.00344311]), 8: array([0.00448302, 0.00892642]), 9: array([0.04329568, 0.06906273])}, 'ndcg': array([0.04180148, 0.05446639])}
total time cost of epoch 10:  212.55374360084534
[AUGMENT]
[TRAIN]






















































































training: 533it [02:54,  3.06it/s]
EPOCH[11]:loss 12.057
[valid]
VALID {'precision': array([0.01539093, 0.01214633]), 'recall': array([0.07712547, 0.11996037]), 'ndcg': array([0.04738761, 0.06013937])}
[TEST]
{'precision': array([0.02265536, 0.01894657]), 'recall': array([0.05028138, 0.08319889]), 'recall_pop': {0: array([4.39831105e-05, 2.66642908e-04]), 1: array([0.00034209, 0.00079681]), 2: array([0.00027051, 0.00070179]), 3: array([0.00067892, 0.00158544]), 4: array([0.00102689, 0.00322785]), 5: array([0.00203475, 0.00546196]), 6: array([0.00414008, 0.00899728]), 7: array([0.00968927, 0.0177375 ]), 8: array([0.01911712, 0.03750384]), 9: array([0.11172328, 0.17703139])}, 'recall_pop_Contribute': {0: array([6.77854423e-06, 3.90317787e-05]), 1: array([4.30007723e-05, 9.53977404e-05]), 2: array([3.42315422e-05, 8.13900855e-05]), 3: array([9.64945661e-05, 1.99982680e-04]), 4: array([0.00013055, 0.00043883]), 5: array([0.00031285, 0.00084509]), 6: array([0.00067331, 0.00149139]), 7: array([0.00177097, 0.00328632]), 8: array([0.00413852, 0.00818947]), 9: array([0.04307469, 0.068532  ])}, 'ndcg': array([0.04127081, 0.05368977])}
total time cost of epoch 11:  186.60493278503418
[AUGMENT]
[TRAIN]


























training: 162it [00:53,  3.04it/s]