==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaptive_method': 'None',
 'alpha': 0.5,
 'augment': 'Learner',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': 'tune_Aument_Learner_LGN_Contrast',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 40,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': '-',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': '-',
 'k_aug': 0,
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'BPR_Contrast',
 'lr': 0.001,
 'model': 'LightGCN_PyG',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'name',
 'notes': '-',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'project',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': None,
 'tau_plus': 0.1,
 'temp_tau': 0.2,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 1,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
precal cost :  0.8114962577819824
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
training: 7it [00:01,  7.35it/s]
[AUGMENT]



































training: 604it [01:11,  8.49it/s]
EPOCH[0]:loss 1.825
[TEST]
{'precision': array([0.00096628]), 'recall': array([0.00154321]), 'recall_pop': {0: array([0.00015368]), 1: array([0.0002342]), 2: array([0.00014841]), 3: array([0.0001342]), 4: array([0.00017868]), 5: array([0.00030134]), 6: array([9.61738954e-05]), 7: array([0.00054847]), 8: array([0.00090829]), 9: array([0.00251165])}, 'recall_pop_Contribute': {0: array([3.19911342e-05]), 1: array([4.32162366e-05]), 2: array([1.94142979e-05]), 3: array([1.01015009e-05]), 4: array([2.64476651e-05]), 5: array([3.98356861e-05]), 6: array([1.40454266e-05]), 7: array([0.00012542]), 8: array([0.00018748]), 9: array([0.00104526])}, 'ndcg': array([0.00139479])}
[5mfind a better recall[25m [0.00154321] ++[0.00154321]
time cost of epoch 0:  77.67453670501709
[AUGMENT]
[TRAIN]



































training: 604it [01:10,  8.52it/s]
EPOCH[1]:loss 1.821
[TEST]
training: 5it [00:00,  7.97it/s]
{'precision': array([0.00531136]), 'recall': array([0.00941552]), 'recall_pop': {0: array([8.5259568e-05]), 1: array([7.89440445e-05]), 2: array([0.00020525]), 3: array([0.00012894]), 4: array([0.00012105]), 5: array([0.00031086]), 6: array([0.00049739]), 7: array([0.00141553]), 8: array([0.00375125]), 9: array([0.02194057])}, 'recall_pop_Contribute': {0: array([1.52625153e-05]), 1: array([1.81571302e-05]), 2: array([2.40194222e-05]), 3: array([3.27617785e-05]), 4: array([2.50380599e-05]), 5: array([5.74356018e-05]), 6: array([6.4166229e-05]), 7: array([0.00025484]), 8: array([0.00082618]), 9: array([0.00809766])}, 'ndcg': array([0.00861051])}
[5mfind a better recall[25m [0.00941552] ++[0.00787231]
time cost of epoch 1:  77.34373903274536
[AUGMENT]



































training: 604it [01:10,  8.53it/s]
EPOCH[2]:loss 1.816
[TEST]
training: 12it [00:01,  8.59it/s]
{'precision': array([0.01069376]), 'recall': array([0.02064941]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.0001421]), 3: array([5.52608311e-05]), 4: array([9.47328534e-05]), 5: array([0.00015789]), 6: array([0.00054471]), 7: array([0.00120911]), 8: array([0.00510485]), 9: array([0.05158132])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.77825609e-05]), 3: array([1.46923638e-05]), 4: array([2.21043324e-05]), 5: array([3.73554561e-05]), 6: array([9.02263568e-05]), 7: array([0.00020492]), 8: array([0.00106721]), 9: array([0.01919512])}, 'ndcg': array([0.01773608])}
[5mfind a better recall[25m [0.02064941] ++[0.01123389]
time cost of epoch 2:  77.34291672706604
[AUGMENT]



































training: 604it [01:11,  8.50it/s]
EPOCH[3]:loss 1.802
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.01385468]), 'recall': array([0.0271345]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([3.15776178e-05]), 4: array([3.15776178e-05]), 5: array([9.47328534e-05]), 6: array([0.00070872]), 7: array([0.00108622]), 8: array([0.0054802]), 9: array([0.06733792])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([3.15776178e-06]), 4: array([7.89440445e-06]), 5: array([1.74052822e-05]), 6: array([0.00011467]), 7: array([0.00016573]), 8: array([0.0011331]), 9: array([0.02567792])}, 'ndcg': array([0.02291359])}
[5mfind a better recall[25m [0.0271345] ++[0.00648509]
time cost of epoch 3:  77.57189083099365
[AUGMENT]




































training: 604it [01:10,  8.56it/s]
EPOCH[4]:loss 1.772
[TEST]
training: 9it [00:01,  8.57it/s]
{'precision': array([0.01512884]), 'recall': array([0.02998075]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([3.15776178e-05]), 4: array([0.]), 5: array([0.00010526]), 6: array([0.00044209]), 7: array([0.00084494]), 8: array([0.00492084]), 9: array([0.07400998])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([3.15776178e-06]), 4: array([0.]), 5: array([2.19163704e-05]), 6: array([6.81397778e-05]), 7: array([0.00012787]), 8: array([0.00104427]), 9: array([0.02870077])}, 'ndcg': array([0.02494362])}
[5mfind a better recall[25m [0.02998075] ++[0.00284625]
time cost of epoch 4:  77.08328676223755
[AUGMENT]



































training: 604it [01:10,  8.60it/s]
EPOCH[5]:loss 1.725
[TEST]
training: 3it [00:00,  7.17it/s]
{'precision': array([0.0152883]), 'recall': array([0.03051486]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([3.94720222e-05]), 4: array([0.]), 5: array([0.00011578]), 6: array([0.00047366]), 7: array([0.00078944]), 8: array([0.00440458]), 9: array([0.07490289])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([5.13136289e-06]), 4: array([0.]), 5: array([1.74428746e-05]), 6: array([6.37414667e-05]), 7: array([0.00011869]), 8: array([0.00089853]), 9: array([0.02939669])}, 'ndcg': array([0.02529995])}
[5mfind a better recall[25m [0.03051486] ++[0.00053411]
time cost of epoch 5:  76.73287415504456
[AUGMENT]




































training: 604it [01:11,  8.44it/s]
EPOCH[6]:loss 1.670
[TEST]
training: 3it [00:00,  7.47it/s]
{'precision': array([0.01525041]), 'recall': array([0.03070249]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([7.89440445e-06]), 4: array([0.]), 5: array([0.00012105]), 6: array([0.00044209]), 7: array([0.00083418]), 8: array([0.00414291]), 9: array([0.07452025])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([1.97360111e-06]), 4: array([0.]), 5: array([1.96984187e-05]), 6: array([6.04333353e-05]), 7: array([0.00012004]), 8: array([0.00086132]), 9: array([0.0296244])}, 'ndcg': array([0.02530366])}
[5mfind a better recall[25m [0.03070249] ++[0.00018763]
time cost of epoch 6:  78.1803548336029
[AUGMENT]




































training: 604it [01:11,  8.44it/s]
EPOCH[7]:loss 1.618
[TEST]
training: 1it [00:00,  5.59it/s]
{'precision': array([0.01518094]), 'recall': array([0.03053605]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([0.]), 4: array([0.]), 5: array([0.00010526]), 6: array([0.00047366]), 7: array([0.00084733]), 8: array([0.00396467]), 9: array([0.07347257])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([0.]), 4: array([0.]), 5: array([1.51873305e-05]), 6: array([6.24069365e-05]), 7: array([0.00012552]), 8: array([0.00084877]), 9: array([0.02946954])}, 'ndcg': array([0.02509829])}
time cost of epoch 7:  78.35473895072937
[AUGMENT]




































training: 604it [01:10,  8.55it/s]
EPOCH[8]:loss 1.574
[TEST]
training: 9it [00:01,  8.22it/s]
{'precision': array([0.01533409]), 'recall': array([0.03072369]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([0.]), 4: array([0.]), 5: array([0.00016052]), 6: array([0.00045788]), 7: array([0.00090891]), 8: array([0.00388152]), 9: array([0.07343093])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([0.]), 4: array([0.]), 5: array([3.06566039e-05]), 6: array([6.34094005e-05]), 7: array([0.0001416]), 8: array([0.00084517]), 9: array([0.02962822])}, 'ndcg': array([0.02519593])}
[5mfind a better recall[25m [0.03072369] ++[2.11968896e-05]
time cost of epoch 8:  77.20664310455322
[AUGMENT]



































training: 604it [01:10,  8.55it/s]
EPOCH[9]:loss 1.537
[TEST]
training: 12it [00:01,  8.69it/s]
{'precision': array([0.01522199]), 'recall': array([0.03060441]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([0.]), 4: array([0.]), 5: array([0.00015789]), 6: array([0.00044209]), 7: array([0.00100289]), 8: array([0.00397512]), 9: array([0.07271475])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([0.]), 4: array([0.]), 5: array([3.07881773e-05]), 6: array([6.27076757e-05]), 7: array([0.00015044]), 8: array([0.00086039]), 9: array([0.02948546])}, 'ndcg': array([0.02503982])}
time cost of epoch 9:  77.32729625701904
[AUGMENT]



































training: 604it [01:10,  8.51it/s]
EPOCH[10]:loss 1.505
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.01518726]), 'recall': array([0.03054573]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([0.]), 4: array([0.]), 5: array([0.00016841]), 6: array([0.00047366]), 7: array([0.00106868]), 8: array([0.00396207]), 9: array([0.0720025])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([0.]), 4: array([0.]), 5: array([3.27617785e-05]), 6: array([6.72688871e-05]), 7: array([0.00016178]), 8: array([0.00086853]), 9: array([0.02940076])}, 'ndcg': array([0.02490464])}
time cost of epoch 10:  77.52390503883362
[AUGMENT]




































training: 604it [01:10,  8.55it/s]
EPOCH[11]:loss 1.479
[TEST]
training: 7it [00:00,  8.34it/s]
{'precision': array([0.01518726]), 'recall': array([0.03055788]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.00011052]), 3: array([0.]), 4: array([0.]), 5: array([0.0001842]), 6: array([0.00050524]), 7: array([0.00113183]), 8: array([0.00405958]), 9: array([0.07165658])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([1.46247991e-05]), 3: array([0.]), 4: array([0.]), 5: array([3.9077302e-05]), 6: array([7.35844107e-05]), 7: array([0.00018257]), 8: array([0.00091303]), 9: array([0.02933499])}, 'ndcg': array([0.0248977])}
time cost of epoch 11:  77.33261132240295
[AUGMENT]


























training: 443it [00:51,  8.54it/s]