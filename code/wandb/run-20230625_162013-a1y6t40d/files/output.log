==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'nothing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'freeze_mlp': 2,
 'group': 'Ours',
 'if_SVD': 1,
 'if_adaptive': 0,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.1,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0009891986846923828
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07538795471191406
shape test : 2474518 == 2474518
precal cost :  0.8260533809661865
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]






















training: 604it [00:44, 13.61it/s]
EPOCH[0]:loss 6.016
[TEST]
training: 2it [00:00, 10.99it/s]
{'precision': array([0.01876816, 0.01581407]), 'recall': array([0.03960334, 0.06660597]), 'recall_pop': {0: array([0.       , 0.0001442]), 1: array([4.73664267e-05, 2.23148499e-04]), 2: array([0.00012631, 0.00057764]), 3: array([0.00023157, 0.00126762]), 4: array([0.00052366, 0.00182361]), 5: array([0.0013609 , 0.00356456]), 6: array([0.00199632, 0.00512875]), 7: array([0.00593013, 0.01423561]), 8: array([0.01648468, 0.03375898]), 9: array([0.08926279, 0.14071519])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 3.28655623e-05]), 1: array([1.15784599e-05, 4.14405584e-05]), 2: array([1.13153130e-05, 7.94983107e-05]), 3: array([3.47305600e-05, 1.97588869e-04]), 4: array([8.46630846e-05, 2.86690369e-04]), 5: array([0.00020978, 0.00060788]), 6: array([0.00033758, 0.00087658]), 7: array([0.00112613, 0.0027128 ]), 8: array([0.00357407, 0.00729836]), 9: array([0.03421348, 0.05447227])}, 'ndcg': array([0.03280248, 0.0429512 ])}
[5mfind a better recall[25m 0.03960333561486059 ++0.03960333561486059
total time cost of epoch 0:  51.32621669769287
[AUGMENT]






















training: 604it [00:42, 14.07it/s]
EPOCH[1]:loss 5.167
[TEST]
training: 5it [00:00, 11.83it/s]
{'precision': array([0.02284641, 0.0191834 ]), 'recall': array([0.0497358 , 0.08294228]), 'recall_pop': {0: array([0.00018262, 0.00082711]), 1: array([0.00060528, 0.00160523]), 2: array([0.00070264, 0.00165816]), 3: array([0.00121472, 0.00363334]), 4: array([0.00224926, 0.00514624]), 5: array([0.00343293, 0.00849171]), 6: array([0.00517829, 0.01280459]), 7: array([0.01248279, 0.02568226]), 8: array([0.02642511, 0.05032083]), 9: array([0.10025219, 0.15374868])}, 'recall_pop_Contribute': {0: array([6.38126442e-05, 1.91354724e-04]), 1: array([0.00012934, 0.00025986]), 2: array([9.70958722e-05, 2.50835309e-04]), 3: array([0.00019586, 0.00059294]), 4: array([0.00036532, 0.00079325]), 5: array([0.00056532, 0.00140369]), 6: array([0.00086014, 0.00217863]), 7: array([0.0023334 , 0.00484519]), 8: array([0.0056986, 0.0109589]), 9: array([0.03942692, 0.06146764])}, 'ndcg': array([0.04100668, 0.05355354])}
[5mfind a better recall[25m 0.04973579918563089 ++0.0101324635707703
total time cost of epoch 1:  49.878108978271484
[AUGMENT]






















training: 604it [00:43, 14.02it/s]
EPOCH[2]:loss 4.846
[TEST]
training: 5it [00:00, 12.72it/s]
{'precision': array([0.02499526, 0.02091701]), 'recall': array([0.05503807, 0.09142167]), 'recall_pop': {0: array([0.00060576, 0.00201157]), 1: array([0.00123683, 0.00321995]), 2: array([0.00131507, 0.00323642]), 3: array([0.00226205, 0.0059493 ]), 4: array([0.00377893, 0.00808462]), 5: array([0.00535083, 0.01257005]), 6: array([0.00815155, 0.01826438]), 7: array([0.01685711, 0.03221098]), 8: array([0.03176993, 0.05734147]), 9: array([0.10368152, 0.1575448 ])}, 'recall_pop_Contribute': {0: array([0.00014624, 0.00044005]), 1: array([0.00021118, 0.00048823]), 2: array([0.00020639, 0.00051869]), 3: array([0.0003601 , 0.00090604]), 4: array([0.00061551, 0.00129863]), 5: array([0.00091011, 0.00213422]), 6: array([0.0013484 , 0.00305707]), 7: array([0.00313352, 0.00607155]), 8: array([0.00688232, 0.01268615]), 9: array([0.0412243 , 0.06382105])}, 'ndcg': array([0.0456801 , 0.05942214])}
[5mfind a better recall[25m 0.055038067662705054 ++0.005302268477074164
total time cost of epoch 2:  49.97635078430176
[AUGMENT]



















training: 604it [00:38, 14.99it/s]
EPOCH[3]:loss 4.658

training: 604it [00:38, 15.64it/s]
training: 11it [00:00, 14.00it/s]
{'precision': array([0.02624574, 0.02190066]), 'recall': array([0.05809722, 0.09610959]), 'recall_pop': {0: array([0.00108468, 0.00276279]), 1: array([0.00196925, 0.00448551]), 2: array([0.00203429, 0.00479316]), 3: array([0.00316855, 0.00739297]), 4: array([0.00455507, 0.0105781 ]), 5: array([0.00694073, 0.01566725]), 6: array([0.01063679, 0.02250848]), 7: array([0.01891816, 0.03686259]), 8: array([0.03531057, 0.0625858 ]), 9: array([0.10378719, 0.15709   ])}, 'recall_pop_Contribute': {0: array([0.0002333 , 0.00058858]), 1: array([0.00030465, 0.00067067]), 2: array([0.00034264, 0.00074481]), 3: array([0.00049043, 0.00110637]), 4: array([0.00073096, 0.001654  ]), 5: array([0.0012122 , 0.00263937]), 6: array([0.00177964, 0.00383829]), 7: array([0.00356376, 0.00697518]), 8: array([0.00778873, 0.01384421]), 9: array([0.0416509 , 0.06404811])}, 'ndcg': array([0.04814958, 0.06248353])}
[5mfind a better recall[25m 0.05809721588191738 ++0.0030591482192123265
total time cost of epoch 3:  45.69276142120361
[AUGMENT]





















training: 601it [00:42, 14.26it/s]
EPOCH[4]:loss 4.542

training: 604it [00:43, 13.96it/s]
training: 7it [00:00, 12.23it/s]
{'precision': array([0.02689308, 0.02230169]), 'recall': array([0.05957379, 0.09819313]), 'recall_pop': {0: array([0.0013174 , 0.00410725]), 1: array([0.00258131, 0.00554697]), 2: array([0.0025597 , 0.00603906]), 3: array([0.00362361, 0.00823583]), 4: array([0.00576923, 0.01165063]), 5: array([0.00787395, 0.01704675]), 6: array([0.01213768, 0.02485084]), 7: array([0.02082934, 0.03860707]), 8: array([0.03745591, 0.06518968]), 9: array([0.10347854, 0.15569907])}, 'recall_pop_Contribute': {0: array([0.00029014, 0.00086224]), 1: array([0.00039762, 0.0008812 ]), 2: array([0.00043056, 0.00092199]), 3: array([0.00053065, 0.0012805 ]), 4: array([0.00089886, 0.00184105]), 5: array([0.00134301, 0.00287943]), 6: array([0.00205544, 0.00420895]), 7: array([0.00390534, 0.00732452]), 8: array([0.00818166, 0.01446096]), 9: array([0.04154052, 0.06353228])}, 'ndcg': array([0.04930537, 0.06383089])}
[5mfind a better recall[25m 0.05957379381893995 ++0.0014765779370225704
total time cost of epoch 4:  50.29758930206299
[AUGMENT]





















training: 603it [00:42, 14.50it/s]
EPOCH[5]:loss 4.465

training: 604it [00:42, 14.12it/s]
training: 13it [00:00, 14.23it/s]
{'precision': array([0.02738727, 0.02272325]), 'recall': array([0.06103048, 0.10022316]), 'recall_pop': {0: array([0.00190012, 0.00540143]), 1: array([0.00281325, 0.00620105]), 2: array([0.0028565 , 0.00707765]), 3: array([0.00416516, 0.00941225]), 4: array([0.00643147, 0.01259637]), 5: array([0.00913765, 0.01916538]), 6: array([0.01320417, 0.02731877]), 7: array([0.0228179 , 0.04104676]), 8: array([0.03799063, 0.06810764]), 9: array([0.10265573, 0.15397017])}, 'recall_pop_Contribute': {0: array([0.0004146 , 0.00109029]), 1: array([0.00044209, 0.00097103]), 2: array([0.00043699, 0.00105832]), 3: array([0.00061919, 0.00144188]), 4: array([0.0010189 , 0.00197638]), 5: array([0.00157145, 0.00323054]), 6: array([0.00225241, 0.00468563]), 7: array([0.00433728, 0.00780349]), 8: array([0.00836988, 0.01517128]), 9: array([0.04156768, 0.06279431])}, 'ndcg': array([0.05054982, 0.06533849])}
[5mfind a better recall[25m 0.06103048119022257 ++0.0014566873712826209
total time cost of epoch 5:  49.71339726448059
[AUGMENT]














training: 399it [00:28, 14.15it/s]
nothing