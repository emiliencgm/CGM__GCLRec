==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'nothing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'gowalla',
 'device': device(type='cuda'),
 'early_stop_steps': 50,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'freeze_mlp': 200,
 'group': 'Ours',
 'if_SVD': 1,
 'if_adaptive': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'gowalla',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.1,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/gowalla]
810128 interactions for training
217242 interactions for testing
gowalla Sparsity : 0.0008396216228570436
loading adjacency matrix
generating adjacency matrix --- All train data
costing 65.04642152786255s, saved norm_mat...
gowalla is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/gowalla/EigenvectorCentroid
eigenvector_centrality cost:  0.0011012554168701172
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/gowalla/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.05611705780029297
shape test : 1620256 == 1620256
precal cost :  0.9377381801605225
[PRECALCULATE--END]
user:29858, item:40981
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]

















training: 395it [00:34, 11.30it/s]
EPOCH[0]:loss 6.688
[TEST]
{'precision': array([0.03630518, 0.02602904]), 'recall': array([0.11536177, 0.16415625]), 'recall_pop': {0: array([0.00285658, 0.00778052]), 1: array([0.00373045, 0.00892096]), 2: array([0.0031767 , 0.00822197]), 3: array([0.004932  , 0.01152487]), 4: array([0.00485249, 0.0110327 ]), 5: array([0.00665268, 0.01442795]), 6: array([0.014097  , 0.02489257]), 7: array([0.01764613, 0.03328805]), 8: array([0.03798857, 0.06053505]), 9: array([0.20411815, 0.26288621])}, 'recall_pop_Contribute': {0: array([0.00098976, 0.00254276]), 1: array([0.00096991, 0.00233355]), 2: array([0.00078135, 0.00203902]), 3: array([0.00123715, 0.00274122]), 4: array([0.00117939, 0.00258478]), 5: array([0.00172584, 0.00365328]), 6: array([0.00350998, 0.00623337]), 7: array([0.00453962, 0.0084024 ]), 8: array([0.01047753, 0.01636126]), 9: array([0.08995124, 0.11726461])}, 'ndcg': array([0.09571505, 0.11109376])}
[5mfind a better recall[25m 0.11536176741893822 ++0.11536176741893822
total time cost of epoch 0:  43.66154170036316
training: 10it [00:00, 12.56it/s]
[AUGMENT]














training: 395it [00:28, 13.70it/s]
EPOCH[1]:loss 4.621
[TEST]
training: 9it [00:00, 12.06it/s]
{'precision': array([0.042394  , 0.03004722]), 'recall': array([0.13688696, 0.19302197]), 'recall_pop': {0: array([0.00436152, 0.01093768]), 1: array([0.00547289, 0.01275914]), 2: array([0.0049194 , 0.01234287]), 3: array([0.00703162, 0.01590146]), 4: array([0.00685873, 0.01600209]), 5: array([0.0100108 , 0.02080827]), 6: array([0.01838522, 0.03387016]), 7: array([0.02514989, 0.04472854]), 8: array([0.04977643, 0.07718081]), 9: array([0.22819593, 0.28800757])}, 'recall_pop_Contribute': {0: array([0.00143608, 0.00345426]), 1: array([0.0014051 , 0.00324591]), 2: array([0.00113366, 0.0030393 ]), 3: array([0.0016908 , 0.00369475]), 4: array([0.00165024, 0.00371927]), 5: array([0.00248983, 0.00514641]), 6: array([0.00450002, 0.0083276 ]), 7: array([0.00641652, 0.0111575 ]), 8: array([0.01374242, 0.02087456]), 9: array([0.1024223 , 0.13036241])}, 'ndcg': array([0.11390842, 0.1315648 ])}
[5mfind a better recall[25m 0.13688696416537824 ++0.021525196746440017
total time cost of epoch 1:  37.988115072250366
[AUGMENT]
















training: 390it [00:32, 12.30it/s]
EPOCH[2]:loss 4.272

training: 395it [00:33, 11.84it/s]
training: 10it [00:00, 12.17it/s]
{'precision': array([0.04523076, 0.03219405]), 'recall': array([0.14752127, 0.20860755]), 'recall_pop': {0: array([0.00593475, 0.01412707]), 1: array([0.00733845, 0.01548182]), 2: array([0.00643271, 0.01597315]), 3: array([0.00861132, 0.01924028]), 4: array([0.00918028, 0.01950817]), 5: array([0.01249821, 0.02579906]), 6: array([0.02135506, 0.03892723]), 7: array([0.02850602, 0.05057695]), 8: array([0.05570377, 0.08479665]), 9: array([0.23762589, 0.29903788])}, 'recall_pop_Contribute': {0: array([0.00191789, 0.00436143]), 1: array([0.00186098, 0.00394595]), 2: array([0.00146679, 0.00379275]), 3: array([0.00202546, 0.0044306 ]), 4: array([0.00218985, 0.00444937]), 5: array([0.00301877, 0.00630315]), 6: array([0.00521942, 0.00952086]), 7: array([0.00716368, 0.01249682]), 8: array([0.0152846 , 0.02292803]), 9: array([0.10737383, 0.13637859])}, 'ndcg': array([0.12296329, 0.14229498])}
[5mfind a better recall[25m 0.14752127345674446 ++0.010634309291366217
total time cost of epoch 2:  42.064046144485474
[AUGMENT]
















training: 395it [00:32, 11.97it/s]
EPOCH[3]:loss 4.063
[TEST]
training: 5it [00:00,  9.83it/s]
{'precision': array([0.04739601, 0.03363085]), 'recall': array([0.15583922, 0.21902392]), 'recall_pop': {0: array([0.00712585, 0.01655519]), 1: array([0.0086803 , 0.01830967]), 2: array([0.00832779, 0.01829913]), 3: array([0.01009532, 0.02139803]), 4: array([0.0107229 , 0.02208035]), 5: array([0.01504917, 0.02939417]), 6: array([0.02416636, 0.04231042]), 7: array([0.03165664, 0.05391272]), 8: array([0.05970389, 0.09012501]), 9: array([0.24432886, 0.30581588])}, 'recall_pop_Contribute': {0: array([0.00225398, 0.00512472]), 1: array([0.00220229, 0.00469229]), 2: array([0.00191295, 0.00435744]), 3: array([0.00239002, 0.0050165 ]), 4: array([0.0025236 , 0.00506258]), 5: array([0.00360218, 0.00711401]), 6: array([0.00588507, 0.01029661]), 7: array([0.00796119, 0.01334029]), 8: array([0.01632905, 0.02428099]), 9: array([0.11077889, 0.1397385 ])}, 'ndcg': array([0.12951533, 0.14955663])}
[5mfind a better recall[25m 0.1558392209519669 ++0.008317947495222439
total time cost of epoch 3:  41.9979293346405
[AUGMENT]




training: 100it [00:08, 11.65it/s]
nothing