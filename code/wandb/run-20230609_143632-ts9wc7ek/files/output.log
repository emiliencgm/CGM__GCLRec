==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaptive_method': 'None',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'baseline',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 1,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'BPR',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+BPR',
 'notes': '_',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['testing'],
 'tau_plus': 0.1,
 'temp_tau': 0.2,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 1,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
precal cost :  0.8005187511444092
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[Visualization]
[t-SNE]
[double-label]
[AUGMENT]
[TRAIN]









training: 604it [00:19, 31.06it/s]
EPOCH[0]:loss 0.352
[TEST]
{'precision': array([0.01532935]), 'recall': array([0.03220105]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.00015263]), 6: array([0.00088417]), 7: array([0.00098943]), 8: array([0.00409487]), 9: array([0.08090944])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.92402558e-05]), 6: array([0.00015122]), 7: array([0.00016961]), 8: array([0.0008219]), 9: array([0.03103909])}, 'ndcg': array([0.02645929])}
[5mfind a better recall[25m [0.03220105] ++[0.03220105]
time cost of epoch 0:  39.28282809257507
[Visualization]
[t-SNE]
[double-label]
[AUGMENT]
[TRAIN]









training: 604it [00:19, 31.35it/s]
EPOCH[1]:loss 0.167
[TEST]
{'precision': array([0.01585039]), 'recall': array([0.03363493]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.00015263]), 6: array([0.00088417]), 7: array([0.00121311]), 8: array([0.00469356]), 9: array([0.08539632])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.92402558e-05]), 6: array([0.00015358]), 7: array([0.00020579]), 8: array([0.00092903]), 9: array([0.03232728])}, 'ndcg': array([0.02762688])}
[5mfind a better recall[25m [0.03363493] ++[0.00143387]
time cost of epoch 1:  39.414352893829346
[Visualization]
[t-SNE]
[double-label]
training: 2it [00:00, 16.06it/s]
[AUGMENT]









training: 587it [00:18, 33.56it/s]
EPOCH[2]:loss 0.155

training: 604it [00:18, 31.81it/s]
{'precision': array([0.0159988]), 'recall': array([0.03408103]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.00015263]), 6: array([0.0008526]), 7: array([0.00120521]), 8: array([0.00527596]), 9: array([0.08610859])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.92402558e-05]), 6: array([0.00014727]), 7: array([0.00020497]), 8: array([0.00104768]), 9: array([0.03266188])}, 'ndcg': array([0.02804775])}
[5mfind a better recall[25m [0.03408103] ++[0.00044611]
time cost of epoch 2:  36.891066789627075
[Visualization]
[t-SNE]
[double-label]
training: 0it [00:00, ?it/s]
[AUGMENT]










training: 604it [00:19, 31.24it/s]
EPOCH[3]:loss 0.148
[TEST]
{'precision': array([0.01646615]), 'recall': array([0.03541059]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.0001421]), 6: array([0.00091575]), 7: array([0.00135257]), 8: array([0.00538877]), 9: array([0.08887091])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.69847117e-05]), 6: array([0.00015753]), 7: array([0.00024124]), 8: array([0.00105879]), 9: array([0.03393604])}, 'ndcg': array([0.02890519])}
[5mfind a better recall[25m [0.03541059] ++[0.00132955]
time cost of epoch 3:  37.07873749732971
[Visualization]
[t-SNE]
[double-label]
training: 21it [00:00, 31.48it/s]
[AUGMENT]









training: 594it [00:18, 33.11it/s]
EPOCH[4]:loss 0.138

training: 604it [00:19, 31.39it/s]
{'precision': array([0.01699981]), 'recall': array([0.03675777]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.0001421]), 6: array([0.00094733]), 7: array([0.00135784]), 8: array([0.00550664]), 9: array([0.0918329])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.69847117e-05]), 6: array([0.00016279]), 7: array([0.00023203]), 8: array([0.00108953]), 9: array([0.03525643])}, 'ndcg': array([0.02973739])}
[5mfind a better recall[25m [0.03675777] ++[0.00134718]
time cost of epoch 4:  37.1711311340332
[Visualization]
[t-SNE]
[double-label]
[AUGMENT]
[TRAIN]









training: 604it [00:19, 31.26it/s]
EPOCH[5]:loss 0.131
[TEST]
{'precision': array([0.01751295]), 'recall': array([0.03786416]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.0001421]), 6: array([0.00100101]), 7: array([0.00132626]), 8: array([0.00554575]), 9: array([0.09433487])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.69847117e-05]), 6: array([0.00017412]), 7: array([0.0002309]), 8: array([0.00110062]), 9: array([0.03634153])}, 'ndcg': array([0.03070811])}
[5mfind a better recall[25m [0.03786416] ++[0.00110639]
time cost of epoch 5:  36.96167755126953
[Visualization]
[t-SNE]
[double-label]
training: 32it [00:01, 31.18it/s]
[AUGMENT]









training: 604it [00:19, 31.57it/s]
EPOCH[6]:loss 0.125
[TEST]
{'precision': array([0.01805135]), 'recall': array([0.03910604]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.0001421]), 6: array([0.00096943]), 7: array([0.00128152]), 8: array([0.00553105]), 9: array([0.09739442])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.69847117e-05]), 6: array([0.00016781]), 7: array([0.00022872]), 8: array([0.00109688]), 9: array([0.03759565])}, 'ndcg': array([0.03166993])}
[5mfind a better recall[25m [0.03910604] ++[0.00124188]
time cost of epoch 6:  36.697821855545044
[Visualization]
[t-SNE]
[double-label]
[AUGMENT]
[TRAIN]








training: 593it [00:18, 32.89it/s]
EPOCH[7]:loss 0.119

training: 604it [00:19, 31.50it/s]
{'precision': array([0.01840975]), 'recall': array([0.03980276]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.00014841]), 6: array([0.00098522]), 7: array([0.00119206]), 8: array([0.00543163]), 9: array([0.09949082])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.74859437e-05]), 6: array([0.00016825]), 7: array([0.00021912]), 8: array([0.00107885]), 9: array([0.03831906])}, 'ndcg': array([0.03218923])}
[5mfind a better recall[25m [0.03980276] ++[0.00069672]
time cost of epoch 7:  36.32354760169983
[Visualization]
[t-SNE]
[double-label]
training: 9it [00:00, 27.09it/s]
[AUGMENT]




training: 234it [00:07, 32.44it/s]