==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0009074211120605469
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07362937927246094
shape test : 2474518 == 2474518
precal cost :  0.8051238059997559
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]
















training: 599it [00:59, 10.38it/s]
EPOCH[0]:loss 6.933

training: 604it [01:00, 10.05it/s]
{'precision': array([0.01974706, 0.01650957]), 'recall': array([0.04197116, 0.06964419]), 'recall_pop': {0: array([0.00000000e+00, 3.28407225e-05]), 1: array([4.21034904e-05, 4.73664267e-05]), 2: array([7.34179613e-05, 2.62883668e-04]), 3: array([0.00013684, 0.00080207]), 4: array([0.00039735, 0.00118319]), 5: array([0.00074689, 0.0029482 ]), 6: array([0.00161182, 0.00415169]), 7: array([0.00384862, 0.00946657]), 8: array([0.01341623, 0.02991226]), 9: array([0.09994178, 0.15545559])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 1.18579078e-05]), 1: array([5.13136289e-06, 5.84903602e-06]), 2: array([7.92005712e-06, 3.78810877e-05]), 3: array([2.59750536e-05, 1.20359784e-04]), 4: array([6.10818997e-05, 1.72290253e-04]), 5: array([0.0001254 , 0.00051363]), 6: array([0.0002617 , 0.00069181]), 7: array([0.00072456, 0.0017786 ]), 8: array([0.00294518, 0.00655501]), 9: array([0.03781422, 0.0597569 ])}, 'ndcg': array([0.03455463, 0.04495472])}
[5mfind a better recall[25m 0.041971155368010306 ++0.041971155368010306
total time cost of epoch 0:  67.32657217979431
tensor([[0.0000, 7.1373, 0.0000, 0.0000, 0.0000]], device='cuda:0') [[0.99997914]]
[AUGMENT]
[TRAIN]





























training: 604it [00:58, 10.33it/s]
EPOCH[1]:loss 5.281
[TEST]
training: 4it [00:00,  8.81it/s]
{'precision': array([0.02402425, 0.020006  ]), 'recall': array([0.05225391, 0.08665527]), 'recall_pop': {0: array([7.75756810e-05, 3.61072516e-04]), 1: array([0.0002221 , 0.00076663]), 2: array([0.00037867, 0.00114048]), 3: array([0.00093101, 0.00254568]), 4: array([0.00133731, 0.00363001]), 5: array([0.00264312, 0.00683601]), 6: array([0.00416464, 0.01047363]), 7: array([0.0099137, 0.0226726]), 8: array([0.02616641, 0.05068208]), 9: array([0.11143917, 0.16994459])}, 'recall_pop_Contribute': {0: array([1.40461813e-05, 7.79161109e-05]), 1: array([3.88818215e-05, 1.21536274e-04]), 2: array([5.34994607e-05, 1.75081565e-04]), 3: array([0.00014653, 0.00039747]), 4: array([0.00021411, 0.00058808]), 5: array([0.00044168, 0.00114062]), 6: array([0.00066483, 0.0017983 ]), 7: array([0.00184445, 0.00435439]), 8: array([0.00566032, 0.01114767]), 9: array([0.04317557, 0.06685422])}, 'ndcg': array([0.04280706, 0.05572426])}
[5mfind a better recall[25m 0.05225391347015649 ++0.010282758102146183
total time cost of epoch 1:  66.75746560096741
[AUGMENT]



