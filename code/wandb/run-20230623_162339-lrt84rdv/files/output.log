==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0010302066802978516
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.08086085319519043
shape test : 2474518 == 2474518
precal cost :  0.7979881763458252
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
training: 0it [00:00, ?it/s]
[AUGMENT]

























training: 602it [01:01, 10.10it/s]
EPOCH[0]:loss 6.933

training: 604it [01:01,  9.77it/s]
{'precision': array([0.01982443, 0.01653404]), 'recall': array([0.04186113, 0.06968213]), 'recall_pop': {0: array([8.94699171e-06, 9.57854406e-05]), 1: array([5.99974738e-05, 2.70514926e-04]), 2: array([6.31552356e-06, 1.01048377e-04]), 3: array([0.00014661, 0.00103868]), 4: array([0.00020789, 0.00102925]), 5: array([0.00060787, 0.0022767 ]), 6: array([0.00163422, 0.00415938]), 7: array([0.00380788, 0.00983499]), 8: array([0.01326682, 0.02942719]), 9: array([0.10018714, 0.15632536])}, 'recall_pop_Contribute': {0: array([1.32958391e-06, 1.45759593e-05]), 1: array([8.88963919e-06, 4.94091224e-05]), 2: array([7.01724840e-07, 1.54755389e-05]), 3: array([2.33767998e-05, 1.85757531e-04]), 4: array([3.93913239e-05, 1.58601793e-04]), 5: array([9.96418660e-05, 3.60703883e-04]), 6: array([0.00025366, 0.00071254]), 7: array([0.00069688, 0.00181584]), 8: array([0.00286045, 0.00628433]), 9: array([0.0378768 , 0.06008491])}, 'ndcg': array([0.03453791, 0.04494274])}
[5mfind a better recall[25m 0.04186112821321276 ++0.04186112821321276
total time cost of epoch 0:  68.89839100837708
[AUGMENT]
[TRAIN]






























training: 604it [01:00, 10.01it/s]
EPOCH[1]:loss 5.282
[TEST]
training: 4it [00:00,  8.85it/s]
{'precision': array([0.02385847, 0.019931  ]), 'recall': array([0.0519972 , 0.08613284]), 'recall_pop': {0: array([0.0001221 , 0.00039081]), 1: array([0.00026788, 0.00104215]), 2: array([0.00022706, 0.00070152]), 3: array([0.00076425, 0.00270737]), 4: array([0.00179348, 0.00457337]), 5: array([0.00195524, 0.00635939]), 6: array([0.00395419, 0.01017814]), 7: array([0.00932704, 0.02147444]), 8: array([0.02518736, 0.04954817]), 9: array([0.11229224, 0.17056653])}, 'recall_pop_Contribute': {0: array([2.00707154e-05, 7.52278280e-05]), 1: array([4.49857604e-05, 1.87919568e-04]), 2: array([3.47679351e-05, 1.13318828e-04]), 3: array([0.00012263, 0.00042783]), 4: array([0.00030014, 0.00071258]), 5: array([0.00034327, 0.00107323]), 6: array([0.00067041, 0.00171303]), 7: array([0.00174043, 0.00396158]), 8: array([0.00545491, 0.01079807]), 9: array([0.04326558, 0.06707006])}, 'ndcg': array([0.04276748, 0.05562427])}
[5mfind a better recall[25m 0.05199720033068178 ++0.010136072117469024
total time cost of epoch 1:  67.31744027137756
[AUGMENT]

























training: 604it [00:50, 12.07it/s]
EPOCH[2]:loss 5.002
[TEST]
training: 15it [00:01, 10.57it/s]
{'precision': array([0.026301  , 0.02184697]), 'recall': array([0.05755388, 0.09548068]), 'recall_pop': {0: array([0.00038893, 0.00120499]), 1: array([0.000924  , 0.00229854]), 2: array([0.00076128, 0.00253802]), 3: array([0.00161395, 0.00464601]), 4: array([0.00351775, 0.00730563]), 5: array([0.00400913, 0.01038627]), 6: array([0.00634801, 0.01648351]), 7: array([0.01407201, 0.0300283 ]), 8: array([0.03094232, 0.06042079]), 9: array([0.11584434, 0.17346641])}, 'recall_pop_Contribute': {0: array([7.99371469e-05, 2.29222580e-04]), 1: array([0.00015954, 0.00037873]), 2: array([0.00011724, 0.00039305]), 3: array([0.00025699, 0.00073396]), 4: array([0.00058729, 0.00114795]), 5: array([0.00070126, 0.0017202 ]), 6: array([0.00109198, 0.00279184]), 7: array([0.00262179, 0.00564151]), 8: array([0.0067843 , 0.01324754]), 9: array([0.04515356, 0.06919668])}, 'ndcg': array([0.04744063, 0.06167701])}
[5mfind a better recall[25m 0.05755388271803548 ++0.005556682387353698
total time cost of epoch 2:  57.072712898254395
[AUGMENT]





























training: 604it [00:58, 10.34it/s]
EPOCH[3]:loss 4.850
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.02768726, 0.02297035]), 'recall': array([0.06094966, 0.10068101]), 'recall_pop': {0: array([0.00098206, 0.00234006]), 1: array([0.0012356, 0.0034289]), 2: array([0.00123831, 0.00382636]), 3: array([0.00251001, 0.00629101]), 4: array([0.00452985, 0.00940996]), 5: array([0.00564223, 0.01319011]), 6: array([0.00932429, 0.02095501]), 7: array([0.01693328, 0.03494587]), 8: array([0.03528003, 0.06583491]), 9: array([0.11645704, 0.1734145 ])}, 'recall_pop_Contribute': {0: array([0.00017528, 0.00046001]), 1: array([0.00019708, 0.0005557 ]), 2: array([0.0001851 , 0.00056826]), 3: array([0.0003916 , 0.00099064]), 4: array([0.00070232, 0.0014649 ]), 5: array([0.00094122, 0.00216658]), 6: array([0.00157882, 0.00357268]), 7: array([0.00315945, 0.00656042]), 8: array([0.00773382, 0.0145006 ]), 9: array([0.04588495, 0.06984122])}, 'ndcg': array([0.0503223 , 0.06524574])}
[5mfind a better recall[25m 0.060949655532268845 ++0.0033957728142333665
total time cost of epoch 3:  65.24771165847778
[AUGMENT]





























training: 604it [00:58, 10.41it/s]
EPOCH[4]:loss 4.754
[TEST]
training: 2it [00:00,  8.14it/s]
{'precision': array([0.02830933, 0.02354585]), 'recall': array([0.06271037, 0.10348164]), 'recall_pop': {0: array([0.00110131, 0.00324844]), 1: array([0.00153218, 0.00433601]), 2: array([0.00163724, 0.00479921]), 3: array([0.00307419, 0.00729033]), 4: array([0.00528218, 0.01072322]), 5: array([0.0065853, 0.0152288]), 6: array([0.01114935, 0.02377096]), 7: array([0.01896243, 0.0391712 ]), 8: array([0.03791637, 0.06908439]), 9: array([0.11600055, 0.17268827])}, 'recall_pop_Contribute': {0: array([0.00019864, 0.00065149]), 1: array([0.00023934, 0.00070638]), 2: array([0.00026621, 0.00070178]), 3: array([0.00045249, 0.00111408]), 4: array([0.00081713, 0.00165128]), 5: array([0.00111171, 0.00248895]), 6: array([0.00188575, 0.00402994]), 7: array([0.00357096, 0.00741703]), 8: array([0.00826487, 0.01523581]), 9: array([0.04590327, 0.0694849 ])}, 'ndcg': array([0.05189718, 0.0672713 ])}
[5mfind a better recall[25m 0.06271036637886475 ++0.0017607108465959032
total time cost of epoch 4:  65.93722200393677
[AUGMENT]





























training: 604it [00:58, 10.35it/s]
EPOCH[5]:loss 4.692
[TEST]
training: 10it [00:01, 10.24it/s]
{'precision': array([0.02901983, 0.0240282 ]), 'recall': array([0.06442669, 0.10555086]), 'recall_pop': {0: array([0.00157238, 0.00408589]), 1: array([0.00186638, 0.00563483]), 2: array([0.00207512, 0.005409  ]), 3: array([0.00375417, 0.00882772]), 4: array([0.00550651, 0.0121942 ]), 5: array([0.00809244, 0.01721825]), 6: array([0.01217341, 0.0264357 ]), 7: array([0.0208434 , 0.04107096]), 8: array([0.03989089, 0.07028554]), 9: array([0.11504164, 0.17138292])}, 'recall_pop_Contribute': {0: array([0.00029456, 0.00081838]), 1: array([0.00028225, 0.00087916]), 2: array([0.00030995, 0.00076379]), 3: array([0.00055701, 0.00135542]), 4: array([0.00086147, 0.00185277]), 5: array([0.0013717 , 0.00287221]), 6: array([0.00207653, 0.00447484]), 7: array([0.00394758, 0.0077688 ]), 8: array([0.00876681, 0.0155079 ]), 9: array([0.04595884, 0.06925758])}, 'ndcg': array([0.05325767, 0.06877436])}
[5mfind a better recall[25m 0.06442669310121589 ++0.0017163267223511414
total time cost of epoch 5:  65.36724996566772
[AUGMENT]





























training: 604it [00:58, 10.35it/s]
EPOCH[6]:loss 4.649
[TEST]
{'precision': array([0.02940034, 0.02427214]), 'recall': array([0.0654228 , 0.10693207]), 'recall_pop': {0: array([0.00220915, 0.00513821]), 1: array([0.00228566, 0.00603787]), 2: array([0.00266224, 0.00646369]), 3: array([0.0040313 , 0.00942452]), 4: array([0.00614964, 0.01319161]), 5: array([0.00947438, 0.01942018]), 6: array([0.01363241, 0.02797056]), 7: array([0.02183847, 0.04332445]), 8: array([0.04114636, 0.07304953]), 9: array([0.11496315, 0.16827597])}, 'recall_pop_Contribute': {0: array([0.00043139, 0.00103567]), 1: array([0.00038206, 0.00096031]), 2: array([0.00037273, 0.00095618]), 3: array([0.00061955, 0.00144586]), 4: array([0.00097816, 0.00201835]), 5: array([0.00156342, 0.00323695]), 6: array([0.0023445 , 0.00473227]), 7: array([0.00409203, 0.00819359]), 8: array([0.00901232, 0.01615171]), 9: array([0.04562665, 0.0682012 ])}, 'ndcg': array([0.05398445, 0.06963323])}
[5mfind a better recall[25m 0.06542280276801203 ++0.000996109666796141
total time cost of epoch 6:  65.25062131881714
training: 16it [00:01, 10.38it/s]
[AUGMENT]





























training: 604it [00:57, 10.42it/s]
EPOCH[7]:loss 4.620
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.0297398 , 0.02448055]), 'recall': array([0.0662355 , 0.10810201]), 'recall_pop': {0: array([0.00258386, 0.00624416]), 1: array([0.002835  , 0.00682494]), 2: array([0.00278561, 0.00724484]), 3: array([0.00416813, 0.00981819]), 4: array([0.00651661, 0.01477524]), 5: array([0.01041026, 0.02066347]), 6: array([0.01434179, 0.02975623]), 7: array([0.02310018, 0.04524047]), 8: array([0.04243079, 0.07345042]), 9: array([0.1139774 , 0.16652285])}, 'recall_pop_Contribute': {0: array([0.00049635, 0.00123   ]), 1: array([0.00043641, 0.0010778 ]), 2: array([0.0003944 , 0.00104765]), 3: array([0.00063219, 0.00150153]), 4: array([0.00100014, 0.00223956]), 5: array([0.00171988, 0.00344723]), 6: array([0.00248691, 0.00507299]), 7: array([0.00440344, 0.00861775]), 8: array([0.00927557, 0.01623582]), 9: array([0.04539021, 0.06763167])}, 'ndcg': array([0.05470978, 0.07045635])}
[5mfind a better recall[25m 0.06623550226098696 ++0.0008126994929749248
total time cost of epoch 7:  65.63664865493774
[AUGMENT]






























training: 604it [00:58, 10.34it/s]
EPOCH[8]:loss 4.598
[TEST]
training: 7it [00:00, 10.11it/s]
{'precision': array([0.02977454, 0.02454923]), 'recall': array([0.066298  , 0.10843306]), 'recall_pop': {0: array([0.00299582, 0.00673837]), 1: array([0.00297031, 0.00761602]), 2: array([0.00298064, 0.00745862]), 3: array([0.00437539, 0.01015738]), 4: array([0.00693659, 0.0141991 ]), 5: array([0.01072816, 0.02194736]), 6: array([0.01518622, 0.03067242]), 7: array([0.02413709, 0.04576734]), 8: array([0.04141571, 0.07440271]), 9: array([0.11266375, 0.16465458])}, 'recall_pop_Contribute': {0: array([0.00057962, 0.0013421 ]), 1: array([0.00047558, 0.00120424]), 2: array([0.00041229, 0.00107598]), 3: array([0.00067568, 0.00158619]), 4: array([0.00106789, 0.00218456]), 5: array([0.00176074, 0.00363312]), 6: array([0.00264119, 0.00523447]), 7: array([0.00455   , 0.00864268]), 8: array([0.00912093, 0.01646971]), 9: array([0.04501408, 0.06706002])}, 'ndcg': array([0.05505721, 0.07092088])}
[5mfind a better recall[25m 0.06629800071061813 ++6.249844963117368e-05
total time cost of epoch 8:  65.36823081970215
[AUGMENT]















training: 308it [00:29, 10.30it/s]