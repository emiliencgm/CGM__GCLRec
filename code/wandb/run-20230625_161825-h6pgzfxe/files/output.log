==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'nothing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'freeze_mlp': 2,
 'group': 'Ours',
 'if_SVD': 1,
 'if_adaptive': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.1,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.001049041748046875
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.08318066596984863
shape test : 2474518 == 2474518
precal cost :  0.839327335357666
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]
























training: 604it [00:49, 12.18it/s]
EPOCH[0]:loss 6.571
[TEST]
{'precision': array([0.01889447, 0.01595854]), 'recall': array([0.03997516, 0.06728111]), 'recall_pop': {0: array([3.15776178e-05, 1.74729485e-04]), 1: array([7.57862827e-05, 2.75777862e-04]), 2: array([0.00014841, 0.00046024]), 3: array([0.0005855 , 0.00176056]), 4: array([0.00040788, 0.00186688]), 5: array([0.00137994, 0.00374784]), 6: array([0.00231571, 0.00622268]), 7: array([0.0060005 , 0.01428985]), 8: array([0.01710597, 0.03502384]), 9: array([0.08909503, 0.14054683])}, 'recall_pop_Contribute': {0: array([6.31552356e-06, 3.89645248e-05]), 1: array([1.49157013e-05, 4.15681853e-05]), 2: array([2.31768551e-05, 7.52519623e-05]), 3: array([7.87870217e-05, 2.73217406e-04]), 4: array([6.77187814e-05, 2.90248974e-04]), 5: array([0.00022662, 0.00065643]), 6: array([0.00037723, 0.0010327 ]), 7: array([0.00120604, 0.00274074]), 8: array([0.00373253, 0.00760952]), 9: array([0.03424183, 0.05452247])}, 'ndcg': array([0.03304864, 0.04333052])}
[5mfind a better recall[25m 0.03997516162310424 ++0.03997516162310424
total time cost of epoch 0:  57.11756730079651
training: 8it [00:00, 11.57it/s]
[AUGMENT]




training: 96it [00:07, 12.27it/s]
nothing