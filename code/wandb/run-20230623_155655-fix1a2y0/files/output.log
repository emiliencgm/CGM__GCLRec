==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0008916854858398438
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07324647903442383
shape test : 2474518 == 2474518
precal cost :  0.7853972911834717
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]























training: 590it [00:58, 10.57it/s]
EPOCH[0]:loss 6.935

training: 604it [01:00, 10.04it/s]
{'precision': array([0.01969338, 0.01652773]), 'recall': array([0.04163201, 0.06971475]), 'recall_pop': {0: array([3.15776178e-05, 1.40520399e-04]), 1: array([5.99974738e-05, 1.65256200e-04]), 2: array([9.47328534e-05, 1.32889142e-04]), 3: array([6.31552356e-05, 7.72899788e-04]), 4: array([0.0002342 , 0.00089873]), 5: array([0.00055261, 0.00200285]), 6: array([0.00141815, 0.00371092]), 7: array([0.00429061, 0.01061877]), 8: array([0.01283681, 0.0297422 ]), 9: array([0.09933855, 0.15611279])}, 'recall_pop_Contribute': {0: array([5.26293630e-06, 2.77004741e-05]), 1: array([9.0212126e-06, 2.2669832e-05]), 2: array([1.39843736e-05, 2.08003818e-05]), 3: array([9.82414776e-06, 1.20258074e-04]), 4: array([3.09937897e-05, 1.24197865e-04]), 5: array([7.93731116e-05, 3.03700494e-04]), 6: array([0.00023016, 0.00064567]), 7: array([0.0007819 , 0.00199731]), 8: array([0.00281272, 0.00652692]), 9: array([0.03765876, 0.05992552])}, 'ndcg': array([0.03433977, 0.04486437])}
[5mfind a better recall[25m 0.04163200579862177 ++0.04163200579862177
total time cost of epoch 0:  67.00217843055725
[AUGMENT]
[TRAIN]





























training: 604it [00:58, 10.29it/s]
EPOCH[1]:loss 5.283
[TEST]
{'precision': array([0.02382373, 0.01996337]), 'recall': array([0.05192937, 0.08633883]), 'recall_pop': {0: array([0.00011421, 0.00043209]), 1: array([0.00026262, 0.00089286]), 2: array([0.00040761, 0.00093052]), 3: array([0.00078681, 0.00221849]), 4: array([0.00137547, 0.00396562]), 5: array([0.00213833, 0.00611638]), 6: array([0.00374756, 0.01010545]), 7: array([0.01005964, 0.02277548]), 8: array([0.02467552, 0.0505291 ]), 9: array([0.11150961, 0.17020634])}, 'recall_pop_Contribute': {0: array([2.51812136e-05, 8.52550984e-05]), 1: array([5.21851184e-05, 1.53617015e-04]), 2: array([5.78428850e-05, 1.29512357e-04]), 3: array([0.0001184 , 0.00037418]), 4: array([0.0002163 , 0.00063695]), 5: array([0.00034654, 0.00101551]), 6: array([0.00062865, 0.0017374 ]), 7: array([0.00188941, 0.00425988]), 8: array([0.00544351, 0.01111791]), 9: array([0.04315135, 0.06682862])}, 'ndcg': array([0.0427018 , 0.05566881])}
[5mfind a better recall[25m 0.05192937214095327 ++0.010297366342331499
total time cost of epoch 1:  65.53429245948792
[AUGMENT]
[TRAIN]




























training: 598it [00:57,  9.95it/s]
EPOCH[2]:loss 5.003

training: 604it [00:58, 10.38it/s]
{'precision': array([0.02603732, 0.02177987]), 'recall': array([0.05727502, 0.09503273]), 'recall_pop': {0: array([0.00040946, 0.00124188]), 1: array([0.00089417, 0.00240262]), 2: array([0.00090759, 0.00238257]), 3: array([0.00156651, 0.00403858]), 4: array([0.00289255, 0.00704858]), 5: array([0.00358643, 0.01008855]), 6: array([0.00673766, 0.01601584]), 7: array([0.01499663, 0.03076268]), 8: array([0.03165667, 0.06042647]), 9: array([0.11399264, 0.17241198])}, 'recall_pop_Contribute': {0: array([8.88185136e-05, 2.52611171e-04]), 1: array([0.00015933, 0.00038759]), 2: array([0.00011686, 0.00034314]), 3: array([0.00025451, 0.00064626]), 4: array([0.00047678, 0.00109911]), 5: array([0.00061028, 0.00166075]), 6: array([0.00115795, 0.00278408]), 7: array([0.00281766, 0.00578748]), 8: array([0.00703534, 0.01329481]), 9: array([0.04455749, 0.06877688])}, 'ndcg': array([0.04723778, 0.06148151])}
[5mfind a better recall[25m 0.05727501829454503 ++0.00534564615359176
total time cost of epoch 2:  66.26626682281494
[AUGMENT]
[TRAIN]




























training: 604it [00:56, 10.61it/s]
EPOCH[3]:loss 4.851
[TEST]
{'precision': array([0.02738569, 0.02287246]), 'recall': array([0.06049272, 0.09999437]), 'recall_pop': {0: array([0.0007926, 0.0020029]), 1: array([0.00160019, 0.00371707]), 2: array([0.00155102, 0.00363698]), 3: array([0.0023731 , 0.00555295]), 4: array([0.00391724, 0.00866456]), 5: array([0.00496372, 0.01319629]), 6: array([0.00854636, 0.02069295]), 7: array([0.01751298, 0.03535119]), 8: array([0.0355921 , 0.06641348]), 9: array([0.11498994, 0.17256928])}, 'recall_pop_Contribute': {0: array([0.00016605, 0.00038405]), 1: array([0.00027228, 0.00057207]), 2: array([0.0002028 , 0.00050595]), 3: array([0.00039242, 0.00087074]), 4: array([0.00063079, 0.00134944]), 5: array([0.00085848, 0.0021807 ]), 6: array([0.00151416, 0.00360712]), 7: array([0.00330355, 0.0067055 ]), 8: array([0.00781737, 0.01464814]), 9: array([0.04533483, 0.06917067])}, 'ndcg': array([0.05000474, 0.06492123])}
[5mfind a better recall[25m 0.060492719564178704 ++0.003217701269633673
total time cost of epoch 3:  65.37461495399475
[AUGMENT]
[TRAIN]




























training: 593it [00:57, 10.27it/s]
EPOCH[4]:loss 4.753

training: 604it [00:58, 10.31it/s]
training: 0it [00:00, ?it/s]
{'precision': array([0.02823828, 0.02351585]), 'recall': array([0.06255917, 0.10324811]), 'recall_pop': {0: array([0.00114399, 0.00308829]), 1: array([0.00203806, 0.00473597]), 2: array([0.00191857, 0.00478878]), 3: array([0.00286123, 0.0068279 ]), 4: array([0.004613  , 0.00982565]), 5: array([0.00659761, 0.01600509]), 6: array([0.01042071, 0.0237074 ]), 7: array([0.01947456, 0.03820199]), 8: array([0.03771125, 0.06891324]), 9: array([0.11520581, 0.17223458])}, 'recall_pop_Contribute': {0: array([0.00022168, 0.00059472]), 1: array([0.00033368, 0.00075076]), 2: array([0.00026309, 0.00067581]), 3: array([0.0004729 , 0.00105569]), 4: array([0.00076197, 0.00152687]), 5: array([0.00110201, 0.00270113]), 6: array([0.00182212, 0.00409057]), 7: array([0.00364744, 0.00725502]), 8: array([0.00831785, 0.01521931]), 9: array([0.04561643, 0.06937823])}, 'ndcg': array([0.05185494, 0.06722177])}
[5mfind a better recall[25m 0.06255916580146784 ++0.0020664462372891323
total time cost of epoch 4:  65.55639886856079
[AUGMENT]





























training: 596it [00:58, 10.25it/s]
EPOCH[5]:loss 4.692

training: 604it [00:58, 10.24it/s]
training: 2it [00:00,  7.77it/s]
{'precision': array([0.02877353, 0.02399662]), 'recall': array([0.06383988, 0.105411  ]), 'recall_pop': {0: array([0.00162321, 0.00388664]), 1: array([0.00214885, 0.00588294]), 2: array([0.00236381, 0.00585475]), 3: array([0.00335472, 0.00790375]), 4: array([0.00503509, 0.01091533]), 5: array([0.0079599 , 0.01809155]), 6: array([0.01219193, 0.02676024]), 7: array([0.02112102, 0.04064647]), 8: array([0.04019506, 0.07199869]), 9: array([0.11437034, 0.17050825])}, 'recall_pop_Contribute': {0: array([0.00031627, 0.00076755]), 1: array([0.00034726, 0.00090166]), 2: array([0.00032244, 0.00083885]), 3: array([0.00054974, 0.00121349]), 4: array([0.00080822, 0.00168086]), 5: array([0.00136773, 0.00302367]), 6: array([0.00207682, 0.00458747]), 7: array([0.00400416, 0.00763613]), 8: array([0.00877321, 0.01583487]), 9: array([0.04527403, 0.06892646])}, 'ndcg': array([0.05300113, 0.06868689])}
[5mfind a better recall[25m 0.06383987935558239 ++0.0012807135541145487
total time cost of epoch 5:  65.88844633102417
[AUGMENT]





























training: 602it [00:58, 10.45it/s]
EPOCH[6]:loss 4.649

training: 604it [00:58, 10.30it/s]
{'precision': array([0.02927561, 0.02421766]), 'recall': array([0.06488559, 0.1070406 ]), 'recall_pop': {0: array([0.00201342, 0.00478483]), 1: array([0.00293592, 0.00633878]), 2: array([0.00253749, 0.00657502]), 3: array([0.00375281, 0.00860786]), 4: array([0.00535305, 0.01156155]), 5: array([0.00882368, 0.01991945]), 6: array([0.01338776, 0.02896561]), 7: array([0.02265238, 0.04221587]), 8: array([0.04149139, 0.07318331]), 9: array([0.11414114, 0.16861944])}, 'recall_pop_Contribute': {0: array([0.00038238, 0.00093795]), 1: array([0.00044503, 0.00098247]), 2: array([0.00036803, 0.00095353]), 3: array([0.00057029, 0.00135352]), 4: array([0.00083197, 0.0018038 ]), 5: array([0.00145388, 0.00332347]), 6: array([0.0022779 , 0.00498534]), 7: array([0.00423509, 0.0079706 ]), 8: array([0.00911803, 0.01623667]), 9: array([0.04520299, 0.06849324])}, 'ndcg': array([0.05411842, 0.06992989])}
[5mfind a better recall[25m 0.06488559305530578 ++0.001045713699723394
total time cost of epoch 6:  65.61415529251099
training: 4it [00:00,  9.11it/s]
[AUGMENT]
























training: 604it [00:58, 10.30it/s]
EPOCH[7]:loss 4.620
[TEST]
{'precision': array([0.02956454, 0.02440634]), 'recall': array([0.06575294, 0.10779595]), 'recall_pop': {0: array([0.00251184, 0.00549832]), 1: array([0.00311334, 0.00720628]), 2: array([0.00303431, 0.00714747]), 3: array([0.00422963, 0.0090663 ]), 4: array([0.00615873, 0.01314285]), 5: array([0.00978086, 0.02103966]), 6: array([0.01468454, 0.02995086]), 7: array([0.02314763, 0.04443407]), 8: array([0.04202562, 0.07438068]), 9: array([0.11295326, 0.16705192])}, 'recall_pop_Contribute': {0: array([0.00048521, 0.00105278]), 1: array([0.00047255, 0.00109185]), 2: array([0.00043282, 0.00101951]), 3: array([0.00065165, 0.00140418]), 4: array([0.00098362, 0.00204386]), 5: array([0.00159708, 0.0035323 ]), 6: array([0.00251292, 0.00517546]), 7: array([0.00437737, 0.00839384]), 8: array([0.00926419, 0.01646122]), 9: array([0.04497554, 0.06762095])}, 'ndcg': array([0.05475697, 0.0705622 ])}
[5mfind a better recall[25m 0.06575293604930564 ++0.0008673429939998617
total time cost of epoch 7:  65.71413135528564
[AUGMENT]
[TRAIN]





























training: 604it [00:58, 10.32it/s]
EPOCH[8]:loss 4.597
[TEST]
{'precision': array([0.02987243, 0.02455239]), 'recall': array([0.06656188, 0.10839947]), 'recall_pop': {0: array([0.00251661, 0.0061341 ]), 1: array([0.00335286, 0.00769345]), 2: array([0.00345693, 0.00797579]), 3: array([0.00465413, 0.0101311 ]), 4: array([0.00647533, 0.01451736]), 5: array([0.01097074, 0.02231045]), 6: array([0.01548178, 0.03087558]), 7: array([0.02398143, 0.04538379]), 8: array([0.04192963, 0.07428089]), 9: array([0.11295729, 0.16486365])}, 'recall_pop_Contribute': {0: array([0.00050554, 0.0011854 ]), 1: array([0.00054741, 0.0011961 ]), 2: array([0.00050877, 0.00113997]), 3: array([0.00071066, 0.00157904]), 4: array([0.00100652, 0.00220229]), 5: array([0.00181146, 0.0037354 ]), 6: array([0.00262829, 0.00532578]), 7: array([0.00454087, 0.00862124]), 8: array([0.00921661, 0.0164697 ]), 9: array([0.04508575, 0.06694454])}, 'ndcg': array([0.05510314, 0.07085622])}
[5mfind a better recall[25m 0.06656188392673644 ++0.000808947877430799
total time cost of epoch 8:  65.51299476623535
[AUGMENT]
[TRAIN]




























training: 595it [00:57, 10.53it/s]
EPOCH[9]:loss 4.582

training: 604it [00:58, 10.34it/s]
{'precision': array([0.02994821, 0.02462107]), 'recall': array([0.0668982 , 0.10879319]), 'recall_pop': {0: array([0.00269354, 0.00677494]), 1: array([0.00349009, 0.00767624]), 2: array([0.00367459, 0.00873506]), 3: array([0.00472435, 0.01031809]), 4: array([0.00686794, 0.01484281]), 5: array([0.01058059, 0.02267186]), 6: array([0.0166035 , 0.03173876]), 7: array([0.0241065 , 0.04520005]), 8: array([0.04254269, 0.07588824]), 9: array([0.1128624 , 0.16347257])}, 'recall_pop_Contribute': {0: array([0.00053991, 0.00127682]), 1: array([0.00054356, 0.00116984]), 2: array([0.00052319, 0.00124998]), 3: array([0.00072724, 0.00159337]), 4: array([0.00105298, 0.00224231]), 5: array([0.00176472, 0.003798  ]), 6: array([0.00280395, 0.00542075]), 7: array([0.00457896, 0.00859332]), 8: array([0.00932518, 0.01678856]), 9: array([0.0450385 , 0.06666023])}, 'ndcg': array([0.05554703, 0.0713584 ])}
[5mfind a better recall[25m 0.06689819700735347 ++0.0003363130806170317
total time cost of epoch 9:  65.54053068161011
[AUGMENT]
[TRAIN]




























training: 598it [00:57, 10.64it/s]
EPOCH[10]:loss 4.570

training: 604it [00:58, 10.31it/s]
training: 3it [00:00,  8.30it/s]
{'precision': array([0.0301061, 0.0246637]), 'recall': array([0.06712491, 0.10921678]), 'recall_pop': {0: array([0.00317987, 0.00727246]), 1: array([0.00400984, 0.00817969]), 2: array([0.00378642, 0.00895812]), 3: array([0.00474939, 0.01113125]), 4: array([0.00711742, 0.01546261]), 5: array([0.01110864, 0.022452  ]), 6: array([0.01659217, 0.03261261]), 7: array([0.02432748, 0.04593442]), 8: array([0.04257404, 0.07538066]), 9: array([0.11168487, 0.16386553])}, 'recall_pop_Contribute': {0: array([0.00059323, 0.00138839]), 1: array([0.00059977, 0.00122766]), 2: array([0.00055647, 0.00129149]), 3: array([0.0007245 , 0.00170596]), 4: array([0.00110134, 0.00232994]), 5: array([0.00181418, 0.00373221]), 6: array([0.00289077, 0.00563236]), 7: array([0.00462946, 0.00874771]), 8: array([0.00935123, 0.01659906]), 9: array([0.04486396, 0.066562  ])}, 'ndcg': array([0.05570908, 0.0715439 ])}
[5mfind a better recall[25m 0.0671249096907624 ++0.00022671268340893058
total time cost of epoch 10:  65.5695276260376
[AUGMENT]





























training: 603it [00:58, 10.30it/s]
EPOCH[11]:loss 4.558

training: 604it [00:58, 10.30it/s]
{'precision': array([0.03005084, 0.0247608 ]), 'recall': array([0.06711554, 0.10966542]), 'recall_pop': {0: array([0.00329199, 0.00770545]), 1: array([0.00428352, 0.00873736]), 2: array([0.00428903, 0.00955885]), 3: array([0.00502968, 0.01094283]), 4: array([0.00718395, 0.01604124]), 5: array([0.01065583, 0.02365219]), 6: array([0.01616124, 0.03256522]), 7: array([0.02418037, 0.04649932]), 8: array([0.04229061, 0.07515733]), 9: array([0.11223905, 0.16302548])}, 'recall_pop_Contribute': {0: array([0.00063512, 0.00143991]), 1: array([0.00063793, 0.00129612]), 2: array([0.0006348 , 0.00139464]), 3: array([0.00076809, 0.0016847 ]), 4: array([0.00110019, 0.00246292]), 5: array([0.00177256, 0.0039514 ]), 6: array([0.00283631, 0.00562995]), 7: array([0.00460414, 0.00884417]), 8: array([0.00933464, 0.01672539]), 9: array([0.04479177, 0.06623623])}, 'ndcg': array([0.05573487, 0.07178964])}
total time cost of epoch 11:  65.71306276321411
[AUGMENT]
[TRAIN]
























training: 602it [00:58, 10.08it/s]
EPOCH[12]:loss 4.551

training: 604it [00:59, 10.23it/s]
{'precision': array([0.0302261 , 0.02476712]), 'recall': array([0.06746146, 0.10974969]), 'recall_pop': {0: array([0.00362341, 0.0083527 ]), 1: array([0.00426089, 0.00896408]), 2: array([0.00426035, 0.00970648]), 3: array([0.00511704, 0.01083241]), 4: array([0.00756137, 0.01618569]), 5: array([0.01132709, 0.02353508]), 6: array([0.01634763, 0.0324118 ]), 7: array([0.02470887, 0.04632393]), 8: array([0.04244003, 0.07499055]), 9: array([0.11208762, 0.16307309])}, 'recall_pop_Contribute': {0: array([0.00070498, 0.001548  ]), 1: array([0.00065746, 0.00137756]), 2: array([0.00063444, 0.00142251]), 3: array([0.00076864, 0.00164526]), 4: array([0.00113104, 0.00249666]), 5: array([0.00187067, 0.003957  ]), 6: array([0.00287671, 0.00559874]), 7: array([0.00464584, 0.00876306]), 8: array([0.00926944, 0.01653544]), 9: array([0.04490224, 0.06640546])}, 'ndcg': array([0.05579289, 0.07171432])}
[5mfind a better recall[25m 0.06746145975512126 ++0.0003365500643588565
training: 6it [00:00,  9.53it/s]
total time cost of epoch 12:  66.10099601745605
[AUGMENT]





























training: 604it [00:58, 10.39it/s]
EPOCH[13]:loss 4.545
[TEST]
{'precision': array([0.03015347, 0.02481843]), 'recall': array([0.06723446, 0.10971422]), 'recall_pop': {0: array([0.00411313, 0.00873333]), 1: array([0.00454728, 0.00938588]), 2: array([0.00427048, 0.00981611]), 3: array([0.00533602, 0.01147687]), 4: array([0.00779209, 0.0161026 ]), 5: array([0.01134056, 0.02391602]), 6: array([0.01604434, 0.03179776]), 7: array([0.02463797, 0.04599142]), 8: array([0.04170871, 0.07388611]), 9: array([0.11177173, 0.16380024])}, 'recall_pop_Contribute': {0: array([0.00077865, 0.00168042]), 1: array([0.00070346, 0.00143758]), 2: array([0.00062378, 0.00140884]), 3: array([0.00079659, 0.00174291]), 4: array([0.001178  , 0.00244367]), 5: array([0.00185717, 0.00395673]), 6: array([0.0028055 , 0.00545949]), 7: array([0.00465554, 0.00869337]), 8: array([0.00918529, 0.01628761]), 9: array([0.04465046, 0.0666036 ])}, 'ndcg': array([0.05569397, 0.07171476])}
total time cost of epoch 13:  65.33255124092102
[AUGMENT]
[TRAIN]























training: 604it [00:46, 12.86it/s]
EPOCH[14]:loss 4.541
[TEST]
{'precision': array([0.03028609, 0.02482553]), 'recall': array([0.06765121, 0.10991205]), 'recall_pop': {0: array([0.00414357, 0.00867788]), 1: array([0.00452524, 0.00980246]), 2: array([0.00422969, 0.00989011]), 3: array([0.00514625, 0.01176016]), 4: array([0.00796791, 0.01701214]), 5: array([0.0112023 , 0.02424748]), 6: array([0.0160836 , 0.03199518]), 7: array([0.02520358, 0.04691304]), 8: array([0.04204516, 0.07404808]), 9: array([0.11238023, 0.16267751])}, 'recall_pop_Contribute': {0: array([0.000801  , 0.00166923]), 1: array([0.00069933, 0.00151632]), 2: array([0.00061872, 0.00145208]), 3: array([0.00076932, 0.0017863 ]), 4: array([0.00119311, 0.00261412]), 5: array([0.00179944, 0.00403967]), 6: array([0.00278253, 0.00551637]), 7: array([0.00479294, 0.00883109]), 8: array([0.00921287, 0.01626612]), 9: array([0.04498194, 0.06622074])}, 'ndcg': array([0.05585112, 0.07178818])}
[5mfind a better recall[25m 0.06765121166198161 ++0.0001897519068603526
total time cost of epoch 14:  54.357335805892944
[AUGMENT]
[TRAIN]






























training: 604it [01:00,  9.99it/s]
EPOCH[15]:loss 4.536
[TEST]
training: 0it [00:00, ?it/s]
{'precision': array([0.03044714, 0.02490369]), 'recall': array([0.06800667, 0.11043877]), 'recall_pop': {0: array([0.00446811, 0.00904838]), 1: array([0.00474459, 0.00989092]), 2: array([0.00441998, 0.01003919]), 3: array([0.00551123, 0.01194846]), 4: array([0.00811458, 0.01750113]), 5: array([0.01122117, 0.02392663]), 6: array([0.01604013, 0.03197984]), 7: array([0.02535551, 0.04714059]), 8: array([0.04128784, 0.07360427]), 9: array([0.11336832, 0.1635185 ])}, 'recall_pop_Contribute': {0: array([0.00089405, 0.00174584]), 1: array([0.00072908, 0.00155093]), 2: array([0.00065715, 0.00144304]), 3: array([0.00083049, 0.00185562]), 4: array([0.00122461, 0.00267091]), 5: array([0.00181533, 0.00394255]), 6: array([0.00276996, 0.00545374]), 7: array([0.00480578, 0.00887723]), 8: array([0.00901055, 0.01618798]), 9: array([0.04526967, 0.06671093])}, 'ndcg': array([0.05610574, 0.07204565])}
[5mfind a better recall[25m 0.06800667305930548 ++0.0003554613973238696
total time cost of epoch 15:  67.1711277961731
[AUGMENT]

























training: 604it [01:00, 10.05it/s]
EPOCH[16]:loss 4.530
[TEST]
{'precision': array([0.03041082, 0.02504105]), 'recall': array([0.06786045, 0.11090449]), 'recall_pop': {0: array([0.00446094, 0.00950636]), 1: array([0.0047307 , 0.01005075]), 2: array([0.00429642, 0.0104215 ]), 3: array([0.00562176, 0.01222128]), 4: array([0.00784363, 0.01707208]), 5: array([0.01147074, 0.02394833]), 6: array([0.01621921, 0.03277988]), 7: array([0.02508217, 0.04666974]), 8: array([0.03952   , 0.07267335]), 9: array([0.1137518 , 0.16498639])}, 'recall_pop_Contribute': {0: array([0.00089023, 0.00186608]), 1: array([0.00075643, 0.00154969]), 2: array([0.0006332 , 0.00149709]), 3: array([0.00082689, 0.00187091]), 4: array([0.00117596, 0.00258084]), 5: array([0.00184386, 0.00395997]), 6: array([0.00280155, 0.0056446 ]), 7: array([0.00475774, 0.00879769]), 8: array([0.00866101, 0.0160793 ]), 9: array([0.04551357, 0.06705831])}, 'ndcg': array([0.05601978, 0.07223137])}
total time cost of epoch 16:  66.9007158279419
[AUGMENT]
[TRAIN]






























training: 604it [01:00,  9.99it/s]
EPOCH[17]:loss 4.529
[TEST]
{'precision': array([0.03054503, 0.02500868]), 'recall': array([0.06815126, 0.11072675]), 'recall_pop': {0: array([0.00485828, 0.0101454 ]), 1: array([0.00508768, 0.00999992]), 2: array([0.00444512, 0.01050525]), 3: array([0.00521489, 0.01211068]), 4: array([0.00820615, 0.01701284]), 5: array([0.01121212, 0.02419479]), 6: array([0.01602495, 0.03229593]), 7: array([0.02407466, 0.04652352]), 8: array([0.03962061, 0.07201944]), 9: array([0.11523153, 0.16552681])}, 'recall_pop_Contribute': {0: array([0.00094805, 0.00194074]), 1: array([0.00080603, 0.00155757]), 2: array([0.00066069, 0.0014849 ]), 3: array([0.00075988, 0.00181078]), 4: array([0.00125  , 0.0025746]), 5: array([0.00181688, 0.00401168]), 6: array([0.00277276, 0.00559422]), 7: array([0.00455356, 0.00874146]), 8: array([0.00870656, 0.01575642]), 9: array([0.04587685, 0.06725438])}, 'ndcg': array([0.0562961, 0.0723086])}
[5mfind a better recall[25m 0.06815125693011073 ++0.00014458387080525104
total time cost of epoch 17:  67.33959150314331
[AUGMENT]
[TRAIN]
























training: 598it [00:59, 10.10it/s]
EPOCH[18]:loss 4.524

training: 604it [01:00, 10.04it/s]
training: 2it [00:00,  8.38it/s]
{'precision': array([0.03065713, 0.02515947]), 'recall': array([0.06847124, 0.11134755]), 'recall_pop': {0: array([0.00455487, 0.01014645]), 1: array([0.00544482, 0.01078722]), 2: array([0.00463985, 0.01047371]), 3: array([0.00566465, 0.01273057]), 4: array([0.00793256, 0.01789483]), 5: array([0.01135816, 0.02375824]), 6: array([0.01649187, 0.03172225]), 7: array([0.02444948, 0.04686979]), 8: array([0.03909912, 0.07163036]), 9: array([0.11614154, 0.16639   ])}, 'recall_pop_Contribute': {0: array([0.00089504, 0.00194187]), 1: array([0.00084309, 0.00165161]), 2: array([0.00067809, 0.00148373]), 3: array([0.00080153, 0.00184684]), 4: array([0.00120547, 0.00275761]), 5: array([0.00182372, 0.00392888]), 6: array([0.00288224, 0.00550515]), 7: array([0.00465137, 0.00883584]), 8: array([0.00854965, 0.01577651]), 9: array([0.04614103, 0.06761951])}, 'ndcg': array([0.0563537 , 0.07250669])}
[5mfind a better recall[25m 0.0684712378918911 ++0.00031998096178037505
total time cost of epoch 18:  67.1455729007721
[AUGMENT]






























training: 604it [00:59, 10.08it/s]
EPOCH[19]:loss 4.522
[TEST]
{'precision': array([0.03079449, 0.02514289]), 'recall': array([0.06895216, 0.11125356]), 'recall_pop': {0: array([0.00439726, 0.01050606]), 1: array([0.00521963, 0.01106214]), 2: array([0.00463862, 0.01044707]), 3: array([0.00576434, 0.01292779]), 4: array([0.00825856, 0.01788652]), 5: array([0.01178193, 0.02432359]), 6: array([0.01590709, 0.03168999]), 7: array([0.02433585, 0.04662919]), 8: array([0.03944697, 0.07114268]), 9: array([0.11786334, 0.16708456])}, 'recall_pop_Contribute': {0: array([0.00085531, 0.00205417]), 1: array([0.00080954, 0.00166634]), 2: array([0.00068321, 0.00149712]), 3: array([0.00082566, 0.00187238]), 4: array([0.00122508, 0.00272539]), 5: array([0.00189646, 0.00401718]), 6: array([0.00279769, 0.0054202 ]), 7: array([0.00460886, 0.00881047]), 8: array([0.00859405, 0.01553777]), 9: array([0.04665629, 0.06765253])}, 'ndcg': array([0.056531  , 0.07247566])}
[5mfind a better recall[25m 0.0689521639966978 ++0.0004809261048066976
total time cost of epoch 19:  66.78453397750854
[AUGMENT]
[TRAIN]





























training: 600it [00:59, 10.14it/s]
EPOCH[20]:loss 4.519

training: 604it [01:00, 10.05it/s]
{'precision': array([0.03059397, 0.02513736]), 'recall': array([0.06832624, 0.1113423 ]), 'recall_pop': {0: array([0.00474801, 0.01089384]), 1: array([0.0054174 , 0.01103926]), 2: array([0.00458511, 0.01039596]), 3: array([0.00566247, 0.01225262]), 4: array([0.00817347, 0.01790362]), 5: array([0.01097493, 0.02341861]), 6: array([0.01509549, 0.03109606]), 7: array([0.02357428, 0.04614749]), 8: array([0.03841729, 0.07122608]), 9: array([0.11709636, 0.1672584 ])}, 'recall_pop_Contribute': {0: array([0.00093286, 0.00207721]), 1: array([0.00085606, 0.00170426]), 2: array([0.00064465, 0.00151647]), 3: array([0.00083057, 0.00182968]), 4: array([0.00121815, 0.00268807]), 5: array([0.00180317, 0.00385333]), 6: array([0.00265915, 0.00540837]), 7: array([0.00448789, 0.00873882]), 8: array([0.00843993, 0.01564287]), 9: array([0.04645381, 0.06788319])}, 'ndcg': array([0.05630623, 0.07251882])}
training: 5it [00:00,  9.22it/s]
total time cost of epoch 20:  67.01699733734131
[AUGMENT]






























training: 604it [01:00,  9.96it/s]
EPOCH[21]:loss 4.519
[TEST]
{'precision': array([0.03048819, 0.02507263]), 'recall': array([0.06804949, 0.11088718]), 'recall_pop': {0: array([0.00486508, 0.01125479]), 1: array([0.00517583, 0.01064149]), 2: array([0.00461774, 0.01070594]), 3: array([0.00554984, 0.01197788]), 4: array([0.0082747 , 0.01748915]), 5: array([0.01081537, 0.02300072]), 6: array([0.01537285, 0.03094302]), 7: array([0.02332321, 0.04528453]), 8: array([0.03825446, 0.07014656]), 9: array([0.1170857 , 0.16683666])}, 'recall_pop_Contribute': {0: array([0.00097816, 0.00212254]), 1: array([0.00083446, 0.00165331]), 2: array([0.00065326, 0.00160391]), 3: array([0.00080196, 0.00179395]), 4: array([0.00124762, 0.00263824]), 5: array([0.00176303, 0.00380681]), 6: array([0.00273822, 0.00542869]), 7: array([0.00441927, 0.00864538]), 8: array([0.00825466, 0.01533515]), 9: array([0.04635886, 0.0678592 ])}, 'ndcg': array([0.05633526, 0.07247752])}
total time cost of epoch 21:  67.5391161441803
[AUGMENT]
[TRAIN]





























training: 596it [00:59,  9.88it/s]
EPOCH[22]:loss 4.516

training: 604it [01:00, 10.06it/s]
{'precision': array([0.03077081, 0.02518473]), 'recall': array([0.06874396, 0.11154749]), 'recall_pop': {0: array([0.00496169, 0.01112998]), 1: array([0.00517952, 0.0111033 ]), 2: array([0.00478585, 0.01099781]), 3: array([0.00593092, 0.01240938]), 4: array([0.00820362, 0.01763904]), 5: array([0.01095235, 0.02364218]), 6: array([0.01541099, 0.03059897]), 7: array([0.02353163, 0.04437192]), 8: array([0.03836454, 0.07025047]), 9: array([0.1180266 , 0.16877102])}, 'recall_pop_Contribute': {0: array([0.00095435, 0.00209963]), 1: array([0.00080148, 0.001682  ]), 2: array([0.0007088 , 0.00162731]), 3: array([0.00087446, 0.00186396]), 4: array([0.00125387, 0.00269515]), 5: array([0.0018189 , 0.00390934]), 6: array([0.00272339, 0.00530986]), 7: array([0.00451419, 0.00842098]), 8: array([0.00826498, 0.01535127]), 9: array([0.04682953, 0.06858798])}, 'ndcg': array([0.05657757, 0.07267163])}
total time cost of epoch 22:  67.81763291358948
[AUGMENT]
[TRAIN]





















training: 420it [00:42,  9.94it/s]