==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0008819103240966797
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07401633262634277
shape test : 2474518 == 2474518
precal cost :  0.8015341758728027
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]










training: 582it [00:21, 28.40it/s]
EPOCH[0]:loss 0.049

training: 604it [00:22, 27.04it/s]
training: 3it [00:00, 12.84it/s]
{'precision': array([0.00023052, 0.00025104]), 'recall': array([0.00045021, 0.00103254]), 'recall_pop': {0: array([0.00020194, 0.00055745]), 1: array([0.00020876, 0.00051933]), 2: array([0.00031946, 0.00059501]), 3: array([0.00018762, 0.00046393]), 4: array([0.00020789, 0.00044314]), 5: array([0.00039557, 0.00075985]), 6: array([0.00029402, 0.00053349]), 7: array([0.00013157, 0.0007019 ]), 8: array([0.0004118 , 0.00072398]), 9: array([0.00017084, 0.00034189])}, 'recall_pop_Contribute': {0: array([3.80781761e-05, 1.19906775e-04]), 1: array([3.00938571e-05, 7.55042783e-05]), 2: array([4.97508455e-05, 8.76172500e-05]), 3: array([1.89824069e-05, 5.50765094e-05]), 4: array([3.55683988e-05, 6.24537494e-05]), 5: array([6.70042224e-05, 1.08071649e-04]), 6: array([4.16763301e-05, 8.15940130e-05]), 7: array([2.34761673e-05, 1.51094453e-04]), 8: array([8.40218334e-05, 1.55714518e-04]), 9: array([6.15577337e-05, 1.35508935e-04])}, 'ndcg': array([0.00034952, 0.00056844])}
[5mfind a better recall[25m 0.00045020997139969763 ++0.00045020997139969763
total time cost of epoch 0:  29.18585705757141
[AUGMENT]











training: 604it [00:21, 28.44it/s]
EPOCH[1]:loss -0.433
[TEST]
training: 8it [00:00, 26.12it/s]
{'precision': array([0.00019104, 0.00019341]), 'recall': array([0.00033201, 0.0006745 ]), 'recall_pop': {0: array([0.00137803, 0.0027851 ]), 1: array([0.00027894, 0.00058524]), 2: array([7.89440445e-05, 3.73668477e-04]), 3: array([0.00012631, 0.00021052]), 4: array([4.99978948e-05, 4.99978948e-05]), 5: array([6.31552356e-05, 6.31552356e-05]), 6: array([0.00000000e+00, 3.15776178e-05]), 7: array([0., 0.]), 8: array([0., 0.]), 9: array([0., 0.])}, 'recall_pop_Contribute': {0: array([0.00022103, 0.00045154]), 1: array([3.87455665e-05, 8.13015204e-05]), 2: array([1.57888089e-05, 6.50902768e-05]), 3: array([2.07114858e-05, 3.45158115e-05]), 4: array([1.71421354e-05, 1.71421354e-05]), 5: array([1.85957083e-05, 1.85957083e-05]), 6: array([0.00000000e+00, 6.31552356e-06]), 7: array([0., 0.]), 8: array([0., 0.]), 9: array([0., 0.])}, 'ndcg': array([0.00028068, 0.000411  ])}
total time cost of epoch 1:  28.008928298950195
[AUGMENT]











training: 604it [00:21, 28.27it/s]
EPOCH[2]:loss -0.909
[TEST]
training: 4it [00:00, 20.90it/s]
{'precision': array([0.00024473, 0.00025104]), 'recall': array([0.00038172, 0.00074534]), 'recall_pop': {0: array([0.00173586, 0.00363539]), 1: array([0.00029472, 0.00055787]), 2: array([7.89440445e-05, 1.89465707e-04]), 3: array([1.57888089e-05, 9.47328534e-05]), 4: array([3.15776178e-05, 6.31552356e-05]), 5: array([9.47328534e-05, 1.26310471e-04]), 6: array([0., 0.]), 7: array([0., 0.]), 8: array([0., 0.]), 9: array([0., 0.])}, 'recall_pop_Contribute': {0: array([0.00028824, 0.00056197]), 1: array([4.46347121e-05, 8.66703966e-05]), 2: array([1.50369608e-05, 3.71549633e-05]), 3: array([5.26293630e-06, 1.86595014e-05]), 4: array([4.51108825e-06, 7.38178078e-06]), 5: array([2.40340758e-05, 3.35073611e-05]), 6: array([0., 0.]), 7: array([0., 0.]), 8: array([0., 0.]), 9: array([0., 0.])}, 'ndcg': array([0.00034533, 0.00049201])}
total time cost of epoch 2:  28.129480600357056
[AUGMENT]



training: 122it [00:04, 27.95it/s]