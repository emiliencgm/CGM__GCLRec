==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
[34m[1mwandb[39m[22m: Network error resolved after 0:00:39.234861, resuming normal operation.
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0009062290191650391
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07700133323669434
shape test : 2474518 == 2474518
precal cost :  0.8126826286315918
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]





























training: 590it [00:59, 10.18it/s]
EPOCH[0]:loss 6.936

training: 604it [01:00,  9.92it/s]
{'precision': array([0.01965391, 0.01642668]), 'recall': array([0.04163213, 0.06919231]), 'recall_pop': {0: array([0.000000e+00, 7.104964e-05]), 1: array([7.57862827e-05, 1.38941518e-04]), 2: array([0.00010105, 0.00018526]), 3: array([7.49968422e-05, 7.29480563e-04]), 4: array([0.00016289, 0.00082505]), 5: array([0.00074313, 0.00273429]), 6: array([0.00148028, 0.00388018]), 7: array([0.00395101, 0.00984886]), 8: array([0.01326478, 0.02963534]), 9: array([0.09952217, 0.1548463 ])}, 'recall_pop_Contribute': {0: array([0.00000000e+00, 1.17664219e-05]), 1: array([1.14271263e-05, 2.38105059e-05]), 2: array([1.09769814e-05, 2.84084644e-05]), 3: array([1.20221272e-05, 1.31306587e-04]), 4: array([2.30169440e-05, 1.32374959e-04]), 5: array([0.00010534, 0.00046604]), 6: array([0.00022674, 0.00063955]), 7: array([0.00076508, 0.00188563]), 8: array([0.00291922, 0.00645221]), 9: array([0.0375583 , 0.05942122])}, 'ndcg': array([0.03443208, 0.04477577])}
[5mfind a better recall[25m 0.041632134708117406 ++0.041632134708117406
total time cost of epoch 0:  67.89062762260437
[AUGMENT]
[TRAIN]




























training: 585it [00:57,  9.21it/s]
EPOCH[1]:loss 5.280

training: 604it [00:59, 10.15it/s]
{'precision': array([0.02385215, 0.01994758]), 'recall': array([0.05189673, 0.08636756]), 'recall_pop': {0: array([6.15763547e-05, 3.04724012e-04]), 1: array([0.00037841, 0.00104873]), 2: array([0.00044314, 0.00119574]), 3: array([0.00092496, 0.00265057]), 4: array([0.00148481, 0.00352946]), 5: array([0.00264688, 0.00677282]), 6: array([0.00386709, 0.0102858 ]), 7: array([0.01004984, 0.0219169 ]), 8: array([0.02463224, 0.05026901]), 9: array([0.11137659, 0.17023723])}, 'recall_pop_Contribute': {0: array([1.73995864e-05, 7.43615394e-05]), 1: array([5.82086930e-05, 1.65634319e-04]), 2: array([7.00497714e-05, 1.82745930e-04]), 3: array([0.00015175, 0.0004205 ]), 4: array([0.00023902, 0.00054385]), 5: array([0.00040206, 0.00113875]), 6: array([0.00060834, 0.00173343]), 7: array([0.00188215, 0.00415305]), 8: array([0.00543832, 0.01104431]), 9: array([0.04302943, 0.06691093])}, 'ndcg': array([0.04287467, 0.05584773])}
[5mfind a better recall[25m 0.051896726278276004 ++0.010264591570158597
total time cost of epoch 1:  66.50633120536804
[AUGMENT]
[TRAIN]





























training: 599it [00:58, 10.51it/s]
EPOCH[2]:loss 5.003

training: 604it [00:58, 10.26it/s]
{'precision': array([0.02616679, 0.02179092]), 'recall': array([0.05763926, 0.0951514 ]), 'recall_pop': {0: array([0.00028788, 0.00122902]), 1: array([0.00081628, 0.00198658]), 2: array([0.00080339, 0.00212921]), 3: array([0.00184312, 0.00429636]), 4: array([0.00277304, 0.00653981]), 5: array([0.0043354 , 0.01093147]), 6: array([0.00674014, 0.01650767]), 7: array([0.01457953, 0.03059762]), 8: array([0.03114601, 0.05904683]), 9: array([0.11576608, 0.17325499])}, 'recall_pop_Contribute': {0: array([6.37763918e-05, 2.21272868e-04]), 1: array([0.00012074, 0.00029668]), 2: array([0.00013103, 0.00034431]), 3: array([0.00029576, 0.0006805 ]), 4: array([0.00044906, 0.0010178 ]), 5: array([0.00071107, 0.00181476]), 6: array([0.00111483, 0.00277522]), 7: array([0.00272225, 0.00579838]), 8: array([0.00685604, 0.01305682]), 9: array([0.04517471, 0.06914565])}, 'ndcg': array([0.04753075, 0.06170673])}
[5mfind a better recall[25m 0.05763926328883367 ++0.005742537010557665
total time cost of epoch 2:  65.85082769393921
[AUGMENT]
[TRAIN]







training: 147it [00:14, 10.16it/s]