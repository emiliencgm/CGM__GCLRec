==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'Ours',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/EigenvectorCentroid
eigenvector_centrality cost:  0.0010027885437011719
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/yelp2018/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.07406497001647949
shape test : 2474518 == 2474518
precal cost :  0.8134982585906982
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]





























training: 599it [00:59, 10.43it/s]
EPOCH[0]:loss 6.932

training: 604it [01:00, 10.05it/s]
training: 1it [00:00,  5.52it/s]
{'precision': array([0.01975969, 0.01651667]), 'recall': array([0.04193631, 0.06960896]), 'recall_pop': {0: array([2.63146815e-06, 7.89440445e-05]), 1: array([4.42086649e-05, 1.02100964e-04]), 2: array([3.5524820e-05, 3.6024799e-04]), 3: array([0.00015789, 0.00062103]), 4: array([0.00022104, 0.00103101]), 5: array([0.00060471, 0.00246436]), 6: array([0.00131654, 0.00337563]), 7: array([0.00421403, 0.00955415]), 8: array([0.0131627 , 0.03053014]), 9: array([0.09974066, 0.15600277])}, 'recall_pop_Contribute': {0: array([2.76996647e-07, 1.90963315e-05]), 1: array([6.91603808e-06, 1.94155118e-05]), 2: array([5.17455869e-06, 4.86175976e-05]), 3: array([2.53184828e-05, 1.09505958e-04]), 4: array([4.23191880e-05, 1.58293225e-04]), 5: array([9.25042562e-05, 4.09226235e-04]), 6: array([0.00022423, 0.00055884]), 7: array([0.000786  , 0.00179096]), 8: array([0.00293072, 0.00657975]), 9: array([0.03782284, 0.05991526])}, 'ndcg': array([0.03465353, 0.04503857])}
[5mfind a better recall[25m 0.041936306250800456 ++0.041936306250800456
total time cost of epoch 0:  67.47174334526062
[AUGMENT]






























training: 604it [00:59, 10.15it/s]
EPOCH[1]:loss 5.282
[TEST]
{'precision': array([0.02392794, 0.01992469]), 'recall': array([0.05201559, 0.08619213]), 'recall_pop': {0: array([0.00011578, 0.00037998]), 1: array([0.00033781, 0.00099515]), 2: array([0.00062708, 0.00140599]), 3: array([0.00080786, 0.00245708]), 4: array([0.00138929, 0.00373664]), 5: array([0.00200585, 0.00598074]), 6: array([0.00370416, 0.00976673]), 7: array([0.00966761, 0.02192483]), 8: array([0.02566404, 0.0511328 ]), 9: array([0.11083064, 0.17001564])}, 'recall_pop_Contribute': {0: array([2.22742085e-05, 7.61956898e-05]), 1: array([6.4949293e-05, 1.5943558e-04]), 2: array([9.84172437e-05, 2.20298975e-04]), 3: array([0.00014018, 0.00041853]), 4: array([0.00020935, 0.00057586]), 5: array([0.00032882, 0.00100946]), 6: array([0.00061946, 0.00165457]), 7: array([0.00180538, 0.00409455]), 8: array([0.00563644, 0.01107328]), 9: array([0.04309033, 0.06690996])}, 'ndcg': array([0.04300113, 0.05585382])}
[5mfind a better recall[25m 0.0520155929848055 ++0.010079286734005044
total time cost of epoch 1:  66.28935694694519
[[0.9999993]]
training: 11it [00:01,  9.88it/s]
[AUGMENT]




























training: 604it [00:56, 10.78it/s]
EPOCH[2]:loss 5.007
[TEST]
training: 1it [00:00,  6.40it/s]
{'precision': array([0.02609732, 0.02177356]), 'recall': array([0.05726825, 0.09498191]), 'recall_pop': {0: array([0.00025788, 0.00098552]), 1: array([0.00072042, 0.00202405]), 2: array([0.00091128, 0.00290067]), 3: array([0.00149366, 0.00437891]), 4: array([0.00253147, 0.00677379]), 5: array([0.00358106, 0.01055593]), 6: array([0.00694709, 0.01574229]), 7: array([0.01490221, 0.03019281]), 8: array([0.03207464, 0.06031163]), 9: array([0.11425066, 0.1725831 ])}, 'recall_pop_Contribute': {0: array([4.21941575e-05, 1.89997236e-04]), 1: array([0.00011916, 0.00031262]), 2: array([0.00014413, 0.00043828]), 3: array([0.00023218, 0.00070456]), 4: array([0.00041184, 0.00104886]), 5: array([0.00060978, 0.00178222]), 6: array([0.00116799, 0.00270459]), 7: array([0.00273542, 0.00567681]), 8: array([0.0069617 , 0.01321158]), 9: array([0.04484387, 0.06891238])}, 'ndcg': array([0.04761738, 0.06181708])}
[5mfind a better recall[25m 0.05726825276620882 ++0.005252659781403317
total time cost of epoch 2:  63.02000069618225
[AUGMENT]

training: 14it [00:01,  9.99it/s]