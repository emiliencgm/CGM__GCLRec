==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaptive_method': 'None',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'baseline',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 1,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'BPR',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+BPR',
 'notes': '_',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['testing'],
 'tau_plus': 0.1,
 'temp_tau': 0.2,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 1,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
precal cost :  0.7968122959136963
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[Visualization]
[t-SNE]
[double-label]
findfont: Font family ['sans-serif'] not found. Falling back to DejaVu Sans.
findfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei
findfont: Font family ['sans-serif'] not found. Falling back to DejaVu Sans.
findfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei
training: 1it [00:00,  3.88it/s]
[AUGMENT]










training: 604it [00:19, 31.12it/s]
EPOCH[0]:loss 0.353
[TEST]
{'precision': array([0.01543514]), 'recall': array([0.03245511]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.00012631]), 6: array([0.00094733]), 7: array([0.00101048]), 8: array([0.00410689]), 9: array([0.08150701])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.45556642e-05]), 6: array([0.00015885]), 7: array([0.00017712]), 8: array([0.00082672]), 9: array([0.03127787])}, 'ndcg': array([0.02657918])}
[5mfind a better recall[25m [0.03245511] ++[0.03245511]
time cost of epoch 0:  38.63786292076111
[Visualization]
[t-SNE]
[double-label]
training: 7it [00:00, 22.59it/s]
[AUGMENT]









training: 583it [00:18, 32.55it/s]
EPOCH[1]:loss 0.167

training: 604it [00:19, 31.66it/s]
{'precision': array([0.01583775]), 'recall': array([0.03353807]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([0.00010526]), 6: array([0.00094733]), 7: array([0.00110259]), 8: array([0.00459093]), 9: array([0.08538146])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.39405158e-05]), 6: array([0.00015704]), 7: array([0.00018519]), 8: array([0.00089793]), 9: array([0.03228396])}, 'ndcg': array([0.02766869])}
[5mfind a better recall[25m [0.03353807] ++[0.00108296]
time cost of epoch 1:  36.97997212409973
[Visualization]
[t-SNE]
[double-label]
[AUGMENT]
[TRAIN]









training: 604it [00:18, 31.80it/s]
EPOCH[2]:loss 0.155
[TEST]
{'precision': array([0.01611248]), 'recall': array([0.03444107]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([9.47328534e-05]), 6: array([0.00102627]), 7: array([0.00112627]), 8: array([0.00540275]), 9: array([0.08697459])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.19669147e-05]), 6: array([0.00017757]), 7: array([0.00019052]), 8: array([0.00106499]), 9: array([0.03299603])}, 'ndcg': array([0.02831262])}
[5mfind a better recall[25m [0.03444107] ++[0.000903]
time cost of epoch 2:  36.77369713783264
[Visualization]
[t-SNE]
[double-label]
[AUGMENT]
[TRAIN]









training: 597it [00:18, 32.87it/s]
EPOCH[3]:loss 0.147

training: 604it [00:19, 31.60it/s]
{'precision': array([0.01660983]), 'recall': array([0.03569303]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([7.36811082e-05]), 6: array([0.00099469]), 7: array([0.00115258]), 8: array([0.00564515]), 9: array([0.08952521])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.04318916e-05]), 6: array([0.00017125]), 7: array([0.00020803]), 8: array([0.00112313]), 9: array([0.03418018])}, 'ndcg': array([0.0291685])}
[5mfind a better recall[25m [0.03569303] ++[0.00125196]
time cost of epoch 3:  36.64234757423401
[Visualization]
[t-SNE]
[double-label]
training: 13it [00:00, 30.44it/s]
[AUGMENT]









training: 585it [00:18, 32.86it/s]
EPOCH[4]:loss 0.138

training: 604it [00:19, 31.57it/s]
{'precision': array([0.01699823]), 'recall': array([0.03670296]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([7.36811082e-05]), 6: array([0.00099469]), 7: array([0.00112101]), 8: array([0.00581264]), 9: array([0.0916862])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.04318916e-05]), 6: array([0.00017125]), 7: array([0.00019229]), 8: array([0.00116677]), 9: array([0.03516221])}, 'ndcg': array([0.02993264])}
[5mfind a better recall[25m [0.03670296] ++[0.00100992]
time cost of epoch 4:  36.55215311050415
[Visualization]
[t-SNE]
[double-label]
training: 5it [00:00, 22.49it/s]
[AUGMENT]









training: 584it [00:18, 33.16it/s]
EPOCH[5]:loss 0.131

training: 604it [00:18, 31.89it/s]
{'precision': array([0.01753505]), 'recall': array([0.03798776]), 'recall_pop': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([7.36811082e-05]), 6: array([0.00097891]), 7: array([0.00113679]), 8: array([0.00584064]), 9: array([0.09466259])}, 'recall_pop_Contribute': {0: array([0.]), 1: array([0.]), 2: array([0.]), 3: array([0.]), 4: array([0.]), 5: array([1.04318916e-05]), 6: array([0.00016599]), 7: array([0.00020094]), 8: array([0.00115626]), 9: array([0.03645413])}, 'ndcg': array([0.03081105])}
[5mfind a better recall[25m [0.03798776] ++[0.0012848]
time cost of epoch 5:  36.01780581474304
[Visualization]
[t-SNE]
[double-label]
training: 9it [00:00, 27.61it/s]
[AUGMENT]







training: 444it [00:14, 31.00it/s]