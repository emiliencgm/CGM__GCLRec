==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaloss_mode': 'pos',
 'adaptive_method': 'mlp',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'c': 'nothing',
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'gowalla',
 'device': device(type='cuda'),
 'early_stop_steps': 50,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'freeze_mlp': 200,
 'group': 'Ours',
 'if_SVD': 1,
 'if_adaptive': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'gowalla',
 'k_aug': 0,
 'lambda1': 0.1,
 'lambda_ForkMerge': 0.5,
 'latent_dim_rec': 64,
 'loss': 'Adaptive',
 'lr': 0.001,
 'model': 'LightGCN',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN+AdaLoss',
 'notes': 'LGN_+_AdaLoss_mlp',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['Adaptive_loss'],
 'tau_plus': 0.1,
 'temp_tau': 0.12,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20, 40],
 'train_mode': 'origin',
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 3,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/gowalla]
810128 interactions for training
217242 interactions for testing
gowalla Sparsity : 0.0008396216228570436
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
[34m[1mwandb[39m[22m: Network error resolved after 0:00:59.015893, resuming normal operation.
gowalla is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
Loading Eigenvector.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/gowalla/EigenvectorCentroid
eigenvector_centrality cost:  0.0008645057678222656
Loading CommonNeighbor_sp.pt from /home/cgm/code/CGM__GCLRec/code/precalculate/gowalla/CommonNeighbor/SC
CN_simi_unsymmetry_mat_sp cost:  0.0496671199798584
shape test : 1620256 == 1620256
precal cost :  0.6563432216644287
[PRECALCULATE--END]
user:29858, item:40981
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]
















training: 391it [00:32, 13.00it/s]
EPOCH[0]:loss 6.587

training: 395it [00:33, 11.93it/s]
{'precision': array([0.0374372 , 0.02666873]), 'recall': array([0.1180944 , 0.16737511]), 'recall_pop': {0: array([0.00191573, 0.00552951]), 1: array([0.0026806 , 0.00725858]), 2: array([0.00313819, 0.00791859]), 3: array([0.00334839, 0.00919774]), 4: array([0.00378721, 0.00979788]), 5: array([0.00526771, 0.01303679]), 6: array([0.01101872, 0.02228187]), 7: array([0.01587562, 0.03067822]), 8: array([0.03650555, 0.05794901]), 9: array([0.21656425, 0.27884453])}, 'recall_pop_Contribute': {0: array([0.00072302, 0.00194877]), 1: array([0.00075984, 0.00197942]), 2: array([0.00071361, 0.0019105 ]), 3: array([0.00083066, 0.00224179]), 4: array([0.00092999, 0.00229328]), 5: array([0.00132427, 0.00329669]), 6: array([0.00288235, 0.00566499]), 7: array([0.00394046, 0.0076029 ]), 8: array([0.01006606, 0.01569841]), 9: array([0.09592416, 0.12473834])}, 'ndcg': array([0.09869958, 0.1140967 ])}
[5mfind a better recall[25m 0.1180944004710173 ++0.1180944004710173
total time cost of epoch 0:  39.679133892059326
training: 0it [00:00, ?it/s]
[AUGMENT]















training: 371it [00:29, 12.46it/s]
EPOCH[1]:loss 4.799

training: 395it [00:31, 12.39it/s]
{'precision': array([0.04306049, 0.03051109]), 'recall': array([0.13787353, 0.19446632]), 'recall_pop': {0: array([0.00332718, 0.00828437]), 1: array([0.00413601, 0.01103677]), 2: array([0.00489149, 0.01200934]), 3: array([0.00482203, 0.01293296]), 4: array([0.00570661, 0.01436259]), 5: array([0.00777685, 0.0184639 ]), 6: array([0.01501548, 0.03032794]), 7: array([0.02255984, 0.0410365 ]), 8: array([0.0474103 , 0.07502088]), 9: array([0.24040816, 0.30273824])}, 'recall_pop_Contribute': {0: array([0.00118018, 0.00272923]), 1: array([0.0011258, 0.0029172]), 2: array([0.0011172 , 0.00280531]), 3: array([0.0011744 , 0.00299581]), 4: array([0.00136326, 0.00333535]), 5: array([0.00194588, 0.00467217]), 6: array([0.00382412, 0.00751426]), 7: array([0.00564276, 0.01019939]), 8: array([0.01305305, 0.02023396]), 9: array([0.1074469 , 0.13706365])}, 'ndcg': array([0.11475561, 0.13248041])}
[5mfind a better recall[25m 0.13787353292369747 ++0.019779132452680176
total time cost of epoch 1:  38.58226990699768
[AUGMENT]
[TRAIN]














training: 371it [00:29, 12.82it/s]

training: 395it [00:31, 12.61it/s]
[TEST]
{'precision': array([0.04601614, 0.03265624]), 'recall': array([0.14863584, 0.20940166]), 'recall_pop': {0: array([0.00462503, 0.01140346]), 1: array([0.00523119, 0.01369467]), 2: array([0.00576068, 0.01429748]), 3: array([0.00658817, 0.01647249]), 4: array([0.00732427, 0.01764695]), 5: array([0.01036386, 0.02191365]), 6: array([0.01857152, 0.03478725]), 7: array([0.02690344, 0.04807364]), 8: array([0.05485149, 0.08479504]), 9: array([0.24973263, 0.3127869 ])}, 'recall_pop_Contribute': {0: array([0.0015198 , 0.00359431]), 1: array([0.00140807, 0.00358324]), 2: array([0.00130795, 0.00335258]), 3: array([0.00150591, 0.00376062]), 4: array([0.00173298, 0.00409017]), 5: array([0.00254401, 0.00541985]), 6: array([0.00454409, 0.00857721]), 7: array([0.00671239, 0.01184277]), 8: array([0.01505067, 0.02278649]), 9: array([0.11230995, 0.14239443])}, 'ndcg': array([0.12399672, 0.14314403])}
[5mfind a better recall[25m 0.14863583855567936 ++0.010762305631981883
total time cost of epoch 2:  38.0206515789032
[AUGMENT]
[TRAIN]















training: 392it [00:31, 12.51it/s]
EPOCH[3]:loss 4.320

training: 395it [00:31, 12.44it/s]
{'precision': array([0.04784982, 0.03408216]), 'recall': array([0.15516506, 0.2192403 ]), 'recall_pop': {0: array([0.00576276, 0.01374539]), 1: array([0.00654691, 0.01600464]), 2: array([0.00686312, 0.01664888]), 3: array([0.00793542, 0.01844604]), 4: array([0.00865961, 0.02036231]), 5: array([0.01182247, 0.02574603]), 6: array([0.02049447, 0.03800804]), 7: array([0.03032929, 0.05282458]), 8: array([0.05921262, 0.09120352]), 9: array([0.25374972, 0.31749528])}, 'recall_pop_Contribute': {0: array([0.0018062 , 0.00427141]), 1: array([0.00170738, 0.00418888]), 2: array([0.00156277, 0.00395828]), 3: array([0.00178528, 0.00417335]), 4: array([0.00204894, 0.00467334]), 5: array([0.00281845, 0.00623049]), 6: array([0.0049906 , 0.00934859]), 7: array([0.00749998, 0.01300155]), 8: array([0.01618264, 0.02440958]), 9: array([0.11476282, 0.14498483])}, 'ndcg': array([0.12989914, 0.15019194])}
[5mfind a better recall[25m 0.15516506478767503 ++0.006529226231995672
total time cost of epoch 3:  38.38680291175842
[AUGMENT]
[TRAIN]















training: 387it [00:30, 13.20it/s]
EPOCH[4]:loss 4.203

training: 395it [00:31, 12.54it/s]
{'precision': array([0.04928495, 0.03505928]), 'recall': array([0.16047928, 0.22603419]), 'recall_pop': {0: array([0.00662484, 0.01590119]), 1: array([0.00716261, 0.01785982]), 2: array([0.00829322, 0.01840027]), 3: array([0.00911266, 0.02024277]), 4: array([0.01038476, 0.02216369]), 5: array([0.01385211, 0.02893846]), 6: array([0.02215994, 0.04082742]), 7: array([0.03248689, 0.05655334]), 8: array([0.06262032, 0.0947692 ]), 9: array([0.25692002, 0.32071278])}, 'recall_pop_Contribute': {0: array([0.00206879, 0.00489829]), 1: array([0.00181679, 0.00461808]), 2: array([0.00188705, 0.00431564]), 3: array([0.0020451 , 0.00461249]), 4: array([0.00240933, 0.00503741]), 5: array([0.00328251, 0.00688199]), 6: array([0.00540497, 0.00997937]), 7: array([0.0080518 , 0.01384059]), 8: array([0.01704085, 0.02534145]), 9: array([0.11647209, 0.14650888])}, 'ndcg': array([0.13425149, 0.15504088])}
[5mfind a better recall[25m 0.16047928135764733 ++0.005314216569972302
training: 1it [00:00,  7.03it/s]
total time cost of epoch 4:  38.68678045272827
[AUGMENT]















training: 377it [00:30, 12.81it/s]
EPOCH[5]:loss 4.121

training: 395it [00:31, 12.47it/s]
{'precision': array([0.05034664, 0.03580531]), 'recall': array([0.16429936, 0.23166354]), 'recall_pop': {0: array([0.00744981, 0.01775474]), 1: array([0.00870267, 0.01917146]), 2: array([0.00892399, 0.02001597]), 3: array([0.00955196, 0.02151374]), 4: array([0.01090999, 0.02369901]), 5: array([0.01481166, 0.02962927]), 6: array([0.02368522, 0.04385679]), 7: array([0.03417697, 0.05831209]), 8: array([0.06572334, 0.09918599]), 9: array([0.25924964, 0.32333352])}, 'recall_pop_Contribute': {0: array([0.00227062, 0.00542127]), 1: array([0.00219975, 0.00492421]), 2: array([0.00203796, 0.00474556]), 3: array([0.0021999 , 0.00485055]), 4: array([0.00253769, 0.00535611]), 5: array([0.00350984, 0.00704262]), 6: array([0.00579936, 0.01070644]), 7: array([0.00834407, 0.01426277]), 8: array([0.0178575 , 0.02650418]), 9: array([0.11754268, 0.14784983])}, 'ndcg': array([0.13756109, 0.15892495])}
[5mfind a better recall[25m 0.16429936097693287 ++0.0038200796192855435
total time cost of epoch 5:  38.38885521888733
[AUGMENT]
[TRAIN]















training: 395it [00:31, 12.42it/s]
EPOCH[6]:loss 4.062
[TEST]
{'precision': array([0.05115379, 0.03642407]), 'recall': array([0.16696934, 0.2359295 ]), 'recall_pop': {0: array([0.00833553, 0.01927596]), 1: array([0.00896317, 0.02066491]), 2: array([0.00937668, 0.02144105]), 3: array([0.01043559, 0.02296896]), 4: array([0.01200121, 0.02496277]), 5: array([0.01546594, 0.03119056]), 6: array([0.02490217, 0.04560434]), 7: array([0.03595664, 0.06103183]), 8: array([0.06735312, 0.10153813]), 9: array([0.26049139, 0.32414366])}, 'recall_pop_Contribute': {0: array([0.00262102, 0.00582557]), 1: array([0.00225767, 0.00534641]), 2: array([0.00214324, 0.00498341]), 3: array([0.00238315, 0.00520859]), 4: array([0.00276383, 0.00571763]), 5: array([0.00365637, 0.00732002]), 6: array([0.00606644, 0.01101276]), 7: array([0.00876801, 0.01488644]), 8: array([0.01827542, 0.02710974]), 9: array([0.11803419, 0.14851893])}, 'ndcg': array([0.13955799, 0.16143004])}
[5mfind a better recall[25m 0.16696933593937077 ++0.0026699749624378988
total time cost of epoch 6:  38.786518812179565
[AUGMENT]
[TRAIN]















training: 391it [00:30, 13.51it/s]
EPOCH[7]:loss 4.021

training: 395it [00:31, 12.65it/s]
{'precision': array([0.05165617, 0.0367255 ]), 'recall': array([0.16869931, 0.23795232]), 'recall_pop': {0: array([0.00890027, 0.02011997]), 1: array([0.00918168, 0.02216573]), 2: array([0.00984138, 0.02231156]), 3: array([0.01120111, 0.0237537 ]), 4: array([0.01273077, 0.02608328]), 5: array([0.0163227 , 0.03244534]), 6: array([0.02583154, 0.04743116]), 7: array([0.03617801, 0.06192809]), 8: array([0.06807476, 0.1033484 ]), 9: array([0.26160604, 0.32293227])}, 'recall_pop_Contribute': {0: array([0.00279907, 0.00606179]), 1: array([0.00229735, 0.00564537]), 2: array([0.00226166, 0.00510889]), 3: array([0.0025542 , 0.00539631]), 4: array([0.00291254, 0.00592038]), 5: array([0.00375813, 0.00755353]), 6: array([0.00627899, 0.01148511]), 7: array([0.00882989, 0.01515335]), 8: array([0.01851895, 0.02766592]), 9: array([0.11848851, 0.14796168])}, 'ndcg': array([0.14109608, 0.16307707])}
[5mfind a better recall[25m 0.16869931161306337 ++0.0017299756736925964
total time cost of epoch 7:  38.2508385181427
[AUGMENT]
[TRAIN]













training: 379it [00:26, 11.45it/s]
EPOCH[8]:loss 3.989

training: 395it [00:28, 13.99it/s]
{'precision': array([0.05204803, 0.03697669]), 'recall': array([0.17069633, 0.24010209]), 'recall_pop': {0: array([0.00942037, 0.02125659]), 1: array([0.00978844, 0.02271246]), 2: array([0.01048475, 0.02214298]), 3: array([0.01141215, 0.02502364]), 4: array([0.01336624, 0.02653676]), 5: array([0.01679637, 0.03373541]), 6: array([0.0267504 , 0.04761381]), 7: array([0.03725138, 0.06317144]), 8: array([0.06810889, 0.10308789]), 9: array([0.26217578, 0.32372688])}, 'recall_pop_Contribute': {0: array([0.00296628, 0.00640171]), 1: array([0.00247367, 0.005775  ]), 2: array([0.00242813, 0.00508624]), 3: array([0.0025705 , 0.00574159]), 4: array([0.00306282, 0.0060833 ]), 5: array([0.00392071, 0.00782701]), 6: array([0.00664669, 0.01162933]), 7: array([0.0091767 , 0.01543309]), 8: array([0.01866203, 0.02763592]), 9: array([0.11878881, 0.1484889 ])}, 'ndcg': array([0.14239162, 0.16443446])}
[5mfind a better recall[25m 0.17069633296865108 ++0.0019970213555877137
total time cost of epoch 8:  41.512267112731934
[AUGMENT]
[TRAIN]











training: 373it [00:23, 10.17it/s]
EPOCH[9]:loss 3.966

training: 395it [00:24, 15.84it/s]
{'precision': array([0.05263079, 0.03737692]), 'recall': array([0.17231595, 0.24224979]), 'recall_pop': {0: array([0.01000776, 0.02218658]), 1: array([0.01058312, 0.02384411]), 2: array([0.01097931, 0.02335427]), 3: array([0.01157184, 0.02562674]), 4: array([0.01370343, 0.02712841]), 5: array([0.0181366 , 0.03487444]), 6: array([0.02758974, 0.04901003]), 7: array([0.03809973, 0.0638709 ]), 8: array([0.06961072, 0.10539297]), 9: array([0.26213886, 0.32381768])}, 'recall_pop_Contribute': {0: array([0.00309844, 0.00671173]), 1: array([0.00262896, 0.006052  ]), 2: array([0.00251704, 0.00533675]), 3: array([0.00263946, 0.00590498]), 4: array([0.00314131, 0.00617039]), 5: array([0.0042621 , 0.00810277]), 6: array([0.00676912, 0.01181557]), 7: array([0.00944284, 0.01569636]), 8: array([0.01899801, 0.02812106]), 9: array([0.11881866, 0.14833816])}, 'ndcg': array([0.1438431 , 0.16605755])}
[5mfind a better recall[25m 0.17231594621744944 ++0.0016196132487983628
total time cost of epoch 9:  38.6583776473999
training: 0it [00:00, ?it/s]
[AUGMENT]

















training: 387it [00:34, 12.11it/s]
EPOCH[10]:loss 3.947

training: 395it [00:34, 11.30it/s]
{'precision': array([0.05296905, 0.03761806]), 'recall': array([0.17371225, 0.24382748]), 'recall_pop': {0: array([0.01047672, 0.02300517]), 1: array([0.01048711, 0.02457007]), 2: array([0.0111049 , 0.02397973]), 3: array([0.01158081, 0.02638554]), 4: array([0.01372485, 0.02798811]), 5: array([0.01836686, 0.03546239]), 6: array([0.02774979, 0.0493693 ]), 7: array([0.03876727, 0.06431259]), 8: array([0.07055412, 0.10588498]), 9: array([0.26321785, 0.32530793])}, 'recall_pop_Contribute': {0: array([0.00324828, 0.0068575 ]), 1: array([0.00270562, 0.00620119]), 2: array([0.0025438 , 0.00543698]), 3: array([0.00269097, 0.00602884]), 4: array([0.00321756, 0.00635505]), 5: array([0.00439895, 0.00822121]), 6: array([0.00677315, 0.01186386]), 7: array([0.00954453, 0.01584886]), 8: array([0.01925628, 0.02828418]), 9: array([0.11933311, 0.14872983])}, 'ndcg': array([0.14479205, 0.16707681])}
[5mfind a better recall[25m 0.1737122457571764 ++0.0013962995397269473
total time cost of epoch 10:  50.53878426551819
[AUGMENT]
[TRAIN]

















training: 382it [00:35, 11.28it/s]
EPOCH[11]:loss 3.932

training: 395it [00:36, 10.69it/s]
{'precision': array([0.05315828, 0.03768588]), 'recall': array([0.17441222, 0.2443373 ]), 'recall_pop': {0: array([0.01063879, 0.02338564]), 1: array([0.01054009, 0.02465951]), 2: array([0.01136805, 0.0237852 ]), 3: array([0.01224674, 0.02682341]), 4: array([0.01445951, 0.0285497 ]), 5: array([0.01823716, 0.03516319]), 6: array([0.02852472, 0.0492733 ]), 7: array([0.03944484, 0.06509374]), 8: array([0.07125169, 0.10662455]), 9: array([0.26321053, 0.32539195])}, 'recall_pop_Contribute': {0: array([0.00336697, 0.00697808]), 1: array([0.00268829, 0.00618582]), 2: array([0.00260081, 0.00541458]), 3: array([0.00279395, 0.00615428]), 4: array([0.00340098, 0.00648395]), 5: array([0.00428211, 0.0081181 ]), 6: array([0.00697577, 0.01192933]), 7: array([0.00964295, 0.01596578]), 8: array([0.01943177, 0.02841022]), 9: array([0.1192286 , 0.14869716])}, 'ndcg': array([0.14545195, 0.16769308])}
[5mfind a better recall[25m 0.1744122189432009 ++0.000699973186024494
total time cost of epoch 11:  48.794519901275635
[AUGMENT]
[TRAIN]


















training: 393it [00:37,  6.22it/s]
EPOCH[12]:loss 3.922

training: 395it [00:37, 10.58it/s]
{'precision': array([0.05342287, 0.03794209]), 'recall': array([0.17510849, 0.24614584]), 'recall_pop': {0: array([0.01122178, 0.02401624]), 1: array([0.01047736, 0.02525451]), 2: array([0.01072924, 0.02459463]), 3: array([0.01259306, 0.02736932]), 4: array([0.01438951, 0.02874943]), 5: array([0.0182742, 0.0359041]), 6: array([0.02850414, 0.05019598]), 7: array([0.04034702, 0.06641361]), 8: array([0.0713895 , 0.10745859]), 9: array([0.26405991, 0.32503034])}, 'recall_pop_Contribute': {0: array([0.00344064, 0.00718488]), 1: array([0.00268652, 0.00629831]), 2: array([0.00244224, 0.00561804]), 3: array([0.00284072, 0.00621396]), 4: array([0.00335896, 0.00657898]), 5: array([0.00429212, 0.00826303]), 6: array([0.00692167, 0.01214341]), 7: array([0.00999277, 0.01627396]), 8: array([0.01949333, 0.02880464]), 9: array([0.11963953, 0.14876664])}, 'ndcg': array([0.14610365, 0.16867131])}
[5mfind a better recall[25m 0.1751084925893691 ++0.0006962736461682273
total time cost of epoch 12:  53.06382489204407
[AUGMENT]
[TRAIN]

















training: 385it [00:35, 11.07it/s]
EPOCH[13]:loss 3.916

training: 395it [00:36, 10.79it/s]
{'precision': array([0.05352669, 0.03793456]), 'recall': array([0.17553279, 0.24573333]), 'recall_pop': {0: array([0.01089721, 0.02466471]), 1: array([0.01130135, 0.02520222]), 2: array([0.01105299, 0.02421194]), 3: array([0.01274018, 0.02706784]), 4: array([0.01473195, 0.02882287]), 5: array([0.01890632, 0.03626887]), 6: array([0.02871458, 0.05018233]), 7: array([0.0399734 , 0.06613346]), 8: array([0.07200717, 0.10682816]), 9: array([0.26370379, 0.32483724])}, 'recall_pop_Contribute': {0: array([0.00338069, 0.00727038]), 1: array([0.00281243, 0.00626811]), 2: array([0.00258078, 0.00551613]), 3: array([0.00288728, 0.00615182]), 4: array([0.00342872, 0.00659365]), 5: array([0.00437013, 0.00831576]), 6: array([0.00699308, 0.01218135]), 7: array([0.00990913, 0.01614969]), 8: array([0.01956854, 0.02857778]), 9: array([0.11960201, 0.14870866])}, 'ndcg': array([0.14667397, 0.16898874])}
[5mfind a better recall[25m 0.17553278998726726 ++0.000424297397898149
total time cost of epoch 13:  52.77290463447571
[AUGMENT]
[TRAIN]


















training: 380it [00:36, 10.16it/s]
EPOCH[14]:loss 3.906

training: 395it [00:38, 10.34it/s]
{'precision': array([0.05393194, 0.03811374]), 'recall': array([0.17670088, 0.24708043]), 'recall_pop': {0: array([0.01139586, 0.02504408]), 1: array([0.01120125, 0.02608564]), 2: array([0.01179177, 0.02494518]), 3: array([0.01288332, 0.02698296]), 4: array([0.01479532, 0.02909338]), 5: array([0.01994577, 0.03691327]), 6: array([0.0290741 , 0.05023799]), 7: array([0.03986028, 0.06693468]), 8: array([0.07213257, 0.10602808]), 9: array([0.26391597, 0.32572371])}, 'recall_pop_Contribute': {0: array([0.00350873, 0.00743071]), 1: array([0.00283937, 0.00655903]), 2: array([0.00272127, 0.00561841]), 3: array([0.0029143 , 0.00615407]), 4: array([0.00350279, 0.00655893]), 5: array([0.00464889, 0.00844076]), 6: array([0.00706385, 0.01225167]), 7: array([0.00985604, 0.01645664]), 8: array([0.0196798 , 0.02837226]), 9: array([0.11996584, 0.14923794])}, 'ndcg': array([0.1473687 , 0.16967192])}
[5mfind a better recall[25m 0.17670088222439628 ++0.0011680922371290203
total time cost of epoch 14:  54.21060538291931
[AUGMENT]
[TRAIN]


















training: 387it [00:36,  9.74it/s]
EPOCH[15]:loss 3.900

training: 395it [00:37, 10.67it/s]
{'precision': array([0.05399223, 0.03814053]), 'recall': array([0.17687904, 0.24742351]), 'recall_pop': {0: array([0.01146291, 0.02480721]), 1: array([0.01084759, 0.02569831]), 2: array([0.01137615, 0.02469455]), 3: array([0.01267292, 0.02743924]), 4: array([0.01487814, 0.0292094 ]), 5: array([0.01973645, 0.03758679]), 6: array([0.02866372, 0.05071688]), 7: array([0.04107094, 0.06662272]), 8: array([0.0725672 , 0.10756467]), 9: array([0.26435246, 0.32536254])}, 'recall_pop_Contribute': {0: array([0.00350821, 0.00734814]), 1: array([0.00277252, 0.00643617]), 2: array([0.00257126, 0.00559836]), 3: array([0.00291173, 0.0062495 ]), 4: array([0.00350918, 0.00662193]), 5: array([0.00452367, 0.00863268]), 6: array([0.0070186 , 0.01232476]), 7: array([0.01009694, 0.0163066 ]), 8: array([0.01981343, 0.02879681]), 9: array([0.1201535 , 0.14910856])}, 'ndcg': array([0.1476636 , 0.17003693])}
[5mfind a better recall[25m 0.17687904330547413 ++0.0001781610810778489
total time cost of epoch 15:  52.59655976295471
[AUGMENT]
[TRAIN]


















training: 385it [00:37, 10.22it/s]
EPOCH[16]:loss 3.893

training: 395it [00:38, 10.29it/s]
{'precision': array([0.05417476, 0.03826278]), 'recall': array([0.17747033, 0.24818818]), 'recall_pop': {0: array([0.01183424, 0.02525541]), 1: array([0.01162398, 0.02588876]), 2: array([0.01151378, 0.02524405]), 3: array([0.01246774, 0.0275347 ]), 4: array([0.01499785, 0.02958145]), 5: array([0.01941182, 0.03632075]), 6: array([0.02843426, 0.05034236]), 7: array([0.04039493, 0.06755245]), 8: array([0.07172946, 0.10746067]), 9: array([0.26646904, 0.32635526])}, 'recall_pop_Contribute': {0: array([0.00363786, 0.00748916]), 1: array([0.00300559, 0.00643846]), 2: array([0.0026704 , 0.00576133]), 3: array([0.00282115, 0.00628855]), 4: array([0.00345761, 0.00670366]), 5: array([0.00445373, 0.0084319 ]), 6: array([0.00692082, 0.01226693]), 7: array([0.01004098, 0.01649244]), 8: array([0.01953319, 0.02880252]), 9: array([0.120929  , 0.14951324])}, 'ndcg': array([0.14802023, 0.17043387])}
[5mfind a better recall[25m 0.17747032750397404 ++0.0005912841984999084
total time cost of epoch 16:  55.46966505050659
[AUGMENT]
[TRAIN]


















training: 380it [00:37, 10.48it/s]
EPOCH[17]:loss 3.888

training: 395it [00:39,  9.95it/s]
{'precision': array([0.05433552, 0.03839926]), 'recall': array([0.17829604, 0.24934638]), 'recall_pop': {0: array([0.0119065 , 0.02537536]), 1: array([0.0114987 , 0.02614277]), 2: array([0.0116645 , 0.02536323]), 3: array([0.01248672, 0.02768094]), 4: array([0.01493649, 0.03005445]), 5: array([0.01906592, 0.0368411 ]), 6: array([0.02871519, 0.05081519]), 7: array([0.04131789, 0.06788192]), 8: array([0.07230435, 0.1069543 ]), 9: array([0.26692235, 0.3281509 ])}, 'recall_pop_Contribute': {0: array([0.00362255, 0.00752481]), 1: array([0.00292181, 0.00657339]), 2: array([0.00268733, 0.00580709]), 3: array([0.00281911, 0.00631171]), 4: array([0.00351975, 0.00678327]), 5: array([0.00440011, 0.00846745]), 6: array([0.00703891, 0.01228808]), 7: array([0.01020071, 0.01653513]), 8: array([0.01983527, 0.02859818]), 9: array([0.12125048, 0.15045726])}, 'ndcg': array([0.14825287, 0.17079229])}
[5mfind a better recall[25m 0.17829604199673477 ++0.0008257144927607263
total time cost of epoch 17:  52.11869215965271
[AUGMENT]
[TRAIN]




















training: 392it [00:42,  9.56it/s]
EPOCH[18]:loss 3.886

training: 395it [00:42,  9.27it/s]
{'precision': array([0.05419653, 0.03845619]), 'recall': array([0.17784176, 0.24962674]), 'recall_pop': {0: array([0.0121403, 0.0259058]), 1: array([0.0110875 , 0.02674179]), 2: array([0.01149453, 0.02593622]), 3: array([0.01246336, 0.02745906]), 4: array([0.01446282, 0.02976871]), 5: array([0.01972983, 0.03663683]), 6: array([0.02946921, 0.05098285]), 7: array([0.04132097, 0.06812407]), 8: array([0.07265438, 0.10815231]), 9: array([0.26565896, 0.32710672])}, 'recall_pop_Contribute': {0: array([0.00369592, 0.00758909]), 1: array([0.00281032, 0.00670302]), 2: array([0.00256642, 0.0059178 ]), 3: array([0.00286738, 0.00629787]), 4: array([0.00343877, 0.00670195]), 5: array([0.00450643, 0.00843259]), 6: array([0.00721031, 0.01231341]), 7: array([0.01027278, 0.0166074 ]), 8: array([0.01980612, 0.02900063]), 9: array([0.12066731, 0.15006298])}, 'ndcg': array([0.14838662, 0.17120339])}
total time cost of epoch 18:  55.90790057182312
[AUGMENT]
[TRAIN]




















training: 387it [00:41,  9.45it/s]
EPOCH[19]:loss 3.881

training: 395it [00:42,  9.33it/s]
{'precision': array([0.05448121, 0.03861779]), 'recall': array([0.17861414, 0.25047644]), 'recall_pop': {0: array([0.01170977, 0.02550914]), 1: array([0.01150912, 0.02659902]), 2: array([0.01172981, 0.02591863]), 3: array([0.01282722, 0.02751125]), 4: array([0.01480404, 0.03025526]), 5: array([0.01911996, 0.03713688]), 6: array([0.02920514, 0.05115683]), 7: array([0.04086991, 0.06840715]), 8: array([0.0718516 , 0.10892249]), 9: array([0.26800789, 0.32848818])}, 'recall_pop_Contribute': {0: array([0.00364262, 0.00750535]), 1: array([0.00287893, 0.00673035]), 2: array([0.00267661, 0.00599316]), 3: array([0.0029712 , 0.00631419]), 4: array([0.00341192, 0.00683587]), 5: array([0.00441262, 0.00848468]), 6: array([0.00713061, 0.01237339]), 7: array([0.0101836 , 0.01667787]), 8: array([0.01949896, 0.02909035]), 9: array([0.12180708, 0.15047121])}, 'ndcg': array([0.14916853, 0.17196623])}
[5mfind a better recall[25m 0.17861413958579564 ++0.0003180975890608728
total time cost of epoch 19:  49.05359363555908
[AUGMENT]
[TRAIN]




















training: 388it [00:40,  9.54it/s]
EPOCH[20]:loss 3.880

training: 395it [00:41,  9.56it/s]
{'precision': array([0.05484292, 0.03867054]), 'recall': array([0.17977952, 0.25112915]), 'recall_pop': {0: array([0.01227329, 0.02637146]), 1: array([0.01161041, 0.02638669]), 2: array([0.01227907, 0.02604618]), 3: array([0.01325002, 0.02778701]), 4: array([0.01556375, 0.03052797]), 5: array([0.0196036, 0.0372167]), 6: array([0.02930007, 0.05121161]), 7: array([0.04102059, 0.06793405]), 8: array([0.07243301, 0.10802035]), 9: array([0.26902807, 0.32973079])}, 'recall_pop_Contribute': {0: array([0.00374941, 0.00780015]), 1: array([0.00288267, 0.00663398]), 2: array([0.00278069, 0.00605609]), 3: array([0.00311694, 0.00637841]), 4: array([0.00357327, 0.00695301]), 5: array([0.00455699, 0.00851159]), 6: array([0.00712305, 0.01238949]), 7: array([0.01025934, 0.01656059]), 8: array([0.01964288, 0.02886264]), 9: array([0.12209428, 0.1509832 ])}, 'ndcg': array([0.14983756, 0.1724027 ])}
[5mfind a better recall[25m 0.17977952329602312 ++0.00116538371022748
total time cost of epoch 20:  48.21238565444946
[AUGMENT]
[TRAIN]




















training: 393it [00:40, 10.35it/s]
EPOCH[21]:loss 3.877

training: 395it [00:40,  9.71it/s]
{'precision': array([0.05496852, 0.03882963]), 'recall': array([0.18008354, 0.25186228]), 'recall_pop': {0: array([0.01233162, 0.02646341]), 1: array([0.0114234 , 0.02627479]), 2: array([0.01185145, 0.02605539]), 3: array([0.01319416, 0.0272983 ]), 4: array([0.01522689, 0.03071326]), 5: array([0.01950033, 0.03741545]), 6: array([0.02991202, 0.0514193 ]), 7: array([0.04151624, 0.06797497]), 8: array([0.07209478, 0.10831825]), 9: array([0.26915844, 0.33105702])}, 'recall_pop_Contribute': {0: array([0.00374184, 0.00777205]), 1: array([0.00293335, 0.00660235]), 2: array([0.00271495, 0.00592839]), 3: array([0.00307554, 0.00627127]), 4: array([0.00360025, 0.00706927]), 5: array([0.00451594, 0.00859652]), 6: array([0.00736284, 0.01243329]), 7: array([0.01029248, 0.01659684]), 8: array([0.01964159, 0.02902313]), 9: array([0.12220476, 0.15156915])}, 'ndcg': array([0.14984464, 0.17259034])}
[5mfind a better recall[25m 0.18008354267068197 ++0.0003040193746588482
total time cost of epoch 21:  47.836907148361206
training: 2it [00:00,  7.33it/s]
[AUGMENT]



















training: 388it [00:38,  9.48it/s]
EPOCH[22]:loss 3.875

training: 395it [00:39, 10.09it/s]
{'precision': array([0.05500871, 0.03875427]), 'recall': array([0.17994634, 0.25102654]), 'recall_pop': {0: array([0.01219377, 0.02610899]), 1: array([0.01141162, 0.02638625]), 2: array([0.01142834, 0.02590384]), 3: array([0.01322937, 0.02724695]), 4: array([0.01517992, 0.03077407]), 5: array([0.01966891, 0.03774694]), 6: array([0.02965853, 0.05138353]), 7: array([0.04114414, 0.06838184]), 8: array([0.07196394, 0.10779549]), 9: array([0.27020141, 0.33015752])}, 'recall_pop_Contribute': {0: array([0.00371532, 0.0076624 ]), 1: array([0.00295473, 0.00660204]), 2: array([0.00262925, 0.00590237]), 3: array([0.00302914, 0.00617526]), 4: array([0.00356074, 0.00709257]), 5: array([0.00456965, 0.00872114]), 6: array([0.00725585, 0.01241312]), 7: array([0.01019658, 0.01662141]), 8: array([0.01952763, 0.02878676]), 9: array([0.12250742, 0.15104946])}, 'ndcg': array([0.14976567, 0.1722621 ])}
total time cost of epoch 22:  46.577229261398315
[AUGMENT]
[TRAIN]



















training: 388it [00:39,  9.88it/s]
EPOCH[23]:loss 3.872

training: 395it [00:40,  9.71it/s]
{'precision': array([0.05520798, 0.03886563]), 'recall': array([0.18043409, 0.25173564]), 'recall_pop': {0: array([0.01229553, 0.02659766]), 1: array([0.01165379, 0.02658347]), 2: array([0.01172139, 0.0257777 ]), 3: array([0.01335691, 0.02772444]), 4: array([0.01472966, 0.03066138]), 5: array([0.01950986, 0.03739695]), 6: array([0.03045287, 0.05148327]), 7: array([0.04081493, 0.06773973]), 8: array([0.07218777, 0.1086532 ]), 9: array([0.27061024, 0.33025547])}, 'recall_pop_Contribute': {0: array([0.00375083, 0.00779115]), 1: array([0.00297984, 0.00664932]), 2: array([0.00268505, 0.00592224]), 3: array([0.00302195, 0.00626714]), 4: array([0.00344173, 0.00707165]), 5: array([0.00450346, 0.00862495]), 6: array([0.00738674, 0.01240352]), 7: array([0.01013831, 0.01652631]), 8: array([0.01960212, 0.02907361]), 9: array([0.12292405, 0.15140575])}, 'ndcg': array([0.15016615, 0.17270017])}
[5mfind a better recall[25m 0.1804340861178145 ++0.00035054344713253416
training: 3it [00:00,  7.97it/s]
total time cost of epoch 23:  47.47500276565552
[AUGMENT]




















training: 395it [00:40,  9.85it/s]
EPOCH[24]:loss 3.871
[TEST]
{'precision': array([0.05519961, 0.03883298]), 'recall': array([0.18048347, 0.25153351]), 'recall_pop': {0: array([0.01229414, 0.02662025]), 1: array([0.0114199 , 0.02644671]), 2: array([0.01189808, 0.02579445]), 3: array([0.01307024, 0.02746823]), 4: array([0.01459547, 0.02997499]), 5: array([0.01967596, 0.0376226 ]), 6: array([0.02986825, 0.05156966]), 7: array([0.04030873, 0.0679574 ]), 8: array([0.0717313 , 0.10802743]), 9: array([0.27153954, 0.33091234])}, 'recall_pop_Contribute': {0: array([0.00379907, 0.00780141]), 1: array([0.00292135, 0.00661253]), 2: array([0.00269812, 0.005915  ]), 3: array([0.00297312, 0.0062556 ]), 4: array([0.00341924, 0.00685845]), 5: array([0.00452474, 0.00864931]), 6: array([0.00733049, 0.01248754]), 7: array([0.01004158, 0.0165833 ]), 8: array([0.01946814, 0.02883678]), 9: array([0.12330762, 0.15153359])}, 'ndcg': array([0.15036136, 0.17284697])}
[5mfind a better recall[25m 0.1804834726579125 ++4.938654009800647e-05
total time cost of epoch 24:  46.95426893234253
[AUGMENT]
[TRAIN]








