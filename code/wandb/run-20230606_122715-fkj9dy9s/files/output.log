==========config==========
{'GTN_K': 3,
 'GTN_alpha': 0.3,
 'adaptive_method': 'None',
 'alpha': 0.5,
 'augment': 'No',
 'batch_size': 2048,
 'centroid_mode': 'eigenvector',
 'comment': '_',
 'commonNeighbor_mode': 'SC',
 'cores': 10,
 'dataset': 'yelp2018',
 'device': device(type='cuda'),
 'early_stop_steps': 30,
 'edge_drop_prob': 0.1,
 'epoch_only_pop_for_BCloss': 5,
 'epochs': 1000,
 'eps_SimGCL': 0.1,
 'epsilon_GCLRec': 0.1,
 'group': 'baseline',
 'if_SVD': 1,
 'if_big_matrix': 0,
 'if_double_label': 1,
 'if_load_embedding': 0,
 'if_multicore': 1,
 'if_pretrain': 0,
 'if_projector': 0,
 'if_tensorboard': 1,
 'if_tsne': 1,
 'if_valid': 0,
 'if_visual': 0,
 'init_method': 'Normal',
 'item_emb': 0,
 'job_type': 'yelp2018',
 'k_aug': 0,
 'lambda1': 0.1,
 'latent_dim_rec': 64,
 'loss': 'BPR',
 'lr': 0.001,
 'model': 'LightGCN_PyG',
 'n_cluster': 10,
 'n_fold': 2,
 'name': 'LightGCN_PyG+BPR',
 'notes': 'PyG_Implementation',
 'num_layers': 3,
 'p_drop': 0.1,
 'perplexity': 50,
 'pop_gamma': 0.02,
 'pop_group': 10,
 'project': 'GCLRec_No_Valid',
 'seed': 2023,
 'sigma_gausse': 1.0,
 'svd_q': 5,
 'tag': ['LightGCN'],
 'tau_plus': 0.1,
 'temp_tau': 0.2,
 'temp_tau_pop': 0.1,
 'test_u_batch_size': 2048,
 'topks': [20],
 'tsne_group': [0, 9],
 'tsne_points': 2000,
 'user_emb': 0,
 'visual_epoch': 1,
 'w_GCLRec': 0.1,
 'weight_decay': 0.0001}
==========config==========
[DATALOADER--START]
loading [/home/cgm/code/CGM__GCLRec/data/yelp2018]
1237259 interactions for training
324147 interactions for testing
yelp2018 Sparsity : 0.0012958757851778647
loading adjacency matrix
successfully loaded...
Remember to delete this pre-calculed mat while changing data split !
yelp2018 is ready to go
[DATALOADER--END]
[PRECALCULATE--START]
precal cost :  0.7982363700866699
[PRECALCULATE--END]
user:31668, item:38048
use NORMAL distribution UI for Embedding
GCL Model is ready to go!
[AUGMENT]
[TRAIN]
tensor([[ 0.0650, -0.0522,  0.0317,  ...,  0.1121,  0.0204,  0.0625],
        [ 0.0721, -0.0071, -0.1823,  ...,  0.0652,  0.1459, -0.1785],
        [-0.1157,  0.1571,  0.0247,  ...,  0.1273,  0.1050,  0.0128],
        ...,
        [ 0.0718,  0.0439,  0.0175,  ..., -0.0222, -0.0996,  0.0086],
        [-0.1261,  0.0546, -0.0632,  ...,  0.0421, -0.0703, -0.0088],
        [-0.0035, -0.1354,  0.0591,  ...,  0.1018,  0.1000,  0.0601]],
       device='cuda:0', grad_fn=<CatBackward0>) tensor([[    0,     0,     0,  ..., 29149,  4927, 31751],
        [    0,     1,     2,  ..., 31667, 31667, 31667]])
tensor([[ 0.0660, -0.0512,  0.0327,  ...,  0.1130,  0.0214,  0.0635],
        [ 0.0711, -0.0081, -0.1833,  ...,  0.0662,  0.1469, -0.1794],
        [-0.1149,  0.1577,  0.0238,  ...,  0.1281,  0.1059,  0.0119],
        ...,
        [ 0.0718,  0.0439,  0.0175,  ..., -0.0222, -0.0996,  0.0086],
        [-0.1261,  0.0546, -0.0632,  ...,  0.0421, -0.0703, -0.0088],
        [-0.0035, -0.1354,  0.0591,  ...,  0.1018,  0.1000,  0.0601]],
       device='cuda:0', grad_fn=<CatBackward0>) tensor([[    0,     0,     0,  ..., 29149,  4927, 31751],
        [    0,     1,     2,  ..., 31667, 31667, 31667]])

training: 2it [00:02,  1.01s/it]